/*! Sugarizer 2018-05-08 */
enyo.kind({name:"Sugar.SelectBox",kind:enyo.Control,classes:"selectbox-border",published:{selected:-1,items:[],parentMargin:null},events:{onIndexChanged:""},components:[{components:[{name:"icon",kind:"Sugar.Icon",size:20,x:6,y:6,classes:"selectbox-icon"},{name:"text",content:"xxx",classes:"selectbox-text"},{name:"selectpopup",kind:"Sugar.Popup",classes:"selectbox-popup",showing:!1}],ontap:"showPopup"}],create:function(){this.inherited(arguments),this.timer=null,this.itemsChanged(),this.selectedChanged(),this.parentMarginChanged()},itemsChanged:function(){0!=this.items.length&&(this.selected=0,this.selectedChanged())},selectedChanged:function(){this.selected>this.items.length||this.selected<0||(this.$.icon.setIcon(this.items[this.selected].icon),this.$.text.setContent(this.items[this.selected].name))},parentMarginChanged:function(){},showPopup:function(){if(0!=this.items.length){var a=this.hasNode().getClientRects(),b=a[a.length-1];if(null!=this.parentMargin){var c=enyo.dom.calcNodePosition(this.parentMargin.hasNode());b={left:b.left-c.left,top:b.top-c.top}}this.$.selectpopup.setMargin({left:b.left-mouse.position.x+5,top:b.top-mouse.position.y-3}),this.$.selectpopup.setHeader({icon:this.items[0].icon,name:this.items[0].name,action:enyo.bind(this,"setSelection"),data:[0]});for(var d=[],e=1;e<this.items.length;e++)d.push({icon:this.items[e].icon,name:this.items[e].name,action:enyo.bind(this,"setSelection"),data:[e]});this.$.selectpopup.setItems(d),this.$.selectpopup.showPopup(),this.$.selectpopup.showContent(),this.timer=window.setInterval(enyo.bind(this,"hidePopup"),constant.timerPopupDuration)}},hidePopup:function(){return!this.$.selectpopup.cursorIsInside()&&(window.clearInterval(this.timer),this.timer=null,this.$.selectpopup.hidePopup(),!0)},setSelection:function(a){this.selected=a,this.selectedChanged(),window.clearInterval(this.timer),this.timer=null,this.$.selectpopup.hidePopup(),this.doIndexChanged()}});