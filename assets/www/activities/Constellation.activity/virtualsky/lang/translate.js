/*! Sugarizer 2020-03-14 */
!function(a){function b(b){this.q=a.query(),this.id=b&&"string"==typeof b.id?b.id:"form",this.master=b&&"string"==typeof b.master?b.master:"",this.json=b&&"string"==typeof b.json?b.json:"",this.langs=b&&"object"==typeof b.langs?b.langs:{en:"English"},this.setLanguage(),this.lang=this.q.lang,this.lang||(this.lang="en"),this.page=a("#"+this.id),html='<form id="langchoice"><label>Select language (not all are complete):</label><select name="lang">';for(var c in this.langs)html+='<option name="'+c+'" value="'+c+'"'+(this.lang==c?" selected":"")+">"+this.langs[c]+"</option>";return html+="</select></form>",0==a("#translate_chooser").length&&this.page.prepend('<div id="translate_chooser"></div>'),0==a("#translation").length&&this.page.append('<div id="translation"></div>'),a("#translate_chooser").html(html).find("#langchoice select").bind("change",{me:this},function(b){b.data.me.setLanguage(a(this).find("option:selected").val())}),this.setLanguage(this.lang),this}function c(a){if(!a)return"";for(var b="",c=0;c<a.length;c++)a.charCodeAt(c)>127?b+="&amp;#"+a.charCodeAt(c)+";":b+=a.charAt(c);return b}function d(a){return a&&(a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;")),a}jQuery.query=function(){var a={length:0},b=location.search;return b&&"#"!=b&&(b=b.replace(/^\?/,"").replace(/\&$/,""),jQuery.each(b.split("&"),function(){var b=this.split("=")[0],c=this.split("=")[1];/^[0-9.]+$/.test(c)&&(c=parseFloat(c)),a[b]=c,a.length++})),a},b.prototype.setLanguage=function(b){return b&&(this.lang=b),this.loadLanguage(this.lang,function(b){if(b.lang?(this.lang=b.lang,this.phrasebook=b.data?b.data:{language:{name:"",code:b.lang}}):this.masterbook=b.data,this.rebuildForm(),b.lang){var c=a("a.langlink").attr("href");a("a.langlink").attr("href",c.substring(0,c.indexOf("?"))+"?lang="+this.lang),a(".langname").html(this.phrasebook.language.name)}}),this},b.prototype.loadLanguage=function(b,c,d){var e=b?this.json.replace("%LANG%",b):this.master;"string"==typeof d&&(b=d),b&&(this.lang=b),a.ajax({url:e,method:"GET",dataType:"json",context:this,error:function(){console.log("Couldn't load "+b),"en"!=b&&this.loadLanguage("en",c,b)},success:function(a){a&&a.language&&"string"==typeof a.language.code&&(a.language.code=b),a&&a.language&&"string"==typeof a.language.code&&(a.language.name=this.langs[b]),"function"==typeof c&&c.call(this,{data:a,lang:b})}})},b.prototype.rebuildForm=function(){var b='<form id="language">';return b+=this.buildForm(this.masterbook,this.phrasebook,""),b+="</form>",a("#translation").html(b),a("#translation input, #translation textarea, #translation select").attr("dir",this.phrasebook&&this.phrasebook.language&&"right"==this.phrasebook.language.alignment?"rtl":"ltr").unbind().bind("change",{me:this},function(a){a.data.me.getOutput(),a.data.me.percentComplete()}),a('#translation select[name=".language.alignment"]').on("change",function(b){a("#translation input, #translation textarea, #translation select").attr("dir","right"==a(this).val()?"rtl":"ltr")}),this.getOutput(),this.percentComplete(),this},b.prototype.buildForm=function(a,b,c){var e,f,g="",h="",i="";c||(c="");for(key in a)if(e=parseInt(key),h=c+"."+key,"object"==typeof a[key])if(e>=0&&this.previousgroup!=e&&(g+="</div>"),a[key]._text&&a[key]._type){if(i="","textarea"==a[key]._type)f=a[key]._height?' style="height:'+a[key]._height+'"':"",i='<textarea name="'+h+'"'+f+">"+d(b?b[key]:"")+"</textarea>";else if("noedit"==a[key]._type)i='<input type="hidden" name="'+h+'" value="'+d(b?b[key]:"")+'" />'+d(b?b[key]:"");else if("select"==a[key]._type){i='<select name="'+h+'">';for(var j=0;j<a[key]._options.length;j++){var k=b&&a[key]._options[j].value==b[key]?' selected="selected"':"";i+='<option value="'+a[key]._options[j].value+'"'+k+">"+a[key]._options[j].name+"</option>"}i+="</select>"}else"string"==a[key]._type&&(i='<input type="text" name="'+h+'" value="'+d(b&&b[key]?b[key]:"")+'" />');g+=this.row(a[key]._title?a[key]._title:key,a[key]._text,i)}else a[key]._title&&(g+="<h2>"+a[key]._title+"</h2>"),e>=0&&(g+='<div class="group">'),g+=this.buildForm(a[key],b?b[key]:{},h),this.previousgroup=e;return g},b.prototype.percentComplete=function(){var b=100;if("en"!=this.lang){b=Math.floor(100*0/0)}a("#complete").html(b)},b.prototype.row=function(a,b,c){var d=c.indexOf('id="');d=c.substr(d+4),d=d.substr(0,d.indexOf('"'));var e="\t<fieldset>";return e+="\t\t<legend>"+a+"</legend>",e+='\t\t<div class="twocol">',e+="\t\t\t<p>"+b+"</p>",e+="\t\t</div>",e+='\t\t<div class="fourcol">',e+="\t\t\t"+c,e+="\t\t</div>",e+="\t</fieldset>"},b.prototype.getOutput=function(){var b=d(a("form#language").formToJSON(this)),c=b?' style="height:'+(b.split("\n").length+5)+'em;font-family:monospace;"':"",e='<textarea onfocus="this.select()"'+c+' wrap="off">'+b+"</textarea>";0==a("#output").length&&a("#translation").after('<div id="output"></div>'),a("#output").html(e)},a.fn.formToJSON=function(b){function d(a,b,c){for(var d=b.split("."),e=a,f=0;f<d.length-1;f++){var g=d[f];g in e?e=e[g]:(e[g]={},e=e[g])}e[d[d.length-1]]=c}if(b.phrasebook){var e=JSON.parse(JSON.stringify(b.phrasebook));this.find("input, textarea, select").each(function(b){"submit"!=a(this).attr("name")&&d(e,a(this).attr("name").substr(1),c(a(this).val()))})}return JSON.stringify(e,null," ")},a.translator=function(c,d){return"object"==typeof d?d.container=c:d="string"==typeof c?{container:c}:c,d.plugins=a.translator.plugins,new b(d)},a.translator.plugins=[]}(jQuery);