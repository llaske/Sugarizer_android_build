/*! Sugarizer 2020-03-14 */
function main(a,b,c,d,e,f,g,h,i){var j=new b({boardState:[],generation:0,playPauseIcon:"play",shouldPlay:!1,generationTimeInterval:235,gridCols:40,gridRows:20,showTrails:!1}),k=c[0],l=c[1],m=c[2],n=c[3],o=document.querySelector(".main canvas"),p=new a(j.state.boardState,d.fill,"#FBF6F5","#C0C0C0",e(d.stroke,10),d.stroke,12,12,2,2,o),q=document.getElementById("speed-button"),r=(new h.ActivityPalette(q,j),document.getElementById("size-button"));new i.ActivityPalette(r,j,p);document.querySelector(".generation-count").style.color=d.fill,document.querySelector(".generation-status").style.color=d.fill,p.draw(j);var s=function(a){g.setDataAsText({boardState:a.boardState,generation:a.generation,gridCols:a.gridCols,gridRows:a.gridRows,showTrails:a.showTrails}),console.log(a),console.log("writing"),g.save(function(a){a?(console.log("writing failed."),console.error(a)):console.log("writing saved.")})},t=function a(){if(!j.state.shouldPlay)return 0;var b=j.state.boardState.map(function(a,b){return a.map(function(a,c){return u(a,v(c,b))})});j.set(function(a){return{boardState:b,generation:a.generation+1}}),setTimeout(a,j.state.generationTimeInterval)},u=function(a,b){var c=1===a||2===a,d=b.filter(function(a){return 1===a||2===a}),e=d.length;return c?e<2?3:2===e||3===e?1:3:3===e?2:a},v=function(a,b){var c=a-1==-1?j.state.gridCols-1:a-1,d=a+1===j.state.gridCols?0:a+1,e=b-1==-1?j.state.gridRows-1:b-1,f=b+1===j.state.gridRows?0:b+1,g=j.state.boardState;return[g[b][c],g[b][d],g[e][a],g[f][a],g[e][c],g[f][c],g[e][d],g[f][d]]};j.subscribe({boardState:[".fake-selector",function(a,b,c){p.update(b)}],generation:[".generation-count","innerText"],playPauseIcon:["#play-pause",function(a,b,c){a.className=b+" toolbutton"}],shouldPlay:[".fake-selector",function(a,b,c){b&&t()}],gridCols:[".fake-selector",function(a,b,c){document.getElementById("sizevalue").value=b/20,p.handleResize(window.innerWidth,j.state.boardState,j)}],gridRows:[".fake-selector",function(a,b,c){document.getElementById("sizevalue").value=b/10,p.handleResize(window.innerWidth,j.state.boardState,j)}],showTrails:["#deadCells-button",function(a,b,c){b?(a.className="toolbutton active",p.showTrails=!0):(a.className="toolbutton",p.showTrails=!1),p.update(j.state.boardState)}]}),g.loadAsText(function(a,b,c){var d=c?c.boardState:k(j),e=c?c.generation:0,f=c?c.gridCols:40,g=c?c.gridRows:20,h=!!c&&c.showTrails;console.log(c),j.set({boardState:d,generation:parseInt(e),gridCols:parseInt(f),gridRows:parseInt(g),showTrails:h})}),p.onClick(function(a,b){j.set(function(c){var d=[].concat(c.boardState),e=d[b][a];return d[b][a]=1===e||2===e?3:2,{boardState:d}})}),document.querySelector("#play-pause").addEventListener("click",function(){j.set(function(a){var b="play"===a.playPauseIcon?"pause":"play",c=!0!==a.shouldPlay;return a.shouldPlay&&s({boardState:j.state.boardState,generation:j.state.generation,gridCols:j.state.gridCols,gridRows:j.state.gridRows,showTrails:j.state.showTrails}),{playPauseIcon:b,shouldPlay:c}})}),document.querySelector("#deadCells-button").addEventListener("click",function(){p.showTrails?j.set({showTrails:!1}):j.set({showTrails:!0})}),document.querySelector("#stop-button").addEventListener("click",function(){s({boardState:j.state.boardState,generation:j.state.generation,gridCols:j.state.gridCols,gridRows:j.state.gridRows,showTrails:j.state.showTrails})}),document.getElementById("fullscreen-button").addEventListener("click",function(){document.getElementById("main-toolbar").style.opacity=0,document.getElementById("canvas").style.top="0px",document.getElementById("unfullscreen-button").style.visibility="visible",p.handleResize(window.innerWidth,j.state.boardState,j)}),document.getElementById("unfullscreen-button").addEventListener("click",function(){document.getElementById("main-toolbar").style.opacity=1,document.getElementById("canvas").style.top="55px",document.getElementById("unfullscreen-button").style.visibility="hidden",p.handleResize(window.innerWidth,j.state.boardState,j)}),document.querySelector("#random").addEventListener("click",function(){j.set({boardState:k(j),generation:0})}),document.querySelector("#glider").addEventListener("click",function(){j.set({boardState:l(j),generation:0})}),document.querySelector("#no").addEventListener("click",function(){j.set({boardState:m(j),generation:0})}),document.querySelector("#clear").addEventListener("click",function(){j.set({boardState:n(j),generation:0,playPauseIcon:"play",shouldPlay:!1})}),window.addEventListener("resize",function(a){p.handleResize(window.innerWidth,j.state.boardState,j)}),p.handleResize(window.innerWidth,j.state.boardState,j)}define(["sugar-web/activity/activity","webL10n","activity/Board","activity/vanilla-state","activity/patterns","activity/shadeColor","sugar-web/env","genSpeedPalette","gridSizePalette","tutorial"],function(a,b,c,d,e,f,g,h,i,j){requirejs(["domReady!"],function(j){a.setup(),g.getEnvironment(function(g,j){var k="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,l=j.user?j.user.language:k;b.language.code=l,window.addEventListener("localized",function(){document.querySelector(".generation-status").innerText=b.get("Generation"),document.querySelector("#speedlabel").innerText=b.get("speed"),document.querySelector("#sizelabel").innerText=b.get("size")}),a.getXOColor(function(g,j){var k=a.getDatastoreObject();main(c,d,e,j,f,b,k,h,i)})})}),document.querySelector("#help-button").addEventListener("click",function(a){j.start()})});