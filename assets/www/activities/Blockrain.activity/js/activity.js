/*! Sugarizer 2020-03-14 */
define(["sugar-web/activity/activity","sugar-web/env","webL10n","tutorial"],function(a,b,c,d){requirejs(["domReady!"],function(e){function f(){console.log("writing...");var b=JSON.stringify(i);a.getDatastoreObject().setDataAsText(b),a.getDatastoreObject().save(function(a){null===a?console.log("write done."):console.log("write failed.")})}function g(){a.getDatastoreObject().loadAsText(function(a,b,c){null==a&&null!=c&&(i=JSON.parse(c),console.log(i))})}function h(a){var b=Object.keys(BlockrainThemes),c=j.blockrain("theme"),d=b.indexOf(c);a?d++:d--,d>=b.length&&(d=0),d<0&&(d=b.length-1),j.blockrain("theme",b[d])}a.setup(),b.getEnvironment(function(a,b){var d="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,e=b.user?b.user.language:d;c.language.code=e});var i=0;g();var j=$("#canvas").blockrain({speed:20,theme:"candy",autoplay:!1,autoplayRestart:!0,autoBlockWidth:!0,autoBlockSize:24,touchControls:!0,highestScore:i,onStart:function(){},onRestart:function(){g()},onGameOver:function(a){f()},onLine:function(a,b,c){c>i&&(i=c)}});document.getElementById("fullscreen-button").addEventListener("click",function(){document.getElementById("main-toolbar").style.display="none",document.getElementById("canvas").style.top="0px",document.getElementById("unfullscreen-button").style.visibility="visible"}),document.getElementById("unfullscreen-button").addEventListener("click",function(){document.getElementById("main-toolbar").style.display="block",document.getElementById("canvas").style.top="55px",document.getElementById("unfullscreen-button").style.visibility="hidden"}),document.getElementById("stop-button").addEventListener("click",function(a){f()}),document.getElementById("btn-next").onclick=function(){h(!0)},document.getElementById("help-button").addEventListener("click",function(a){d.start()})})});