enyo.kind({name:"TamTam.App",kind:"FittableRows",published:{activity:null},components:[{name:"content",kind:"Scroller",fit:!0,classes:"maincontent",onresize:"resize",components:[{name:"collections",classes:"collections",components:[]},{name:"items",classes:"items",components:[]}]}],openItems:{},handlers:{onSelectionChange:"updateItem"},create:function(){this.inherited(arguments),this.collection=0,this.computeSize();var e=this;requirejs(["sugar-web/env"],(function(t){t.getEnvironment((function(t,o){e.userColor=o.user.colorvalue,e.draw()}))}))},computeSize:function(){var e=document.getElementById("main-toolbar"),t=document.getElementById("body").offsetHeight;this.$.content.applyStyle("height",t-e.offsetHeight+"px")},resize:function(){this.computeSize(),this.draw()},draw:function(){var e=[];enyo.forEach(this.$.collections.getControls(),(function(t){e.push(t)}));var t=[];enyo.forEach(this.$.items.getControls(),(function(e){t.push(e)}));for(var o=0;o<e.length;o++)e[o].destroy();for(o=0;o<t.length;o++)t[o].destroy();if(pianoMode){if(document.getElementById("body").style.backgroundColor="#ffffff",this.$.collections.applyStyle("background-color","#ffffff"),null!==currentPianoMode)(n=this.$.items.createComponent({kind:"TamTam.Item",name:currentPianoMode},{owner:this}).render()).applyStyle("background-color",this.userColor.stroke),n.render();this.$.items.createComponent({kind:"TamTam.Piano"},{owner:this}).render()}else if(simonMode){var n;if(document.getElementById("body").style.backgroundColor="#ffffff",this.$.collections.applyStyle("background-color","#ffffff"),null!==currentSimonMode)(n=this.$.items.createComponent({kind:"TamTam.Item",name:currentSimonMode},{owner:this}).render()).applyStyle("background-color",this.userColor.stroke),n.render();this.$.items.createComponent({kind:"TamTam.Simon"},{owner:this}).render()}else{document.getElementById("body").style.backgroundColor=this.userColor.fill,this.$.collections.applyStyle("background-color",this.userColor.fill);var i=TamTam.collections.length;for(o=0;o<i;o++)this.$.collections.createComponent({kind:"TamTam.Collection",name:TamTam.collections[o].name,selection:o==this.collection,ontap:"changeCollection"},{owner:this}).render();var s=TamTam.collections[this.collection];for(i=s.content.length,o=0;o<i;o++)this.openItems[s.content[o]]=this.$.items.createComponent({kind:"TamTam.Item",name:s.content[o]},{owner:this}),this.openItems[s.content[o]].applyStyle("background-color",this.userColor.stroke),this.openItems[s.content[o]].render()}},updateItem:function(e,t){void 0!==this.openItems[t.toChange]&&this.openItems[t.toChange].deselect()},changeCollection:function(e,t){for(var o=TamTam.collections.length,n=0;n<o;n++)if(TamTam.collections[n].name==e.name)return this.collection=n,void this.draw()},changePianoMode:function(e){pianoMode=!0,simonMode=!1,document.getElementById("piano-button").classList.add("active"),document.getElementById("simon-button").classList.remove("active"),document.getElementById("instruments-button").classList.remove("active"),this.draw()},changeSimonMode:function(e){simonMode=!0,pianoMode=!1,document.getElementById("simon-button").classList.add("active"),document.getElementById("piano-button").classList.remove("active"),document.getElementById("instruments-button").classList.remove("active"),this.draw()},changeInstrumentsMode:function(e){simonMode=!1,pianoMode=!1,document.getElementById("instruments-button").classList.add("active"),document.getElementById("piano-button").classList.remove("active"),document.getElementById("simon-button").classList.remove("active"),this.draw()},setContext:function(e){pianoMode=e.piano,currentPianoMode=e.currentPianoMode,simonMode=e.simon,currentSimonMode=e.currentSimonMode,simonMode&&(document.getElementById("simon-button").classList.add("active"),document.getElementById("piano-button").classList.remove("active"),document.getElementById("instruments-button").classList.remove("active")),pianoMode&&(document.getElementById("piano-button").classList.add("active"),document.getElementById("simon-button").classList.remove("active"),document.getElementById("instruments-button").classList.remove("active"))},getContext:function(){return{piano:pianoMode,currentPianoMode:currentPianoMode,simon:simonMode,currentSimonMode:currentSimonMode}}});