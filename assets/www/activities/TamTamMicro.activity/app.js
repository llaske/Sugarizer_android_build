/*! Sugarizer 2020-03-14 */
enyo.kind({name:"TamTam.App",kind:"FittableRows",published:{activity:null},components:[{name:"content",kind:"Scroller",fit:!0,classes:"maincontent",onresize:"resize",components:[{name:"collections",classes:"collections",components:[]},{name:"items",classes:"items",components:[]}]}],openItems:{},handlers:{onSelectionChange:"updateItem"},create:function(){this.inherited(arguments),this.collection=0,this.computeSize();var a=this;requirejs(["sugar-web/env"],function(b){b.getEnvironment(function(b,c){a.userColor=c.user.colorvalue,a.draw()})})},computeSize:function(){var a=document.getElementById("main-toolbar"),b=document.getElementById("body"),c=b.offsetHeight;this.$.content.applyStyle("height",c-a.offsetHeight+"px")},resize:function(){this.computeSize(),this.draw()},draw:function(){var a=[];enyo.forEach(this.$.collections.getControls(),function(b){a.push(b)});var b=[];enyo.forEach(this.$.items.getControls(),function(a){b.push(a)});for(var c=0;c<a.length;c++)a[c].destroy();for(var c=0;c<b.length;c++)b[c].destroy();if(pianoMode){if(document.getElementById("body").style.backgroundColor="#ffffff",this.$.collections.applyStyle("background-color","#ffffff"),null!==currentPianoMode){var d=this.$.items.createComponent({kind:"TamTam.Item",name:currentPianoMode},{owner:this}).render();d.applyStyle("background-color",this.userColor.stroke),d.render()}this.$.items.createComponent({kind:"TamTam.Piano"},{owner:this}).render()}else{document.getElementById("body").style.backgroundColor=this.userColor.fill,this.$.collections.applyStyle("background-color",this.userColor.fill);for(var e=TamTam.collections.length,c=0;c<e;c++)this.$.collections.createComponent({kind:"TamTam.Collection",name:TamTam.collections[c].name,selection:c==this.collection,ontap:"changeCollection"},{owner:this}).render();for(var f=TamTam.collections[this.collection],e=f.content.length,c=0;c<e;c++)this.openItems[f.content[c]]=this.$.items.createComponent({kind:"TamTam.Item",name:f.content[c]},{owner:this}),this.openItems[f.content[c]].applyStyle("background-color",this.userColor.stroke),this.openItems[f.content[c]].render()}},updateItem:function(a,b){void 0!==this.openItems[b.toChange]&&this.openItems[b.toChange].deselect()},changeCollection:function(a,b){sound.pause();for(var c=TamTam.collections.length,d=0;d<c;d++)if(TamTam.collections[d].name==a.name)return this.collection=d,void this.draw()},changePianoMode:function(a){pianoMode=!pianoMode,pianoMode?document.getElementById("piano-button").classList.add("active"):document.getElementById("piano-button").classList.remove("active"),this.draw()}});