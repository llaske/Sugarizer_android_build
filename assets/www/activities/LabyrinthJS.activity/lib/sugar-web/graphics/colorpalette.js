/*! Sugarizer 2019-09-21 */
define(["sugar-web/graphics/palette","mustache"],function(a,b){function c(a){for(var b=a.split("(")[1].split(")")[0].split(","),c=0;c<b.length;c++)b[c]=parseInt(b[c]);return b}function d(){function a(a){PaintApp.data.color.fill=a.detail.color}function b(a){PaintApp.data.color.stroke=a.detail.color}var c=document.getElementById("colors-button-fill"),d=new PaintApp.palettes.colorPalette.ColorPalette(c,void 0),e=document.getElementById("colors-button-stroke"),f=new PaintApp.palettes.colorPalette.ColorPalette(e,void 0);d.addEventListener("colorChange",a);d.getPalette().querySelector(".palette-invoker");d.setColor(0),f.addEventListener("colorChange",b);f.getPalette().querySelector(".palette-invoker");f.setColor(2)}var e={};e.initGui=d,e.ColorPalette=function(d,e){function f(a){colors=c(a),k.inputSliders[0].value=colors[0],k.inputSliders[1].value=colors[1],k.inputSliders[2].value=colors[2]}function g(a,b,c){d.style.backgroundColor=a.target.style.backgroundColor,k.colorChangeEvent.detail.color=a.target.style.backgroundColor,k.getPalette().dispatchEvent(k.colorChangeEvent),k.getPalette().querySelector(".palette-invoker").style.backgroundColor=a.target.style.backgroundColor,null!==b&&void 0!==b&&!0!==b||k.popDown(),null!==c&&void 0!==c&&!0!==c||f(k.colorChangeEvent.detail.color)}function h(){g({target:{style:{backgroundColor:"rgb("+k.inputSliders[0].value+","+k.inputSliders[1].value+","+k.inputSliders[2].value+")"}}},!1,!1)}this.invoker=d,a.Palette.call(this,d,e),this.getPalette().className+=" colorpalette",this.colorChangeEvent=document.createEvent("CustomEvent"),this.colorChangeEvent.initCustomEvent("colorChange",!0,!0,{color:"#ed2529"}),this.template='        <style>            @media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {                input[type=range] {                    width:100px;                    background-color: transparent !important; /* Hides the slider so custom styles can be added */                }                }        </style>        <div style="width:370px;">          <div style="float:left; width: 190px;">              <table>                <tbody>                {{#rows}}                    <tr>                      {{#.}}                        <td>                          <button style="background-color: {{ color }}"></button>                        </td>                      {{/.}}                    </tr>                  {{/rows}}                </tbody>                </table>              </div>          <div style="float:left; width: 150px; padding-top:10px">          Red          <input class="multiplatformInputSlider" type="range"  min="0" max="255" />          <br/>          <br/>          Green          <input class="multiplatformInputSlider" type="range"  min="0" max="255" />          <br/>          <br/>          Blue          <input class="multiplatformInputSlider" type="range"  min="0" max="255" />          </div>      </div>';var i=document.createElement("div");i.className="colors";var j={rows:[[{color:"#FF2B34"},{color:"#00EA11"},{color:"#005FE4"}],[{color:"#FF8F00"},{color:"#008009"},{color:"#00A0FF"}],[{color:"#FFFA00"},{color:"#A700FF"},{color:"#5E008C"}],[{color:"#000000"},{color:"#919496"},{color:"#ffffff"}]]};i.innerHTML=b.render(this.template,j),this.setContent([i]),i.parentNode.style.backgroundColor="black",i.parentNode.parentNode.style.maxWidth="400px",i.parentNode.style.width="330px",i.parentNode.style.height="225px",i.parentNode.style.overflowY="auto",i.parentNode.style.overflowX="hidden",this.buttons=i.querySelectorAll("button");var k=this;k.colorsElem=i;var l=i.querySelectorAll("input[type=range]");k.inputSliders=l;for(var m=0;m<l.length;m++)l[m].onchange=function(a){h()};for(var m=0;m<this.buttons.length;m++)this.buttons[m].addEventListener("click",g)};var f=function(a){for(var b=0;b<this.buttons.length;b++)if(this.buttons[b].style.backgroundColor==a){var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0),this.buttons[b].dispatchEvent(d);break}var e=c(a);this.inputSliders[0].value=e[0],this.inputSliders[1].value=e[1],this.inputSliders[2].value=e[2],this.getPalette().querySelector(".palette-invoker").style.backgroundColor=a,this.invoker.style.backgroundColor=a},g=function(a,b,c){return this.getPalette().addEventListener(a,b,c)};return e.ColorPalette.prototype=Object.create(a.Palette.prototype,{setColor:{value:f,enumerable:!0,configurable:!0,writable:!0},addEventListener:{value:g,enumerable:!0,configurable:!0,writable:!0}}),e});