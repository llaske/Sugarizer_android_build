/*! Sugarizer 2020-03-14 */
function loadData(a,b,c){var d=0;"undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.storage.local.get("sugar_settings",function(a){d=500}):d=0,setTimeout(function(){a.getDatastoreObject().loadAsText(function(a,d,e){if(null!=e){var f=JSON.parse(e);null!=f&&(f.game&&(b.game=f.game,b.game.multiplayer=!1,b.game.selectedCards=[],b.game.currentPlayer="",b.game.players=[]),c&&c())}})},d)}function initPresence(a,b,c,d){a.getPresenceObject(function(e,f){b.presence=f;var g=document.getElementById("network-button"),h=new c.PresencePalette(g,void 0,f);f.onSharedActivityUserChanged(function(a){h.onSharedActivityUserChanged(a)}),h.onUsersListChanged(function(a){b.onUsersListChanged(a)}),window.top&&window.top.sugar&&window.top.sugar.environment&&window.top.sugar.environment.sharedId?(shareActivity(a,f,b,!1),h.setShared(!0)):h.addEventListener("shared",function(){h.popDown(),shareActivity(a,f,b,!0)}),d&&d()})}function shareActivity(a,b,c,d){c.shareActivity(d);b.getUserInfo();window.top.sugar.environment.sharedId||b.createSharedActivity("org.olpcfrance.MemorizeActivity",function(a){}),b.onConnectionClosed(function(a){console.log(a),console.log("Connection closed")}),b.onDataReceived(function(a){c.onDataReceived(a)}),b.listUsers(function(a){console.log(a)})}define(function(a){requirejs(["domReady!","sugar-web/activity/activity","sugar-web/graphics/presencepalette","sugar-web/env","webL10n","activity/memorize-app"],function(a,b,c,d,e,f){window.memorizeApp=f,f.activity=b,f.activity.setup(),d.getEnvironment(function(a,b){var c="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,d=b.user?b.user.language:c;window.addEventListener("localized",function(a){a.language!=d&&setTimeout(function(){e.language.code=d},50)})}),window.top.sugar.environment.sharedId?f.initUI(function(){initPresence(f.activity,f,c)}):f.initUI(function(){initPresence(f.activity,f,c),f.computeCards(!0),f.drawGame(),loadData(f.activity,f,function(){f.drawGame()})});var g=function(){var a=Math.min(document.body.clientHeight,document.body.clientWidth),b=document.getElementById("game-grid").offsetWidth,c=a/b;document.getElementById("game-grid").style.zoom=c},h=function(){document.getElementById("game-grid").style.zoom=1};document.getElementById("fullscreen-button").addEventListener("click",function(){document.getElementById("main-toolbar").style.display="none",document.getElementById("unfullscreen-button").style.visibility="visible",g()}),document.getElementById("unfullscreen-button").addEventListener("click",function(){document.getElementById("main-toolbar").style.display="",document.getElementById("unfullscreen-button").style.visibility="hidden",h()})})});