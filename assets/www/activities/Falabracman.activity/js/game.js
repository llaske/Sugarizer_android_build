/*! Sugarizer 2020-03-14 */
function Game(a,b,c,d){this.homeScreen=!0,this.playScreen=!1,this.PlayerStop=!0,this.gameEnded=!1,this.obstacles=[],this.frameWidth=76,this.frameHeight=80,this.obstWidth=130,this.obstHeight=64,this.prevCanvasWidth=a.width,this.prevCanvasHeight=a.height,this.lives=3,this.frameX=0,this.frameY=0,this.frameNo=0,this.framesSequenceNo=0,this.playerX=.88*a.width,this.playerY=.15*a.height,this.key=void 0,this.lastTime=Date.now(),this.PlayerTimeInterval=25,this.playerSpeed=(2+a.width/screen.width*(screen.width/300))/this.PlayerTimeInterval,this.targetWord="",this.targetWordLetters=[],this.targetLetterSize=.1*screen.height,this.homeScreenFontSize=.07*a.height,this.menuSelected=0,this.menuTexts=[],this.settingScreen=!1,this.useCustomDict=!1,this.customDictWordEdit=!1,this.wordInSetting=null,this.customDict=[],this.wordToBeEdited=null,this.customDictLang=null,this.splashAudio=new Audio("./sounds/splash.mp3"),this.aplausoAudio=new Audio("./sounds/aplauso.mp3"),this.moneyAudio=new Audio("./sounds/money.mp3"),this.menuAudio=new Audio("./sounds/menu.mp3"),this.gameAudio=new Audio("./sounds/menumusic22.mp3"),this.main=function(){this.useCustomDict||this.initializeCustomDict(),this.homeScreen?this.drawHomeScreen():this.creditScreen?this.drawCreditScreen():this.settingScreen?this.drawSettingScreen():this.playScreen&&(this.initializeObstacles(),this.generateTargetWord(),this.run())},this.reset=function(b,c){this.PlayerStop=!0,this.gameEnded=!1,this.lives=null!=c?c:3,this.targetWordLetters=[],this.obstacles=[],this.frameNo=0,this.playerX=.88*a.width,this.playerY=.15*a.height,b||(this.initializeObstacles(),this.generateTargetWord())},this.resizeImagesAndFont=function(){var b=.95,c=130/64,d=a.width/a.height;b>=d?(this.frameWidth=.1*a.width,this.frameHeight=this.frameWidth/b):(this.frameHeight=.1*a.height,this.frameWidth=this.frameHeight*b),c>=d?(this.obstWidth=.1*a.width,this.obstHeight=this.obstWidth/c):(this.obstHeight=.1*a.height,this.obstWidth=this.obstHeight*c),this.targetLetterSize=1>=d?.1*a.width:.1*a.height,this.homeScreenFontSize=.07*a.height},this.resizeGame=function(b,c){for(var d=this.playerX/this.prevCanvasWidth,e=this.playerY/this.prevCanvasHeight,f=[],g=[],h=0;h<this.obstacles.length;h++){var i=this.obstacles[h].x/this.prevCanvasWidth,j=this.obstacles[h].y/this.prevCanvasHeight,k={xr:i,yr:j};f.push(k)}for(var h=0;h<this.targetWordLetters.length;h++){var i=this.targetWordLetters[h].x/this.prevCanvasWidth,j=this.targetWordLetters[h].y/this.prevCanvasHeight,k={xr:i,yr:j};g.push(k)}a.width=b,a.height=c,this.prevCanvasWidth=b,this.prevCanvasHeight=c,this.resizeImagesAndFont(),this.playerX=d*a.width,this.playerY=e*a.height,this.playerSpeed=(2+a.width/screen.width*(2+screen.width/300))/this.PlayerTimeInterval;for(var h=0;h<this.obstacles.length;h++)this.obstacles[h].x=f[h].xr*a.width,this.obstacles[h].y=f[h].yr*a.height;for(var h=0;h<g.length;h++)this.targetWordLetters[h].x=g[h].xr*a.width,this.targetWordLetters[h].y=g[h].yr*a.height;this.resizeSettingScreen(),this.homeScreen?this.drawHomeScreen():this.settingScreen&&this.drawSettingScreen()},this.drawHomeScreen=function(){var c=a.getContext("2d"),d=b.get("./images/menu.jpg");c.drawImage(d,0,0,a.width,a.height),this.drawMenu()},this.drawMenu=function(){var b=a.getContext("2d");b.textBaseline="top";var c=["Play","Credits","Settings","Quit"];this.menuTexts=[];var e=this;document.fonts.load(e.homeScreenFontSize+"px ds_moster").then(function(){for(var f=0;f<c.length;f++){e.menuSelected==f?b.fillStyle="Red":b.fillStyle="Black",b.font=e.homeScreenFontSize+"px ds_moster";var g=d.get(c[f]),h={x:a.width/4,y:a.height/2+f*e.homeScreenFontSize+10*f,text:g};e.menuTexts.push(h),b.fillText(g,h.x,h.y)}})},this.drawCreditScreen=function(){var c=a.getContext("2d"),d=b.get("./images/splash.jpg"),e=b.get("./images/creditos.jpg");c.drawImage(d,0,0,a.width,a.height);var f=this;setTimeout(function(){c.drawImage(e,0,0,a.width,a.height),setTimeout(function(){f.homeScreen=!0,f.creditScreen=!1,f.drawHomeScreen()},2e3)},2e3)},this.initializeCustomDict=function(a){this.customDict=[],this.customDictLang=d.language.code;if(null==a)for(var b=c.defaultDict.length,e=0;e<b;e++){var f=d.get(c.defaultDict[e]);this.customDict.push(f)}else this.customDict=a},this.resizeSettingScreen=function(){var a=document.getElementById("settingScreen"),b=document.getElementById("panel-body"),c=document.getElementById("word");a.style.top=.15*window.innerHeight+"px",a.style.left=.05*window.innerWidth+"px",a.style.right=.05*window.innerWidth+"px",a.style.width=.9*window.innerWidth+"px",a.style.height=.8*window.innerHeight+"px",window.innerHeight<500?b.style.height=.2*window.innerHeight+"px":b.style.height=.4*window.innerHeight+"px",b.style.width="100%",c.style.width=.9*window.innerWidth+"px"},this.drawSettingScreen=function(){var c=a.getContext("2d"),d=b.get("./images/setting.jpg");c.drawImage(d,0,0,a.width,a.height);var e=document.getElementById("settingScreen"),f=document.getElementById("dictionary");e.style.visibility="visible",this.resizeSettingScreen();var g=this.wordInSetting;if(f.innerHTML="",this.customDictWordEdit){var h=document.createElement("li"),i='<div class="dictRow"><div>'+g+'</div><div><button type="button" id="'+this.wordToBeEdited+'" class="settingButtons saveEditWord" name="button" title="Okay"></button><button type="button" id="'+this.wordToBeEdited+'" class="settingButtons resetEditWord" name="button" title="Cancel"></button></div></div>';h.innerHTML=i,f.appendChild(h)}else for(var j=0;j<this.customDict.length;j++){var k=this.customDict[j];if(null!=g){if(k.toUpperCase().startsWith(g.toUpperCase())){var h=document.createElement("li"),i='<div class="dictRow"><div>'+k+'</div><div><button type="button" id="'+k+'" class="settingButtons editWord" name="button" title="Edit"></button>';1!=this.customDict.length&&(i+='<button type="button" id="'+k+'" class="settingButtons deleteWord" name="button title="Delete""></button>'),i+="</div></div>",h.innerHTML=i,f.appendChild(h)}}else{var h=document.createElement("li"),i='<div class="dictRow"><div>'+k+'</div><div><button type="button" id="'+k+'" class="settingButtons editWord" name="button" title="Edit"></button>';1!=this.customDict.length&&(i+='<button type="button" id="'+k+'" class="settingButtons deleteWord" name="button" title="Delete"></button>'),i+="</div></div>",h.innerHTML=i,f.appendChild(h)}}},this.run=function(){var c=a.getContext("2d");if(c.clearRect(0,0,a.width,a.height),this.playScreen){void 0!=this.key&&this.gameAudio.play();var d;d=b.get("./images/barra.jpg"),c.drawImage(d,0,0,a.width,.15*a.height);var e;e=b.get("./images/fondo.jpg"),c.drawImage(e,0,.15*a.height,a.width,.85*a.height);for(var f=0;f<this.obstacles.length;f++){var g,h=this.obstacles[f].x,i=this.obstacles[f].y,j=this.obstacles[f].j;g=b.get("./images/lago"+j+".png"),c.drawImage(g,h,i,this.obstWidth,this.obstHeight)}this.drawTargetLetters();for(var f=1;f<=this.lives;f++){var k;k=b.get("./images/zeek0.png");var h=.95*a.width-f*this.frameWidth;c.drawImage(k,h,10,this.frameWidth,this.frameHeight)}this.movePlayerSprite();var l=this.checkIfGameEnded();if(this.gameEnded){this.drawEndGameScreen(l);var m=this;setTimeout(function(){if(l){var a=m.lives;m.reset(!1,a)}else m.reset(!0),m.playScreen=!1,m.homeScreen=!0,display="homeScreen",m.gameAudio.pause();requestAnimationFrame(m.run.bind(m))},2e3)}else requestAnimationFrame(this.run.bind(this))}else this.main()},this.initializeObstacles=function(){this.resizeImagesAndFont();for(var b=0;b<6;){for(var c=[],d=0;d<6;d++)1==obstaclesPossiblePos[b][d]&&c.push(d);for(var e=b*this.obstWidth+this.frameWidth,f=c[Math.floor(Math.random()*c.length)]*a.height*.1+this.frameHeight+.15*a.height,g=Math.floor(4*Math.random()),h={x:e,y:f,j:g},i=!0,d=0;d<this.obstacles.length;d++){if(this.collides({x:e,y:f,width:this.obstWidth,height:this.obstHeight},{x:this.obstacles[d].x,y:this.obstacles[d].y,width:this.obstWidth,height:this.obstHeight})){i=!1;break}i=!0}i&&(b++,this.obstacles.push(h))}this.aplausoAudio.play()},this.generateTargetWord=function(){var b=c.getRandomWord();this.useCustomDict?this.targetWord=b.toUpperCase():this.targetWord=d.get(b).toUpperCase();for(var e=this.targetWord.split(""),f=0;f<e.length;){for(var g=Math.floor(Math.random()*a.width*.7)+.1*a.width,h=Math.floor(Math.random()*a.height*.65)+.2*a.height,i=e[f],j={x:g,y:h,letter:i},k=!0,l=!0,m=0;m<this.obstacles.length;m++){var n=this.collides({x:g,y:h,width:this.targetLetterSize,height:this.targetLetterSize},{x:this.obstacles[m].x,y:this.obstacles[m].y,width:.1*screen.width,height:.1*screen.height});if(n){k=!1;break}k=!0}for(var m=0;m<this.targetWordLetters.length;m++){var n=this.collides({x:g,y:h,width:this.targetLetterSize,height:this.targetLetterSize},{x:this.targetWordLetters[m].x,y:this.targetWordLetters[m].y,width:this.targetLetterSize,height:this.targetLetterSize});if(n){l=!1;break}l=!0}k&&l&&(f++,this.targetWordLetters.push(j))}},this.drawTargetLetters=function(){var b=a.getContext("2d"),c=this.targetWord.length-this.targetWordLetters.length;b.font=this.targetLetterSize+"px VeraBd",b.fillStyle="white",b.strokeStyle="Black";var d=this.targetWord.substr(0,c);b.strokeText(d,15,20),b.fillText(d,15,20),b.fillStyle="Black",b.strokeStyle="White";var e=this.targetWord.substr(c);b.strokeText(e,15+b.measureText(d).width,20),b.fillText(e,15+b.measureText(d).width,20);for(var f=0;f<this.targetWordLetters.length;f++){var g=this.targetWordLetters[f].x,h=this.targetWordLetters[f].y,i=this.targetWordLetters[f].letter;b.font=this.targetLetterSize+"px VeraBd",b.fillStyle="White",b.textBaseline="top",b.strokeStyle="Black",b.fillText(i,g,h),b.strokeText(i,g,h),b.stroke()}},this.movePlayerSprite=function(){var c=a.getContext("2d");"LEFT"==this.key&&Date.now()-this.lastTime>=this.PlayerTimeInterval&&(this.playerNobstaclesCollision(),this.playerX<=0&&(this.PlayerStop=!0,this.frameNo=4),this.PlayerStop||(3==this.framesSequenceNo?(this.framesSequenceNo=0,this.frameNo=framesSequence.LEFT[this.framesSequenceNo]):(this.framesSequenceNo++,this.frameNo=framesSequence.LEFT[this.framesSequenceNo]),this.playerX-=this.playerSpeed*this.PlayerTimeInterval),this.lastTime=Date.now()),"UP"==this.key&&Date.now()-this.lastTime>=this.PlayerTimeInterval&&(this.playerNobstaclesCollision(),this.playerY<=.15*a.height&&(this.PlayerStop=!0,this.frameNo=9),this.PlayerStop||(3==this.framesSequenceNo?(this.framesSequenceNo=0,this.frameNo=framesSequence.UP[this.framesSequenceNo]):(this.framesSequenceNo++,this.frameNo=framesSequence.UP[this.framesSequenceNo]),this.playerY-=this.playerSpeed*this.PlayerTimeInterval),this.lastTime=Date.now()),"RIGHT"==this.key&&Date.now()-this.lastTime>=this.PlayerTimeInterval&&(this.playerNobstaclesCollision(),this.playerX+this.frameWidth>=a.width&&(this.PlayerStop=!0,this.frameNo=1),this.PlayerStop||(3==this.framesSequenceNo?(this.framesSequenceNo=0,this.frameNo=framesSequence.RIGHT[this.framesSequenceNo]):(this.framesSequenceNo++,this.frameNo=framesSequence.RIGHT[this.framesSequenceNo]),this.playerX+=this.playerSpeed*this.PlayerTimeInterval),this.lastTime=Date.now()),"DOWN"==this.key&&Date.now()-this.lastTime>=this.PlayerTimeInterval&&(this.playerNobstaclesCollision(),this.playerY+this.frameHeight>=a.height&&(this.PlayerStop=!0,this.frameNo=0),this.PlayerStop||(3==this.framesSequenceNo?(this.framesSequenceNo=0,this.frameNo=framesSequence.DOWN[this.framesSequenceNo]):(this.framesSequenceNo++,this.frameNo=framesSequence.DOWN[this.framesSequenceNo]),this.playerY+=this.playerSpeed*this.PlayerTimeInterval),this.lastTime=Date.now()),this.checkIfWordsCollected();var d;d=b.get("./images/zeek"+this.frameNo+".png"),c.drawImage(d,this.playerX,this.playerY,this.frameWidth,this.frameHeight)},this.checkIfWordsCollected=function(){this.targetWordLetters.length>0&&this.collides({x:this.playerX,y:this.playerY,width:this.frameWidth,height:this.frameHeight},{x:this.targetWordLetters[0].x,y:this.targetWordLetters[0].y,width:30,height:30})&&(this.targetWordLetters.splice(0,1),this.moneyAudio.play(),this.drawTargetLetters())},this.playerNobstaclesCollision=function(){for(var b,c=0;c<this.obstacles.length&&!(b=this.collides({x:this.obstacles[c].x,y:this.obstacles[c].y,width:this.obstWidth,height:this.obstHeight},{x:this.playerX,y:this.playerY,width:this.frameWidth,height:this.frameHeight}));c++);return b&&(this.PlayerStop=!0,this.lives--,this.playerX=.88*a.width,this.playerY=.15*a.height,this.frameNo=0,this.splashAudio.play()),b},this.collides=function(a,b){return a.x<b.x+b.width&&a.x+a.width>b.x&&a.y<b.y+b.height&&a.y+a.height>b.y},this.drawEndGameScreen=function(c){var d,e=a.getContext("2d");d=c?b.get("./images/ganaste.png"):b.get("./images/perdio.png"),e.drawImage(d,0,0,a.width,a.height)},this.checkIfGameEnded=function(){return 0!=this.targetWordLetters.length||this.gameEnded?-1!=this.lives||this.gameEnded?void 0:(this.gameEnded=!0,!1):(this.gameEnded=!0,!0)}}var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;const obstaclesPossiblePos=[[1,1,1,0,1,1],[1,0,1,0,0,1],[1,0,1,1,1,1],[1,0,0,0,1,0],[1,1,1,0,1,1],[1,0,1,0,1,1]],framesSequence={LEFT:[4,5,4,6],RIGHT:[1,2,1,3],UP:[9,10,9,11],DOWN:[0,7,0,8]};define(function(){return Game});