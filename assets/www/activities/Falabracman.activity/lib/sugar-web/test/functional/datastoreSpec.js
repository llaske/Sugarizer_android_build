/*! Sugarizer 2020-03-14 */
define(["sugar-web/bus","sugar-web/env","sugar-web/datastore"],function(a,b,c){"use strict";var d=jasmine.getEnv().defaultTimeoutInterval;describe("datastore object",function(){beforeEach(function(){jasmine.getEnv().defaultTimeoutInterval=1e4,spyOn(b,"isStandalone").andReturn(!1),a.listen()}),afterEach(function(){jasmine.getEnv().defaultTimeoutInterval=d,a.close()}),it("should be able to set and get metadata",function(){var a,b,d,e,f="hello";runs(function(){a=!1,d=new c.DatastoreObject,d.setMetadata({title:f}),d.save(function(){a=!0,e=d.objectId})}),waitsFor(function(){return a},"should have saved the object"),runs(function(){b=!1,d=new c.DatastoreObject(e),d.getMetadata(function(a,c){expect(c.title).toEqual(f),b=!0})}),waitsFor(function(){return b},"should have got the object metadata")}),it("should be able to save and load text",function(){var a,b,d,e,f="hello";runs(function(){a=!1,d=new c.DatastoreObject,d.setDataAsText(f),d.save(function(){a=!0,e=d.objectId})}),waitsFor(function(){return a},"should have saved the object"),runs(function(){function a(a,c,d){expect(d).toEqual(f),b=!0}b=!1,d=new c.DatastoreObject(e),d.loadAsText(a)}),waitsFor(function(){return b},"should have got the object metadata")})}),describe("datastore",function(){beforeEach(function(){jasmine.getEnv().defaultTimeoutInterval=1e4,spyOn(b,"isStandalone").andReturn(!1),a.listen()}),afterEach(function(){jasmine.getEnv().defaultTimeoutInterval=d,a.close()}),it("should be able to create an object",function(){var a;runs(function(){function b(b,c){expect(c).toEqual(jasmine.any(String)),a=!0}a=!1,c.create({},b)}),waitsFor(function(){return a},"the object should be created")}),it("should be able to set object metadata",function(){var a,b,d,e="hello";runs(function(){function b(b){expect(b).toBeNull(),a=!0}function f(a,f){d=f;var g={title:e};c.setMetadata(d,g,b)}a=!1,c.create({},f)}),waitsFor(function(){return a},"metadata should be set"),runs(function(){function a(a,c){expect(c.title).toEqual(e),b=!0}b=!1,c.getMetadata(d,a)}),waitsFor(function(){return b},"should have got object metadata")}),it("should be able to get object metadata",function(){var a=!1,b="hello";runs(function(){function d(c,d){expect(d.title).toEqual(b),a=!0}function e(a,b){c.getMetadata(b,d)}c.create({title:b},e)}),waitsFor(function(){return a},"should have got object metadata")}),it("should be able to load an object",function(){var a=!1,b=null,d=null,e=null,f=new Uint8Array([1,2,3,4]);runs(function(){function g(b){expect(e).toEqual(f.buffer),a=!0}function h(a,b){e=b}function i(a,b,c){d=c,d.read(8192,h),d.close(g)}function j(a){c.load(b,i)}function k(a,b){b.write(f),b.close(j)}function l(a,d){b=d,c.save(b,{},k)}c.create({},l)}),waitsFor(function(){return a},"the object should be loaded")})})});