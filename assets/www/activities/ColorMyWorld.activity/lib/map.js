define(["activity/ol","print","util","colormyworld","humane"],(function(e,t,o,l,r){var n={map:null,featureOverlay:null,HILIGHTS:[],tooltipDisplay:null,test:function(){return INSTALLED.keys}};return n.setup_map=function(){window.map=new e.Map({layers:[],target:"cmw_bg",view:new e.View({center:e.proj.transform(INSTALLED.Africa.center,"EPSG:4326","EPSG:3857"),zoom:2})}),window.map.on("click",(function(o){if(l.mode==COLORING){var i=!1;dummmy=window.map.forEachFeatureAtPixel(o.pixel,(function(o,a){var u=o.get("NAME");if(u||(u=o.get("Name")),u||(u=o.get("name")),l.currents.indexOf(u)<0){n.tooltipDisplay&&u==n.tooltipDisplay||(n.tooltipDisplay=u,r.timeout=1e3,r.log(document.webL10n.get(u.replace(/ /g,"_")).replace(/_/g," ")),setTimeout((function(){n.tooltipDisplay=null}),r.timeout));var c=l.getRGBColorString();t(c);var f=new e.style.Style({fill:new e.style.Fill({color:l.getRGBColorString()}),stroke:new e.style.Stroke({color:DEFAULT_STROKE,width:1})});o.setStyle(f),i=!0}})),i||l.set_background(null)}else l.check_feature(o.pixel)}));var o,i={};n.featureOverlay=new e.layer.Vector({source:new e.source.Vector,map:window.map,style:function(t,o){return i[""]||(i[""]=new e.style.Style({stroke:new e.style.Stroke({color:"#ff0",width:1}),fill:new e.style.Fill({color:"rgba(0,200,0,0.2)"}),text:new e.style.Text({font:"12px Calibri,sans-serif",text:"",fill:new e.style.Fill({color:"#000"}),stroke:new e.style.Stroke({color:"#ff0",width:3})})})),i[""]}});window.map.on("pointermove",(function(e){e.dragging||function(e){var t=map.forEachFeatureAtPixel(e,(function(e){return e})),r=null;t&&((r=t.get("name"))||(r=t.get("Name")),r||(r=t.get("NAME"))),REGION_NAMES.indexOf(r)>-1||l.mode!=TOUR&&t!==o&&(o&&n.featureOverlay.getSource().removeFeature(o),t&&n.featureOverlay.getSource().addFeature(t),o=t)}(window.map.getEventPixel(e.originalEvent))}))},n}));