/*! Sugarizer 2020-03-14 */
define(["sugar-web/activity/activity","webL10n","sugar-web/datastore"],function(a,b,c){requirejs(["domReady!"],function(b){function d(a){return"none"===window.getComputedStyle(a,null).getPropertyValue("display")}function e(a,b){if(document.selection)a.focus(),sel=document.selection.createRange(),sel.text=b;else if(a.selectionStart||"0"==a.selectionStart){var c=a.selectionStart,d=a.selectionEnd;a.value=a.value.substring(0,c)+b+a.value.substring(d,a.value.length)}else a.value+=b}function f(){var a=new Markdown.Converter,b=function(){alert(l10n_s.get("need-help"))},c={helpButton:{handler:b},strings:{quoteexample:l10n_s.get("put-it-right-here")}};new Markdown.Editor(a,"-second",c).run()}a.setup();var g=["insertText","wmd-bold-button-second","wmd-italic-button-second","wmd-heading-button","wmd-hr-button","wmd-olist-button","wmd-ulist-button","wmd-code-button","wmd-quote-button","wmd-link-button","wmd-undo-button","wmd-redo-button","wmd-showHideEditor-button","wmd-showHidePreview-button"];inputTextContent=document.getElementById("wmd-input-second"),inputTextContent.value="#"+l10n_s.get("sample-input");var h=a.getDatastoreObject();for(inputTextContent.onblur=function(){var a=JSON.stringify(inputTextContent.value.toString());h.setDataAsText(a),h.save(function(){})},f(),h.loadAsText(function(a,b,c){markdowntext=JSON.parse(c),inputTextContent.value=markdowntext,f()}),i=0;i<g.length;i++)document.getElementById(g[i]).title=l10n_s.get(g[i]);document.getElementById("insertText").onclick=function(){a.showObjectChooser(function(a,b){new c.DatastoreObject(b).loadAsText(function(a,b,c){try{textdata=JSON.parse(c)}catch(a){textdata=c}e(document.getElementById("wmd-input-second"),textdata)})})};var j=document.getElementById("wmd-showHideEditor-button"),k=document.getElementById("wmd-showHidePreview-button"),l=document.getElementById("wmd-panel"),m=document.getElementById("wmd-preview-second");document.getElementById("wmd-input-second");j.onclick=function(){d(m)&&(m.style.display="inline",m.style.width="97%",l.style.width="1%"),d(l)?(l.style.display="inline",l.style.width="47%",m.style.width="47%"):(l.style.display="none",l.style.width="1%",m.style.width="97%")},k.onclick=function(){d(l)&&(l.style.display="inline",l.style.width="97%",m.style.width="1%"),d(m)?(m.style.display="inline",m.style.width="47%",l.style.width="47%"):(m.style.display="none",m.style.width="1%",l.style.width="94%")}})});