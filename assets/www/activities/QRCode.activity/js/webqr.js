/*! Sugarizer 2020-03-14 */
function handleFiles(a){for(var b=0;b<a.length;b++){var c=new FileReader;c.onload=function(a){return function(a){gCtx.clearRect(0,0,gCanvas.width,gCanvas.height),qrcode.decode(a.target.result)}}(a[b]),c.readAsDataURL(a[b])}}function initCanvas(a,b){gCanvas=document.getElementById("qr-canvas"),gCanvas.style.width=a+"px",gCanvas.style.height=b+"px",gCanvas.width=a,gCanvas.height=b,gCtx=gCanvas.getContext("2d"),gCtx.clearRect(0,0,a,b)}function captureToCanvas(){if(1==stype&&gUM)try{gCtx.drawImage(v,0,0);try{qrcode.decode()}catch(a){console.log(a),setTimeout(captureToCanvas,500)}}catch(a){console.log(a),setTimeout(captureToCanvas,500)}}function htmlEntities(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function read(a){scannedCallback&&scannedCallback(a)}function isCanvasSupported(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}function success(a){v.srcObject=a,v.play(),gUM=!0,setTimeout(captureToCanvas,500)}function error(a){gUM=!1}function load(a,b,c){qrSize=a,margin=b,scannedCallback=c,isCanvasSupported()&&window.File&&window.FileReader?(initCanvas(800,600),qrcode.callback=read,setwebcam()):console.log("Sorry your browser is not supported")}function setwebcam(){var a=!0;if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)try{navigator.mediaDevices.enumerateDevices().then(function(b){b.forEach(function(b){"videoinput"===b.kind&&b.label.toLowerCase().search("back")>-1&&(a={deviceId:{exact:b.deviceId},facingMode:"environment"}),console.log(b.kind+": "+b.label+" id = "+b.deviceId)}),setwebcam2(a)})}catch(a){console.log(a)}else console.log("no navigator.mediaDevices.enumerateDevices"),setwebcam2(a)}function setwebcam2(a){if(console.log(a),1==stype)return void setTimeout(captureToCanvas,500);var b=navigator;document.getElementById("outdiv").innerHTML=vidhtml,v=document.getElementById("video-stream"),v.style.width=qrSize+"px",v.style.marginLeft=margin+"px",b.mediaDevices.getUserMedia?b.mediaDevices.getUserMedia({video:a,audio:!1}).then(function(a){success(a)}).catch(function(a){a(a)}):b.getUserMedia?(webkit=!0,b.getUserMedia({video:a,audio:!1},success,error)):b.webkitGetUserMedia&&(webkit=!0,b.webkitGetUserMedia({video:a,audio:!1},success,error)),stype=1,setTimeout(captureToCanvas,500)}var gCtx=null,gCanvas=null,c=0,stype=0,gUM=!1,webkit=!1,moz=!1,v=null,qrSize=0,margin=0,scannedCallback=null,vidhtml='<video id="video-stream" autoplay></video>';