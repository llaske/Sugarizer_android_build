/*! Sugarizer 2020-03-14 */
var entriesByScreen=8;enyo.kind({name:"Abcd.Learn",kind:enyo.Control,classes:"board",published:{context:null},components:[{components:[{name:"colorBar",classes:"colorBar"},{name:"home",kind:"Abcd.HomeButton"},{name:"startSlideshow",kind:"Image",src:"images/slideshow.png",showing:!1,ontap:"startSlideshow",classes:"standardButton slideshow"},{name:"stopSlideshow",kind:"Image",src:"images/pause.png",showing:!1,ontap:"stopSlideshow",classes:"standardButton slideshow"},{kind:"Abcd.CaseButton"},{kind:"Abcd.LanguageButton"}]},{components:[{name:"pageCount",content:"-/-",classes:"pageCount",showing:!1},{name:"back",kind:"Image",src:"images/back.png",showing:!1,classes:"standardButton backButton",ontap:"backTaped"},{name:"prev",kind:"Image",src:"images/previous.png",showing:!1,classes:"standardButton prevButton",ontap:"displayPrevEntries"},{name:"next",kind:"Image",src:"images/next.png",showing:!1,classes:"standardButton nextButton",ontap:"displayNextEntries"}]},{name:"box",classes:"learnBox",components:[]}],create:function(){this.inherited(arguments),this.theme=this.collection=this.entry=this.position=-1,this.collections=[],this.playing=null,this.slideshowIndex=-1,this.exportPNG=enyo.bind(this,"clickExportPNG"),this.exportSOUND=enyo.bind(this,"clickExportSOUND"),this.restoreContext(),-1!=this.theme?4==this.theme?this.displayLetters({letter:this.collection}):-1!=this.collection?this.displayEntries({index:this.collection}):this.displayCollections({index:this.theme}):this.displayThemes()},restoreContext:function(){if(null!=this.context&&""!=this.context){var a=this.context.split("|");this.theme=a[0],this.collection=a[1],this.entry=parseInt(a[2])}},saveContext:function(){var a=[];return a.push(this.theme),a.push(this.collection),a.push(this.position),a.join("|")},setLocale:function(){var a=this.$.box.getControls()[0];if("Abcd.Entry"==a.kind)return this.entry=-1,void(4!=this.theme?this.displayEntries({index:Abcd.entries[a.index].coll}):this.displayLetters({letter:this.collection}));enyo.forEach(this.$.box.getControls(),function(a){"Control"!=a.kind&&a.setLocale()})},setCase:function(){enyo.forEach(this.$.box.getControls(),function(a){"hidden"==document.getElementById("main-toolbar").style.visibility&&Abcd.changeVisibility({switchToEnglish:!1,switchToFrench:!1,switchToSpanish:!1}),"Abcd.Letter"==a.kind?a.letterChanged():"Control"!=a.kind&&a.indexChanged()})},clickExportPNG:function(){var a,b=document.getElementById("png-button");a=b.classList.contains("active")?0:1,this.putEntriesJournalModeTo(a)},clickExportSOUND:function(){var a,b=document.getElementById("sound-button");a=b.classList.contains("active")?0:2,this.putEntriesJournalModeTo(a)},putEntriesJournalModeTo:function(a){1==a?(document.getElementById("png-button").classList.add("active"),document.getElementById("sound-button").classList.remove("active")):2==a?(document.getElementById("sound-button").classList.add("active"),document.getElementById("png-button").classList.remove("active")):(document.getElementById("png-button").classList.remove("active"),document.getElementById("sound-button").classList.remove("active")),enyo.forEach(this.$.box.getControls(),function(b){"Abcd.Entry"==b.kind&&(b.tojournal=a,b.tojournalChanged())})},displayThemes:function(){this.theme=-1;var a=Abcd.themes.length;this.cleanBox(),this.$.box.addClass("box-4-theme"),this.$.box.createComponent({classes:"linebreak"}).render(),Abcd.changeVisibility(this,{home:!0,back:!1,prev:!1,next:!1,pageCount:!1,startSlideshow:!1,stopSlideshow:!1}),document.getElementById("png-button").style.visibility="hidden",document.getElementById("sound-button").style.visibility="hidden",document.getElementById("png-button").classList.remove("active"),document.getElementById("sound-button").classList.remove("active"),document.getElementById("png-button").removeEventListener("click",this.exportPNG),document.getElementById("sound-button").removeEventListener("click",this.exportSOUND),this.$.colorBar.addClass("themeColor"+this.theme);for(var b=0;b<a;b++)this.$.box.createComponent({kind:"Abcd.Theme",index:b,ontap:"displayCollections"},{owner:this}).render();this.$.box.createComponent({classes:"linebreak"}).render();for(var b=0;b<26;b++)this.$.box.createComponent({kind:"Abcd.Letter",letter:String.fromCharCode(65+b),ontap:"displayLetters"},{owner:this}).render();Abcd.saveContext()},displayCollections:function(a,b){this.theme=a.index;var c=Abcd.collections.length;this.cleanBox(),Abcd.changeVisibility(this,{home:!1,back:!0,prev:!1,next:!1,pageCount:!1,startSlideshow:!1,stopSlideshow:!1}),this.$.colorBar.removeClass("themeColor-1"),this.$.colorBar.addClass("themeColor"+this.theme),this.$.box.removeClass("box-4-theme"),this.$.box.addClass("box-4-collection"),document.getElementById("png-button").style.visibility="hidden",document.getElementById("sound-button").style.visibility="hidden",document.getElementById("png-button").classList.remove("active"),document.getElementById("sound-button").classList.remove("active"),document.getElementById("png-button").removeEventListener("click",this.exportPNG),document.getElementById("sound-button").removeEventListener("click",this.exportSOUND),this.$.box.createComponent({classes:"linebreak"}).render(),this.$.box.createComponent({classes:"linebreak"}).render();for(var d=0;d<c;d++)Abcd.collections[d].theme==this.theme&&this.$.box.createComponent({kind:"Abcd.Collection",index:d,ontap:"displayEntries"},{owner:this}).render();Abcd.saveContext()},displayEntries:function(a,b){this.$.box.removeClass("box-4-collection"),this.$.colorBar.addClass("themeColor"+this.theme);var c=a.index;this.collection=c,this.collections=[];for(var d=Abcd.collections[c].entries.length,e=0;e<d;e++){var f=Abcd.collections[c].entries[e];1==Abcd.entries[f][Abcd.context.lang]&&this.collections.push(f)}this.displayEntriesFrom(this.entry+1)},displayLetters:function(a,b){void 0!==a.kind&&a.play(Abcd.sound),this.collection=a.letter,void 0!==Abcd.letters[this.collection]&&(this.collections=Abcd.letters[this.collection],this.theme=4,this.$.colorBar.addClass("themeColor"+this.theme),this.$.box.removeClass("box-4-theme"),document.getElementById("png-button").style.visibility="hidden",document.getElementById("sound-button").style.visibility="hidden",document.getElementById("png-button").classList.remove("active"),document.getElementById("sound-button").classList.remove("active"),document.getElementById("png-button").removeEventListener("click",this.exportPNG),document.getElementById("sound-button").removeEventListener("click",this.exportSOUND),this.displayEntriesFrom(this.entry+1))},displayEntriesFrom:function(a){this.cleanBox(),this.$.box.addClass("box-4-entry"),Abcd.changeVisibility(this,{home:!1,back:!0,pageCount:!0,startSlideshow:!0,stopSlideshow:!1}),length=this.collections.length;for(var b=0,c=a;c<length&&(this.$.box.createComponent({kind:"Abcd.Entry",index:this.collections[c],ontap:"play",onEntrySoundEnded:"soundEnd"},{owner:this}).render(),this.entry=c,++b!=entriesByScreen);c++);0!=a?this.$.prev.show():this.$.prev.hide(),this.entry+1<length?this.$.next.show():this.$.next.hide(),this.$.pageCount.setContent(Math.ceil(c/entriesByScreen)+"/"+Math.ceil(length/entriesByScreen)),this.position=a-1,document.getElementById("png-button").style.visibility="visible",document.getElementById("sound-button").style.visibility="visible",document.getElementById("png-button").addEventListener("click",this.exportPNG),document.getElementById("sound-button").addEventListener("click",this.exportSOUND),Abcd.saveContext()},displayNextEntries:function(){this.entry+1<this.collections.length&&this.displayEntriesFrom(this.entry+1)},displayPrevEntries:function(){this.displayEntriesFrom(Math.max(0,this.entry-entriesByScreen-this.entry%entriesByScreen))},backTaped:function(){var a=this.$.box.getControls()[0];if(this.entry=-1,"Abcd.Entry"==a.kind&&4!=this.theme)return this.collection=-1,this.displayCollections({index:this.theme}),void this.$.box.removeClass("box-4-entry");this.$.colorBar.removeClass("themeColor"+this.theme),this.$.box.removeClass("box-4-collection"),this.displayThemes()},cleanBox:function(){var a=[];enyo.forEach(this.$.box.getControls(),function(b){a.push(b)});for(var b=0;b<a.length;b++)a[b].destroy()},startSlideshow:function(a,b){this.slideshowIndex=0,Abcd.changeVisibility(this,{startSlideshow:!1,stopSlideshow:!0});var c=this.$.box.getControls()[this.slideshowIndex];this.play(c)},stopSlideshow:function(a,b){this.slideshowIndex=-1,Abcd.changeVisibility(this,{startSlideshow:!0,stopSlideshow:!1})},play:function(a,b){null!=this.playing&&this.playing.abort(),this.playing=a;var c=a.tojournal;a.play(Abcd.sound),c&&this.putEntriesJournalModeTo(!1)},soundEnd:function(a,b){if(this.playing=null,-1!=this.slideshowIndex){var c=this.$.box.getControls()[++this.slideshowIndex];void 0!==c?this.play(c):this.stopSlideshow()}}});