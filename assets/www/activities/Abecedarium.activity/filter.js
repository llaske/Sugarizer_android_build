var minFilterEntries=3;enyo.kind({name:"Abcd.FilterPopup",kind:"onyx.Popup",classes:"filter-popup",centered:!0,modal:!0,floating:!0,published:{filter:null},events:{onFilterChanged:""},components:[{name:"box",classes:"filterBox",components:[]},{name:"trash",kind:"Image",src:"images/trashcan.png",classes:"standardButton trashButton",ontap:"trashTaped"}],create:function(){this.inherited(arguments),this.filterChanged()},rendered:function(){this.displayThemes()},filterChanged:function(){this.render()},displayThemes:function(){this.cleanBox();var e=Abcd.themes.length,t=-1;null!=this.filter&&"Abcd.Collection"==this.filter.kind&&(t=Abcd.collections[this.filter.index].theme),this.$.box.createComponent({classes:"linebreak"}).render();for(var n=0;n<e;n++)this.$.box.createComponent({kind:"Abcd.Theme",index:n,selected:n==t,ontap:"displayCollections"},{owner:this}).render();this.$.box.createComponent({classes:"linebreak"}).render(),this.$.box.createComponent({classes:"linebreak"}).render();for(n=0;n<26;n++){var i=String.fromCharCode(65+n).toLowerCase();this.$.box.createComponent({kind:"Abcd.Letter",letter:i,selected:null!=this.filter&&this.filter.letter==i,ontap:"filterOnLetter"},{owner:this}).render()}},display:function(e){this.filter=e,this.render(),this.show()},displayCollections:function(e,t){var n=e.index,i=Abcd.collections.length;this.cleanBox();for(var r=0;r<i;r++)Abcd.collections[r].theme==n&&this.$.box.createComponent({kind:"Abcd.Collection",index:r,selected:null!=this.filter&&this.filter.index==r,ontap:"filterOnCollection"},{owner:this}).render()},trashTaped:function(){this.hide(),this.filter=null,this.doFilterChanged()},filterOnLetter:function(e,t){!Abcd.letters.hasOwnProperty(e.letter)||Abcd.letters[e.letter].length<minFilterEntries||(this.hide(),this.filter=e,this.doFilterChanged())},filterOnCollection:function(e,t){for(var n=e.index,i=Abcd.collections[n],r=i.entries.length,o=0,s=0;s<r;s++){var l=i.entries[s];1==Abcd.entries[l][Abcd.context.lang]&&o++}o<minFilterEntries||(this.hide(),this.filter=e,this.doFilterChanged())},cleanBox:function(){var e=[];enyo.forEach(this.$.box.getControls(),(function(t){e.push(t)}));for(var t=0;t<e.length;t++)e[t].destroy()}});