function AbacusBead(t,i,e,a,n,s,h,d){void 0===d&&(d=-1);var o=net.brehaut.Color;this.bead=null,this.originaly=null,this.index=s,this.value=h,this.text=null,this.containerbead=null,this.age=4,this.y=i,this.updateY=function(t){this.containerbead.y=t,this.y=t},this.resetAge=function(){this.age=-1},this.forceAge=function(t){this.age=t-1,console.log(this.age),this.updateAge()},this.updateAge=function(){var t=navigator.userAgent.toLowerCase();if(!(-1!=t.indexOf("safari")&&-1==t.indexOf("chrome")||/Android/i.test(t)||t.match(/ipad|iphone|ipod/g)))if(this.age+=1,this.age<=0)this.redraw("#FFF"),this.age=0;else if(this.age<3){var i=o(e);(i=i.setSaturation(i.getSaturation()/3)).s=i.s/2,console.log(i.toRGB()),this.redraw(i.toRGB())}else 3==this.age&&this.redraw(e)},this.redraw=function(t){var i;i=-1==d?a.blockHeight:d,this.bead.graphics.clear().beginStroke("#000000").setStrokeStyle(a.blockWidth/25).beginFill(t).drawRoundRect(-1*a.blockWidth/2,0,a.blockWidth,i,a.blockHeight/2)},this.drawBead=function(i){var n;void 0===i&&(i=e),n=-1==d?a.blockHeight:d,this.bead=new createjs.Shape,this.bead.graphics.beginStroke("#000000"),this.bead.graphics.setStrokeStyle(a.blockWidth/25),this.bead.graphics.beginFill(i).drawRoundRect(-1*a.blockWidth/2,0,a.blockWidth,n,a.blockHeight/2),this.bead.x=0,this.bead.y=0,this.containerbead=new createjs.Container,this.containerbead.addChild(this.bead),this.containerbead.x=t,this.containerbead.y=this.y,a.stage.addChild(this.containerbead)},this.updateIndex=function(t){var i=this.index;this.index=t,this.index!=i&&this.resetAge()},this.addClickListeners=function(){var t=this,i=n,e="down";this.bead.on("mousedown",(function(i){t.originaly=i.stageY})),this.bead.on("pressup",(function(e){t.originaly<e.stageY?i.shuntRight(t.index):t.originaly>e.stageY&&i.shuntLeft(t.index)})),this.bead.addEventListener("click",(function(a){"down"===e?(i.shuntLeft(t.index),e="up"):"up"===e&&(i.shuntRight(t.index),e="down")}))},this.updateValue=function(t,i){void 0===i&&(i=!0),1==t&&this.value.toFraction(!0).length<=4?this.text.text=0==i?"-"+this.value.toFraction(!0):this.value.toFraction(!0):this.text.text=""},this.drawText=function(){var t;t="#000"==e||"#000000"==e?"#FFF":"#000";var i,n=new createjs.Text("",(a.blockWidth/3).toString()+"px Arial",t);n.set({textAlign:"center"}),n.x=0,i=-1==d?a.blockHeight/3:d/2-a.blockHeight/3,n.y=i,this.containerbead.addChild(n),this.text=n},this.init=function(){this.drawBead(),this.addClickListeners(),this.drawText()}}