enyo.kind({name:"TankOp.App",kind:enyo.Control,published:{activity:null},classes:"home",components:[{kind:"Image",classes:"home-image no-select-content",src:"images/home.png"},{classes:"start-button",ontap:"play",components:[{kind:"Image",classes:"start-button-image no-select-content",src:"images/button.png"},{name:"start",classes:"start-button-text no-select-content"}]},{kind:"Image",classes:"credit-button no-select-content",src:"images/credit.png",ontap:"showCredit"},{name:"creditsPopup",kind:"TankOp.CreditsPopup"},{classes:"mission-description no-select-content",components:[{components:[{name:"nextmission",classes:"mission-header mission-line"},{content:":",classes:"mission-dot mission-line"}]},{classes:"go-arrow go-left mission-line",ontap:"previousMission"},{name:"mission",content:" ",classes:"mission-text mission-line"},{classes:"go-arrow go-right mission-line",ontap:"nextMission"}]},{classes:"mission-status no-select-content",components:[{components:[{name:"completed",classes:"mission-header mission-line"},{content:":",classes:"mission-dot mission-line"}]},{name:"stars",components:[{classes:"mission mission-completed mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"},{classes:"mission mission-tocomplete mission-line"}]}]}],create:function(){this.inherited(arguments),this.currentlevel=0,this.$.mission.setContent(preferences.levels[this.currentlevel].name),this.init()},init:function(){this.setLocale();var e=[];enyo.forEach(this.$.stars.getControls(),(function(s){e.push(s)}));for(var s=0;s<e.length;s++)e[s].destroy();for(s=0;s<preferences.levels.length;s++)this.$.stars.createComponent({classes:preferences.levels[s].completed?"mission mission-completed mission-line":"mission mission-tocomplete mission-line"},{owner:this}).render()},setLocale:function(){this.$.start.setContent(l10n.get("Start")),this.$.nextmission.setContent(l10n.get("NextMission")),this.$.completed.setContent(l10n.get("Completed")),this.$.mission.setContent(preferences.levels[this.currentlevel].name=l10n.get(preferences.levels[this.currentlevel].id));for(var e=0;e<preferences.levels.length;e++)preferences.levels[e].name=l10n.get(preferences.levels[e].id)},previousMission:function(){this.currentlevel--,this.currentlevel<0&&(this.currentlevel=preferences.levels.length-1),this.$.mission.setContent(preferences.levels[this.currentlevel].name)},nextMission:function(){this.currentlevel++,this.currentlevel==preferences.levels.length&&(this.currentlevel=0),this.$.mission.setContent(preferences.levels[this.currentlevel].name)},showCredit:function(){this.$.creditsPopup.show()},playTheme:function(){sound.play("audio/soundtrack",!0)},play:function(){sound.pause(),new TankOp.Play({level:this.currentlevel}).renderInto(document.getElementById("board"))},load:function(){this.playTheme();var e=this.activity.getDatastoreObject(),s=this;e.loadAsText((function(e,n,i){i=JSON.parse(i);preferences.setState(i),s.init()}))},save:function(e){var s=this.activity.getDatastoreObject(),n=JSON.stringify(preferences.getState());s.setDataAsText(n),s.save((function(){}))}});