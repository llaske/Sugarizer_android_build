define(["sugar-web/graphics/palette","mustache"],(function(t,e){var a={},n=!!navigator.userAgent.match(/iPad|iPhone|iPod/g);a.algebraPalette=function(a,r){t.Palette.call(this,a,r),this.algebraChangeEvent=document.createEvent("CustomEvent"),this.algebraChangeEvent.initCustomEvent("algebraClick",!0,!0,{}),this.template='<tbody>{{#rows}}<tr>{{#.}}<td><button style="background:none; border-radius:0px; border:0px; margin:3px; width:55px; height:55px; background-image: url({{backgroundSvg}})" value="{{value}}"></button></td>{{/.}}</tr>{{/rows}}</tbody>';var o=document.createElement("table");o.className="algebras";o.innerHTML=e.render(this.template,{rows:[[{title:"EXP",value:"exp(",backgroundSvg:"icons/algebra-exp.svg"},{title:"LN",value:"log(",backgroundSvg:"icons/algebra-ln.svg"},{title:"SQRT",value:"sqrt(",backgroundSvg:"icons/algebra-sqrt.svg"}],[{title:"X",value:"x",backgroundSvg:"icons/algebra-x.svg"},{title:"POW",value:"^",backgroundSvg:"icons/algebra-xpowy.svg"},{title:"PI",value:"3.14159",backgroundSvg:"icons/constants-pi.svg"}],[{title:"F(X)",value:"f(x)=",backgroundSvg:"icons/plot.svg"}]]}),this.setContent([o]),this.buttons=o.querySelectorAll("button");var l=this;function popDownOnButtonClick(t){l.algebraChangeEvent.detail.value=t.target.value,l.getPalette().dispatchEvent(l.algebraChangeEvent),l.popDown()}for(var i=0;i<this.buttons.length;i++)n?this.buttons[i].addEventListener("touchstart",popDownOnButtonClick):this.buttons[i].addEventListener("click",popDownOnButtonClick)};return a.algebraPalette.prototype=Object.create(t.Palette.prototype,{setColor:{value:function(t){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),this.buttons[t].dispatchEvent(e)},enumerable:!0,configurable:!0,writable:!0},addEventListener:{value:function(t,e,a){return this.getPalette().addEventListener(t,e,a)},enumerable:!0,configurable:!0,writable:!0}}),a}));