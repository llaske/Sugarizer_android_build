define(["sugar-web/graphics/palette","mustache"],(function(e,t){var o={};function parseColor(e){return e.split("(")[1].split(")")[0].split(",")}o.initGui=function initGui(){function onColorChangeFill(t){PaintApp.data.color.fill=t.detail.color,e.style.backgroundColor=t.detail.color,u.style.backgroundColor=t.detail.color;var o=parseColor(t.detail.color);r.value=parseInt(o[0]),a.value=parseInt(o[1]),n.value=parseInt(o[2])}function onColorChangeStroke(e){PaintApp.data.color.stroke=e.detail.color,o.style.backgroundColor=e.detail.color,s.style.backgroundColor=e.detail.color;var t=parseColor(e.detail.color);i.value=parseInt(t[0]),d.value=parseInt(t[1]),c.value=parseInt(t[2])}var e=document.getElementById("colors-button-fill"),t=new PaintApp.palettes.colorPalette.ColorPalette(e,void 0,"fill"),o=document.getElementById("colors-button-stroke"),l=new PaintApp.palettes.colorPalette.ColorPalette(o,void 0,"stroke"),r=document.getElementById("slider-fill-red"),n=document.getElementById("slider-fill-blue"),a=document.getElementById("slider-fill-green"),i=document.getElementById("slider-stroke-red"),c=document.getElementById("slider-stroke-blue"),d=document.getElementById("slider-stroke-green");function generateColorFillSlider(){return{detail:{color:"rgb("+r.value+","+a.value+","+n.value+")"}}}function generateColorStrokeSlider(){return{detail:{color:"rgb("+i.value+","+d.value+","+c.value+")"}}}r.onchange=function(e){onColorChangeFill(generateColorFillSlider())},n.onchange=function(e){onColorChangeFill(generateColorFillSlider())},a.onchange=function(e){onColorChangeFill(generateColorFillSlider())},i.onchange=function(e){onColorChangeStroke(generateColorStrokeSlider())},c.onchange=function(e){onColorChangeStroke(generateColorStrokeSlider())},d.onchange=function(e){onColorChangeStroke(generateColorStrokeSlider())},t.addEventListener("colorChange",onColorChangeFill);var u=t.getPalette().querySelector(".palette-invoker");t.setColor(0),l.addEventListener("colorChange",onColorChangeStroke);var s=l.getPalette().querySelector(".palette-invoker");l.setColor(2)},o.ColorPalette=function(o,l,r){e.Palette.call(this,o,l),this.colorChangeEvent=document.createEvent("CustomEvent"),this.colorChangeEvent.initCustomEvent("colorChange",!0,!0,{color:"#ed2529"}),this.template='      <div style="width:370px;">          <div style="float:left; width: 190px;">          <table>            <tbody>              {{#rows}}                <tr>                  {{#.}}                    <td>                      <button style="background-color: {{ color }}"></button>                    </td>                  {{/.}}                </tr>              {{/rows}}            </tbody>            </table>          </div>          <div style="float:left; width: 150px; padding-top:10px">          Red          <input id="slider-'+r+'-red" type="range"  min="0" max="255" />          <br/>          <br/>          Green          <input id="slider-'+r+'-green" type="range"  min="0" max="255" />          <br/>          <br/>          Blue          <input id="slider-'+r+'-blue" type="range"  min="0" max="255" />          </div>      </div>';var n=document.createElement("div");n.className="colors";n.innerHTML=t.render(this.template,{rows:[[{color:"#FF2B34"},{color:"#00EA11"},{color:"#005FE4"}],[{color:"#FF8F00"},{color:"#008009"},{color:"#00A0FF"}],[{color:"#FFFA00"},{color:"#A700FF"},{color:"#5E008C"}],[{color:"#000000"},{color:"#919496"},{color:"#ffffff"}]]}),this.setContent([n]),n.parentNode.style.height="225px",n.parentNode.style.overflowY="auto",n.parentNode.style.overflowX="hidden",this.buttons=n.querySelectorAll("button");var a=this;function popDownOnButtonClick(e){a.colorChangeEvent.detail.color=e.target.style.backgroundColor,a.getPalette().dispatchEvent(a.colorChangeEvent),a.popDown()}for(var i=0;i<this.buttons.length;i++)this.buttons[i].addEventListener("click",popDownOnButtonClick)};return o.ColorPalette.prototype=Object.create(e.Palette.prototype,{setColor:{value:function(e){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!0),this.buttons[e].dispatchEvent(t)},enumerable:!0,configurable:!0,writable:!0},addEventListener:{value:function(e,t,o){return this.getPalette().addEventListener(e,t,o)},enumerable:!0,configurable:!0,writable:!0}}),o}));