/*! Sugarizer 2017-08-25 */
define(["sugar-web/graphics/palette","mustache"],function(a,b){function c(a){return a.split("(")[1].split(")")[0].split(",")}function d(){function a(a){PaintApp.data.color.fill=a.detail.color,f.style.backgroundColor=a.detail.color,p.style.backgroundColor=a.detail.color;var b=c(a.detail.color);j.value=parseInt(b[0]),l.value=parseInt(b[1]),k.value=parseInt(b[2])}function b(a){PaintApp.data.color.stroke=a.detail.color,h.style.backgroundColor=a.detail.color,q.style.backgroundColor=a.detail.color;var b=c(a.detail.color);m.value=parseInt(b[0]),o.value=parseInt(b[1]),n.value=parseInt(b[2])}function d(){return{detail:{color:"rgb("+j.value+","+l.value+","+k.value+")"}}}function e(){return{detail:{color:"rgb("+m.value+","+o.value+","+n.value+")"}}}var f=document.getElementById("colors-button-fill"),g=new PaintApp.palettes.colorPalette.ColorPalette(f,void 0,"fill"),h=document.getElementById("colors-button-stroke"),i=new PaintApp.palettes.colorPalette.ColorPalette(h,void 0,"stroke"),j=document.getElementById("slider-fill-red"),k=document.getElementById("slider-fill-blue"),l=document.getElementById("slider-fill-green"),m=document.getElementById("slider-stroke-red"),n=document.getElementById("slider-stroke-blue"),o=document.getElementById("slider-stroke-green");j.onchange=function(b){a(d())},k.onchange=function(b){a(d())},l.onchange=function(b){a(d())},m.onchange=function(a){b(e())},n.onchange=function(a){b(e())},o.onchange=function(a){b(e())},g.addEventListener("colorChange",a);var p=g.getPalette().querySelector(".palette-invoker");g.setColor(0),i.addEventListener("colorChange",b);var q=i.getPalette().querySelector(".palette-invoker");i.setColor(2)}var e={};e.initGui=d,e.ColorPalette=function(c,d,e){function f(a){i.colorChangeEvent.detail.color=a.target.style.backgroundColor,i.getPalette().dispatchEvent(i.colorChangeEvent),i.popDown()}a.Palette.call(this,c,d),this.colorChangeEvent=document.createEvent("CustomEvent"),this.colorChangeEvent.initCustomEvent("colorChange",!0,!0,{color:"#ed2529"}),this.template='      <div style="width:370px;">          <div style="float:left; width: 190px;">          <table>            <tbody>              {{#rows}}                <tr>                  {{#.}}                    <td>                      <button style="background-color: {{ color }}"></button>                    </td>                  {{/.}}                </tr>              {{/rows}}            </tbody>            </table>          </div>          <div style="float:left; width: 150px; padding-top:10px">          Red          <input id="slider-'+e+'-red" type="range"  min="0" max="255" />          <br/>          <br/>          Green          <input id="slider-'+e+'-green" type="range"  min="0" max="255" />          <br/>          <br/>          Blue          <input id="slider-'+e+'-blue" type="range"  min="0" max="255" />          </div>      </div>';var g=document.createElement("div");g.className="colors";var h={rows:[[{color:"#FF2B34"},{color:"#00EA11"},{color:"#005FE4"}],[{color:"#FF8F00"},{color:"#008009"},{color:"#00A0FF"}],[{color:"#FFFA00"},{color:"#A700FF"},{color:"#5E008C"}],[{color:"#000000"},{color:"#919496"},{color:"#ffffff"}]]};g.innerHTML=b.render(this.template,h),this.setContent([g]),g.parentNode.style.height="225px",g.parentNode.style.overflowY="auto",g.parentNode.style.overflowX="hidden",this.buttons=g.querySelectorAll("button");for(var i=this,j=0;j<this.buttons.length;j++)this.buttons[j].addEventListener("click",f)};var f=function(a){var b=document.createEvent("MouseEvents");b.initEvent("click",!0,!0),this.buttons[a].dispatchEvent(b)},g=function(a,b,c){return this.getPalette().addEventListener(a,b,c)};return e.ColorPalette.prototype=Object.create(a.Palette.prototype,{setColor:{value:f,enumerable:!0,configurable:!0,writable:!0},addEventListener:{value:g,enumerable:!0,configurable:!0,writable:!0}}),e});