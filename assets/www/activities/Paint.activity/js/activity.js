/*! Sugarizer 2020-03-14 */
define(["sugar-web/activity/activity","tutorial","webL10n","sugar-web/env","activity/paint-activity","activity/paint-app","sugar-web/graphics/presencepalette","activity/palettes/color-palette","activity/palettes/stamp-palette","activity/palettes/text-palette","activity/palettes/drawings-palette","activity/palettes/filters-palette","activity/buttons/size-button","activity/buttons/clear-button","activity/buttons/undo-button","activity/buttons/redo-button","activity/modes/modes-pen","activity/modes/modes-eraser","activity/modes/modes-bucket","activity/modes/modes-text","activity/modes/modes-stamp","activity/modes/modes-copy","activity/modes/modes-paste","activity/collaboration","activity/buttons/insertimage-button"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){window.PaintApp=f,PaintApp.libs.activity=a,PaintApp.palettes.presencePalette=g,PaintApp.palettes.colorPalette=h,PaintApp.palettes.stampPalette=i,PaintApp.palettes.textPalette=j,PaintApp.palettes.drawingsPalette=k,PaintApp.palettes.filtersPalette=l,PaintApp.buttons.sizeButton=m,PaintApp.buttons.clearButton=n,PaintApp.buttons.undoButton=o,PaintApp.buttons.redoButton=p,PaintApp.buttons.insertImageButton=y,PaintApp.modes.Pen=q,PaintApp.modes.Eraser=r,PaintApp.modes.Bucket=s,PaintApp.modes.Text=t,PaintApp.modes.Stamp=u,PaintApp.modes.Copy=v,PaintApp.modes.Paste=w,PaintApp.collaboration=x,requirejs(["domReady!","sugar-web/datastore","paper-core","mustache","lzstring","humane"],function(e,f,g,h,i,j){PaintApp.libs.mustache=h,PaintApp.libs.humane=j,PaintApp.libs.lzstring=i,a.setup(),initGui(),d.getEnvironment(function(a,b){currentenv=b;var d="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,e=b.user?b.user.language:d;c.language.code=e}),document.getElementById("stop-button").addEventListener("click",function(b){var c={width:PaintApp.elements.canvas.width/window.devicePixelRatio,height:PaintApp.elements.canvas.height/window.devicePixelRatio,src:PaintApp.collaboration.compress(PaintApp.elements.canvas.toDataURL())},d=JSON.stringify(c);a.getDatastoreObject().setDataAsText(d),a.getDatastoreObject().save(function(a){})}),document.getElementById("help-button").addEventListener("click",function(a){b.start()}),window.top.sugar&&window.top.sugar.environment&&window.top.sugar.environment.sharedId||a.getDatastoreObject().loadAsText(function(a,b,c){if(null!=c){var d=JSON.parse(c);PaintApp.clearCanvas(),img=new Image,img.onload=function(){PaintApp.elements.canvas.getContext("2d").drawImage(img,0,0,d.width,d.height),PaintApp.saveCanvas()},img.src=PaintApp.collaboration.decompress(d.src)}}),window.top&&window.top.sugar&&window.top.sugar.environment&&window.top.sugar.environment.sharedId&&(PaintApp.data.isHost=!1,PaintApp.buttons.undoButton.hideGui(),PaintApp.buttons.redoButton.hideGui(),PaintApp.displayUndoRedoButtons(),PaintApp.collaboration.shareActivity())})});