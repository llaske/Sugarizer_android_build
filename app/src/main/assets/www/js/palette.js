var _displayedPalette=null;function _getOffset(t,e){var n=t.currentStyle||window.getComputedStyle(t,""),s=-2*n.marginLeft.slice(0,-2),i=-1*n.marginTop.slice(0,-2),a=t.getBoundingClientRect();s=a.left,i+=a.top;var l=s+e.offsetWidth-document.getElementById("canvas").offsetWidth;return l>0&&(s-=l),{top:i,left:s,width:a.width,height:a.height}}function _updatePosition(t){var e=_getOffset(t.hasNode(),t.palette.hasNode()),n=e.left,s=e.top,i=document.getElementById(t.palette.getAttribute("id"));i.style.left=n+"px",i.style.top=s+"px"}enyo.kind({name:"Sugar.Palette",kind:enyo.Control,published:{icon:null,text:null,contents:null,contentsClasses:"",header:null},classes:"palette-sugarizer palette-down",components:[{name:"icon",kind:"Sugar.Icon",classes:"palette-icon",size:20,x:6,y:6},{name:"text",classes:"palette-text"}],create:function(){this.inherited(arguments),this.iconChanged(),this.textChanged()},rendered:function(){this.inherited(arguments)},iconChanged:function(){this.$.icon.setIcon(this.icon)},textChanged:function(){this.$.text.setContent(this.text)},displayPopup:function(t){if(_displayedPalette&&(_displayedPalette.switchPalette(t),_displayedPalette=null),null!=this.contents){var e=this.hasNode().id+"_content";this.palette=t.createComponent({name:e,classes:"palette-content "+this.contentsClasses}),this.header&&(this.palette.createComponent({content:this.header,classes:"palette-header"},{owner:this.palette}),this.palette.createComponent({classes:"palette-hr"},{owner:this.palette})),this.paletteEvents=[];for(var n=0;n<this.contents.length;n++){var s=this.palette.createComponent(this.contents[n],{owner:this.palette}),i=this.contents[n].ontap;i&&(this.palette[i]=enyo.bind(this,"bindedFunction"),this.paletteEvents.push({event:"tap",object:s,name:i}))}this.palette.render(),_updatePosition(this),_displayedPalette=this}},setItems:function(t){this.contents=t},bindedFunction:function(t,e){for(var n=0;n<this.paletteEvents.length;n++)this.paletteEvents[n].event==e.type&&this.paletteEvents[n].object==t&&enyo.call(this.parent,this.paletteEvents[n].name,[t,e])},hidePopup:function(t){var e=this,n=null;enyo.forEach(t.getControls(),(function(t){t.getAttribute("id")==e.palette.getAttribute("id")&&(n=t)})),n&&n.destroy(),_displayedPalette=null},switchPalette:function(t){var e=this.isOpen();this.addRemoveClass("palette-down",e),this.addRemoveClass("palette-up",!e),e?this.hidePopup(t):this.displayPopup(t)},isOpen:function(){return this.hasClass("palette-up")}});