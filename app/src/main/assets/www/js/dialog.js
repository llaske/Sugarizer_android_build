enyo.kind({name:"Sugar.DialogSettings",kind:"enyo.Popup",classes:"settings-dialog",centered:!1,modal:!0,floating:!0,components:[{name:"toolbar",classes:"toolbar",components:[{name:"settingssearch",kind:"Sugar.SearchField",onTextChanged:"filterSettings",classes:"settings-filter-text"},{name:"donebutton",kind:"Button",classes:"toolbutton settings-close-button",title:"List",ontap:"closeSettings"}]},{name:"scroller",kind:"Scroller",horizontal:"hidden",vertical:"auto",classes:"settings-scroller",components:[{name:"content",components:[{name:"me",kind:"Sugar.DialogSettingsItem",ontap:"meClicked",text:"Me",icon:{directory:"icons",icon:"module-about_me.svg"},colorized:!0},{name:"computer",kind:"Sugar.DialogSettingsItem",ontap:"computerClicked",text:"Computer",icon:{directory:"icons",icon:"module-about_my_computer.svg"}},{name:"aboutserver",kind:"Sugar.DialogSettingsItem",ontap:"serverClicked",text:"Server",icon:{directory:"icons",icon:"cloud-settings.svg"}},{name:"security",kind:"Sugar.DialogSettingsItem",ontap:"securityClicked",icon:{directory:"icons",icon:"login-icon.svg"},showing:!1},{name:"privacy",kind:"Sugar.DialogSettingsItem",ontap:"privacyClicked",icon:{directory:"icons",icon:"privacy.svg"}},{name:"language",kind:"Sugar.DialogSettingsItem",ontap:"languageClicked",text:"Language",icon:{directory:"icons",icon:"module-language.svg"}},{name:"androidSettings",kind:"Sugar.DialogSettingsItem",ontap:"androidSettingsClicked",text:"AndroidSettings",icon:{directory:"icons",icon:"android-preferences.svg"},showing:!1},{name:"resetLauncher",kind:"Sugar.DialogSettingsItem",ontap:"resetLauncherPopup",text:"ResetLauncher",icon:{directory:"icons",icon:"launcher-icon.svg"},showing:!1}]}]},{name:"subdialog"}],create:function(){this.inherited(arguments),this.$.settingssearch.setPlaceholder(l10n.get("SearchSettings")),this.$.me.setText(l10n.get("AboutMe")),this.$.computer.setText(l10n.get("AboutMyComputer")),this.$.security.setText(l10n.get("MySecurity")),this.$.privacy.setText(l10n.get("MyPrivacy")),this.$.language.setText(l10n.get("Language")),this.$.aboutserver.setText(l10n.get("Server")),(util.getClientType()==constant.webAppType||preferences.isConnected())&&this.$.security.setShowing(!0),window.sugarizerOS&&(sugarizerOS.getLauncherPackageName((function(e){sugarizerOS.launcherPackageName=e})),this.$.androidSettings.setText(l10n.get("AndroidSettings")),this.$.androidSettings.show(),this.$.resetLauncher.show(),this.$.resetLauncher.setText(l10n.get("ResetLauncher"))),"rtl"==l10n.language.direction&&(this.$.me.addClass("rtl-10"),this.$.computer.addClass("rtl-10"),this.$.security.addClass("rtl-10"),this.$.privacy.addClass("rtl-10"),this.$.language.addClass("rtl-10"),this.$.aboutserver.addClass("rtl-10")),util.getClientType()==constant.webAppType&&this.$.security.setShowing(!0),this.subdialog=null},rendered:function(){this.inherited(arguments),app.noresize=!0,this.$.me.render(),this.$.donebutton.setNodeProperty("title",l10n.get("Done"));var e=this.centerDialog(this);this.$.content.applyStyle("height",e.height+"px"),this.$.scroller.render()},centerDialog:function(e){var t=util.computeMargin({width:800,height:500},{width:.95,height:.95});return e.applyStyle("margin-left",t.left+"px"),e.applyStyle("margin-top",t.top-55+"px"),t},filterSettings:function(){var e=this.$.settingssearch.getText().toLowerCase();stats.trace("my_settings","search","q="+e,null),enyo.forEach(this.$.content.getControls(),(function(t){t.setDisabled(-1==t.getText().toLowerCase().indexOf(e)&&0!=e.length)}))},closeSettings:function(){this.hide(),app.noresize=!1},meClicked:function(){this.$.me.getDisabled()||(stats.trace("my_settings","click","about_me",null),this.hide(),this.subdialog=this.$.subdialog.createComponent({kind:"Sugar.DialogAboutme"},{owner:this}),this.subdialog.show())},computerClicked:function(){this.$.computer.getDisabled()||(stats.trace("my_settings","click","about_my_computer",null),this.hide(),this.subdialog=this.$.subdialog.createComponent({kind:"Sugar.DialogComputer"},{owner:this}),this.subdialog.show())},securityClicked:function(){this.$.security.getDisabled()||(stats.trace("my_settings","click","security",null),this.hide(),this.subdialog=this.$.subdialog.createComponent({kind:"Sugar.DialogSecurity"},{owner:this}),this.subdialog.show())},privacyClicked:function(){this.$.security.getDisabled()||(stats.trace("my_settings","click","privacy",null),this.hide(),this.subdialog=this.$.subdialog.createComponent({kind:"Sugar.DialogPrivacy"},{owner:this}),this.subdialog.show())},languageClicked:function(){this.$.language.getDisabled()||(stats.trace("my_settings","click","language",null),this.hide(),this.subdialog=this.$.subdialog.createComponent({kind:"Sugar.DialogLanguage"},{owner:this}),this.subdialog.show())},serverClicked:function(){this.$.aboutserver.getDisabled()||(stats.trace("my_settings","click","about_my_server",null),this.hide(),this.subdialog=this.$.subdialog.createComponent({kind:"Sugar.DialogServer"},{owner:this}),this.subdialog.show())},androidSettingsClicked:function(){window.sugarizerOS&&sugarizerOS.runSettings(),this.hide()},resetLauncherPopup:function(){this.hide(),this.subdialog=this.$.subdialog.createComponent({kind:"Sugar.DialogSetLauncher"},{owner:this}),this.subdialog.show()}}),enyo.kind({name:"Sugar.DialogSetLauncher",kind:"enyo.Popup",classes:"module-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!1,components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",colorized:!0,size:constant.sizeToolbar,icon:{directory:"icons",icon:"owner-icon.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"warningbox",kind:"Sugar.DialogSettingsWarningBox",showing:!1,onCancel:"cancel",onRestart:"restart"},{name:"content",components:[{name:"message",content:"xxx",classes:"launcher-message"},{classes:"launcher-icons",components:[{name:"nativeIcon",kind:"Sugar.Icon",classes:"setlauncher-icon native",icon:{directory:"icons",icon:"launcher-icon.svg"},size:100,ontap:"changeLauncher"},{name:"sugarIcon",kind:"Sugar.Icon",classes:"setlauncher-icon sugar",icon:{directory:"icons",icon:"sugarizer.svg"},size:100,ontap:"changeLauncher"}]}]}],create:function(){this.inherited(arguments),this.$.text.setContent(l10n.get("SetLauncherTitle")),this.$.message.setContent(l10n.get("SetLauncherText",{launcher:sugarizerOS.launcherPackageName})),"rtl"==l10n.language.direction&&this.$.text.addClass("rtl-10"),window.sugarizerOS&&(sugarizerOS.launcherPackageName==sugarizerOS.packageName?this.$.sugarIcon.addClass("selected"):this.$.nativeIcon.addClass("selected"))},rendered:function(){this.inherited(arguments),this.$.icon.render(),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok")),this.owner.centerDialog(this)},cancel:function(){this.hide()},restart:function(){sugarizerOS.chooseLauncher(),this.hide()},changeLauncher:function(){this.$.warningbox.setShowing(!0)}}),enyo.kind({name:"Sugar.DialogNetworkKey",kind:"enyo.Popup",classes:"module-dialog-wifikey",centered:!1,modal:!0,floating:!0,autoDismiss:!1,components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",colorized:!0,size:constant.sizeToolbar,icon:{directory:"icons",icon:"owner-icon.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"content",components:[{classes:"enterkey",components:[{name:"keyInput",kind:"Input",classes:"enterkey-input",oninput:"keychanged"}]}]}],create:function(){this.inherited(arguments),this.$.text.setContent(l10n.get("EnterKey")+" ["+sugarizerOS.NetworkBuffer.SSID+"]"),sugarizerOS.sharedKeyBuffer?this.$.keyInput.setValue(sugarizerOS.sharedKeyBuffer):this.$.keyInput.setValue(""),"rtl"==l10n.language.direction&&this.$.text.addClass("rtl-10")},rendered:function(){this.inherited(arguments),this.$.icon.render(),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok")),this.centerDialog(this)},cancel:function(){this.hide()},ok:function(){sugarizerOS.sharedKeyBuffer=this.$.keyInput.getValue(),sugarizerOS.setKey(sugarizerOS.NetworkBuffer.SSID,sugarizerOS.sharedKeyBuffer,!0),this.hide(),this.$.okbutton.setDisabled(!0),this.$.cancelbutton.setDisabled(!0)},keychanged:function(){},connect:function(){},centerDialog:function(e){var t=util.computeMargin({width:500,height:150},{width:.95,height:.25});e.applyStyle("margin-left",t.left+"px"),e.applyStyle("margin-top",t.top-55-40+"px")}}),enyo.kind({name:"Sugar.DialogAboutme",kind:"enyo.Popup",classes:"module-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!1,components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",colorized:!0,size:constant.sizeToolbar,icon:{directory:"icons",icon:"owner-icon.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"content",components:[{name:"message",content:"xxx",classes:"aboutme-message"},{classes:"aboutme-icons",components:[{name:"psicon",kind:"Sugar.Icon",x:0,y:6,classes:"aboutme-icon aboutme-psicon",size:constant.sizeOwner,icon:{directory:"icons",icon:"owner-icon.svg"},ontap:"setcolor"},{name:"nsicon",kind:"Sugar.Icon",x:-12,y:6,classes:"aboutme-icon aboutme-nsicon",size:constant.sizeOwner,icon:{directory:"icons",icon:"owner-icon.svg"},ontap:"setcolor"},{name:"cicon",kind:"Sugar.Icon",x:6,y:6,classes:"aboutme-icon aboutme-cicon",size:constant.sizeOwner,icon:{directory:"icons",icon:"owner-icon.svg"},ontap:"setcolor"},{name:"pficon",kind:"Sugar.Icon",x:0,y:6,classes:"aboutme-icon aboutme-pficon",size:constant.sizeOwner,icon:{directory:"icons",icon:"owner-icon.svg"},ontap:"setcolor"},{name:"nficon",kind:"Sugar.Icon",x:-12,y:6,classes:"aboutme-icon aboutme-nficon",size:constant.sizeOwner,icon:{directory:"icons",icon:"owner-icon.svg"},ontap:"setcolor"}]},{classes:"aboutme-input",components:[{name:"name",kind:"Input",classes:"aboutme-name",oninput:"namechanged"}]},{name:"restartmessage",content:"xxx",classes:"aboutme-restart",showing:!1}]}],create:function(){this.inherited(arguments),this.$.text.setContent(l10n.get("AboutMe")),this.$.message.setContent(l10n.get("ClickToChangeColor")),this.$.restartmessage.setContent(l10n.get("ChangesRequireRestart")),this.initcolor=this.currentcolor=preferences.getColor(),this.initname=this.currentname=preferences.getName(),this.$.name.setValue(this.initname),"rtl"==l10n.language.direction&&(this.$.text.addClass("rtl-10"),this.$.name.addClass("rtl-10"),this.$.message.addClass("rtl-10"),this.$.restartmessage.addClass("rtl-10"))},rendered:function(){this.inherited(arguments),this.$.icon.render(),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok"));var e=util.getCanvasCenter().dx<515?constant.sizeOwner/2:constant.sizeOwner;this.$.pficon.setSize(e),this.$.pficon.setColorizedColor(util.getPreviousFillColor(this.currentcolor)),this.$.pficon.setColorized(!0),this.$.psicon.setSize(e),this.$.psicon.setColorizedColor(util.getPreviousStrokeColor(this.currentcolor)),this.$.psicon.setColorized(!0),this.$.cicon.setSize(e),this.$.cicon.setColorizedColor(this.currentcolor),this.$.cicon.setColorized(!0),this.$.nficon.setSize(e),this.$.nficon.setColorizedColor(util.getNextFillColor(this.currentcolor)),this.$.nficon.setColorized(!0),this.$.nsicon.setSize(e),this.$.nsicon.setColorizedColor(util.getNextStrokeColor(this.currentcolor)),this.$.nsicon.setColorized(!0),this.$.name.setValue(this.currentname),this.owner.centerDialog(this)},cancel:function(){this.hide(),this.owner.show()},ok:function(){if("#00B20D"!=this.currentcolor.stroke||"#00EA11"!=this.currentcolor.fill||"one laptop per child"!=this.currentname&&"OLPC France"!=this.currentname)return this.currentcolor==this.initcolor&&this.currentname==this.initname?(this.hide(),void this.owner.show()):void this.restart();new Sugar.EE({mode:-1==this.currentname.indexOf("Fr")?1:2}).renderInto(document.getElementById("body"))},setcolor:function(e){var t=e.getColorizedColor();t!=this.currentcolor&&(this.currentcolor=t,this.render())},namechanged:function(){this.currentname=this.$.name.getValue().trim()},restart:function(){stats.trace("my_settings_about_me","change","name_color",null),preferences.setName(this.currentname),preferences.setColor(util.getColorIndex(this.currentcolor)),preferences.save();var e=this;preferences.saveToServer(myserver,(function(){util.restartApp()}),(function(t,n){e.$.restartmessage.setShowing(!0),e.currentname=preferences.getName(),preferences.setName(e.initname),22==n?e.$.restartmessage.setContent(l10n.get("UserAlreadyExist")):e.$.restartmessage.setContent(l10n.get("ServerError",{code:n}))}))}}),enyo.kind({name:"Sugar.DialogSecurity",kind:"enyo.Popup",classes:"module-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!1,components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",size:constant.sizeToolbar,icon:{directory:"icons",icon:"login-icon.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"content",components:[{name:"message",content:"xxx",classes:"security-message"},{name:"password",kind:"Sugar.Password",classes:"security-password",onEnter:"next"},{name:"next",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"go-right.svg"},classes:"security-rightbutton",ontap:"next"},{name:"spinner",kind:"Image",src:"images/spinner-light.gif",classes:"security-spinner",showing:!1},{name:"warningmessage",content:"xxx",classes:"security-warning",showing:!1}]}],create:function(){this.inherited(arguments),this.$.text.setContent(l10n.get("MySecurity")),this.$.message.setContent(l10n.get("SecurityMessage")),this.$.next.setText(l10n.get("Next")),this.$.password.giveFocus(),"rtl"==l10n.language.direction&&(this.$.text.addClass("rtl-10"),this.$.message.addClass("rtl-10")),this.step=0},rendered:function(){this.inherited(arguments),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok")),this.owner.centerDialog(this)},cancel:function(){this.hide(),this.owner.show()},ok:function(){this.hide(),this.owner.show()},next:function(){var e=this,t={name:preferences.getName(),password:this.$.password.getPassword()};if(0==this.step)e.$.spinner.setShowing(!0),myserver.loginUser(t,(function(t,n){preferences.setToken({x_key:n.user._id,access_token:n.token}),e.$.warningmessage.setShowing(!1),e.$.password.setPassword(""),e.$.next.setText(l10n.get("Done")),e.$.message.setContent(l10n.get("SecurityMessageNew",{min:util.getMinPasswordSize()})),e.step++,e.$.spinner.setShowing(!1)}),(function(t,n){1==n?e.$.warningmessage.setContent(l10n.get("InvalidPassword")):e.$.warningmessage.setContent(l10n.get("ServerError",{code:n})),e.$.warningmessage.setShowing(!0),e.$.spinner.setShowing(!1)}));else{var n=this.$.password.getPassword();if(0==n.length||n.length<util.getMinPasswordSize())return;e.$.spinner.setShowing(!0),myserver.putUser(preferences.getNetworkId(),{password:this.$.password.getPassword()},(function(t,n){e.$.message.setContent(l10n.get("SecurityMessageDone")),e.$.next.setShowing(!1),e.$.password.setShowing(!1),e.$.warningmessage.setShowing(!1),e.$.spinner.setShowing(!1)}),(function(t,n){e.$.warningmessage.setContent(l10n.get("ServerError",{code:n})),e.$.warningmessage.setShowing(!0),e.$.password.giveFocus(),e.$.spinner.setShowing(!1)}))}}}),enyo.kind({name:"Sugar.DialogLanguage",kind:"enyo.Popup",classes:"module-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!1,components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",size:constant.sizeToolbar,icon:{directory:"icons",icon:"module-language.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"content",components:[{name:"message",content:"xxx",classes:"language-message"},{name:"languageselect",kind:"Sugar.SelectBox",classes:"language-select",onIndexChanged:"languageChanged"}]}],create:function(){this.inherited(arguments),this.$.text.setContent(l10n.get("Language")),this.$.message.setContent(l10n.get("ChooseLanguage")),this.initlanguage=this.currentlanguage=preferences.getLanguage(),this.languageset=[{code:"en",icon:null,name:"English ("+l10n.get("English")+")"},{code:"es",icon:null,name:"Español ("+l10n.get("Spanish")+")"},{code:"fr",icon:null,name:"Français ("+l10n.get("French")+")"},{code:"de",icon:null,name:"Deutsch ("+l10n.get("German")+")"},{code:"pt",icon:null,name:"Português ("+l10n.get("Portuguese")+")"},{code:"ar",icon:null,name:"عربي ("+l10n.get("Arabic")+")"},{code:"ja",icon:null,name:"日本語 ("+l10n.get("Japanese")+")"},{code:"pl",icon:null,name:"Polski ("+l10n.get("Polish")+")"},{code:"ibo",icon:null,name:"Igbo ("+l10n.get("Igbo")+")"},{code:"yor",icon:null,name:"Yoruba ("+l10n.get("Yoruba")+")"}],this.$.languageselect.setItems(this.languageset);for(var e=0;e<this.languageset.length;e++)if(this.languageset[e].code==this.initlanguage){this.$.languageselect.setSelected(e);break}"rtl"==l10n.language.direction&&(this.$.text.addClass("rtl-10"),this.$.message.addClass("rtl-10"))},rendered:function(){this.inherited(arguments),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok")),this.$.languageselect.setParentMargin(this),this.owner.centerDialog(this)},cancel:function(){this.hide(),this.owner.show()},ok:function(){if(this.currentlanguage==this.initlanguage)return this.hide(),void this.owner.show();this.restart()},languageChanged:function(){this.currentlanguage=this.languageset[this.$.languageselect.getSelected()].code},restart:function(){stats.trace("my_settings_language","change","language",null),preferences.setLanguage(this.currentlanguage),preferences.save(),preferences.saveToServer(myserver,(function(){util.restartApp()}),(function(){util.restartApp()}))}}),enyo.kind({name:"Sugar.DialogComputer",kind:"enyo.Popup",classes:"module-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!1,components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",size:constant.sizeToolbar,icon:{directory:"icons",icon:"module-about_my_computer.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"warningbox",kind:"Sugar.DialogSettingsWarningBox",showing:!1,onCancel:"cancel",onRestart:"reinit"},{name:"content",kind:"Scroller",classes:"computer-content",components:[{name:"software",content:"xxx",classes:"computer-software"},{content:"Sugarizer:",classes:"computer-sugarizer"},{name:"sugarizer_value",classes:"computer-value",ontap:"version"},{classes:"computer-line"},{name:"clienttype",classes:"computer-clienttype"},{name:"clienttype_value",classes:"computer-value"},{classes:"computer-line"},{name:"browser",content:"xxx",classes:"computer-browser"},{name:"browser_value",classes:"computer-value"},{classes:"computer-line"},{name:"browserversion",content:"xxx",classes:"computer-browserversion"},{name:"browserversion_value",classes:"computer-value"},{classes:"computer-line"},{name:"useragent",content:"xxx",classes:"computer-useragent"},{name:"useragent_value",classes:"computer-value"},{name:"storage",content:"xxx",classes:"computer-storage"},{name:"storage_value",classes:"computer-value"},{classes:"computer-line"},{name:"reinitcheck",showing:!1,kind:"Input",type:"checkbox",classes:"toggle computer-reinitcheck",onchange:"switchInit"},{name:"reinittext",showing:!1,content:"xxx",classes:"computer-reinit"},{classes:"computer-line"},{name:"copyright",content:"xxx",classes:"computer-copyright"},{content:"© 2013-2022 Lionel Laské, Sugar Labs Inc and&nbsp;",allowHtml:!0,classes:"computer-contributor"},{content:"contributors",classes:"computer-contributor-link",allowHtml:!0,ontap:"viewContributors"},{name:"license",content:"xxx",classes:"computer-licence"},{name:"licenseplus",content:"xxx",classes:"computer-licence"},{name:"warningmessage",showing:!1,content:"xxx",classes:"computer-warningmessage",showing:!1}]}],create:function(){this.inherited(arguments),this.$.text.setContent(l10n.get("AboutMyComputer")),this.$.software.setContent(l10n.get("Software")),this.$.browser.setContent(l10n.get("Browser")),this.$.clienttype.setContent(l10n.get("ClientType")),this.$.browserversion.setContent(l10n.get("BrowserVersion")),this.$.useragent.setContent(l10n.get("UserAgent")),this.$.storage.setContent(l10n.get("Storage")),this.$.copyright.setContent(l10n.get("Copyright")),this.$.license.setContent(l10n.get("LicenseTerms")),this.$.licenseplus.setContent(l10n.get("LicenseTermsPlus")),this.$.warningmessage.setContent(l10n.get("AllDataWillBeLost")),this.$.reinittext.setContent(l10n.get("ReinitJournalAndSettings")),this.notify=humane.create({timeout:1e3,baseCls:"humane-libnotify"}),this.clickLeft=3,this.$.sugarizer_value.setContent(constant.sugarizerVersion),this.$.clienttype_value.setContent(util.getClientName()),this.$.browser_value.setContent(util.getBrowserName()),this.$.browserversion_value.setContent(util.getBrowserVersion()),this.$.useragent_value.setContent(navigator.userAgent);var e=this;util.computeDatastoreSize((function(t){e.$.storage_value.setContent(l10n.get("StorageSize",{used:t.bytes,formatted:t.formatted}))})),"rtl"==l10n.language.direction&&(this.$.text.addClass("rtl-10"),this.$.software.addClass("rtl-10"),this.$.browser.addClass("rtl-10"),this.$.clienttype.addClass("rtl-10"),this.$.browserversion.addClass("rtl-10"),this.$.useragent.addClass("rtl-10"),this.$.storage.addClass("rtl-10"),this.$.copyright.addClass("rtl-10"),this.$.license.addClass("rtl-10"))},rendered:function(){this.inherited(arguments),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok")),this.owner.centerDialog(this)},cancel:function(){this.hide(),this.owner.show()},ok:function(){this.$.reinitcheck.getNodeProperty("checked")?(this.$.warningbox.setShowing(!0),this.$.okbutton.setDisabled(!0),this.$.cancelbutton.setDisabled(!0)):(this.hide(),this.owner.show())},reinit:function(){util.cleanDatastore(!0,(function(){util.restartApp()}))},switchInit:function(){this.$.warningmessage.setShowing(this.$.reinitcheck.getNodeProperty("checked"))},viewContributors:function(){util.openAsUrl("https://github.com/llaske/sugarizer/blob/dev/docs/credits.md")},version:function(){this.clickLeft--,0==this.clickLeft?(this.$.reinittext.setShowing(!0),this.$.reinitcheck.setShowing(!0)):this.clickLeft>0&&this.notify.log(l10n.get("ClickMore"))}}),enyo.kind({name:"Sugar.DialogServer",kind:"enyo.Popup",classes:"module-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!1,published:{standalone:!1},components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",size:constant.sizeToolbar,icon:{directory:"icons",icon:"cloud-settings.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"warningbox",kind:"Sugar.DialogSettingsWarningBox",showing:!1,onCancel:"cancel",onRestart:"restart"},{name:"content",components:[{name:"connected",kind:"Input",type:"checkbox",classes:"toggle aboutserver-checkbox",onchange:"switchConnection"},{name:"textconnected",content:"xxx",classes:"aboutserver-message"},{components:[{name:"textservername",content:"xxx",classes:"aboutserver-serverlabel"},{name:"servername",kind:"Input",classes:"aboutserver-servername",onkeydown:"enterclick"},{name:"qrbutton",kind:"Sugar.Icon",size:constant.sizeEmpty,icon:{directory:"icons",icon:"qrcode.svg"},ontap:"scanQR",classes:"aboutserver-qr",showing:!1}]},{name:"serversettingsname",classes:"aboutserver-settingsname"},{name:"serversettingsvalue",classes:"aboutserver-settingsvalue"},{name:"serverdescription",classes:"aboutserver-description"},{name:"serverdescriptionvalue",classes:"aboutserver-descriptionvalue"},{components:[{name:"textusername",content:"xxx",classes:"aboutserver-userlabel"},{name:"username",kind:"Input",classes:"aboutserver-username",disabled:!0}]},{name:"consent",kind:"Input",type:"checkbox",classes:"toggle aboutserver-consent",onchange:"switchConsent"},{name:"textconsent",content:"xxx",classes:"aboutserver-consentmessage",allowHtml:!0},{name:"passwordmessage",classes:"aboutserver-passwordmessage"},{name:"password",kind:"Sugar.Password",classes:"aboutserver-password",onEnter:"next"},{name:"next",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"go-right.svg"},classes:"aboutserver-rightbutton",ontap:"next"},{name:"spinner",kind:"Image",src:"images/spinner-light.gif",classes:"aboutserver-spinner",showing:!1},{name:"warningmessage",content:"xxx",classes:"aboutserver-warningmessage",showing:!1}]}],create:function(){if(this.inherited(arguments),this.$.text.setContent(l10n.get("Server")),this.$.textconnected.setContent(l10n.get("ConnectedToServer")),this.$.textservername.setContent(l10n.get("ServerUrl")),this.$.serversettingsname.setContent(l10n.get("ServerName")),this.$.serverdescription.setContent(l10n.get("ServerDescription")),this.$.textusername.setContent(l10n.get("UserId")),this.$.textconsent.setContent(l10n.get("CheckboxCookieConsent",{url:"#"})),this.$.next.setText(l10n.get("Next")),this.currentserver=preferences.getServer(),this.initconnected=preferences.isConnected(),this.initservername=this.currentserver&&this.currentserver.url?this.currentserver.url:util.getCurrentServerUrl(),this.initusername=preferences.getName(),this.networkId=null,this.forbidcheck=!1,this.createmode=!1,this.wait4consent=!1,"rtl"==l10n.language.direction&&(this.$.text.addClass("rtl-10"),this.$.textconnected.addClass("rtl-10"),this.$.warningmessage.addClass("rtl-10"),this.$.textservername.addClass("rtl-10"),this.$.textusername.addClass("rtl-10"),this.$.textusermessage.addClass("rtl-10"),this.$.next.addClass("rtl-10")),this.standalone&&(app.noresize=!0),this.step=0,util.getClientType()==constant.webAppType)this.step=3;else if(this.initconnected){var e=preferences.getToken();e&&e.expired?this.step=2:this.step=3}else this.step=0;this.displayStep()},rendered:function(){this.inherited(arguments),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok")),this.$.connected.setNodeProperty("checked",this.initconnected),util.getClientType()==constant.webAppType&&(this.$.servername.setDisabled(!0),this.$.username.setDisabled(!0)),this.centerDialog(this)},centerDialog:function(e){var t=util.computeMargin({width:800,height:500},{width:.95,height:.95});return e.applyStyle("margin-left",t.left+"px"),e.applyStyle("margin-top",t.top-55+"px"),t},displayStep:function(){var e=!1,t=!1,n=!1,s=(e=!1,!1),o=!1,i=!1,a=!1,r=!1,c=!1,l=!1,g=!1,u=!1,h=!1,d=!1;0==this.step?(this.$.passwordmessage.setContent(l10n.get("PleaseConnectMessage")),h=!0):1==this.step?(this.$.servername.setValue(constant.defaultServer),e=s=l=!0,a=util.platform.ios||util.platform.android):2==this.step?(h=d=l=!0,preferences.getToken()&&preferences.getToken().expired?this.$.passwordmessage.setContent(l10n.get("SecurityMessageExpired",{min:util.getMinPasswordSize()})):this.$.passwordmessage.setContent(l10n.get("SecurityMessageNew",{min:util.getMinPasswordSize()}))):3==this.step&&(this.$.servername.setValue(this.initservername),this.$.username.setValue(this.initusername),this.$.serversettingsvalue.setContent(this.currentserver.name),this.$.serverdescriptionvalue.setContent(this.currentserver.description),this.$.servername.setDisabled(!0),e=t=n=e=s=o=i=r=c=!0,(this.wait4consent=this.createmode&&this.currentserver.options["consent-need"])&&(g=u=!0,this.$.textconsent.setContent(l10n.get("CheckboxCookieConsent",{url:this.currentserver.options["policy-url"]+"?lang="+preferences.getLanguage()||"#"})))),this.$.textservername.setShowing(e),this.$.serversettingsname.setShowing(t),this.$.serverdescription.setShowing(n),this.$.textservername.setShowing(e),this.$.servername.setShowing(s),this.$.qrbutton.setShowing(a),this.$.serversettingsvalue.setShowing(o),this.$.serverdescriptionvalue.setShowing(i),this.$.textusername.setShowing(r),this.$.username.setShowing(c),this.$.next.setShowing(l),this.$.consent.setShowing(g),this.$.textconsent.setShowing(u),this.$.passwordmessage.setShowing(h),this.$.password.setShowing(d),d&&this.$.password.giveFocus()},cancel:function(){!this.initconnected&&this.hasChanged()&&preferences.setServer(null),this.hide(),this.standalone?app.noresize=!1:this.owner.show()},ok:function(){if(!this.hasChanged()||this.$.connected.getNodeProperty("checked")&&3!=this.step)return this.hide(),void(this.standalone?app.noresize=!1:this.owner.show());this.$.warningbox.setShowing(!0),this.$.okbutton.setDisabled(!0),this.$.cancelbutton.setDisabled(!0)},switchConnection:function(){this.forbidcheck?this.$.connected.setNodeProperty("checked",!this.$.connected.getNodeProperty()):(this.forbidcheck=!0,util.getClientType()!=constant.webAppType?0==this.step&&(this.step++,this.displayStep()):this.$.connected.setNodeProperty("checked",!0))},switchConsent:function(){var e=this.$.consent.getNodeProperty("checked");this.$.warningmessage.setContent(l10n.get(e?"ChangesRequireRestart":"CheckboxToConsent")),this.$.warningbox.setShowing(e),this.$.okbutton.setDisabled(e),this.$.cancelbutton.setDisabled(e)},next:function(){if(1==this.step)(e=this).$.spinner.setShowing(!0),myserver.getServerInformation(this.$.servername.getValue(),(function(t,n){e.currentserver=n,e.currentserver.url=e.$.servername.getValue(),e.currentserver.secure?e.currentserver.url=e.currentserver.url.replace(constant.http,constant.https):e.currentserver.url=e.currentserver.url.replace(constant.https,constant.http),preferences.setServer(e.currentserver),e.initservername=e.$.servername.getValue(),e.step++,e.displayStep(),e.$.spinner.setShowing(!1),e.$.warningmessage.setShowing(!1)}),(function(){e.$.warningmessage.setContent(l10n.get("ErrorLoadingRemote")),e.$.warningmessage.setShowing(!0),e.$.spinner.setShowing(!1)}));else if(2==this.step){var e,t=this.$.password.getPassword();if(0==t.length||t.length<util.getMinPasswordSize())return;(e=this).$.spinner.setShowing(!0),myserver.postUser({name:preferences.getName(),color:preferences.getColor(),language:preferences.getLanguage(),role:"student",password:this.$.password.getPassword(),options:{sync:preferences.getOptions("sync"),stats:preferences.getOptions("stats")}},(function(t,n){e.createmode=!0,e.login()}),(function(t,n){22==n?(e.createmode=!1,e.login()):(e.$.warningmessage.setContent(l10n.get("ServerError",{code:n})),e.$.warningmessage.setShowing(!0),e.$.spinner.setShowing(!1))}))}},login:function(){var e=this,t={name:preferences.getName(),password:e.$.password.getPassword()};myserver.loginUser(t,(function(t,n){e.step++,e.displayStep(),e.networkId=n.user._id,e.networkColor=n.user.color,preferences.setToken({x_key:e.networkId,access_token:n.token}),preferences.setPrivateJournal(n.user.private_journal),preferences.setSharedJournal(n.user.shared_journal),e.$.spinner.setShowing(!1),e.wait4consent?e.$.warningmessage.setContent(l10n.get("CheckboxToConsent")):(e.$.warningmessage.setContent(l10n.get("ChangesRequireRestart")),e.$.warningbox.setShowing(!0),e.$.okbutton.setDisabled(!0),e.$.cancelbutton.setDisabled(!0)),e.$.warningmessage.setShowing(!0)}),(function(t,n){1==n?e.$.warningmessage.setContent(l10n.get("UserLoginInvalid")):e.$.warningmessage.setContent(l10n.get("ServerError",{code:n})),e.$.warningmessage.setShowing(!0),e.$.spinner.setShowing(!1)}))},restart:function(){var e=this.$.connected.getNodeProperty("checked");preferences.setConnected(e),e?(preferences.setNetworkId(this.networkId),historic.addUser({name:preferences.getName(),color:util.getColorIndex(this.networkColor),server:preferences.getServer()})):(preferences.setNetworkId(null),preferences.setServer(null),preferences.setToken(null)),preferences.save(),util.restartApp()},scanQR:function(){var e=this,t=document.getElementById("toolbar");this.hide(),t.style.visibility="hidden",util.scanQRCode((function(n){t.style.visibility="visible",e.show(),e.$.servername.setValue(n)}),(function(){t.style.visibility="visible",e.show(),e.$.servername.focus(),e.$.servername.hasNode().select()}))},hasChanged:function(){var e=this.$.connected.getNodeProperty("checked");return this.initconnected!=e},enterclick:function(e,t){if(13===t.keyCode)return this.next(),!0}}),enyo.kind({name:"Sugar.DialogPrivacy",kind:"enyo.Popup",classes:"module-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!1,components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",size:constant.sizeToolbar,icon:{directory:"icons",icon:"privacy.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"warningbox",kind:"Sugar.DialogSettingsWarningBox",showing:!1,onCancel:"cancelRemove",onRestart:"confirmRemove"},{name:"content",components:[{name:"stats",kind:"Input",type:"checkbox",classes:"toggle privacy-statscheckbox"},{name:"textstats",content:"xxx",classes:"privacy-statsmessage"},{content:""},{name:"sync",kind:"Input",type:"checkbox",classes:"toggle privacy-synccheckbox"},{name:"textsync",content:"xxx",classes:"privacy-syncmessage"},{content:""},{name:"remove",kind:"Input",type:"checkbox",classes:"toggle privacy-removecheckbox",onchange:"showRemove"},{name:"textremove",content:"xxx",classes:"privacy-removemessage"},{components:[{name:"removelocal",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"module-about_my_computer.svg"},classes:"privacy-removelocalbutton",ontap:"removeLocalAccount",showing:!1},{name:"removeremote",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"cloud-settings.svg"},classes:"privacy-removeremotebutton",ontap:"removeRemoteAccount",showing:!1}]},{name:"warningmessage",content:"xxx",classes:"privacy-warningmessage",showing:!1}]}],create:function(){this.inherited(arguments),this.$.text.setContent(l10n.get("MyPrivacy")),this.$.textstats.setContent(l10n.get("PrivacyStats")),this.$.textsync.setContent(l10n.get("PrivacySync")),this.$.textremove.setContent(l10n.get("PrivacyRemove")),this.$.removelocal.setText(l10n.get("PrivacyRemoveLocal")),this.$.removeremote.setText(l10n.get("PrivacyRemoveRemote")),this.$.warningmessage.setContent(l10n.get("AllDataWillBeLost")),this.initstats=preferences.getOptions("stats"),this.initsync=preferences.getOptions("sync"),this.removelocal=!0,"rtl"==l10n.language.direction&&(this.$.text.addClass("rtl-10"),this.$.textstats.addClass("rtl-10"),this.$.textsync.addClass("rtl-10")),util.getClientType()!=constant.appType||preferences.isConnected()||(this.$.stats.setShowing(!1),this.$.sync.setShowing(!1),this.$.textstats.setShowing(!1),this.$.textsync.setShowing(!1))},rendered:function(){this.inherited(arguments),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok")),this.$.stats.setNodeProperty("checked",!this.initstats),this.$.sync.setNodeProperty("checked",!this.initsync),this.owner.centerDialog(this)},cancel:function(){this.hide(),this.owner.show()},ok:function(){if(!this.hasChanged())return this.hide(),void this.owner.show();this.restart()},restart:function(){this.hasChanged()&&(preferences.setOptions("stats",!this.$.stats.getNodeProperty("checked")),preferences.setOptions("sync",!this.$.sync.getNodeProperty("checked")),preferences.save(),preferences.saveToServer(myserver,null,null)),util.restartApp()},showRemove:function(){util.getClientType()!=constant.webAppType&&this.$.removelocal.setShowing(this.$.remove.getNodeProperty("checked")),(util.getClientType()==constant.webAppType||preferences.isConnected())&&this.$.removeremote.setShowing(this.$.remove.getNodeProperty("checked"))},removeLocalAccount:function(){this.$.warningmessage.setShowing(!0),this.$.warningbox.setShowing(!0),this.$.remove.setDisabled(!0),this.removelocal=!0},removeRemoteAccount:function(){this.$.warningmessage.setShowing(!0),this.$.warningbox.setShowing(!0),this.$.remove.setDisabled(!0),this.removelocal=!1},cancelRemove:function(){this.hide(),this.owner.show()},confirmRemove:function(){if(this.hide(),historic.removeUser({name:preferences.getName(),server:preferences.getServer()}),this.removelocal)util.cleanDatastore(null,(function(){util.restartApp()}));else{var e=this,t=preferences.getNetworkId();util.getClientType()==constant.appType&&(preferences.setConnected(!1),preferences.setNetworkId(null),preferences.save()),myserver.deleteUser(t,(function(e,t){util.getClientType()==constant.appType?(preferences.setServer(null),preferences.save(),util.restartApp()):util.cleanDatastore(null,(function(){util.restartApp()}))}),(function(t,n){util.getClientType()==constant.appType&&(preferences.setServer(null),preferences.save()),humane.log(l10n.get("ServerError",{code:n})),e.hide(),e.owner.show()}))}},hasChanged:function(){var e=!this.$.stats.getNodeProperty("checked"),t=!this.$.sync.getNodeProperty("checked");return this.initstats!=e||this.initsync!=t}}),enyo.kind({name:"Sugar.DialogSettingsItem",kind:enyo.Control,classes:"settings-item",published:{icon:null,text:null,colorized:!1,disabled:!1},components:[{components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"settings-item-icon",size:constant.sizeSettings,disabledBackground:"#000000"},{name:"text",content:"xxx",classes:"settings-item-text"}]}],create:function(){this.inherited(arguments),this.colorizedChanged(),this.iconChanged(),this.textChanged(),this.disabledChanged()},iconChanged:function(){this.$.icon.setIcon(this.icon)},textChanged:function(){this.$.text.setContent(this.text)},colorizedChanged:function(){this.$.icon.setColorized(this.colorized)},disabledChanged:function(){this.$.icon.setDisabled(this.disabled),this.addRemoveClass("settings-item-text-disable",this.disabled),this.addRemoveClass("settings-item-text-enable",!this.disabled)}}),enyo.kind({name:"Sugar.DialogSettingsWarningBox",kind:enyo.Control,classes:"settings-warningbox",events:{onRestart:"",onCancel:""},components:[{name:"warningtitle",content:"xxx",classes:"warningbox-title"},{name:"warningmessage",content:"xxx",classes:"warningbox-message"},{name:"warningcancel",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"dialog-cancel.svg"},classes:"warningbox-cancel-button",ontap:"cancel"},{name:"warningrestart",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"system-restart.svg"},classes:"warningbox-refresh-button",ontap:"restart"}],create:function(){this.inherited(arguments),this.$.warningtitle.setContent(l10n.get("Warning")),this.$.warningmessage.setContent(l10n.get("ChangesRequireRestart")),this.$.warningcancel.setText(l10n.get("CancelChanges")),this.$.warningrestart.setText(l10n.get("RestartNow")),"rtl"==l10n.language.direction&&(this.$.warningtitle.addClass("rtl-10"),this.$.warningmessage.addClass("rtl-10"))},cancel:function(){this.doCancel()},restart:function(){this.doRestart()}}),enyo.kind({name:"Sugar.DialogChangeLauncher",kind:"enyo.Popup",classes:"module-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!1,components:[{name:"toolbar",classes:"toolbar",components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"module-icon",colorized:!0,size:constant.sizeToolbar,icon:{directory:"icons",icon:"owner-icon.svg"}},{name:"text",content:"xxx",classes:"module-text"},{name:"cancelbutton",kind:"Button",classes:"toolbutton module-cancel-button",ontap:"cancel"},{name:"okbutton",kind:"Button",classes:"toolbutton module-ok-button",ontap:"ok"}]},{name:"warningbox",kind:"Sugar.DialogSettingsWarningBox",showing:!1,onCancel:"cancel",onRestart:"restart"},{name:"content",components:[{classes:"enterkey",components:[{name:"keyInput",kind:"Input",classes:"enterkey-input",oninput:"keychanged"}]},{name:"connectButton",kind:"Button",classes:"toolbutton",ontap:"ok"}]}],create:function(){this.inherited(arguments),this.$.text.setContent(l10n.get("EnterKey")),"rtl"==l10n.language.direction&&this.$.text.addClass("rtl-10")},rendered:function(){this.inherited(arguments),this.$.icon.render(),this.$.cancelbutton.setNodeProperty("title",l10n.get("Cancel")),this.$.okbutton.setNodeProperty("title",l10n.get("Ok")),this.$.connectButton.setContent(l10n.get("Ok"))},cancel:function(){this.hide()},ok:function(){sugarizerOS.sharedKeyBuffer=this.$.keyInput.getValue(),this.hide(),this.$.okbutton.setDisabled(!0),this.$.cancelbutton.setDisabled(!0)},keychanged:function(){},connect:function(){},centerDialog:function(e){var t=util.computeMargin({width:800,height:500},{width:.95,height:.95});e.applyStyle("margin-left",t.left+"px"),e.applyStyle("margin-top",t.top-55+"px")}}),enyo.kind({name:"Sugar.DialogWarningMessage",kind:"enyo.Popup",classes:"warning-dialog",centered:!1,modal:!0,floating:!0,autoDismiss:!0,components:[{name:"icon",kind:"Sugar.Icon",x:6,y:6,classes:"warningdialog-icon",size:constant.sizeToolbar,icon:{directory:"icons",icon:"emblem-warning.svg"}},{name:"warningtitle",content:"xxx",classes:"warningdialog-title"},{name:"warningmessage",content:"xxx",classes:"warningdialog-message"},{name:"warningcancel",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"dialog-cancel.svg"},classes:"warningdialog-cancel-button",ontap:"cancel"},{name:"warningrestart",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"system-shutdown.svg"},classes:"warningdialog-ok-button",ontap:"ok"}],create:function(){this.inherited(arguments),this.$.warningtitle.setContent(l10n.get("Warning")),this.$.warningmessage.setContent(l10n.get("AllDataWillBeLost")),this.$.warningcancel.setText(l10n.get("CancelChanges")),this.$.warningrestart.setText(l10n.get("Logoff"))},rendered:function(){this.inherited(arguments);var e=util.computeMargin({width:800,height:150},{width:.95,height:.95});this.applyStyle("margin-left",e.left+"px"),this.applyStyle("margin-top",e.top-55+"px")},cancel:function(){this.hide()},ok:function(){this.hide(),util.cleanDatastore(null,(function(){util.restartApp()}))}}),enyo.kind({name:"Sugar.GenericDialogBox",kind:enyo.Control,classes:"genericbox",events:{onOk:"",onCancel:"",onShow:"",onHide:""},published:{title:null,message:null,okText:"",cancelText:""},components:[{name:"warningtitle",content:"xxx",classes:"genericbox-title"},{name:"warningmessage",content:"xxx",classes:"genericbox-message"},{name:"warningcancel",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"dialog-cancel.svg"},classes:"genericbox-cancel-button",ontap:"cancel"},{name:"warningok",kind:"Sugar.IconButton",icon:{directory:"icons",icon:"dialog-ok.svg"},classes:"genericbox-ok-button",ontap:"ok"}],create:function(){this.inherited(arguments),this.titleChanged(),this.messageChanged(),this.okTextChanged(),this.cancelTextChanged(),"rtl"==l10n.language.direction&&(this.$.warningtitle.addClass("rtl-10"),this.$.warningmessage.addClass("rtl-10"))},titleChanged:function(){this.$.warningtitle.setContent(this.title)},messageChanged:function(){this.$.warningmessage.setContent(this.message)},cancelTextChanged:function(){this.$.warningcancel.setText(this.cancelText)},okTextChanged:function(){this.$.warningok.setText(this.okText)},showingChanged:function(){this.inherited(arguments),this.showing?this.doShow():this.doHide()},cancel:function(){this.doCancel()},ok:function(){this.doOk()}});