requirejs(["activity/utils"]);var TRASHWIDTH=120,TRASHHEIGHT=120;function Trashcan(){this.isVisible=!1,this._canvas=null,this._stage=null,this._size=null,this._refreshCanvas=null,this._scale=1,this._iconsize=55,this._container=new createjs.Container,this._borderHighlightBitmap=null,this._isHighlightInitialized=!1,this._inAnimation=!1,this._animationInterval=null,this._highlightPower=255,this._animationLevel=0,this.animationTime=500,this.init=function(){this._stage.addChild(this._container),this._stage.setChildIndex(this._container,0),this.resizeEvent(1),this._makeTrash()},this.setCanvas=function(i){return this._canvas=i,this},this.setStage=function(i){return this._stage=i,this},this.setSize=function(i){return this._size=i,this},this.setRefreshCanvas=function(i){return this._refreshCanvas=i,this},this._makeBorderHighlight=function(i){var t=new Image,e=this;t.onload=function(){e._borderHighlightBitmap=new createjs.Bitmap(t),e._borderHighlightBitmap.scaleX=e._size/e._iconsize,e._borderHighlightBitmap.scaleY=e._size/e._iconsize,e._isHighlightInitialized?e._container.removeChildAt(e._container.children.length-1):(e._container.visible=!1,e._isHighlightInitialized=!0),e._container.addChild(e._borderHighlightBitmap),e._borderHighlightBitmap.visible=!0};var n="rgb("+this._highlightPower+","+this._highlightPower+","+this._highlightPower+")";i&&(n="rgb(255, 0, 0)"),t.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(BORDER.replace("stroke_color",n))))},this._makeBorder=function(){var i=new Image,t=this;i.onload=function(){border=new createjs.Bitmap(i),bitmap.scaleX=t._size/t._iconsize,bitmap.scaleY=t._size/t._iconsize,t._container.addChild(border),t._makeBorderHighlight(!1)},i.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(BORDER.replace("stroke_color","#e0e0e0"))))},this._makeTrash=function(){var i=new Image,t=this;i.onload=function(){bitmap=new createjs.Bitmap(i),t._container.addChild(bitmap),t._iconsize=bitmap.getBounds().width,bitmap.scaleX=t._size/t._iconsize,bitmap.scaleY=t._size/t._iconsize,bitmap.x=(TRASHWIDTH-t._size)/2*bitmap.scaleX,bitmap.y=(TRASHHEIGHT-t._size)/2*bitmap.scaleY,t._makeBorder()},i.src="images/trash.svg"},this.resizeEvent=function(i){this._scale=i,this._container.x=(this._canvas.width/this._scale-TRASHWIDTH)/2,this._container.y=this._canvas.height/this._scale-TRASHHEIGHT},this.hide=function(){createjs.Tween.get(this._container).to({alpha:0},200).set({visible:!1})},this.show=function(){this.stopHighlightAnimation(),createjs.Tween.get(this._container).to({alpha:0,visible:!0}).to({alpha:1},200)},this.startHighlightAnimation=function(){if(!this._inAnimation){this._inAnimation=!0;var i=this;this._animationInterval=setInterval((function(){if(i._animationLevel+=20,i._animationLevel>=i.animationTime)return i.isVisible=!0,i._makeBorderHighlight(!0),i._refreshCanvas(),void clearInterval(i._animationInterval);i._highlightPower=parseInt(255-i._animationLevel/i.animationTime*255,10),i._makeBorderHighlight(!1),i._refreshCanvas()}),20),this._switchHighlightVisibility(!0)}},this.stopHighlightAnimation=function(){this._inAnimation&&(clearInterval(this._animationInterval),this._inAnimation=!1,this.isVisible=!1,this._animationLevel=0,this._highlightPower=255,this._makeBorderHighlight(!1),this._switchHighlightVisibility(!1))},this._switchHighlightVisibility=function(i){last(this._container.children).visible=i,this._container.children[1].visible=!i,this._container.visible=!0,this._refreshCanvas()},this.overTrashcan=function(i,t){var e=this._container.x,n=this._container.y;return!(i<e)&&(!(i>e+TRASHWIDTH)&&!(t<n))}}