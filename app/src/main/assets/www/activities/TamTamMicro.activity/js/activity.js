var app,tonePlayer,pianoMode=!1,simonMode=!1;define(["sugar-web/activity/activity","sugar-web/env","tutorial","l10n"],(function(e,t,n,o){requirejs(["domReady!"],(function(a){e.setup(),tonePlayer=new TamTam.TonePlayer,t.getEnvironment((function(t,n){currentenv=n;var a="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,d=n.user?n.user.language:a;o.init(d),app=new TamTam.App({activity:e}),n.objectId?e.getDatastoreObject().loadAsText((function(e,t,o){if(null==e&&null!=o){console.log("jornal data loaded!");var a=JSON.parse(o);app.setContext(a),app.renderInto(document.getElementById("keyboard"))}else console.log(o);(simonMode||pianoMode)&&(app.userColor=n.user.colorvalue,app.draw())})):app.renderInto(document.getElementById("keyboard")),pianoMode||simonMode||document.getElementById("instruments-button").classList.add("active")})),document.getElementById("fullscreen-button").addEventListener("click",(function(){document.getElementById("main-toolbar").style.display="none",document.getElementById("app_content").style.top="0px",document.getElementById("app_content").style.height="100%",document.getElementById("unfullscreen-button").style.visibility="visible",app.computeSize()})),document.getElementById("unfullscreen-button").addEventListener("click",(function(){document.getElementById("main-toolbar").style.display="block",document.getElementById("app_content").style.top="0px",document.getElementById("app_content").style.height="50%",document.getElementById("unfullscreen-button").style.visibility="hidden",app.computeSize()})),document.getElementById("help-button").addEventListener("click",(function(e){n.start()})),document.getElementById("stop-button").addEventListener("click",(function(t){console.log(app.getContext());var n=JSON.stringify(app.getContext());e.getDatastoreObject().setDataAsText(n),e.getDatastoreObject().save((function(e){null===e?console.log("write done."):console.log("write failed.")}))})),document.getElementById("piano-button").addEventListener("click",(function(e){app.changePianoMode()})),document.getElementById("simon-button").addEventListener("click",(function(e){app.changeSimonMode()})),document.getElementById("instruments-button").addEventListener("click",(function(e){app.changeInstrumentsMode()}))}))}));