Vue.component("sugar-localization",{template:"<div/>",data:function(){return{l10n:null,code:null,dictionary:null,eventReceived:!1,activityInitialized:!1,units:[{name:"Years",factor:30758400},{name:"Months",factor:2592e3},{name:"Weeks",factor:604800},{name:"Days",factor:86400},{name:"Hours",factor:3600},{name:"Minutes",factor:60}]}},computed:{readyToEmit:function(){return null!=this.dictionary&&this.activityInitialized}},watch:{readyToEmit:function(t,e){t&&(this.$emit("localized"),this.eventReceived=!0)}},mounted:function(){var t=this;null==t.l10n&&(requirejs(["sugar-web/env","webL10n"],(function(e,n){e.getEnvironment((function(e,i){t.l10n=n;var a="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,o=i.user?i.user.language:a;n.language.code=o,window.addEventListener("localized",(function(){t.eventReceived?n.language.code!=o&&(n.language.code=o):(t.code=o,t.dictionary=t.l10n.dictionary)}))}))})),t.$root.$children.find((function(t){return"SugarActivity"==t.$options.name})).$on("initialized",(function(){t.activityInitialized=!0})))},methods:{get:function(t,e){var n="";if(this.dictionary){var i=this.dictionary[t];n=i&&i.textContent?i.textContent:t}else n=t;if(e){var a=n.match(/{{\s*[\w\.]+\s*}}/g);for(var o in a){var r=a[o].match(/[\w\.]+/)[0];e[r]&&(n=n.replace(a[o],e[r]))}}return n},localize:function(t){var e=this;Object.keys(t).forEach((function(n,i){t[n]=e.get(n.substr(6))}))},localizeTimestamp:function(t){for(var e=0,n="",i=((new Date).getTime()-t)/1e3,a=0;a<this.units.length;a++){var o=this.units[a].factor,r=Math.floor(i/o);if(r>0&&(e>0&&(n+=","),n+=" "+r+" "+(1==r?this.get(this.units[a].name+"_one"):this.get(this.units[a].name+"_other")),i-=r*o),""!=n&&(e+=1),2==e)break}return 0==e?this.get("SecondsAgo"):this.get("Ago",{time:n})}}});