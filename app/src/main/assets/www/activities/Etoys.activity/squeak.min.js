"use strict";window.module=function(Bt){if(""===Bt)return window;var Yt=Bt.split("."),Zt=Yt.pop(),te=module(Yt.join(".")),ee=te[Zt];return ee||(te[Zt]=ee={loaded:!1,pending:[],requires:function(Bt){return{toRun:function(Yt){function i(){Yt(),ee.loaded=!0,ee.pending.forEach((function(Bt){Bt()}))}Bt&&!module(Bt).loaded?module(Bt).pending.push(i):i()}}}}),ee},Object.extend=function(Bt){for(var Yt=1;Yt<arguments.length;Yt++)if("object"==typeof arguments[Yt])for(var Zt in arguments[Yt])Bt[Zt]=arguments[Yt][Zt]},Function.prototype.subclass=function(Bt){var e=function(){return this.initialize&&this.initialize.apply(this,arguments),this},i=function(){};i.prototype=this.prototype,e.prototype=new i;for(var Yt=1;Yt<arguments.length;Yt++)Object.extend(e.prototype,arguments[Yt]);var Zt=Bt.split("."),te=Zt.pop();return module(Zt.join("."))[te]=e,e},function(){var Bt=document.getElementsByTagName("script"),Yt=Bt[Bt.length-1],Zt=Yt.src.replace(/[^\/]*$/,"");Yt.src.match(/squeak\.min\.js$/)||["vm.js","jit.js","plugins/ADPCMCodecPlugin.js","plugins/B2DPlugin.js","plugins/BitBltPlugin.js","plugins/FFTPlugin.js","plugins/FloatArrayPlugin.js","plugins/GeniePlugin.js","plugins/JPEGReaderPlugin.js","plugins/KedamaPlugin.js","plugins/KedamaPlugin2.js","plugins/Klatt.js","plugins/LargeIntegers.js","plugins/Matrix2x3Plugin.js","plugins/MiscPrimitivePlugin.js","plugins/ScratchPlugin.js","plugins/SoundGenerationPlugin.js","plugins/StarSqueakPlugin.js","plugins/ZipPlugin.js","lib/lz-string.js"].forEach((function(Bt){var Yt=document.createElement("script");Yt.setAttribute("type","text/javascript"),Yt.setAttribute("src",Zt+Bt),document.getElementsByTagName("head")[0].appendChild(Yt)}))}(),module("SqueakJS").requires("users.bert.SqueakJS.vm").toRun((function(){function c(Yt){if(Yt.swapCheckbox){var Zt=Bt.squeakImageName||"default",te=JSON.parse(Bt["squeakSettings:"+Zt]||"{}");"swapButtons"in te&&(Yt.swapButtons=te.swapButtons),Yt.swapCheckbox.checked=Yt.swapButtons,Yt.swapCheckbox.onclick=function(){Yt.swapButtons=Yt.swapCheckbox.checked,te.swapButtons=Yt.swapButtons,Bt["squeakSettings:"+Zt]=JSON.stringify(te)}}}function n(Bt,Yt){var Zt=Bt.shiftKey,te=Bt.ctrlKey&&!Bt.altKey,ee=Bt.metaKey||Bt.altKey&&!Bt.ctrlKey,ie=(Zt?Squeak.Keyboard_Shift:0)+(te?Squeak.Keyboard_Ctrl:0)+(ee?Squeak.Keyboard_Cmd:0);return Yt.buttons=Yt.buttons&~Squeak.Keyboard_All|ie,ie}function l(Bt,Yt,te){var ee=Zt?Bt.offsetX:Bt.layerX,ie=Zt?Bt.offsetY:Bt.layerY;te.cursorCanvas.style.left=ee+Yt.offsetLeft+te.cursorOffsetX+"px",te.cursorCanvas.style.top=ie+Yt.offsetTop+te.cursorOffsetY+"px";var re=ee*Yt.width/Yt.offsetWidth|0,se=ie*Yt.height/Yt.offsetHeight|0;te.mouseX=Math.max(0,Math.min(te.width,re)),te.mouseY=Math.max(0,Math.min(te.height,se))}function e(Bt,Yt,Zt,te,ee,ie){if(l(Yt,Zt,te),te.vm){var re=te.buttons&Squeak.Mouse_All;switch(Bt){case"mousedown":switch(Yt.button||0){case 0:re=Squeak.Mouse_Red;break;case 1:re=Squeak.Mouse_Yellow;break;case 2:re=Squeak.Mouse_Blue}ie.swapButtons&&(re==Squeak.Mouse_Yellow?re=Squeak.Mouse_Blue:re==Squeak.Mouse_Blue&&(re=Squeak.Mouse_Yellow));break;case"mousemove":break;case"mouseup":re=0}te.buttons=re|n(Yt,te),ee&&(ee.push([Squeak.EventTypeMouse,Yt.timeStamp,te.mouseX,te.mouseY,te.buttons&Squeak.Mouse_All,te.buttons>>3]),te.signalInputEvent&&te.signalInputEvent()),te.idle=0,"mouseup"==Bt?te.runFor&&te.runFor(100):te.runNow&&te.runNow()}}function r(Bt,Yt,Zt,te){if(Zt.vm){var ee=Zt.buttons>>3<<8|Bt;ee===Zt.vm.interruptKeycode?Zt.vm.interruptPending=!0:te?(te.push([Squeak.EventTypeKeyboard,Yt,Bt,Squeak.EventKeyChar,Zt.buttons>>3,Bt]),Zt.signalInputEvent&&Zt.signalInputEvent()):Zt.keys.push(ee),Zt.idle=0,Zt.runNow&&Zt.runNow()}}function s(Bt,Yt,Zt,te,ee){te.vm&&ee&&(l(Yt,Zt,te),ee.push([Squeak.EventTypeDragDropFiles,Yt.timeStamp,Bt,te.mouseX,te.mouseY,te.buttons>>3,te.droppedFiles.length]),te.signalInputEvent&&te.signalInputEvent())}function f(Bt,Yt,Zt,te){Zt.buttons&=~Squeak.Keyboard_All,Zt.buttons|=Squeak.Keyboard_Cmd|Squeak.Keyboard_Ctrl,Zt.keys=[],r(Bt,Yt,Zt,te)}function m(Bt,Yt){function p(Yt){if(Yt.touches.length){ie.x=ie.y=0;for(var Zt=0;Zt<Yt.touches.length;Zt++)ie.x+=Yt.touches[Zt].pageX/Yt.touches.length,ie.y+=Yt.touches[Zt].pageY/Yt.touches.length}return{timeStamp:Yt.timeStamp,button:ie.button,offsetX:ie.x-Bt.offsetLeft,offsetY:ie.y-Bt.offsetTop}}function k(Bt,Yt,Zt,te){var ee=Bt-Zt,ie=Yt-te;return Math.sqrt(ee*ee+ie*ie)}function m(Bt,Yt){return k(Bt.pageX,Bt.pageY,Yt.pageX,Yt.pageY)}function b(te,ee,ie,re){var se=Zt.cursorCanvas,ne=ie/Bt.width;Bt.style.left=(0|te)+"px",Bt.style.top=(0|ee)+"px",Bt.style.width=(0|ie)+"px",Bt.style.height=(0|re)+"px",se.style.left=(te+Zt.cursorOffsetX+Zt.mouseX*ne|0)+"px",se.style.top=(ee+Zt.cursorOffsetY+Zt.mouseY*ne|0)+"px",se.style.width=(se.width*ne|0)+"px",se.style.height=(se.height*ne|0)+"px",Yt.pixelated||(ne>=3?(Bt.classList.add("pixelated"),Zt.cursorCanvas.classList.add("pixelated")):(Bt.classList.remove("pixelated"),Zt.cursorCanvas.classList.remove("pixelated")))}function F(Yt){ie.dist=m(Yt.touches[0],Yt.touches[1]),ie.down.x=ie.x,ie.down.y=ie.y,ie.down.dist=ie.dist,ie.down.left=Bt.offsetLeft,ie.down.top=Bt.offsetTop,ie.down.width=Bt.offsetWidth,ie.down.height=Bt.offsetHeight,ie.orig||(ie.orig={left:ie.down.left,top:ie.down.top,right:ie.down.left+ie.down.width,bottom:ie.down.top+ie.down.height,width:ie.down.width,height:ie.down.height})}function y(){var Yt=Bt.offsetLeft,Zt=Bt.offsetTop,te=Bt.offsetWidth,ee=Bt.offsetHeight;te=Math.min(Math.max(te,ie.orig.width),ie.orig.width*re),ee=ie.orig.height*te/ie.orig.width,b(Yt=Math.max(Math.min(Yt,ie.orig.left),ie.orig.right-te),Zt=Math.max(Math.min(Zt,ie.orig.top),ie.orig.bottom-ee),te,ee)}function h(Bt){for(var Yt=0;Yt<Bt.dataTransfer.types.length;Yt++)if("Files"==Bt.dataTransfer.types[Yt])return!0;return!1}(Yt=Yt||{}).fullscreen&&(document.body.style.margin=0,document.body.style.backgroundColor="black",document.ontouchmove=function(Bt){Bt.preventDefault()},Yt.header&&(Yt.header.style.display="none"),Yt.footer&&(Yt.footer.style.display="none"));var Zt={context:Bt.getContext("2d"),fullscreen:!1,width:0,height:0,mouseX:0,mouseY:0,buttons:0,keys:[],clipboardString:"",clipboardStringChanged:!1,cursorCanvas:document.createElement("canvas"),cursorOffsetX:0,cursorOffsetY:0,droppedFiles:[],signalInputEvent:null};c(Yt),Yt.pixelated&&(Bt.classList.add("pixelated"),Zt.cursorCanvas.classList.add("pixelated"));var te=null;Zt.reset=function(){te=null,Zt.signalInputEvent=null,Zt.lastTick=0,Zt.getNextEvent=function(Bt,Yt){(te=[]).push=function(Bt){te.offset=Date.now()-Bt[1],delete te.push,te.push(Bt)},Zt.getNextEvent=function(Bt,Yt){var Zt=te.shift();Zt?function d(Bt,Yt,Zt){Yt[0]=Bt[0],Yt[1]=Bt[1]-Zt&Squeak.MillisecondClockMask;for(var te=2;te<Bt.length;te++)Yt[te]=Bt[te]}(Zt,Bt,Yt-te.offset):Bt[0]=Squeak.EventTypeNone},Zt.getNextEvent(Bt,Yt)}},Zt.reset();var ee=function v(Bt,Yt,Zt){function a(Yt){Bt.fullscreen=Yt,ee.style.background=Yt?"black":"",Zt.header&&(Zt.header.style.display=Yt?"none":""),Zt.footer&&(Zt.footer.style.display=Yt?"none":""),Zt.fullscreenCheckbox&&(Zt.fullscreenCheckbox.checked=Yt),setTimeout(window.onresize,0)}var te,ee=Yt.parentElement,ie="fullscreenchange",re="fullscreenElement",se="fullscreenEnabled";if(ee.requestFullscreen||[{req:ee.webkitRequestFullscreen,exit:document.webkitExitFullscreen,evt:"webkitfullscreenchange",elem:"webkitFullscreenElement",enable:"webkitFullscreenEnabled"},{req:ee.mozRequestFullScreen,exit:document.mozCancelFullScreen,evt:"mozfullscreenchange",elem:"mozFullScreenElement",enable:"mozFullScreenEnabled"},{req:ee.msRequestFullscreen,exit:document.msExitFullscreen,evt:"MSFullscreenChange",elem:"msFullscreenElement",enable:"msFullscreenEnabled"}].forEach((function(Bt){Bt.req&&(ee.requestFullscreen=Bt.req,document.exitFullscreen=Bt.exit,ie=Bt.evt,re=Bt.elem,se=Bt.enable)})),ee.requestFullscreen)document.addEventListener(ie,(function(){a(ee==document[re])})),te=function(){document[se]&&ee==document[re]!=Bt.fullscreen&&(Bt.fullscreen?ee.requestFullscreen():document.exitFullscreen())};else{var ne=!1;te=function(){(Zt.header||Zt.footer)&&ne!=Bt.fullscreen&&a(ne=Bt.fullscreen)}}return Zt.fullscreenCheckbox&&(Zt.fullscreenCheckbox.onclick=function(){Bt.fullscreen=Zt.fullscreenCheckbox.checked,te()}),te}(Zt,Bt,Yt);Zt.fullscreenRequest=function(Bt,Yt){Zt.fullscreen!=Bt?(Zt.fullscreen=Bt,Zt.resizeTodo=Yt,Zt.resizeTodoTimeout=setTimeout(Zt.resizeDone,1e3),ee()):Yt()},Zt.resizeDone=function(){clearTimeout(Zt.resizeTodoTimeout);var Bt=Zt.resizeTodo;Bt&&(Zt.resizeTodo=null,Bt())},Zt.clear=function(){Bt.width=Bt.width},Zt.showBanner=function(Yt,te){te=te||{};var ee=Zt.context;ee.clearRect(0,0,Bt.width,Bt.height),ee.fillStyle=te.color||"#F90",ee.font=te.font||"bold 48px sans-serif",ee.textAlign="center",ee.textBaseline="middle",ee.fillText(Yt,Bt.width/2,Bt.height/2)},Zt.showProgress=function(Yt,te){te=te||{};var ee=Zt.context,ie=Bt.width/3|0,re=.5*Bt.width-ie/2,se=.5*Bt.height+48;ee.fillStyle=te.background||"#000",ee.fillRect(re,se,ie,24),ee.lineWidth=2,ee.strokeStyle=te.color||"#F90",ee.strokeRect(re,se,ie,24),ee.fillStyle=te.color||"#F90",ee.fillRect(re,se,ie*Yt,24)},Zt.executeClipboardPaste=function(Bt,Yt){if(!Zt.vm)return!0;try{Zt.clipboardString=Bt,f("v".charCodeAt(0),Yt,Zt,te)}catch(Bt){console.error("paste error "+Bt)}},Zt.executeClipboardCopy=function(Bt,Yt){if(!Zt.vm)return!0;Zt.clipboardStringChanged=!1,f((Bt||"c").charCodeAt(0),Yt,Zt,te);for(var ee=Date.now();!Zt.clipboardStringChanged&&Date.now()-ee<500;)Zt.vm.interpret(20);if(Zt.clipboardStringChanged)try{return Zt.clipboardString}catch(Bt){console.error("copy error "+Bt)}},Bt.onmousedown=function(ie){return ee(),e("mousedown",ie,Bt,Zt,te,Yt),ie.preventDefault(),!1},Bt.onmouseup=function(ie){e("mouseup",ie,Bt,Zt,te,Yt),ee(),ie.preventDefault()},Bt.onmousemove=function(ee){e("mousemove",ee,Bt,Zt,te,Yt),ee.preventDefault()},Bt.oncontextmenu=function(){return!1};var ie={state:"idle",button:0,x:0,y:0,dist:0,down:{}},re=5;return Bt.ontouchstart=function(ee){ee.preventDefault();for(var re=p(ee),se=0;se<ee.changedTouches.length;se++)switch(ie.state){case"idle":ie.state="got1stFinger",ie.first=re,setTimeout((function(){"got1stFinger"===ie.state&&(ie.state="mousing",ie.button=re.button=0,e("mousemove",re,Bt,Zt,te,Yt),e("mousedown",re,Bt,Zt,te,Yt))}),100);break;case"got1stFinger":ie.state="got2ndFinger",F(ee),setTimeout((function(){"got2ndFinger"===ie.state&&(Math.abs(ie.down.dist-ie.dist)>10||k(ie.down.x,ie.down.y,ie.x,ie.y)>10?ie.state="zooming":(ie.state="mousing",ie.button=re.button=2,e("mousemove",re,Bt,Zt,te,Yt),e("mousedown",re,Bt,Zt,te,Yt)))}),200)}},Bt.ontouchmove=function(ee){ee.preventDefault();var se=p(ee);switch(ie.state){case"got1stFinger":ie.state="mousing",ie.button=se.button=0,e("mousemove",se,Bt,Zt,te,Yt),e("mousedown",se,Bt,Zt,te,Yt);break;case"mousing":return void e("mousemove",se,Bt,Zt,te,Yt);case"got2ndFinger":return void(ee.touches.length>1&&(ie.dist=m(ee.touches[0],ee.touches[1])));case"zooming":return void function S(Bt){if(!(Bt.touches.length<2)){ie.dist=m(Bt.touches[0],Bt.touches[1]);var Yt=ie.orig.width/ie.down.width,Zt=ie.dist/ie.down.dist,te=Math.min(Math.max(Zt,.95*Yt),Yt*re),ee=ie.down.width*te,se=ie.orig.height*ee/ie.orig.width,ne=ie.down.left-(ie.down.x-ie.down.left)*(te-1)+(ie.x-ie.down.x),ae=ie.down.top-(ie.down.y-ie.down.top)*(te-1)+(ie.y-ie.down.y);b(ne=Math.max(Math.min(ne,ie.orig.left+20),ie.orig.right-ee-20),ae=Math.max(Math.min(ae,ie.orig.top+20),ie.orig.bottom-se-20),ee,se)}}(ee)}},Bt.ontouchend=function(re){re.preventDefault(),ee();for(var se=p(re),ne=0;ne<re.changedTouches.length;ne++)switch(ie.state){case"mousing":if(re.touches.length>0)break;return ie.state="idle",void e("mouseup",se,Bt,Zt,te,Yt);case"got1stFinger":return ie.state="idle",ie.button=se.button=0,e("mousemove",se,Bt,Zt,te,Yt),e("mousedown",se,Bt,Zt,te,Yt),void e("mouseup",se,Bt,Zt,te,Yt);case"got2ndFinger":ie.state="mousing",ie.button=se.button=2,e("mousemove",se,Bt,Zt,te,Yt),e("mousedown",se,Bt,Zt,te,Yt);break;case"zooming":if(re.touches.length>0)break;return ie.state="idle",void y()}},Bt.ontouchcancel=function(Yt){Bt.ontouchend(Yt)},Zt.cursorCanvas.style.display="block",Zt.cursorCanvas.style.position="absolute",Zt.cursorCanvas.style.cursor="none",Zt.cursorCanvas.style.background="transparent",Zt.cursorCanvas.style.pointerEvents="none",Bt.parentElement.appendChild(Zt.cursorCanvas),Bt.style.cursor="none",document.onkeypress=function(Bt){return!Zt.vm||(!!/[CXVR]/.test(String.fromCharCode(Bt.charCode+64))||(n(Bt,Zt),r(Bt.charCode,Bt.timeStamp,Zt,te),void Bt.preventDefault()))},document.onkeydown=function(Bt){if(ee(),!Zt.vm)return!0;n(Bt,Zt);var Yt={8:8,9:9,13:13,27:27,33:11,34:12,35:4,36:1,37:28,38:30,39:29,40:31,45:5,46:127}[Bt.keyCode];if(Yt)return r(Yt,Bt.timeStamp,Zt,te),Bt.preventDefault();if(Bt.metaKey||Bt.altKey&&!Bt.ctrlKey){var ie=Bt.key;if(!ie&&Bt.keyIdentifier&&"U+"==Bt.keyIdentifier.slice(0,2)&&(ie=String.fromCharCode(parseInt(Bt.keyIdentifier.slice(2),16))),ie&&1==ie.length){if(/[CXVR]/i.test(ie))return!0;var re=ie.charCodeAt(0);return/[A-Z]/.test(ie)&&!Bt.shiftKey&&(re+=32),r(re,Bt.timeStamp,Zt,te),Bt.preventDefault()}}},document.onkeyup=function(Bt){return!Zt.vm||void n(Bt,Zt)},document.oncopy=function(Bt,Yt){var te=Zt.executeClipboardCopy(Yt,Bt.timeStamp);"string"==typeof te&&Bt.clipboardData.setData("Text",te),Bt.preventDefault()},document.oncut=function(Bt){return!Zt.vm||void document.oncopy(Bt,"x")},document.onpaste=function(Bt){var Yt=Bt.clipboardData.getData("Text");Zt.executeClipboardPaste(Yt,Bt.timeStamp),Bt.preventDefault()},document.ondragover=function(Yt){Yt.preventDefault(),h(Yt)?(Yt.dataTransfer.dropEffect="copy",s(Squeak.EventDragMove,Yt,Bt,Zt,te)):Yt.dataTransfer.dropEffect="none"},document.ondragenter=function(Yt){h(Yt)&&s(Squeak.EventDragEnter,Yt,Bt,Zt,te)},document.ondragleave=function(Yt){h(Yt)&&s(Squeak.EventDragLeave,Yt,Bt,Zt,te)},document.ondrop=function(ee){if(ee.preventDefault(),!h(ee))return!1;var ie,re=[].slice.call(ee.dataTransfer.files),se=[],ne=null;return Zt.droppedFiles=[],re.forEach((function(ae){Zt.droppedFiles.push(ae.name);var oe=new FileReader;oe.onload=function(){var oe=this.result;Squeak.filePut(ae.name,oe),se.push(ae.name),ie||!/.*image$/.test(ae.name)||Zt.vm&&!confirm("Run "+ae.name+" now?\n(cancel to use as file)")||(ie=oe,ne=ae.name),se.length==re.length&&(ie?(SqueakJS.appName=ne.slice(0,-6),SqueakJS.runImage(ie,ne,Zt,Yt)):s(Squeak.EventDragDrop,ee,Bt,Zt,te))},oe.readAsArrayBuffer(ae)})),!1},window.onresize=function(){if(!ie.orig){var te=window.innerWidth,ee=window.innerHeight;if(setTimeout((function(){te==window.innerWidth&&ee==window.innerHeight&&Zt.resizeDone()}),300),!(Yt.header&&Yt.footer||Yt.fullscreen))return Zt.width=Bt.width,void(Zt.height=Bt.height);var re=Yt.fullscreen||Zt.fullscreen,se=re?0:Yt.header.offsetTop+Yt.header.offsetHeight,ne=window.innerWidth,ae=re?window.innerHeight:Math.max(100,Yt.footer.offsetTop-se),oe=0,ue=0;if(Yt.fixedWidth){Zt.width=Yt.fixedWidth,Zt.height=Yt.fixedHeight;var le=Zt.width/Zt.height;ne/ae>le?oe=ne-Math.floor(ae*le):ue=ae-Math.floor(ne/le)}else Zt.width=ne,Zt.height=ae;if(Bt.style.left=0+Math.floor(oe/2)+"px",Bt.style.top=se+Math.floor(ue/2)+"px",Bt.style.width=ne-oe+"px",Bt.style.height=ae-ue+"px",Bt.width!=Zt.width||Bt.height!=Zt.height){var ce=(Yt.fixedWidth||!Zt.resizeTodo)&&Zt.context.getImageData(0,0,Bt.width,Bt.height);Bt.width=Zt.width,Bt.height=Zt.height,ce&&Zt.context.putImageData(ce,0,0)}if(Yt.fixedWidth){var fe=Zt.cursorCanvas,he=Bt.offsetWidth/Bt.width;fe.style.width=fe.width*he+"px",fe.style.height=fe.height*he+"px"}}},window.onresize(),Zt}function k(Bt,Yt,Zt,ie){var re=0===Yt,se=Zt.lastTick-ie.lastTick<500;!re||se?(Bt.display="none",ee=0):0===ee?ee=Zt.lastTick:Zt.lastTick-ee>1e3&&(Bt.display="block",te=(te+30)%360,Bt.webkitTransform=Bt.transform="rotate("+te+"deg)")}var Bt=window.localStorage;try{if(Bt["squeak-foo:"]="bar","bar"!==Bt["squeak-foo:"])throw Error();delete Bt["squeak-foo:"]}catch(Yt){Bt={}}var Yt,Zt=navigator.userAgent.match("AppleWebKit/"),te=0,ee=0;SqueakJS.runImage=function(Zt,te,ee,ie){window.onbeforeunload=function(Bt){var Yt=SqueakJS.appName+" is still running";return Bt.returnValue=Yt,Yt},window.clearTimeout(Yt),ee.reset(),ee.clear(),ee.showBanner("Loading "+SqueakJS.appName),ee.showProgress(0);var re=this;window.setTimeout((function(){var se=new Squeak.Image(te);se.readFromBuffer(Zt,(function(){function u(){try{ee.quitFlag?re.onQuit(Zt,ee,ie):Zt.interpret(50,(function(Bt){"sleep"==Bt&&(Bt=200),ne&&k(ne,Bt,Zt,ee),Yt=window.setTimeout(u,Bt)}))}catch(Bt){console.error(Bt),alert(Bt)}}ee.quitFlag=!1;var Zt=new Squeak.Interpreter(se,ee);SqueakJS.vm=Zt,Bt.squeakImageName=te,c(ie),ee.clear(),ee.showBanner("Starting "+SqueakJS.appName);var ne=function g(Bt,Yt){var Zt=Yt.spinner;return Zt?(Zt.onmousedown=function(){confirm(SqueakJS.appName+" is busy. Interrupt?")&&(Bt.interruptPending=!0)},Zt.style):null}(Zt,ie);ee.runNow=function(){window.clearTimeout(Yt),u()},ee.runFor=function(Bt){var Yt=Date.now()+Bt;do{ee.runNow()}while(Date.now()<Yt)},u()}),(function(Bt){ee.showProgress(Bt)}))}),0)},SqueakJS.runSqueak=function(Bt,Yt,Zt){if(function h(Bt){var Yt=window.location.hash.slice(1),Zt=Yt&&Yt.split("&");if(Zt)for(var te=0;te<Zt.length;te++){var ee=Zt[te].split("="),ie=ee[0],re=!0;if(ee.length>1&&(re=decodeURIComponent(ee.slice(1).join("="))).match(/^(true|false|null|[0-9"[{].*)$/))try{re=JSON.parse(re)}catch(Bt){"["===re[0]&&(re=re.slice(1,-1).split(","))}Bt[ie]=re}var se=Squeak.splitFilePath(Bt.root||"/").fullname;Squeak.dirCreate(se,!0),/\/$/.test(se)||(se+="/"),Bt.root=se,Bt.url&&Bt.files&&!Bt.image&&(Bt.image=Bt.url+"/"+Bt.files[0])}(Zt),Zt.image?Bt=Zt.image:Zt.image=Bt,!Bt.match(/^http:/)||!location.protocol.match(/^https/)){SqueakJS.options=Zt,SqueakJS.appName=Zt.appName||Bt.replace(/.*\//,"").replace(/\.image$/,""),Squeak.fsck(),function p(Bt){if(Bt.templates){if(Bt.templates.constructor===Array){var Yt={};Bt.templates.forEach((function(Bt){Yt[Bt]=Bt})),Bt.templates=Yt}for(var Zt in Bt.templates)Squeak.fetchTemplateDir("/"==Zt[0]?Zt:Bt.root+Zt,Bt.templates[Zt])}}(Zt);var te=m(Yt,Zt),ee=Squeak.splitFilePath(Bt).basename,ie=null,re=Bt.replace(/[^\/]*$/,""),se=[{url:Bt,name:ee}];if(Zt.files&&Zt.files.forEach((function(Bt){Bt!==ee&&se.push({url:re+Bt,name:Bt})})),Zt.document){var ne=Squeak.splitFilePath(Zt.document).basename;se.push({url:Zt.document,name:ne,forceDownload:!1!==Zt.forceDownload}),te.documentName=Zt.root+ne}return function i(Bt){if(0===se.length)return Bt(ie);var Yt=se.shift();if(Zt.forceDownload||Yt.forceDownload||!Squeak.fileExists(Zt.root+Yt.name)){te.showBanner("Downloading "+Yt.name);var re=new XMLHttpRequest;re.open("GET",Yt.url),re.responseType="arraybuffer",re.onprogress=function(Bt){Bt.lengthComputable&&te.showProgress(Bt.loaded/Bt.total)},re.onload=function(){200==this.status?(Yt.name==ee&&(ie=this.response),Squeak.filePut(Zt.root+Yt.name,this.response,(function(){i(Bt)}))):this.onerror(this.statusText)},re.onerror=function(){console.warn("Retrying with CORS proxy: "+Yt.url);var Bt=Zt.proxy||"https://crossorigin.me/",te=new XMLHttpRequest;te.open("GET",Bt+Yt.url),te.responseType=re.responseType,te.onprogress=re.onprogress,te.onload=re.onload,te.onerror=function(){alert("Failed to download:\n"+Yt.url)},te.send()},re.send()}else Yt.name==ee?Squeak.fileGet(Zt.root+Yt.name,(function(Yt){ie=Yt,i(Bt)}),(function(){Squeak.fileDelete(Zt.root+Yt.name),se.unshift(Yt),i(Bt)})):i(Bt)}((function(Bt){SqueakJS.runImage(Bt,Zt.root+ee,te,Zt)})),te}location.protocol="http"},SqueakJS.quitSqueak=function(){SqueakJS.vm.quitFlag=!0},SqueakJS.onQuit=function(Bt,Yt,Zt){window.onbeforeunload=null,Yt.vm=null,Zt.spinner&&(Zt.spinner.style.display="none"),Zt.onQuit?Zt.onQuit(Bt,Yt,Zt):Yt.showBanner(SqueakJS.appName+" stopped.")}})),window.applicationCache&&applicationCache.addEventListener("updateready",(function(){var Bt=window.SqueakJS&&SqueakJS.options&&SqueakJS.options.appName||"SqueakJS";confirm(Bt+" has been updated. Restart now?")&&(window.onbeforeunload=null,window.location.reload())})),module("users.bert.SqueakJS.vm").requires().toRun((function(){window.Squeak=users.bert.SqueakJS.vm;var Bt=window.localStorage;try{if(Bt["squeak-foo:"]="bar","bar"!==Bt["squeak-foo:"])throw Error();delete Bt["squeak-foo:"]}catch(Yt){console.warn("localStorage not available, faking"),Bt={}}Object.extend(Squeak,"version",{vmVersion:"SqueakJS 0.8.2",vmBuild:"unknown",vmPath:"/",vmFile:"vm.js",platformName:"Web",platformSubtype:"unknown",osVersion:navigator.userAgent,windowSystem:"HTML"},"object header",{HeaderTypeMask:3,HeaderTypeSizeAndClass:0,HeaderTypeClass:1,HeaderTypeFree:2,HeaderTypeShort:3},"special objects",{splOb_NilObject:0,splOb_FalseObject:1,splOb_TrueObject:2,splOb_SchedulerAssociation:3,splOb_ClassBitmap:4,splOb_ClassInteger:5,splOb_ClassString:6,splOb_ClassArray:7,splOb_SmalltalkDictionary:8,splOb_ClassFloat:9,splOb_ClassMethodContext:10,splOb_ClassBlockContext:11,splOb_ClassPoint:12,splOb_ClassLargePositiveInteger:13,splOb_TheDisplay:14,splOb_ClassMessage:15,splOb_ClassCompiledMethod:16,splOb_TheLowSpaceSemaphore:17,splOb_ClassSemaphore:18,splOb_ClassCharacter:19,splOb_SelectorDoesNotUnderstand:20,splOb_SelectorCannotReturn:21,splOb_TheInputSemaphore:22,splOb_SpecialSelectors:23,splOb_CharacterTable:24,splOb_SelectorMustBeBoolean:25,splOb_ClassByteArray:26,splOb_ClassProcess:27,splOb_CompactClasses:28,splOb_TheTimerSemaphore:29,splOb_TheInterruptSemaphore:30,splOb_FloatProto:31,splOb_SelectorCannotInterpret:34,splOb_MethodContextProto:35,splOb_ClassBlockClosure:36,splOb_BlockContextProto:37,splOb_ExternalObjectsArray:38,splOb_ClassPseudoContext:39,splOb_ClassTranslatedMethod:40,splOb_TheFinalizationSemaphore:41,splOb_ClassLargeNegativeInteger:42,splOb_ClassExternalAddress:43,splOb_ClassExternalStructure:44,splOb_ClassExternalData:45,splOb_ClassExternalFunction:46,splOb_ClassExternalLibrary:47,splOb_SelectorAboutToReturn:48,splOb_SelectorRunWithIn:49,splOb_SelectorAttemptToAssign:50,splOb_PrimErrTableIndex:51,splOb_ClassAlien:52,splOb_InvokeCallbackSelector:53,splOb_ClassUnsafeAlien:54,splOb_ClassWeakFinalizer:55},"known classes",{Class_superclass:0,Class_mdict:1,Class_format:2,Class_instVars:null,Class_name:6,Context_sender:0,Context_instructionPointer:1,Context_stackPointer:2,Context_method:3,Context_closure:4,Context_receiver:5,Context_tempFrameStart:6,Context_smallFrameSize:17,Context_largeFrameSize:57,BlockContext_caller:0,BlockContext_argumentCount:3,BlockContext_initialIP:4,BlockContext_home:5,Closure_outerContext:0,Closure_startpc:1,Closure_numArgs:2,Closure_firstCopiedValue:3,Stream_array:0,Stream_position:1,Stream_limit:2,ProcSched_processLists:0,ProcSched_activeProcess:1,Link_nextLink:0,LinkedList_firstLink:0,LinkedList_lastLink:1,Semaphore_excessSignals:2,Proc_suspendedContext:1,Proc_priority:2,Proc_myList:3,Assn_key:0,Assn_value:1,MethodDict_array:1,MethodDict_selectorStart:2,Message_selector:0,Message_arguments:1,Message_lookupClass:2,Point_x:0,Point_y:1,LargeInteger_bytes:0,LargeInteger_neg:1,BitBlt_dest:0,BitBlt_source:1,BitBlt_halftone:2,BitBlt_combinationRule:3,BitBlt_destX:4,BitBlt_destY:5,BitBlt_width:6,BitBlt_height:7,BitBlt_sourceX:8,BitBlt_sourceY:9,BitBlt_clipX:10,BitBlt_clipY:11,BitBlt_clipW:12,BitBlt_clipH:13,BitBlt_colorMap:14,BitBlt_warpBase:15,Form_bits:0,Form_width:1,Form_height:2,Form_depth:3,Form_offset:4,WeakFinalizationList_first:0,WeakFinalizerItem_list:0,WeakFinalizerItem_next:1},"events",{Mouse_Blue:1,Mouse_Yellow:2,Mouse_Red:4,Keyboard_Shift:8,Keyboard_Ctrl:16,Keyboard_Alt:32,Keyboard_Cmd:64,Mouse_All:7,Keyboard_All:120,EventTypeNone:0,EventTypeMouse:1,EventTypeKeyboard:2,EventTypeDragDropFiles:3,EventKeyChar:0,EventKeyDown:1,EventKeyUp:2,EventDragEnter:1,EventDragMove:2,EventDragLeave:3,EventDragDrop:4},"constants",{MinSmallInt:-1073741824,MaxSmallInt:1073741823,NonSmallInt:-1342177280,MillisecondClockMask:536870911},"modules",{externalModules:Squeak.externalModules||{},registerExternalModule:function(Bt,Yt){this.externalModules[Bt]=Yt}},"files",{fsck:function(Yt,Zt,te,ee){if(Zt=Zt||"",ee=ee||{dirs:0,files:0,bytes:0,deleted:0},!te){for(var ie in te={},Bt){var re=ie.match(/squeak-file(\.lz)?:(.*)$/);re&&(te[re[2]]=!0)}if("undefined"!=typeof indexedDB)return this.dbTransaction("readonly","fsck cursor",(function(Bt){var ie=Bt.openCursor();ie.onsuccess=function(Bt){var ie=Bt.target.result;ie?(te[ie.key]=!0,ie.continue()):Squeak.fsck(Yt,Zt,te,ee)},ie.onerror=function(){console.error("fsck failed")}}))}var se=Squeak.dirList(Zt);for(var ne in se){var ae=Zt+"/"+ne;if(se[ne][3])"squeak:"+ae in Bt?(Squeak.fsck(null,ae,te,ee),ee.dirs++):(console.log("Deleting stale directory "+ae),Squeak.dirDelete(ae),ee.deleted++);else te[ae]?(te[ae]=!1,ee.files++,ee.bytes+=se[ne][4]):(console.log("Deleting stale file entry "+ae),Squeak.fileDelete(ae,!0),ee.deleted++)}if(""===Zt){console.log("squeak fsck: "+ee.dirs+" directories, "+ee.files+" files, "+(ee.bytes/1e6).toFixed(1)+" MBytes");var oe=[];for(var ae in te)te[ae]&&oe.push(ae);if(oe.length>0){for(var ue=0;ue<oe.length;ue++)console.log("Deleting orphaned file "+oe[ue]),delete Bt["squeak-file:"+oe[ue]],delete Bt["squeak-file.lz:"+oe[ue]],ee.deleted++;"undefined"!=typeof indexedDB&&this.dbTransaction("readwrite","fsck delete",(function(Bt){for(var Yt=0;Yt<oe.length;Yt++)Bt.delete(oe[Yt])}))}Yt&&Yt(ee)}},dbTransaction:function(Bt,Yt,Zt,te){function i(){Zt(Squeak.dbFake()),te&&te()}function n(){var ee=SqueakDB.transaction("files",Bt),ie=ee.objectStore("files");ee.oncomplete=function(){te&&te()},ee.onerror=function(Bt){console.error(Bt.target.error.name+": "+Yt)},ee.onabort=function(Bt){console.error(Bt.target.error.name+": aborting "+Yt),Zt(Squeak.dbFake()),te&&te()},Zt(ie)}if("undefined"==typeof indexedDB)return i();if(window.SqueakDB)return n();var ee=indexedDB.open("squeak");return ee?(ee.onsuccess=function(){console.log("Opened files database."),window.SqueakDB=this.result,SqueakDB.onversionchange=function(){delete window.SqueakDB,this.close()},SqueakDB.onerror=function(Bt){console.error("Error accessing database: "+Bt.target.error.name)},n()},ee.onupgradeneeded=function(Bt){console.log("Creating files database"),Bt.target.result.createObjectStore("files")},ee.onerror=function(Bt){console.error(Bt.target.error.name+": cannot open files database"),console.warn("Falling back to local storage"),i()},void(ee.onblocked=function(){console.log("Database upgrade needed, but was blocked."),console.warn("Falling back to local storage"),i()})):i()},dbFake:function(){return"undefined"==typeof SqueakDBFake&&("undefined"==typeof indexedDB&&console.warn("IndexedDB not supported by this browser, using localStorage"),window.SqueakDBFake={bigFiles:{},bigFileThreshold:1e5,get:function(Yt){var Zt=SqueakDBFake.bigFiles[Yt];if(!Zt){var te=Bt["squeak-file:"+Yt];if(!te){var ee=Bt["squeak-file.lz:"+Yt];ee&&("object"==typeof LZString?te=LZString.decompressFromUTF16(ee):console.error("LZString not loaded: cannot decompress "+Yt))}if(te){for(var ie=new Uint8Array(te.length),re=0;re<ie.length;re++)ie[re]=255&te.charCodeAt(re);Zt=ie.buffer}}var se={result:Zt};return setTimeout((function(){se.onsuccess&&se.onsuccess({target:se})}),0),se},put:function(Yt,Zt){if(Yt.byteLength>SqueakDBFake.bigFileThreshold)SqueakDBFake.bigFiles[Zt]||console.log("File "+Zt+" ("+Yt.byteLength+" bytes) too large, storing in memory only"),SqueakDBFake.bigFiles[Zt]=Yt;else{var te=Squeak.bytesAsString(new Uint8Array(Yt));if("object"==typeof LZString){var ee=LZString.compressToUTF16(te);Bt["squeak-file.lz:"+Zt]=ee,delete Bt["squeak-file:"+Zt]}else Bt["squeak-file:"+Zt]=te}var ie={};return setTimeout((function(){ie.onsuccess&&ie.onsuccess()}),0),ie},delete:function(Yt){delete Bt["squeak-file:"+Yt],delete Bt["squeak-file.lz:"+Yt],delete SqueakDBFake.bigFiles[Yt];var Zt={};return setTimeout((function(){Zt.onsuccess&&Zt.onsuccess()}),0),Zt},openCursor:function(){var Bt={};return setTimeout((function(){Bt.onsuccess&&Bt.onsuccess({target:Bt})}),0),Bt}}),SqueakDBFake},fileGet:function(Bt,Yt,Zt){Zt||(Zt=function(Bt){console.log(Bt)});var te=this.splitFilePath(Bt);return te.basename?window.SqueakDBFake&&SqueakDBFake.bigFiles[te.fullname]?Yt(SqueakDBFake.bigFiles[te.fullname]):void this.dbTransaction("readonly","get "+Bt,(function(Bt){var ee=Bt.get(te.fullname);ee.onerror=function(Bt){Zt(Bt.target.error.name)},ee.onsuccess=function(){return void 0!==this.result?Yt(this.result):void Squeak.fetchTemplateFile(te.fullname,(function(Bt){Yt(Bt)}),(function(){if("undefined"==typeof indexedDB)return Zt("file not found: "+te.fullname);var Bt=Squeak.dbFake().get(te.fullname);Bt.onerror=function(){Zt("file not found: "+te.fullname)},Bt.onsuccess=function(){Yt(this.result)}}))}})):Zt("Invalid path: "+Bt)},filePut:function(Yt,Zt,te){var ee=this.splitFilePath(Yt);if(!ee.basename)return null;var ie=this.dirList(ee.dirname);if(!ie)return null;var re=ie[ee.basename],se=this.totalSeconds();if(re){if(re[3])return null}else re=[ee.basename,se,0,!1,0],ie[ee.basename]=re;return re[2]=se,re[4]=Zt.byteLength||Zt.length||0,Bt["squeak:"+ee.dirname]=JSON.stringify(ie),this.dbTransaction("readwrite","put "+Yt,(function(Bt){Bt.put(Zt,ee.fullname)}),(function(){te&&te()})),re},fileDelete:function(Yt,Zt){var te=this.splitFilePath(Yt);if(!te.basename)return!1;var ee=this.dirList(te.dirname);if(!ee)return!1;var ie=ee[te.basename];return!(!ie||ie[3])&&(delete ee[te.basename],Bt["squeak:"+te.dirname]=JSON.stringify(ee),Zt||this.dbTransaction("readwrite","delete "+Yt,(function(Bt){Bt.delete(te.fullname)})),!0)},fileRename:function(Yt,Zt){var te=this.splitFilePath(Yt);if(!te.basename)return!1;var ee=this.splitFilePath(Zt);if(!ee.basename)return!1;var ie=this.dirList(te.dirname);if(!ie)return!1;var re=ie[te.basename];if(!re||re[3])return!1;var se=te.dirname==ee.dirname,ne=se?ie:this.dirList(ee.dirname);return!!ne&&(!ne[ee.basename]&&(delete ie[te.basename],re[0]=ee.basename,ne[ee.basename]=re,Bt["squeak:"+ee.dirname]=JSON.stringify(ne),se||(Bt["squeak:"+te.dirname]=JSON.stringify(ie)),this.fileGet(te.fullname,function(Bt){this.dbTransaction("readwrite","rename "+te.fullname+" to "+ee.fullname,(function(Yt){Yt.delete(te.fullname),Yt.put(Bt,ee.fullname)}))}.bind(this),function(Bt){console.log("File rename failed: "+Bt)}.bind(this)),!0))},fileExists:function(Bt){var Yt=this.splitFilePath(Bt);if(!Yt.basename)return!1;var Zt=this.dirList(Yt.dirname);if(!Zt)return!1;var te=Zt[Yt.basename];return!(!te||te[3])},dirCreate:function(Yt,Zt){var te=this.splitFilePath(Yt);if(!te.basename)return!1;Zt&&!Bt["squeak:"+te.dirname]&&Squeak.dirCreate(te.dirname,!0);var ee=this.dirList(te.dirname);if(!ee)return!1;if(ee[te.basename])return!1;var ie=this.totalSeconds(),re=[te.basename,ie,ie,!0,0];return ee[te.basename]=re,Bt["squeak:"+te.fullname]=JSON.stringify({}),Bt["squeak:"+te.dirname]=JSON.stringify(ee),!0},dirDelete:function(Yt){var Zt=this.splitFilePath(Yt);if(!Zt.basename)return!1;var te=this.dirList(Zt.dirname);if(!te)return!1;if(!te[Zt.basename])return!1;var ee=this.dirList(Zt.fullname);if(!ee)return!1;for(var ie in ee)return!1;return delete te[Zt.basename],Bt["squeak:"+Zt.dirname]=JSON.stringify(te),delete Bt["squeak:"+Zt.fullname],!0},dirList:function(Yt,Zt){function n(Bt,Yt){for(var Zt in Yt)if(Yt.hasOwnProperty(Zt)){var te=Yt[Zt];Bt[te[0]]=te}}var te=this.splitFilePath(Yt),ee=Bt["squeak:"+te.fullname],ie=Zt&&Bt["squeak-template:"+te.fullname];if(ee||ie){var re={};return ie&&n(re,JSON.parse(ie).entries),ee&&n(re,JSON.parse(ee)),re}return"/"==te.fullname?{}:null},splitFilePath:function(Bt){"/"!==Bt[0]&&(Bt="/"+Bt);var Yt=(Bt=Bt.replace(/\/\//gi,"/")).match(/(.*)\/(.*)/);return{fullname:Bt,dirname:Yt[1].length?Yt[1]:"/",basename:Yt[2].length?Yt[2]:null}},flushFile:function(Bt){if(Bt.modified){var Yt=Bt.contents.buffer;Yt.byteLength!==Bt.size&&(Yt=new ArrayBuffer(Bt.size),new Uint8Array(Yt).set(Bt.contents.subarray(0,Bt.size))),Squeak.filePut(Bt.name,Yt),Bt.modified=!1}},flushAllFiles:function(){if("undefined"!=typeof SqueakFiles)for(var Bt in SqueakFiles)this.flushFile(SqueakFiles[Bt])},closeAllFiles:function(){Squeak.flushAllFiles(),delete window.SqueakFiles},fetchTemplateDir:function(Yt,Zt){function s(Yt){var Zt=Squeak.splitFilePath(Yt);if("/"!==Zt.dirname&&s(Zt.dirname),!(Yt=JSON.parse(Bt["squeak-template:"+Zt.dirname]||'{"entries": {}}')).entries[Zt.basename]){var te=Squeak.totalSeconds();Yt.entries[Zt.basename]=[Zt.basename,te,te,!0,0],Bt["squeak-template:"+Zt.dirname]=JSON.stringify(Yt)}}function n(Yt,Zt){var te=JSON.parse(Bt["squeak-template:"+Yt]);for(var ee in te.entries){var ie=te.entries[ee];ie[3]&&Squeak.fetchTemplateDir(Yt+"/"+ie[0],Zt+"/"+ie[0])}}if(Yt=Squeak.splitFilePath(Yt).fullname,Bt["squeak-template:"+Yt])n(Yt,Zt);else{var te=Zt+"/sqindex.json",ee=new XMLHttpRequest;ee.open("GET",te,!0),ee.onload=function(){if(200==ee.status){console.log("adding template "+Yt),s(Yt);var te=JSON.parse(ee.response),ie={url:Zt,entries:{}};for(var re in te){var se=te[re];ie.entries[se[0]]=se}Bt["squeak-template:"+Yt]=JSON.stringify(ie),n(Yt,Zt)}else ee.onerror(ee.statusText)},ee.onerror=function(){console.log("cannot load template index "+te)},ee.send()}},fetchTemplateFile:function(Yt,Zt,te){Yt=Squeak.splitFilePath(Yt);var ee=Bt["squeak-template:"+Yt.dirname];if(!ee)return te();var ie=JSON.parse(ee).url;if(!ie)return te();ie+="/"+Yt.basename;var re=new XMLHttpRequest;re.open("get",ie,!0),re.responseType="arraybuffer",re.timeout=3e4,re.onreadystatechange=function(){if(this.readyState==this.DONE)if(200==this.status){var Bt=this.response;console.log("Got "+Bt.byteLength+" bytes from "+ie),Squeak.dirCreate(Yt.dirname,!0),Squeak.filePut(Yt.fullname,Bt),Zt(Bt)}else alert("Download failed ("+this.status+") "+ie),te()},console.log("Fetching "+ie),re.send()}},"audio",{startAudioOut:function(){if(!this.audioOutContext){var Bt=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;this.audioOutContext=Bt&&new Bt}return this.audioOutContext},startAudioIn:function(Bt,Yt){return this.audioInContext?(this.audioInSource.disconnect(),Bt(this.audioInContext,this.audioInSource)):(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia?void navigator.getUserMedia({audio:!0,toString:function(){return"audio"}},(function(Yt){var Zt=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;this.audioInContext=Zt&&new Zt,this.audioInSource=this.audioInContext.createMediaStreamSource(Yt),Bt(this.audioInContext,this.audioInSource)}),(function(){Yt("cannot access microphone")})):Yt("test: audio input not supported"))},stopAudio:function(){this.audioInSource&&this.audioInSource.disconnect()}},"time",{Epoch:Date.UTC(1901,0,1)+6e4*(new Date).getTimezoneOffset(),EpochUTC:Date.UTC(1901,0,1),totalSeconds:function(){return Math.floor((Date.now()-Squeak.Epoch)/1e3)}},"utils",{bytesAsString:function(Bt){for(var Yt=[],Zt=0;Zt<Bt.length;Zt++)Yt.push(String.fromCharCode(Bt[Zt]));return Yt.join("")}}),Object.subclass("Squeak.Image","about",{about:function(){}},"initializing",{initialize:function(Bt){this.totalMemory=1e8,this.name=Bt,this.gcCount=0,this.gcTenured=0,this.gcMilliseconds=0,this.allocationCount=0,this.oldSpaceCount=0,this.newSpaceCount=0,this.hasNewInstances={}},readFromBuffer:function(Bt,Yt,Zt){function O(){if(we){for(var Bt=Ce+(Ve.oldSpaceCount/10|0);we&&Bt>Ce;)we.installFromImage(he,Ae,Pe,ee,ae),we=we.nextObject,Ce++;return Zt&&Zt(Ce/Ve.oldSpaceCount),!0}return Ve.specialObjectsArray=Ie,Ve.decorateKnownObjects(),Ve.fixCompiledMethods(),Ve.fixCompactOops(),!1}console.log("squeak: reading "+this.name+" ("+Bt.byteLength+" bytes)"),this.startupTime=Date.now();for(var te=new DataView(Bt),ee=!1,ie=0,e=function(){var Bt=te.getUint32(ie,ee);return ie+=4,Bt},_=function(Yt,Zt){if(5>Zt){for(var te=[];te.length<Yt;)te.push(e());return te}var ee=new Uint32Array(Bt,ie,Yt);return ie+=4*Yt,ee},re=[6501,6502,6504,6505,68e3,68002,68003],se=0,ne=0;ee=!ee,ie=ne,se=e(),!(re.indexOf(se)>=0);)if(ee||(ne+=512),ne>512)throw Error("bad image version");this.version=se;var ae=[6505,68003].indexOf(se)>=0;if(this.hasClosures=[6504,6505,68002,68003].indexOf(se)>=0,se>=68e3)throw Error("64 bit images not supported yet");var oe=e(),ue=e(),le=e(),ce=e();this.lastHash=e(),e(),e(),e(),ie+=oe-36;for(var fe,he={},pe=ne+oe;pe+ue>ie;){var de=0,me=0,ve=e();switch(ve&Squeak.HeaderTypeMask){case Squeak.HeaderTypeSizeAndClass:de=ve>>2,me=e(),ve=e();break;case Squeak.HeaderTypeClass:me=ve-Squeak.HeaderTypeClass,de=(ve=e())>>2&63;break;case Squeak.HeaderTypeShort:de=ve>>2&63,me=ve>>12&31;break;case Squeak.HeaderTypeFree:throw Error("Unexpected free block")}de--;var ke=ie-4-pe,ge=ve>>8&15,be=ve>>17&4095,ye=_(de,ge),Fe=new Squeak.Object;Fe.initFromImage(ke,me,ge,be,ye),32>me&&(Fe.hash|=268435456),fe&&(fe.nextObject=Fe),this.oldSpaceCount++,fe=Fe,he[le+ke]=Fe}this.firstOldObject=he[le+4],this.lastOldObject=Fe,this.oldSpaceBytes=ue;var Se=he[he[ce].bits[Squeak.splOb_CompactClasses]].bits,Oe=null;for(Fe=this.firstOldObject,fe=null;Fe;)fe=Oe,Oe=Fe.renameFromImage(he,Se),fe&&(fe.nextObject=Oe),he[le+Fe.oop]=Oe,Fe=Fe.nextObject;this.firstOldObject=he[le+4],this.lastOldObject=Oe;var Ie=he[ce],Ae=he[Ie.bits[Squeak.splOb_CompactClasses]].bits,Pe=he[Ie.bits[Squeak.splOb_ClassFloat]],we=this.firstOldObject,Ce=0,Ve=this;if(Zt)window.setTimeout((function w(){O()?window.setTimeout(w,0):Yt&&Yt()}),0);else{for(;O(););Yt&&Yt()}},decorateKnownObjects:function(){var Bt=this.specialObjectsArray.pointers;Bt[Squeak.splOb_NilObject].isNil=!0,Bt[Squeak.splOb_TrueObject].isTrue=!0,Bt[Squeak.splOb_FalseObject].isFalse=!0,Bt[Squeak.splOb_ClassFloat].isFloatClass=!0,this.compactClasses=this.specialObjectsArray.pointers[Squeak.splOb_CompactClasses].pointers;for(var Yt=0;Yt<this.compactClasses.length;Yt++)this.compactClasses[Yt].isNil||(this.compactClasses[Yt].isCompact=!0);Number.prototype.sqInstName||Object.defineProperty(Number.prototype,"sqInstName",{enumerable:!1,value:function(){return this.toString()}})},fixCompactOops:function(){for(var Bt=this.firstOldObject,Yt=0;Bt;){var Zt=Bt.hash>268435455;if(Zt!==!!Bt.sqClass.isCompact){var te=0===Bt.snapshotSize().header;Zt!==te&&(Yt+=te?-4:4)}Bt.hash&=268435455,Bt.oop+=Yt,Bt=Bt.nextObject}this.oldSpaceBytes+=Yt},fixCompiledMethods:function(){if(!(this.version>=6502))for(var Bt=this.firstOldObject,Yt=this.specialObjectsArray.pointers[Squeak.splOb_ClassCompiledMethod];Bt;)Bt.format>=12&&(Bt.sqClass=Yt),Bt=Bt.nextObject}},"garbage collection",{partialGC:function(){return this.totalMemory-this.oldSpaceBytes},fullGC:function(Bt){this.vm.addMessage("fullGC: "+Bt);var Yt=Date.now(),Zt=this.markReachableObjects();return this.removeUnmarkedOldObjects(),this.appendToOldObjects(Zt),this.finalizeWeakReferences(),this.allocationCount+=this.newSpaceCount,this.newSpaceCount=0,this.hasNewInstances={},this.gcCount++,this.gcMilliseconds+=Date.now()-Yt,Zt.length>0?Zt[0]:null},markReachableObjects:function(){this.vm.storeContextRegisters();for(var Bt=[this.specialObjectsArray,this.vm.activeContext],Yt=[];Bt.length>0;){var Zt=Bt.pop();if(!Zt.mark){Zt.nextObject||Zt===this.lastOldObject||Yt.push(Zt),Zt.mark=!0,Zt.sqClass.mark||Bt.push(Zt.sqClass);var te=Zt.pointers;if(te){var ee=te.length;if(this.vm.isContext(Zt))for(var ie=ee=Zt.contextSizeWithStack();ie<te.length;ie++)te[ie]=this.vm.nilObj;else Zt.sqClass.isWeak()&&(ee=Zt.sqClass.classInstSize());for(ie=0;ee>ie;ie++)"object"!=typeof te[ie]||te[ie].mark||Bt.push(te[ie])}}}return Yt.sort((function(Bt,Yt){return Yt.oop-Bt.oop}))},removeUnmarkedOldObjects:function(){var Bt=0,Yt=0,Zt=this.firstOldObject;for(Zt.mark=!1;;){var te=Zt.nextObject;if(!te)return this.lastOldObject=Zt,this.oldSpaceBytes-=Yt,void(this.oldSpaceCount-=Bt);if(te.mark)(Zt=te).mark=!1,Zt.oop-=Yt;else{var ee=te;Zt.nextObject=ee.nextObject,ee.oop=-++this.newSpaceCount,Yt+=ee.totalBytes(),Bt++}}},appendToOldObjects:function(Bt){for(var Yt=this.lastOldObject,Zt=0;Zt<Bt.length;Zt++){var te=Bt[Zt];te.mark=!1,this.oldSpaceBytes=te.setAddr(this.oldSpaceBytes),Yt.nextObject=te,Yt=te}this.lastOldObject=Yt,this.oldSpaceCount+=Bt.length,this.gcTenured+=Bt.length},finalizeWeakReferences:function(){for(var Bt=this.firstOldObject;Bt;){if(Bt.sqClass.isWeak()){for(var Yt=Bt.pointers||[],Zt=Bt.sqClass.classInstSize(),te=!1,ee=Zt;ee<Yt.length;ee++)Yt[ee].oop<0&&(Yt[ee]=this.vm.nilObj,te=!0);if(te&&(this.vm.pendingFinalizationSignals++,Zt>=2)){var ie=Bt.pointers[Squeak.WeakFinalizerItem_list];if(ie.sqClass==this.vm.specialObjects[Squeak.splOb_ClassWeakFinalizer]){var re=ie.pointers[Squeak.WeakFinalizationList_first];Bt.pointers[Squeak.WeakFinalizerItem_next]=re,ie.pointers[Squeak.WeakFinalizationList_first]=Bt}}}Bt=Bt.nextObject}this.vm.pendingFinalizationSignals>0&&this.vm.forceInterruptCheck()}},"creating",{registerObject:function(Bt){return Bt.oop=-++this.newSpaceCount,this.lastHash=13849+27181*this.lastHash&4294967295,4095&this.lastHash},instantiateClass:function(Bt,Yt,Zt){var te=new(Bt.classInstProto()),ee=this.registerObject(te);return te.initInstanceOf(Bt,Yt,ee,Zt),this.hasNewInstances[Bt.oop]=!0,te},clone:function(Bt){var Yt=new(Bt.sqClass.classInstProto()),Zt=this.registerObject(Yt);return Yt.initAsClone(Bt,Zt),this.hasNewInstances[Yt.sqClass.oop]=!0,Yt}},"operations",{bulkBecome:function(Bt,Yt,Zt,te){if(!Bt)return!Yt;var ee=Bt.length;if(ee!==Yt.length)return!1;this.newSpaceCount>0?this.fullGC("become"):this.vm.storeContextRegisters();for(var ie={},re=0;ee>re;re++){if(!(ne=Bt[re]).sqClass)return!1;if(ie[ne.oop])return!1;ie[ne.oop]=Yt[re]}if(Zt)for(re=0;ee>re;re++){if(!(ne=Yt[re]).sqClass)return!1;if(ie[ne.oop])return!1;ie[ne.oop]=Bt[re]}if(te)for(re=0;ee>re;re++){if(!Yt[re].sqClass)return!1;var se=Bt[re].hash;Bt[re].hash=Yt[re].hash,Yt[re].hash=se}for(var ne=this.firstOldObject;ne;){var ae=ie[ne.sqClass.oop];ae&&(ne.sqClass=ae);var oe=ne.pointers;if(oe)for(var ue=0;ue<oe.length;ue++)(ae=ie[oe[ue].oop])&&(oe[ue]=ae);ne=ne.nextObject}return this.vm.flushMethodCacheAfterBecome(ie),!0},objectAfter:function(Bt){return Bt.nextObject||this.newSpaceCount>0&&this.fullGC("nextObject")},someInstanceOf:function(Bt){for(var Yt=this.firstOldObject;;){if(Yt.sqClass===Bt)return Yt;if(!(Yt=Yt.nextObject||this.nextObjectWithGCFor(Bt)))return null}},nextInstanceAfter:function(Bt){for(var Yt=Bt.sqClass;;){if(!(Bt=Bt.nextObject||this.nextObjectWithGCFor(Yt)))return null;if(Bt.sqClass===Yt)return Bt}},nextObjectWithGCFor:function(Bt){return 0!==this.newSpaceCount&&this.hasNewInstances[Bt.oop]?this.fullGC("instance of "+Bt.className()):null},writeToBuffer:function(){var Bt=new DataView(new ArrayBuffer(64+this.oldSpaceBytes)),Yt=0,e=function(Zt){Bt.setUint32(Yt,Zt),Yt+=4};for(e(this.formatVersion()),e(64),e(this.oldSpaceBytes),e(this.firstOldObject.addr()),e(this.objectToOop(this.specialObjectsArray)),e(this.lastHash),e(52429400);64>Yt;)e(0);for(var Zt=this.firstOldObject,te=0;Zt;)Yt=Zt.writeTo(Bt,Yt,this),Zt=Zt.nextObject,te++;if(Yt!==Bt.byteLength)throw Error("wrong image size");if(te!==this.oldSpaceCount)throw Error("wrong object count");return Bt.buffer},objectToOop:function(Bt){if("number"==typeof Bt)return Bt<<1|1;if(Bt.oop<0)throw Error("temporary oop");return Bt.oop},bytesLeft:function(){return this.totalMemory-this.oldSpaceBytes},formatVersion:function(){return this.hasClosures?6504:6502},segmentVersion:function(){var Bt=this.specialObjectsArray.pointers[Squeak.splOb_SelectorDoesNotUnderstand],Yt=new Uint32Array(Bt.bytes.buffer,0,1);return this.formatVersion()|4278190080&Yt[0]},loadImageSegment:function(Bt,Yt){var Zt=new DataView(Bt.words.buffer),te=!1,ee=0,r=function(){var Bt=Zt.getUint32(ee,te);return ee+=4,Bt},g=function(Bt,Yt){if(5>Yt){for(var te=[];te.length<Bt;)te.push(r());return te}var ie=new Uint32Array(Zt.buffer,ee,Bt);return ee+=4*Bt,ie},ie=r();if(!0&ie&&(te=!0,ee=0,!0&(ie=r())))return console.error("image segment format not supported"),null;for(var re=[],se={};ee<Zt.byteLength;){var ne=0,ae=0,oe=r();switch(oe&Squeak.HeaderTypeMask){case Squeak.HeaderTypeSizeAndClass:ne=oe>>2,ae=r(),oe=r();break;case Squeak.HeaderTypeClass:ae=oe-Squeak.HeaderTypeClass,ne=(oe=r())>>2&63;break;case Squeak.HeaderTypeShort:ne=oe>>2&63,ae=oe>>12&31;break;case Squeak.HeaderTypeFree:throw Error("Unexpected free block")}ne--;var ue=ee,le=oe>>8&15,ce=oe>>17&4095,fe=g(ne,le),he=new Squeak.Object;he.initFromImage(ue,ae,le,ce,fe),re.push(he),se[ue]=he}for(var pe=0;pe<Yt.pointers.length;pe++)se[2147483652+4*pe]=Yt.pointers[pe];var de=this.specialObjectsArray.pointers[Squeak.splOb_CompactClasses].pointers,me=0,ve=de.map((function(Bt){return se[--me]=Bt,me})),ke=se[8]||se[12]||se[16],ge=this.specialObjectsArray.pointers[Squeak.splOb_ClassFloat];for(pe=0;pe<re.length;pe++){var be=re[pe];be.installFromImage(se,ve,ge,te,false),be.oop=-++this.newSpaceCount,this.hasNewInstances[be.sqClass.oop]=!0}return ke}}),Object.subclass("Squeak.Object","initialization",{initInstanceOf:function(Bt,Yt,Zt,te){this.sqClass=Bt,this.hash=Zt;var ee=Bt.pointers[Squeak.Class_format],ie=(ee>>1&63)+(ee>>10&192)-1;this.format=ee>>7&15,this.format<8?6!=this.format?ie+Yt>0&&(this.pointers=this.fillArray(ie+Yt,te)):Yt>0&&(Bt.isFloatClass?(this.isFloat=!0,this.float=0):this.words=new Uint32Array(Yt)):Yt>0&&(this.bytes=new Uint8Array(Yt))},initAsClone:function(Bt,Yt){this.sqClass=Bt.sqClass,this.hash=Yt,this.format=Bt.format,Bt.isFloat?(this.isFloat=Bt.isFloat,this.float=Bt.float):(Bt.pointers&&(this.pointers=Bt.pointers.slice(0)),Bt.words&&(this.words=new Uint32Array(Bt.words)),Bt.bytes&&(this.bytes=new Uint8Array(Bt.bytes)))},initFromImage:function(Bt,Yt,Zt,te,ee){this.oop=Bt,this.sqClass=Yt,this.format=Zt,this.hash=te,this.bits=ee},classNameFromImage:function(Bt){var Yt=Bt[this.bits[Squeak.Class_name]];if(Yt&&Yt.format>=8&&Yt.format<12){var Zt=Yt.decodeBytes(Yt.bits.length,Yt.bits,0,3&Yt.format);return Squeak.bytesAsString(Zt)}return"Class"},renameFromImage:function(Bt,Yt){var Zt=this.sqClass<32?Bt[Yt[this.sqClass-1]]:Bt[this.sqClass],te=Zt.instProto||Zt.classInstProto(Zt.classNameFromImage(Bt));if(!te)return this;var ee=new te;return ee.oop=this.oop,ee.sqClass=this.sqClass,ee.format=this.format,ee.hash=this.hash,ee.bits=this.bits,ee},installFromImage:function(Bt,Yt,Zt,te,ee){var ie=this.sqClass;this.sqClass=ie>0&&32>ie?Bt[Yt[ie-1]]:Bt[ie];var re=this.bits.length;if(this.format<5){if(re>0){var se=this.bits;this.pointers=this.decodePointers(re,se,Bt)}}else if(this.format>=12){var ne=this.decodeWords(1,this.bits,te)[0]>>10&255;se=this.decodeWords(ne+1,this.bits,te);this.pointers=this.decodePointers(ne+1,se,Bt),this.bytes=this.decodeBytes(re-(ne+1),this.bits,ne+1,3&this.format)}else if(this.format>=8)re>0&&(this.bytes=this.decodeBytes(re,this.bits,0,3&this.format));else if(this.sqClass==Zt){if(this.isFloat=!0,this.float=this.decodeFloat(this.bits,te,ee),1.3797216632888e-310==this.float)if(/noFloatDecodeWorkaround/.test(window.location.hash));else if(this.constructor.prototype.decodeFloat=this.decodeFloatDeoptimized,this.float=this.decodeFloat(this.bits,te,ee),1.3797216632888e-310==this.float)throw Error("Cannot deoptimize decodeFloat")}else re>0&&(this.words=this.decodeWords(re,this.bits,te));delete this.bits,this.mark=!1},decodePointers:function(Bt,Yt,Zt){for(var te=new Array(Bt),ee=0;Bt>ee;ee++){var ie=Yt[ee];te[ee]=1==(1&ie)?ie>>1:Zt[ie]||42424242}return te},decodeWords:function(Bt,Yt,Zt){for(var te=new DataView(Yt.buffer,Yt.byteOffset),ee=new Uint32Array(Bt),ie=0;Bt>ie;ie++)ee[ie]=te.getUint32(4*ie,Zt);return ee},decodeBytes:function(Bt,Yt,Zt,te){var ee=4*Bt-te,ie=new Uint8Array(Yt.buffer,Yt.byteOffset+4*Zt,ee),re=new Uint8Array(ee);return re.set(ie),re},decodeFloat:function(Bt,Yt,Zt){var te=new DataView(Bt.buffer,Bt.byteOffset);if(!Yt)return te.getFloat64(0,!1);if(Zt)return te.getFloat64(0,!0);var ee=new ArrayBuffer(8),ie=new DataView(ee);return ie.setUint32(0,te.getUint32(4)),ie.setUint32(4,te.getUint32(0)),ie.getFloat64(0,!0)},decodeFloatDeoptimized:function(Bt,Yt,Zt){var te=new DataView(Bt.buffer,Bt.byteOffset);if(!Yt)return te.getFloat64(0,!1);if(Zt)return te.getFloat64(0,!0);var ee=new ArrayBuffer(8),ie=new DataView(ee);return ie.setUint32(0,te.getUint32(4)),ie.setUint32(4,te.getUint32(0)),ie.getFloat64(0,!0)},fillArray:function(Bt,Yt){for(var Zt=[],te=0;Bt>te;te++)Zt[te]=Yt;return Zt}},"printing",{toString:function(){return this.sqInstName()},bytesAsString:function(){return this.bytes?Squeak.bytesAsString(this.bytes):""},bytesAsNumberString:function(Bt){if(!this.bytes)return"";for(var Yt="0123456789ABCDEF",Zt=[],te=0,ee=this.bytes.length-1;ee>=0;ee--)Zt.push(Yt[this.bytes[ee]>>4]),Zt.push(Yt[15&this.bytes[ee]]),te=256*te+this.bytes[ee];var ie=Bt?"-":"",re=te>=9007199254740992?"≈":"";return ie+"16r"+Zt.join("")+" ("+re+ie+te+"L)"},assnKeyAsString:function(){return this.pointers[Squeak.Assn_key].bytesAsString()},slotNameAt:function(Bt){var Yt=this.instSize();return Yt>=Bt?this.sqClass.allInstVarNames()[Bt-1]:(Bt-Yt).toString()},sqInstName:function(){if(this.isNil)return"nil";if(this.isTrue)return"true";if(this.isFalse)return"false";if(this.isFloat){var Bt=this.float.toString();return/\./.test(Bt)||(Bt+=".0"),Bt}var Yt=this.sqClass.className();if(/ /.test(Yt))return"the "+Yt;switch(Yt){case"String":case"ByteString":return"'"+this.bytesAsString()+"'";case"Symbol":case"ByteSymbol":return"#"+this.bytesAsString();case"Point":return this.pointers.join("@");case"Rectangle":return this.pointers.join(" corner: ");case"Association":case"ReadOnlyVariableBinding":return this.pointers.join("->");case"LargePositiveInteger":return this.bytesAsNumberString(!1);case"LargeNegativeInteger":return this.bytesAsNumberString(!0);case"Character":return"$"+String.fromCharCode(this.pointers[0])+" ("+this.pointers[0].toString()+")"}return/^[aeiou]/i.test(Yt)?"an "+Yt:"a "+Yt}},"accessing",{isWords:function(){return 6===this.format},isBytes:function(){var Bt=this.format;return Bt>=8&&11>=Bt},isWordsOrBytes:function(){var Bt=this.format;return 6==Bt||Bt>=8&&11>=Bt},isPointers:function(){return this.format<=4},isMethod:function(){return this.format>=12},pointersSize:function(){return this.pointers?this.pointers.length:0},bytesSize:function(){return this.bytes?this.bytes.length:0},wordsSize:function(){return this.isFloat?2:this.words?this.words.length:0},instSize:function(){return this.format>4||2==this.format?0:this.format<2?this.pointersSize():this.sqClass.classInstSize()},floatData:function(){var Bt=new ArrayBuffer(8),Yt=new DataView(Bt);return Yt.setFloat64(0,this.float,!1),Yt},wordsAsFloat32Array:function(){return this.float32Array||this.words&&(this.float32Array=new Float32Array(this.words.buffer))},wordsAsFloat64Array:function(){return this.float64Array||this.words&&(this.float64Array=new Float64Array(this.words.buffer))},wordsAsInt32Array:function(){return this.int32Array||this.words&&(this.int32Array=new Int32Array(this.words.buffer))},wordsAsInt16Array:function(){return this.int16Array||this.words&&(this.int16Array=new Int16Array(this.words.buffer))},wordsAsUint16Array:function(){return this.uint16Array||this.words&&(this.uint16Array=new Uint16Array(this.words.buffer))},wordsAsUint8Array:function(){return this.uint8Array||this.words&&(this.uint8Array=new Uint8Array(this.words.buffer))},wordsOrBytes:function(){return this.words?this.words:this.uint32Array?this.uint32Array:this.bytes?this.uint32Array=new Uint32Array(this.bytes.buffer,0,this.bytes.length>>2):null},setAddr:function(Bt){var Yt=this.snapshotSize();return this.oop=Bt+4*Yt.header,Bt+4*(Yt.header+Yt.body)},snapshotSize:function(){var Bt=this.isFloat?2:this.words?this.words.length:this.pointers?this.pointers.length:0;return this.bytes&&(Bt+=this.bytes.length+3>>2),{header:++Bt>63?2:this.sqClass.isCompact?0:1,body:Bt}},addr:function(){return this.oop-4*this.snapshotSize().header},totalBytes:function(){var Bt=this.snapshotSize();return 4*(Bt.header+Bt.body)},writeTo:function(Bt,Yt,Zt){this.bytes&&(this.format|=3&-this.bytes.length);var te=Yt,ee=this.snapshotSize(),ie=(15&this.format)<<8|(4095&this.hash)<<17;switch(ee.header){case 2:Bt.setUint32(Yt,ee.body<<2|Squeak.HeaderTypeSizeAndClass),Yt+=4,Bt.setUint32(Yt,this.sqClass.oop|Squeak.HeaderTypeSizeAndClass),Yt+=4,Bt.setUint32(Yt,ie|Squeak.HeaderTypeSizeAndClass),Yt+=4;break;case 1:Bt.setUint32(Yt,this.sqClass.oop|Squeak.HeaderTypeClass),Yt+=4,Bt.setUint32(Yt,ie|ee.body<<2|Squeak.HeaderTypeClass),Yt+=4;break;case 0:var re=Zt.compactClasses.indexOf(this.sqClass)+1;Bt.setUint32(Yt,ie|re<<12|ee.body<<2|Squeak.HeaderTypeShort),Yt+=4}if(this.isFloat)Bt.setFloat64(Yt,this.float),Yt+=8;else if(this.words)for(var se=0;se<this.words.length;se++)Bt.setUint32(Yt,this.words[se]),Yt+=4;else if(this.pointers)for(se=0;se<this.pointers.length;se++)Bt.setUint32(Yt,Zt.objectToOop(this.pointers[se])),Yt+=4;if(this.bytes){for(se=0;se<this.bytes.length;se++)Bt.setUint8(Yt++,this.bytes[se]);Yt+=3&-this.bytes.length}if(Yt!==te+this.totalBytes())throw Error("written size does not match");return Yt}},"as class",{classInstSize:function(){var Bt=this.pointers[Squeak.Class_format];return(Bt>>10&192)+(Bt>>1&63)-1},isWeak:function(){return 4==(this.pointers[Squeak.Class_format]>>7&15)},instVarNames:function(){var Bt=this.pointers.length>12?4:this.pointers.length>9?3:4;return(this.pointers[Bt].pointers||[]).map((function(Bt){return Bt.bytesAsString()}))},allInstVarNames:function(){var Bt=this.superclass();return Bt.isNil?this.instVarNames():Bt.allInstVarNames().concat(this.instVarNames())},superclass:function(){return this.pointers[0]},className:function(){if(!this.pointers)return"_NOTACLASS_";var Bt=this.pointers[Squeak.Class_name];if(Bt&&Bt.bytes)return Bt.bytesAsString();for(var Yt=5;6>=Yt;Yt++){var Zt=this.pointers[Yt];if(Zt&&Zt.pointers&&((Bt=Zt.pointers[Squeak.Class_name])&&Bt.bytes))return Bt.bytesAsString()+" class"}return"_SOMECLASS_"},classInstProto:function(Bt){if(this.instProto)return this.instProto;var Yt=Squeak.Object;try{Bt||(Bt=this.className());var Zt=Bt.replace(/[^A-Za-z0-9]/g,"_");Zt="UndefinedObject"===Zt?"nil":"True"===Zt?"true_":"False"===Zt?"false_":(/^[AEIOU]/.test(Zt)?"an":"a")+Zt,(Yt=new Function("return function "+Zt+"() {};")()).prototype=Squeak.Object.prototype}catch(Bt){}return Object.defineProperty(this,"instProto",{value:Yt}),Yt}},"as method",{methodHeader:function(){return this.pointers[0]},methodNumLits:function(){return this.pointers.length-1},methodNumArgs:function(){return this.methodHeader()>>24&15},methodPrimitiveIndex:function(){var Bt=805306879&this.methodHeader();return Bt>511?(511&Bt)+(Bt>>19):Bt},methodClassForSuper:function(){return this.pointers[this.methodNumLits()].pointers[Squeak.Assn_value]},methodNeedsLargeFrame:function(){return(131072&this.methodHeader())>0},methodAddPointers:function(Bt){this.pointers=Bt},methodTempCount:function(){return this.methodHeader()>>18&63},methodGetLiteral:function(Bt){return this.pointers[1+Bt]},methodGetSelector:function(Bt){return this.pointers[1+Bt]},methodSetLiteral:function(Bt,Yt){this.pointers[1+Bt]=Yt}},"as context",{contextHome:function(){return this.contextIsBlock()?this.pointers[Squeak.BlockContext_home]:this},contextIsBlock:function(){return"number"==typeof this.pointers[Squeak.BlockContext_argumentCount]},contextMethod:function(){return this.contextHome().pointers[Squeak.Context_method]},contextSender:function(){return this.pointers[Squeak.Context_sender]},contextSizeWithStack:function(Bt){if(Bt&&Bt.activeContext===this)return Bt.sp+1;var Yt=this.pointers[Squeak.Context_stackPointer];return Squeak.Context_tempFrameStart+("number"==typeof Yt?Yt:0)}}),Object.subclass("Squeak.Interpreter","initialization",{initialize:function(Bt,Yt){console.log("squeak: initializing interpreter "+Squeak.vmVersion),this.Squeak=Squeak,this.image=Bt,this.image.vm=this,this.primHandler=new Squeak.Primitives(this,Yt),this.loadImageState(),this.hackImage(),this.initVMState(),this.loadInitialContext(),this.initCompiler(),console.log("squeak: ready")},loadImageState:function(){this.specialObjects=this.image.specialObjectsArray.pointers,this.specialSelectors=this.specialObjects[Squeak.splOb_SpecialSelectors].pointers,this.nilObj=this.specialObjects[Squeak.splOb_NilObject],this.falseObj=this.specialObjects[Squeak.splOb_FalseObject],this.trueObj=this.specialObjects[Squeak.splOb_TrueObject],this.hasClosures=this.image.hasClosures,this.globals=this.findGlobals(),this.hasClosures||this.findMethod("UnixFileDirectory class>>pathNameDelimiter")||(this.primHandler.emulateMac=!0),6501==this.image.version&&(this.primHandler.reverseDisplay=!0)},initVMState:function(){this.byteCodeCount=0,this.sendCount=0,this.interruptCheckCounter=0,this.interruptCheckCounterFeedBackReset=1e3,this.interruptChecksEveryNms=3,this.nextPollTick=0,this.nextWakeupTick=0,this.lastTick=0,this.interruptKeycode=2094,this.interruptPending=!1,this.pendingFinalizationSignals=0,this.freeContexts=this.nilObj,this.freeLargeContexts=this.nilObj,this.reclaimableContextCount=0,this.nRecycledContexts=0,this.nAllocatedContexts=0,this.methodCacheSize=1024,this.methodCacheMask=this.methodCacheSize-1,this.methodCacheRandomish=0,this.methodCache=[];for(var Bt=0;Bt<this.methodCacheSize;Bt++)this.methodCache[Bt]={lkupClass:null,selector:null,method:null,primIndex:0,argCount:0,mClass:null};this.breakOutOfInterpreter=!1,this.breakOutTick=0,this.breakOnMethod=null,this.breakOnNewMethod=!1,this.breakOnContextChanged=!1,this.breakOnContextReturned=null,this.messages={},this.startupTime=Date.now()},loadInitialContext:function(){var Bt=this.specialObjects[Squeak.splOb_SchedulerAssociation].pointers[Squeak.Assn_value].pointers[Squeak.ProcSched_activeProcess];this.activeContext=Bt.pointers[Squeak.Proc_suspendedContext],this.fetchContextRegisters(this.activeContext),this.reclaimableContextCount=0},findGlobals:function(){var Bt=this.specialObjects[Squeak.splOb_SmalltalkDictionary],Yt=Bt.sqClass.className();if("Association"===Yt&&(Yt=(Bt=Bt.pointers[1]).sqClass.className()),"SystemDictionary"===Yt)return Bt.pointers[1].pointers;if("SmalltalkImage"===Yt){var Zt=Bt.pointers[0],te=Zt.sqClass.className();if("SystemDictionary"===te)return Zt.pointers[1].pointers;if("Environment"===te)return Zt.pointers[2].pointers[1].pointers}throw Error("cannot find global dict")},initCompiler:function(){if(!Squeak.Compiler)return console.warn("Squeak.Compiler not loaded, using interpreter only");try{if(42!==new Function("return 42")())return console.warn("function constructor not working, disabling JIT")}catch(Bt){return console.warn("disabling JIT: "+Bt)}var Bt=this.image.oldSpaceCount/(this.startupTime-this.image.startupTime);if(10>Bt)return console.warn("Slow machine detected (loaded "+(1e3*Bt|0)+" objects/sec), using interpreter only");try{console.log("squeak: initializing JIT compiler"),this.compiler=new Squeak.Compiler(this)}catch(Bt){console.warn("Compiler "+Bt)}},hackImage:function(){[].forEach((function(Bt){var Yt=this.findMethod(Bt.method);Yt&&(Yt.pointers[0]|=Bt.primitive,console.warn("Hacking "+Bt.method))}),this)}},"interpreting",{interpretOne:function(Bt){if(!this.method.compiled){var Yt,Zt,te=this.Squeak;if(this.byteCodeCount++,128>(Yt=this.nextByte()))switch(Yt){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return void this.push(this.receiver.pointers[15&Yt]);case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:return void this.push(this.homeContext.pointers[te.Context_tempFrameStart+(15&Yt)]);case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:return void this.push(this.method.methodGetLiteral(31&Yt));case 64:case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 91:case 92:case 93:case 94:case 95:return void this.push(this.method.methodGetLiteral(31&Yt).pointers[te.Assn_value]);case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:return void(this.receiver.pointers[7&Yt]=this.pop());case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:return void(this.homeContext.pointers[te.Context_tempFrameStart+(7&Yt)]=this.pop());case 112:return void this.push(this.receiver);case 113:return void this.push(this.trueObj);case 114:return void this.push(this.falseObj);case 115:return void this.push(this.nilObj);case 116:return void this.push(-1);case 117:return void this.push(0);case 118:return void this.push(1);case 119:return void this.push(2);case 120:return void this.doReturn(this.receiver);case 121:return void this.doReturn(this.trueObj);case 122:return void this.doReturn(this.falseObj);case 123:return void this.doReturn(this.nilObj);case 124:return void this.doReturn(this.pop());case 125:return void this.doReturn(this.pop(),this.activeContext.pointers[te.BlockContext_caller]);case 126:case 127:return void this.nono()}else switch(Yt){case 128:return void this.extendedPush(this.nextByte());case 129:return void this.extendedStore(this.nextByte());case 130:return void this.extendedStorePop(this.nextByte());case 131:return Zt=this.nextByte(),void this.send(this.method.methodGetSelector(31&Zt),Zt>>5,!1);case 132:return void this.doubleExtendedDoAnything(this.nextByte());case 133:return Zt=this.nextByte(),void this.send(this.method.methodGetSelector(31&Zt),Zt>>5,!0);case 134:return Zt=this.nextByte(),void this.send(this.method.methodGetSelector(63&Zt),Zt>>6,!1);case 135:return void this.pop();case 136:return void this.push(this.top());case 137:return void this.push(this.exportThisContext());case 138:return void this.pushNewArray(this.nextByte());case 139:return void this.nono();case 140:return Zt=this.nextByte(),void this.push(this.homeContext.pointers[te.Context_tempFrameStart+this.nextByte()].pointers[Zt]);case 141:return Zt=this.nextByte(),void(this.homeContext.pointers[te.Context_tempFrameStart+this.nextByte()].pointers[Zt]=this.top());case 142:return Zt=this.nextByte(),void(this.homeContext.pointers[te.Context_tempFrameStart+this.nextByte()].pointers[Zt]=this.pop());case 143:return void this.pushClosureCopy();case 144:case 145:case 146:case 147:case 148:case 149:case 150:case 151:return void(this.pc+=1+(7&Yt));case 152:case 153:case 154:case 155:case 156:case 157:case 158:case 159:return void this.jumpIfFalse(1+(7&Yt));case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:return Zt=this.nextByte(),this.pc+=256*((7&Yt)-4)+Zt,void(4>(7&Yt)&&this.interruptCheckCounter--<=0&&this.checkForInterrupts());case 168:case 169:case 170:case 171:return void this.jumpIfTrue(256*(3&Yt)+this.nextByte());case 172:case 173:case 174:case 175:return void this.jumpIfFalse(256*(3&Yt)+this.nextByte());case 176:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)+this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 177:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)-this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 178:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)<this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 179:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)>this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 180:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)<=this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 181:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)>=this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 182:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)===this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 183:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)!==this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 184:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)*this.stackIntOrFloat(0))||this.sendSpecial(15&Yt));case 185:return this.success=!0,void(this.pop2AndPushIntResult(this.quickDivide(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&Yt));case 186:return this.success=!0,void(this.pop2AndPushIntResult(this.mod(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&Yt));case 187:return this.success=!0,void(this.primHandler.primitiveMakePoint(1,!0)||this.sendSpecial(15&Yt));case 188:return this.success=!0,void(this.pop2AndPushIntResult(this.safeShift(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&Yt));case 189:return this.success=!0,void(this.pop2AndPushIntResult(this.div(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&Yt));case 190:return this.success=!0,void(this.pop2AndPushIntResult(this.stackInteger(1)&this.stackInteger(0))||this.sendSpecial(15&Yt));case 191:return this.success=!0,void(this.pop2AndPushIntResult(this.stackInteger(1)|this.stackInteger(0))||this.sendSpecial(15&Yt));case 192:case 193:case 194:case 195:case 196:case 197:case 198:case 199:case 200:case 201:case 202:case 203:case 204:case 205:case 206:case 207:return void(this.primHandler.quickSendOther(this.receiver,15&Yt)||this.sendSpecial(16+(15&Yt)));case 208:case 209:case 210:case 211:case 212:case 213:case 214:case 215:case 216:case 217:case 218:case 219:case 220:case 221:case 222:case 223:return void this.send(this.method.methodGetSelector(15&Yt),0,!1);case 224:case 225:case 226:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 238:case 239:return void this.send(this.method.methodGetSelector(15&Yt),1,!1);case 240:case 241:case 242:case 243:case 244:case 245:case 246:case 247:case 248:case 249:case 250:case 251:case 252:case 253:case 254:case 255:return void this.send(this.method.methodGetSelector(15&Yt),2,!1)}throw Error("not a bytecode: "+Yt)}if(Bt){if(!this.compiler.enableSingleStepping(this.method))return this.method.compiled=null,this.interpretOne(Bt);this.breakNow()}this.byteCodeCount+=this.method.compiled(this)},interpret:function(Bt,Yt){if(this.frozen)return"frozen";for(this.isIdle=!1,this.breakOutOfInterpreter=!1,this.breakOutTick=this.primHandler.millisecondClockValue()+(Bt||500);!1===this.breakOutOfInterpreter;)this.method.compiled?this.byteCodeCount+=this.method.compiled(this):this.interpretOne();if("function"==typeof this.breakOutOfInterpreter)return this.breakOutOfInterpreter(Yt);var Zt="break"==this.breakOutOfInterpreter?"break":this.isIdle?this.nextWakeupTick?Math.max(1,this.nextWakeupTick-this.primHandler.millisecondClockValue()):"sleep":0;return Yt&&Yt(Zt),Zt},goIdle:function(){var Bt=0!==this.nextWakeupTick;this.forceInterruptCheck(),this.checkForInterrupts();var Yt=0!==this.nextWakeupTick;this.isIdle=Yt||!Bt,this.breakOut()},freeze:function(Bt){var Yt;this.frozen=!0,this.breakOutOfInterpreter=function(Bt){if(!Bt)throw Error("need function to restart interpreter");return Yt=Bt,"frozen"}.bind(this);var Zt=function(){if(this.frozen=!1,!Yt)throw Error("no continue function");Yt(0)}.bind(this);return Bt&&window.setTimeout((function(){Bt(Zt)}),0),Zt},breakOut:function(){this.breakOutOfInterpreter=this.breakOutOfInterpreter||!0},nextByte:function(){return this.methodBytes[this.pc++]},nono:function(){throw Error("Oh No!")},forceInterruptCheck:function(){this.interruptCheckCounter=-1e3},checkForInterrupts:function(){var Bt=this.primHandler.millisecondClockValue();(Bt<this.lastTick&&(this.nextPollTick=Bt+(this.nextPollTick-this.lastTick),this.breakOutTick=Bt+(this.breakOutTick-this.lastTick),0!==this.nextWakeupTick&&(this.nextWakeupTick=Bt+(this.nextWakeupTick-this.lastTick))),this.interruptCheckCounter>-100&&(Bt-this.lastTick<this.interruptChecksEveryNms?this.interruptCheckCounterFeedBackReset+=10:this.interruptCheckCounterFeedBackReset<=1e3?this.interruptCheckCounterFeedBackReset=1e3:this.interruptCheckCounterFeedBackReset-=12),this.interruptCheckCounter=this.interruptCheckCounterFeedBackReset,this.lastTick=Bt,this.interruptPending)&&(this.interruptPending=!1,(Yt=this.specialObjects[Squeak.splOb_TheInterruptSemaphore]).isNil||this.primHandler.synchronousSignal(Yt));0!==this.nextWakeupTick&&Bt>=this.nextWakeupTick&&(this.nextWakeupTick=0,(Yt=this.specialObjects[Squeak.splOb_TheTimerSemaphore]).isNil||this.primHandler.synchronousSignal(Yt));if(this.pendingFinalizationSignals>0){var Yt=this.specialObjects[Squeak.splOb_TheFinalizationSemaphore];this.pendingFinalizationSignals=0,Yt.isNil||this.primHandler.synchronousSignal(Yt)}this.primHandler.semaphoresToSignal.length>0&&this.primHandler.signalExternalSemaphores(),!this.method.compiled&&this.compiler&&this.compiler.compile(this.method),Bt>=this.breakOutTick&&this.breakOut()},extendedPush:function(Bt){var Yt=63&Bt;switch(Bt>>6){case 0:this.push(this.receiver.pointers[Yt]);break;case 1:this.push(this.homeContext.pointers[Squeak.Context_tempFrameStart+Yt]);break;case 2:this.push(this.method.methodGetLiteral(Yt));break;case 3:this.push(this.method.methodGetLiteral(Yt).pointers[Squeak.Assn_value])}},extendedStore:function(Bt){var Yt=63&Bt;switch(Bt>>6){case 0:this.receiver.pointers[Yt]=this.top();break;case 1:this.homeContext.pointers[Squeak.Context_tempFrameStart+Yt]=this.top();break;case 2:this.nono();break;case 3:this.method.methodGetLiteral(Yt).pointers[Squeak.Assn_value]=this.top()}},extendedStorePop:function(Bt){var Yt=63&Bt;switch(Bt>>6){case 0:this.receiver.pointers[Yt]=this.pop();break;case 1:this.homeContext.pointers[Squeak.Context_tempFrameStart+Yt]=this.pop();break;case 2:this.nono();break;case 3:this.method.methodGetLiteral(Yt).pointers[Squeak.Assn_value]=this.pop()}},doubleExtendedDoAnything:function(Bt){var Yt=this.nextByte();switch(Bt>>5){case 0:this.send(this.method.methodGetSelector(Yt),31&Bt,!1);break;case 1:this.send(this.method.methodGetSelector(Yt),31&Bt,!0);break;case 2:this.push(this.receiver.pointers[Yt]);break;case 3:this.push(this.method.methodGetLiteral(Yt));break;case 4:this.push(this.method.methodGetLiteral(Yt).pointers[Squeak.Assn_value]);break;case 5:this.receiver.pointers[Yt]=this.top();break;case 6:this.receiver.pointers[Yt]=this.pop();break;case 7:this.method.methodGetLiteral(Yt).pointers[Squeak.Assn_value]=this.top()}},jumpIfTrue:function(Bt){var Yt=this.pop();return Yt.isTrue?void(this.pc+=Bt):void(Yt.isFalse||(this.push(Yt),this.send(this.specialObjects[Squeak.splOb_SelectorMustBeBoolean],0,!1)))},jumpIfFalse:function(Bt){var Yt=this.pop();return Yt.isFalse?void(this.pc+=Bt):void(Yt.isTrue||(this.push(Yt),this.send(this.specialObjects[Squeak.splOb_SelectorMustBeBoolean],0,!1)))},sendSpecial:function(Bt){this.send(this.specialSelectors[2*Bt],this.specialSelectors[2*Bt+1],!1)}},"closures",{pushNewArray:function(Bt){var Yt=Bt>127,Zt=127&Bt,te=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],Zt);if(Yt){for(var ee=0;Zt>ee;ee++)te.pointers[ee]=this.stackValue(Zt-ee-1);this.popN(Zt)}this.push(te)},pushClosureCopy:function(){var Bt=this.nextByte(),Yt=15&Bt,Zt=Bt>>4,te=256*this.nextByte()+this.nextByte(),ee=this.encodeSqueakPC(this.pc,this.method),ie=this.newClosure(Yt,ee,Zt);if(ie.pointers[Squeak.Closure_outerContext]=this.activeContext,this.reclaimableContextCount=0,Zt>0){for(var re=0;Zt>re;re++)ie.pointers[Squeak.Closure_firstCopiedValue+re]=this.stackValue(Zt-re-1);this.popN(Zt)}this.pc+=te,this.push(ie)},newClosure:function(Bt,Yt,Zt){var te=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassBlockClosure],Zt);return te.pointers[Squeak.Closure_startpc]=Yt,te.pointers[Squeak.Closure_numArgs]=Bt,te}},"sending",{send:function(Bt,Yt,Zt){var te=this.stackValue(Yt),ee=this.getClass(te);Zt&&(ee=(ee=this.method.methodClassForSuper()).pointers[Squeak.Class_superclass]);var ie=this.findSelectorInClass(Bt,Yt,ee);ie.primIndex&&(this.verifyAtSelector=Bt,this.verifyAtClass=ee),this.executeNewMethod(te,ie.method,ie.argCount,ie.primIndex,ie.mClass,Bt)},sendAsPrimitiveFailure:function(Bt,Yt,Zt){this.executeNewMethod(Bt,Yt,Zt,0)},findSelectorInClass:function(Bt,Yt,Zt){var te=this.findMethodCacheEntry(Bt,Zt);if(te.method)return te;for(var ee,ie=Zt;!ie.isNil;){if((ee=ie.pointers[Squeak.Class_mdict]).isNil){var re=this.specialObjects[Squeak.splOb_SelectorCannotInterpret],se=this.createActualMessage(Bt,Yt,Zt);return this.popNandPush(Yt,se),this.findSelectorInClass(re,1,ie.superclass())}var ne=this.lookupSelectorInDict(ee,Bt);if(!ne.isNil)return this.currentSelector=Bt,this.currentLookupClass=Zt,te.method=ne,te.primIndex=ne.isMethod()?ne.methodPrimitiveIndex():248,te.argCount=Yt,te.mClass=ie,te;ie=ie.superclass()}var ae=this.specialObjects[Squeak.splOb_SelectorDoesNotUnderstand];if(Bt===ae)throw Error("Recursive not understood error encountered");var oe=this.createActualMessage(Bt,Yt,Zt);return this.popNandPush(Yt,oe),this.findSelectorInClass(ae,1,Zt)},lookupSelectorInDict:function(Bt,Yt){for(var Zt=Bt.pointersSize(),te=(Zt-Squeak.MethodDict_selectorStart-1&Yt.hash)+Squeak.MethodDict_selectorStart,ee=!1;;){var ie=Bt.pointers[te];if(ie===Yt)return Bt.pointers[Squeak.MethodDict_array].pointers[te-Squeak.MethodDict_selectorStart];if(ie.isNil)return this.nilObj;if(++te===Zt){if(ee)return this.nilObj;te=Squeak.MethodDict_selectorStart,ee=!0}}},executeNewMethod:function(Bt,Yt,Zt,te,ee,ie){if(this.sendCount++,Yt===this.breakOnMethod&&this.breakNow("executing method "+this.printMethod(Yt,ee,ie)),this.logSends&&console.log(this.sendCount+" "+this.printMethod(Yt,ee,ie)),this.breakOnContextChanged&&(this.breakOnContextChanged=!1,this.breakNow()),!(te>0&&this.tryPrimitive(te,Zt,Yt))){var re=this.allocateOrRecycleContext(Yt.methodNeedsLargeFrame()),se=Yt.methodTempCount(),ne=Squeak.Context_tempFrameStart+se-1;if(re.pointers[Squeak.Context_method]=Yt,re.pointers[Squeak.BlockContext_initialIP]=this.nilObj,re.pointers[Squeak.Context_sender]=this.activeContext,this.arrayCopy(this.activeContext.pointers,this.sp-Zt,re.pointers,Squeak.Context_tempFrameStart-1,Zt+1),this.arrayFill(re.pointers,Squeak.Context_tempFrameStart+Zt,Squeak.Context_tempFrameStart+se,this.nilObj),this.popN(Zt+1),this.reclaimableContextCount++,this.storeContextRegisters(),this.activeContext=re,this.homeContext=re,this.method=Yt,this.methodBytes=Yt.bytes,this.pc=0,this.sp=ne,this.storeContextRegisters(),this.receiver=re.pointers[Squeak.Context_receiver],this.receiver!==Bt)throw Error("receivers don't match");!Yt.compiled&&this.compiler&&this.compiler.compile(Yt,ee,ie),this.interruptCheckCounter--<=0&&this.checkForInterrupts()}},doReturn:function(Bt,Yt){if(!Yt){var Zt=this.homeContext;if(this.hasClosures)for(var te;!(te=Zt.pointers[Squeak.Context_closure]).isNil;)Zt=te.pointers[Squeak.Closure_outerContext];Yt=Zt.pointers[Squeak.Context_sender]}if(Yt.isNil||Yt.pointers[Squeak.Context_instructionPointer].isNil)return this.cannotReturn(Bt);for(var ee=this.activeContext.pointers[Squeak.Context_sender];ee!==Yt;){if(ee.isNil)return this.cannotReturn(Bt);if(this.isUnwindMarked(ee))return this.aboutToReturnThrough(Bt,ee);ee=ee.pointers[Squeak.Context_sender]}var ie;for(ee=this.activeContext;ee!==Yt;)this.breakOnContextReturned===ee&&(this.breakOnContextReturned=null,this.breakNow()),ie=ee.pointers[Squeak.Context_sender],ee.pointers[Squeak.Context_sender]=this.nilObj,ee.pointers[Squeak.Context_instructionPointer]=this.nilObj,this.reclaimableContextCount>0&&(this.reclaimableContextCount--,this.recycleIfPossible(ee)),ee=ie;this.activeContext=ee,this.fetchContextRegisters(this.activeContext),this.push(Bt),this.breakOnContextChanged&&(this.breakOnContextChanged=!1,this.breakNow())},aboutToReturnThrough:function(Bt,Yt){this.push(this.exportThisContext()),this.push(Bt),this.push(Yt);var Zt=this.specialObjects[Squeak.splOb_SelectorAboutToReturn];this.send(Zt,2)},cannotReturn:function(Bt){this.push(this.exportThisContext()),this.push(Bt);var Yt=this.specialObjects[Squeak.splOb_SelectorCannotReturn];this.send(Yt,1)},tryPrimitive:function(Bt,Yt,Zt){if(Bt>255&&520>Bt){if(Bt>=264)return this.popNandPush(1,this.top().pointers[Bt-264]),!0;switch(Bt){case 256:return!0;case 257:return this.popNandPush(1,this.trueObj),!0;case 258:return this.popNandPush(1,this.falseObj),!0;case 259:return this.popNandPush(1,this.nilObj),!0}return this.popNandPush(1,Bt-261),!0}return this.primHandler.doPrimitive(Bt,Yt,Zt)},createActualMessage:function(Bt,Yt,Zt){var te=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMessage],0),ee=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],Yt);return this.arrayCopy(this.activeContext.pointers,this.sp-Yt+1,ee.pointers,0,Yt),te.pointers[Squeak.Message_selector]=Bt,te.pointers[Squeak.Message_arguments]=ee,te.pointers.length>Squeak.Message_lookupClass&&(te.pointers[Squeak.Message_lookupClass]=Zt),te},primitivePerform:function(Bt){var Yt=this.stackValue(Bt-1),Zt=this.stackValue(Bt),te=Bt-1,ee=this.sp-te,ie=this.activeContext.pointers;this.arrayCopy(ie,ee+1,ie,ee,te),this.sp--;var re=this.findSelectorInClass(Yt,te,this.getClass(Zt));return this.executeNewMethod(Zt,re.method,re.argCount,re.primIndex,re.mClass,Yt),!0},primitivePerformWithArgs:function(Bt,Yt){var Zt=this.stackValue(Bt),te=this.stackValue(Bt-1),ee=this.stackValue(Bt-2);if(ee.sqClass!==this.specialObjects[Squeak.splOb_ClassArray])return!1;var ie=Yt?this.stackValue(Bt-3):this.getClass(Zt);if(Yt)for(var re=this.getClass(Zt);re!==ie;)if((re=re.pointers[Squeak.Class_superclass]).isNil)return!1;var se=ee.pointersSize(),ne=this.activeContext.pointers;this.arrayCopy(ee.pointers,0,ne,this.sp-1,se),this.sp+=se-Bt;var ae=this.findSelectorInClass(te,se,ie);return this.executeNewMethod(Zt,ae.method,ae.argCount,ae.primIndex,ae.mClass,te),!0},primitiveInvokeObjectAsMethod:function(Bt,Yt){for(var Zt=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],Bt),te=0;Bt>te;te++)Zt.pointers[Bt-te-1]=this.pop();var ee=this.pop(),ie=this.currentSelector,re=this.specialObjects[Squeak.splOb_SelectorRunWithIn];return this.push(Yt),this.push(ie),this.push(Zt),this.push(ee),this.send(re,3,!1),!0},findMethodCacheEntry:function(Bt,Yt){var Zt;this.methodCacheRandomish=this.methodCacheRandomish+1&3;for(var te=(Bt.hash^Yt.hash)&this.methodCacheMask,ee=te,ie=0;4>ie;ie++){if((Zt=this.methodCache[ee]).selector===Bt&&Zt.lkupClass===Yt)return Zt;ie===this.methodCacheRandomish&&(te=ee),ee=ee+Bt.hash&this.methodCacheMask}return(Zt=this.methodCache[te]).lkupClass=Yt,Zt.selector=Bt,Zt.method=null,Zt},flushMethodCache:function(){for(var Bt=0;Bt<this.methodCacheSize;Bt++)this.methodCache[Bt].selector=null,this.methodCache[Bt].method=null;return!0},flushMethodCacheForSelector:function(Bt){for(var Yt=0;Yt<this.methodCacheSize;Yt++)this.methodCache[Yt].selector===Bt&&(this.methodCache[Yt].selector=null,this.methodCache[Yt].method=null);return!0},flushMethodCacheForMethod:function(Bt){for(var Yt=0;Yt<this.methodCacheSize;Yt++)this.methodCache[Yt].method===Bt&&(this.methodCache[Yt].selector=null,this.methodCache[Yt].method=null);return!0},flushMethodCacheAfterBecome:function(){this.flushMethodCache()}},"contexts",{isUnwindMarked:function(Bt){return!!this.isMethodContext(Bt)&&198==Bt.pointers[Squeak.Context_method].methodPrimitiveIndex()},newActiveContext:function(Bt){this.storeContextRegisters(),this.activeContext=Bt,this.fetchContextRegisters(Bt)},exportThisContext:function(){return this.storeContextRegisters(),this.reclaimableContextCount=0,this.activeContext},fetchContextRegisters:function(Bt){var Yt=Bt.pointers[Squeak.Context_method];this.isSmallInt(Yt)?(this.homeContext=Bt.pointers[Squeak.BlockContext_home],Yt=this.homeContext.pointers[Squeak.Context_method]):this.homeContext=Bt,this.receiver=this.homeContext.pointers[Squeak.Context_receiver],this.method=Yt,this.methodBytes=Yt.bytes,this.pc=this.decodeSqueakPC(Bt.pointers[Squeak.Context_instructionPointer],Yt),this.sp=this.decodeSqueakSP(Bt.pointers[Squeak.Context_stackPointer])},storeContextRegisters:function(){this.activeContext.pointers[Squeak.Context_instructionPointer]=this.encodeSqueakPC(this.pc,this.method),this.activeContext.pointers[Squeak.Context_stackPointer]=this.encodeSqueakSP(this.sp)},encodeSqueakPC:function(Bt,Yt){return Bt+4*Yt.pointers.length+1},decodeSqueakPC:function(Bt,Yt){return Bt-4*Yt.pointers.length-1},encodeSqueakSP:function(Bt){return Bt-(Squeak.Context_tempFrameStart-1)},decodeSqueakSP:function(Bt){return Bt+(Squeak.Context_tempFrameStart-1)},recycleIfPossible:function(Bt){if(this.isMethodContext(Bt))if(Bt.pointersSize()===Squeak.Context_tempFrameStart+Squeak.Context_smallFrameSize)Bt.pointers[0]=this.freeContexts,this.freeContexts=Bt;else{if(Bt.pointersSize()!==Squeak.Context_tempFrameStart+Squeak.Context_largeFrameSize)return;Bt.pointers[0]=this.freeLargeContexts,this.freeLargeContexts=Bt}},allocateOrRecycleContext:function(Bt){var Yt;return Bt?this.freeLargeContexts.isNil?(this.nAllocatedContexts++,this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMethodContext],Squeak.Context_largeFrameSize)):(Yt=this.freeLargeContexts,this.freeLargeContexts=Yt.pointers[0],this.nRecycledContexts++,Yt):this.freeContexts.isNil?(this.nAllocatedContexts++,this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMethodContext],Squeak.Context_smallFrameSize)):(Yt=this.freeContexts,this.freeContexts=Yt.pointers[0],this.nRecycledContexts++,Yt)}},"stack access",{pop:function(){return this.activeContext.pointers[this.sp--]},popN:function(Bt){this.sp-=Bt},push:function(Bt){this.activeContext.pointers[++this.sp]=Bt},popNandPush:function(Bt,Yt){this.activeContext.pointers[this.sp-=Bt-1]=Yt},top:function(){return this.activeContext.pointers[this.sp]},stackValue:function(Bt){return this.activeContext.pointers[this.sp-Bt]},stackInteger:function(Bt){return this.checkSmallInt(this.stackValue(Bt))},stackIntOrFloat:function(Bt){var Yt=this.stackValue(Bt);if("number"==typeof Yt)return Yt;if(Yt.isFloat)return this.resultIsFloat=!0,Yt.float;var Zt=Yt.bytes;if(Zt&&4==Zt.length){for(var te=0,ee=3;ee>=0;ee--)te=256*te+Zt[ee];if(Yt.sqClass===this.specialObjects[Squeak.splOb_ClassLargePositiveInteger])return te;if(Yt.sqClass===this.specialObjects[Squeak.splOb_ClassLargeNegativeInteger])return-te}return this.success=!1,0},pop2AndPushIntResult:function(Bt){return!(!this.success||!this.canBeSmallInt(Bt))&&(this.popNandPush(2,Bt),!0)},pop2AndPushNumResult:function(Bt){if(this.success){if(this.resultIsFloat)return this.popNandPush(2,this.primHandler.makeFloat(Bt)),!0;if(Bt>=Squeak.MinSmallInt&&Bt<=Squeak.MaxSmallInt)return this.popNandPush(2,Bt),!0;if(Bt>=-4294967295&&4294967295>=Bt){var Yt=0>Bt,Zt=Yt?-Bt:Bt,te=Yt?Squeak.splOb_ClassLargeNegativeInteger:Squeak.splOb_ClassLargePositiveInteger,ee=this.instantiateClass(this.specialObjects[te],4),ie=ee.bytes;return ie[0]=255&Zt,ie[1]=Zt>>8&255,ie[2]=Zt>>16&255,ie[3]=Zt>>24&255,this.popNandPush(2,ee),!0}}return!1},pop2AndPushBoolResult:function(Bt){return!!this.success&&(this.popNandPush(2,Bt?this.trueObj:this.falseObj),!0)}},"numbers",{getClass:function(Bt){return this.isSmallInt(Bt)?this.specialObjects[Squeak.splOb_ClassInteger]:Bt.sqClass},canBeSmallInt:function(Bt){return Bt>=Squeak.MinSmallInt&&Bt<=Squeak.MaxSmallInt},isSmallInt:function(Bt){return"number"==typeof Bt},checkSmallInt:function(Bt){return"number"==typeof Bt?Bt:(this.success=!1,1)},quickDivide:function(Bt,Yt){if(0===Yt)return Squeak.NonSmallInt;var Zt=Bt/Yt|0;return Zt*Yt===Bt?Zt:Squeak.NonSmallInt},div:function(Bt,Yt){return 0===Yt?Squeak.NonSmallInt:Math.floor(Bt/Yt)},mod:function(Bt,Yt){return 0===Yt?Squeak.NonSmallInt:Bt-Math.floor(Bt/Yt)*Yt},safeShift:function(Bt,Yt){if(0>Yt)return-31>Yt?0>Bt?-1:0:Bt>>-Yt;if(Yt>31)return 0==Bt?0:Squeak.NonSmallInt;var Zt=Bt<<Yt;return Zt>>Yt===Bt?Zt:Squeak.NonSmallInt}},"utils",{isContext:function(Bt){return Bt.sqClass===this.specialObjects[Squeak.splOb_ClassMethodContext]||Bt.sqClass===this.specialObjects[Squeak.splOb_ClassBlockContext]},isMethodContext:function(Bt){return Bt.sqClass===this.specialObjects[Squeak.splOb_ClassMethodContext]},isMethod:function(Bt){return Bt.sqClass===this.specialObjects[Squeak.splOb_ClassCompiledMethod]},instantiateClass:function(Bt,Yt){return this.image.instantiateClass(Bt,Yt,this.nilObj)},arrayFill:function(Bt,Yt,Zt,te){for(var ee=Yt;Zt>ee;ee++)Bt[ee]=te},arrayCopy:function(Bt,Yt,Zt,te,ee){if(Bt===Zt&&te>Yt)for(var ie=ee-1;ie>=0;ie--)Zt[te+ie]=Bt[Yt+ie];else for(ie=0;ee>ie;ie++)Zt[te+ie]=Bt[Yt+ie]}},"debugging",{addMessage:function(Bt){return this.messages[Bt]?++this.messages[Bt]:this.messages[Bt]=1},warnOnce:function(Bt){1==this.addMessage(Bt)&&console.warn(Bt)},printMethod:function(Bt,Yt,Zt){return Zt?Yt.className()+">>"+Zt.bytesAsString():(Bt||(Bt=this.activeContext.contextMethod()),this.allMethodsDo((function(Yt,Zt,ee){return Zt===Bt?te=Yt.className()+">>"+ee.bytesAsString():void 0})),te||(Yt?"("+Yt.pointers[Squeak.Context_receiver]+")>>?":"?>>?"));var te},allInstancesOf:function(Bt,Yt){"string"==typeof Bt&&(Bt=this.globalNamed(Bt));for(var Zt=[],te=this.image.someInstanceOf(Bt);te;)Yt?Yt(te):Zt.push(te),te=this.image.nextInstanceAfter(te);return Zt},globalNamed:function(Bt){return this.allGlobalsDo((function(Yt,Zt){return Yt.bytesAsString()===Bt?Zt:void 0}))},allGlobalsDo:function(Bt){for(var Yt=this.globals,Zt=0;Zt<Yt.length;Zt++){var te=Yt[Zt];if(!te.isNil){var ee=Bt(te.pointers[0],te.pointers[1]);if(ee)return ee}}},allMethodsDo:function(Bt){this.allGlobalsDo((function(Yt,Zt){if(Zt.pointers&&Zt.pointers.length>=9)for(var te=[Zt,Zt.sqClass],ee=0;ee<te.length;ee++){var ie=te[ee],re=ie.pointers[1];if(re.pointers&&re.pointers[1]){var se=re.pointers[1].pointers;if(se)for(var ne=re.pointers,ae=0;ae<se.length;ae++)if(Bt.call(this,ie,se[ae],ne[2+ae]))return!0}}}))},printStack:function(Bt,Yt){"number"==typeof Bt&&(Yt=Bt,Bt=null),Bt||(Bt=this.activeContext),Yt||(Yt=100);for(var Zt=[],te=Math.max(Yt,1e6);!Bt.isNil&&te-- >0;)Zt.push(Bt),Bt=Bt.pointers[Squeak.Context_sender];Zt.length>Yt+200&&(Bt.isNil||Zt.push("..."),Zt=Zt.slice(0,Yt).concat(["..."]).concat(Zt.slice(-200)));for(var ee=[],ie=Zt.length;ie-- >0;){if((Bt=Zt[ie]).pointers){var re="",se=Bt.pointers[Squeak.Context_method];"number"==typeof se?(se=Bt.pointers[Squeak.BlockContext_home].pointers[Squeak.Context_method],re="[] in "):Bt.pointers[Squeak.Context_closure].isNil||(re="[] in "),ee.push(re+this.printMethod(se,Bt)+"\n")}else ee.push("...\n")}return ee.join("")},findMethod:function(Bt){var Yt,Zt=Bt.split(">>")[0],te=Bt.split(">>")[1];return this.allMethodsDo((function(Bt,ee,ie){return te.length==ie.bytesSize()&&te==ie.bytesAsString()&&Zt==Bt.className()?Yt=ee:void 0})),Yt},breakNow:function(Bt){Bt&&console.log("Break: "+Bt),this.breakOutOfInterpreter="break"},breakOn:function(Bt){return this.breakOnMethod=Bt&&this.findMethod(Bt)},breakOnReturnFromThisContext:function(){this.breakOnContextChanged=!1,this.breakOnContextReturned=this.activeContext},breakOnSendOrReturn:function(){this.breakOnContextChanged=!0,this.breakOnContextReturned=null},printActiveContext:function(){for(var Bt=this.activeContext,Yt="number"==typeof Bt.pointers[Squeak.BlockContext_argumentCount],Zt=Bt.pointers[Squeak.Context_closure],te=!Yt&&!Zt.isNil,ee=Yt?Bt.pointers[Squeak.BlockContext_home]:Bt,ie=te?Zt.pointers[Squeak.Closure_numArgs]:ee.pointers[Squeak.Context_method].methodTempCount(),re=this.decodeSqueakSP(0),se=ee.contextSizeWithStack(this)-1,ne=re+1,ae=ne+ie-1,oe="",ue=re;se>=ue;ue++){var le="";ue==re?le="=rcvr":ae>=ue&&(le="=tmp"+(ue-ne)),oe+="\nctx["+ue+"]"+le+": "+((pe=ee.pointers[ue]).sqInstName?pe.sqInstName():pe.toString())}if(Yt){oe+="\n";var ce=Bt.pointers[3],fe=this.decodeSqueakSP(1),he=fe+ce;for(ue=fe;ue<=this.sp;ue++){var pe;le="";he>=ue&&(le="=arg"+(ue-fe)),oe+="\nblk["+ue+"]"+le+": "+((pe=Bt.pointers[ue]).sqInstName?pe.sqInstName():pe.toString())}}return oe},printAllProcesses:function(){for(var Bt=this.specialObjects[Squeak.splOb_SchedulerAssociation].pointers[Squeak.Assn_value],Yt=Bt.pointers[Squeak.ProcSched_activeProcess],Zt="Active: "+this.printProcess(Yt,!0),te=Bt.pointers[Squeak.ProcSched_processLists].pointers,ee=te.length-1;ee>=0;ee--)for(var ie=te[ee].pointers[Squeak.LinkedList_firstLink];!ie.isNil;)Zt+="\nRunnable: "+this.printProcess(ie),ie=ie.pointers[Squeak.Link_nextLink];for(var re=this.specialObjects[Squeak.splOb_ClassSemaphore],se=this.image.someInstanceOf(re);se;){for(ie=se.pointers[Squeak.LinkedList_firstLink];!ie.isNil;)Zt+="\nWaiting: "+this.printProcess(ie),ie=ie.pointers[Squeak.Link_nextLink];se=this.image.nextInstanceAfter(se)}return Zt},printProcess:function(Bt,Yt){var Zt=Bt.pointers[Squeak.Proc_suspendedContext],te=Bt.pointers[Squeak.Proc_priority],ee=this.printStack(Yt?null:Zt);return Bt.toString()+" at priority "+te+"\n"+ee},printByteCodes:function(Bt,Yt,Zt,te){return Bt||(Bt=this.method),new Squeak.InstructionPrinter(Bt,this).printInstructions(Yt,Zt,te)},willSendOrReturn:function(){var Bt=this.method.bytes[this.pc];if(Bt>=120&&125>=Bt)return!0;if(131>Bt||200==Bt)return!1;if(Bt>=176)return!0;if(134>=Bt){var Yt;if(132===Bt){if(this.method.bytes[this.pc+1]>>5>1)return!1;Yt=this.method.bytes[this.pc+2]}else Yt=this.method.bytes[this.pc+1]&(134===Bt?63:31);if("blockCopy:"!=this.method.pointers[Yt+1].bytesAsString())return!0}return!1}}),Object.subclass("Squeak.Primitives","initialization",{initialize:function(Bt,Yt){this.vm=Bt,this.display=Yt,this.display.vm=this.vm,this.oldPrims=!this.vm.image.hasClosures,this.allowAccessBeyondSP=this.oldPrims,this.deferDisplayUpdates=!1,this.semaphoresToSignal=[],this.initDisplay(),this.initAtCache(),this.initModules()},initModules:function(){this.loadedModules={},this.builtinModules={JavaScriptPlugin:this.findPluginFunctions("js_","",!0),FilePlugin:this.findPluginFunctions("","primitive(Disable)?(File|Directory)"),DropPlugin:this.findPluginFunctions("","primitiveDropRequest"),SoundPlugin:this.findPluginFunctions("snd_"),JPEGReadWriter2Plugin:this.findPluginFunctions("jpeg2_"),SecurityPlugin:{primitiveDisableImageWrite:this.fakePrimitive.bind(this,"SecurityPlugin.primitiveDisableImageWrite",0)}},this.patchModules={ScratchPlugin:this.findPluginFunctions("scratch_")},this.interpreterProxy=new Squeak.InterpreterProxy(this.vm)},findPluginFunctions:function(Bt,Yt,Zt){Yt=Yt||"(initialise|shutdown|prim)";var te={},ee=new RegExp("^"+Bt+Yt,"i");for(var ie in this)if(ee.test(ie)&&"function"==typeof this[ie]){var re=ie;Bt&&(re=ie[Bt.length].toLowerCase()+ie.slice(Bt.length+1)),te[re]=Zt?ie:this[ie].bind(this)}return te},initDisplay:function(){this.indexedColors=[4294967295,4278190081,4294967295,4286611584,4294901760,4278255360,4278190335,4278255615,4294967040,4294902015,4280295456,4282400832,4284506208,4288651167,4290756543,4292861919,4278716424,4279242768,4279769112,4280821800,4281348144,4281874488,4282927176,4283453520,4283979864,4285032552,4285558896,4286085240,4287072135,4287598479,4288124823,4289177511,4289703855,4290230199,4291282887,4291809231,4292335575,4293388263,4293914607,4294440951,4278190081,4278203136,4278216192,4278229248,4278242304,4278255360,4278190131,4278203187,4278216243,4278229299,4278242355,4278255411,4278190182,4278203238,4278216294,4278229350,4278242406,4278255462,4278190233,4278203289,4278216345,4278229401,4278242457,4278255513,4278190284,4278203340,4278216396,4278229452,4278242508,4278255564,4278190335,4278203391,4278216447,4278229503,4278242559,4278255615,4281532416,4281545472,4281558528,4281571584,4281584640,4281597696,4281532467,4281545523,4281558579,4281571635,4281584691,4281597747,4281532518,4281545574,4281558630,4281571686,4281584742,4281597798,4281532569,4281545625,4281558681,4281571737,4281584793,4281597849,4281532620,4281545676,4281558732,4281571788,4281584844,4281597900,4281532671,4281545727,4281558783,4281571839,4281584895,4281597951,4284874752,4284887808,4284900864,4284913920,4284926976,4284940032,4284874803,4284887859,4284900915,4284913971,4284927027,4284940083,4284874854,4284887910,4284900966,4284914022,4284927078,4284940134,4284874905,4284887961,4284901017,4284914073,4284927129,4284940185,4284874956,4284888012,4284901068,4284914124,4284927180,4284940236,4284875007,4284888063,4284901119,4284914175,4284927231,4284940287,4288217088,4288230144,4288243200,4288256256,4288269312,4288282368,4288217139,4288230195,4288243251,4288256307,4288269363,4288282419,4288217190,4288230246,4288243302,4288256358,4288269414,4288282470,4288217241,4288230297,4288243353,4288256409,4288269465,4288282521,4288217292,4288230348,4288243404,4288256460,4288269516,4288282572,4288217343,4288230399,4288243455,4288256511,4288269567,4288282623,4291559424,4291572480,4291585536,4291598592,4291611648,4291624704,4291559475,4291572531,4291585587,4291598643,4291611699,4291624755,4291559526,4291572582,4291585638,4291598694,4291611750,4291624806,4291559577,4291572633,4291585689,4291598745,4291611801,4291624857,4291559628,4291572684,4291585740,4291598796,4291611852,4291624908,4291559679,4291572735,4291585791,4291598847,4291611903,4291624959,4294901760,4294914816,4294927872,4294940928,4294953984,4294967040,4294901811,4294914867,4294927923,4294940979,4294954035,4294967091,4294901862,4294914918,4294927974,4294941030,4294954086,4294967142,4294901913,4294914969,4294928025,4294941081,4294954137,4294967193,4294901964,4294915020,4294928076,4294941132,4294954188,4294967244,4294902015,4294915071,4294928127,4294941183,4294954239,4294967295]}},"dispatch",{quickSendOther:function(Bt,Yt){switch(this.success=!0,Yt){case 0:return this.popNandPushIfOK(2,this.objectAt(!0,!0,!1));case 1:return this.popNandPushIfOK(3,this.objectAtPut(!0,!0,!1));case 2:return this.popNandPushIfOK(1,this.objectSize(!0));case 6:return this.pop2andPushBoolIfOK(this.vm.stackValue(1)===this.vm.stackValue(0));case 7:return this.popNandPushIfOK(1,this.vm.getClass(this.vm.top()));case 8:return this.popNandPushIfOK(2,this.doBlockCopy());case 9:return this.primitiveBlockValue(0);case 10:return this.primitiveBlockValue(1)}return!1},doPrimitive:function(Bt,Yt,Zt){if(this.success=!0,128>Bt)switch(Bt){case 1:return this.popNandPushIntIfOK(2,this.stackInteger(1)+this.stackInteger(0));case 2:return this.popNandPushIntIfOK(2,this.stackInteger(1)-this.stackInteger(0));case 3:return this.pop2andPushBoolIfOK(this.stackInteger(1)<this.stackInteger(0));case 4:return this.pop2andPushBoolIfOK(this.stackInteger(1)>this.stackInteger(0));case 5:return this.pop2andPushBoolIfOK(this.stackInteger(1)<=this.stackInteger(0));case 6:return this.pop2andPushBoolIfOK(this.stackInteger(1)>=this.stackInteger(0));case 7:return this.pop2andPushBoolIfOK(this.stackInteger(1)===this.stackInteger(0));case 8:return this.pop2andPushBoolIfOK(this.stackInteger(1)!==this.stackInteger(0));case 9:return this.popNandPushIntIfOK(2,this.stackInteger(1)*this.stackInteger(0));case 10:return this.popNandPushIntIfOK(2,this.vm.quickDivide(this.stackInteger(1),this.stackInteger(0)));case 11:return this.popNandPushIntIfOK(2,this.vm.mod(this.stackInteger(1),this.stackInteger(0)));case 12:return this.popNandPushIntIfOK(2,this.vm.div(this.stackInteger(1),this.stackInteger(0)));case 13:return this.popNandPushIntIfOK(2,this.stackInteger(1)/this.stackInteger(0)|0);case 14:return this.popNandPushIfOK(2,this.doBitAnd());case 15:return this.popNandPushIfOK(2,this.doBitOr());case 16:return this.popNandPushIfOK(2,this.doBitXor());case 17:return this.popNandPushIfOK(2,this.doBitShift());case 18:return this.primitiveMakePoint(Yt,!1);case 19:case 20:case 21:case 22:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 52:case 65:case 66:case 67:case 103:case 104:case 120:return!1;case 23:return this.primitiveLessThanLargeIntegers();case 24:return this.primitiveGreaterThanLargeIntegers();case 25:return this.primitiveLessOrEqualLargeIntegers();case 26:return this.primitiveGreaterOrEqualLargeIntegers();case 27:return this.primitiveEqualLargeIntegers();case 28:return this.primitiveNotEqualLargeIntegers();case 38:case 60:return this.popNandPushIfOK(2,this.objectAt(!1,!1,!1));case 39:case 61:return this.popNandPushIfOK(3,this.objectAtPut(!1,!1,!1));case 40:return this.popNandPushFloatIfOK(1,this.stackInteger(0));case 41:return this.popNandPushFloatIfOK(2,this.stackFloat(1)+this.stackFloat(0));case 42:return this.popNandPushFloatIfOK(2,this.stackFloat(1)-this.stackFloat(0));case 43:return this.pop2andPushBoolIfOK(this.stackFloat(1)<this.stackFloat(0));case 44:return this.pop2andPushBoolIfOK(this.stackFloat(1)>this.stackFloat(0));case 45:return this.pop2andPushBoolIfOK(this.stackFloat(1)<=this.stackFloat(0));case 46:return this.pop2andPushBoolIfOK(this.stackFloat(1)>=this.stackFloat(0));case 47:return this.pop2andPushBoolIfOK(this.stackFloat(1)===this.stackFloat(0));case 48:return this.pop2andPushBoolIfOK(this.stackFloat(1)!==this.stackFloat(0));case 49:return this.popNandPushFloatIfOK(2,this.stackFloat(1)*this.stackFloat(0));case 50:return this.popNandPushFloatIfOK(2,this.safeFDiv(this.stackFloat(1),this.stackFloat(0)));case 51:return this.popNandPushIfOK(1,this.floatAsSmallInt(this.stackFloat(0)));case 53:return this.popNandPushIntIfOK(1,this.frexp_exponent(this.stackFloat(0))-1);case 54:return this.popNandPushFloatIfOK(2,this.ldexp(this.stackFloat(1),this.stackFloat(0)));case 55:return this.popNandPushFloatIfOK(1,Math.sqrt(this.stackFloat(0)));case 56:return this.popNandPushFloatIfOK(1,Math.sin(this.stackFloat(0)));case 57:return this.popNandPushFloatIfOK(1,Math.atan(this.stackFloat(0)));case 58:return this.popNandPushFloatIfOK(1,Math.log(this.stackFloat(0)));case 59:return this.popNandPushFloatIfOK(1,Math.exp(this.stackFloat(0)));case 62:return this.popNandPushIfOK(1,this.objectSize(!1));case 63:return this.popNandPushIfOK(2,this.objectAt(!1,!0,!1));case 64:return this.popNandPushIfOK(3,this.objectAtPut(!1,!0,!1));case 68:case 73:return this.popNandPushIfOK(2,this.objectAt(!1,!1,!0));case 69:case 74:return this.popNandPushIfOK(3,this.objectAtPut(!1,!1,!0));case 70:return this.popNandPushIfOK(1,this.instantiateClass(this.stackNonInteger(0),0));case 71:return this.popNandPushIfOK(2,this.instantiateClass(this.stackNonInteger(1),this.stackPos32BitInt(0)));case 72:return this.primitiveArrayBecome(Yt,!1);case 75:return this.popNandPushIfOK(1,this.stackNonInteger(0).hash);case 76:return this.primitiveStoreStackp(Yt);case 77:return this.popNandPushIfOK(1,this.someInstanceOf(this.stackNonInteger(0)));case 78:return this.popNandPushIfOK(1,this.nextInstanceAfter(this.stackNonInteger(0)));case 79:return this.primitiveNewMethod(Yt);case 80:return this.popNandPushIfOK(2,this.doBlockCopy());case 81:return this.primitiveBlockValue(Yt);case 82:return this.primitiveBlockValueWithArgs(Yt);case 83:return this.vm.primitivePerform(Yt);case 84:return this.vm.primitivePerformWithArgs(Yt,!1);case 85:return this.primitiveSignal();case 86:return this.primitiveWait();case 87:return this.primitiveResume();case 88:return this.primitiveSuspend();case 89:return this.vm.flushMethodCache();case 90:return this.primitiveMousePoint(Yt);case 91:return this.primitiveTestDisplayDepth(Yt);case 93:return this.primitiveInputSemaphore(Yt);case 94:return this.primitiveGetNextEvent(Yt);case 95:return this.primitiveInputWord(Yt);case 96:return this.namedPrimitive("BitBltPlugin","primitiveCopyBits",Yt);case 97:return this.primitiveSnapshot(Yt);case 99:return this.primitiveLoadImageSegment(Yt);case 100:return this.vm.primitivePerformWithArgs(Yt,!0);case 101:return this.primitiveBeCursor(Yt);case 102:return this.primitiveBeDisplay(Yt);case 105:return this.popNandPushIfOK(5,this.doStringReplace());case 106:return this.primitiveScreenSize(Yt);case 107:return this.primitiveMouseButtons(Yt);case 108:return this.primitiveKeyboardNext(Yt);case 109:return this.primitiveKeyboardPeek(Yt);case 110:return this.pop2andPushBoolIfOK(this.vm.stackValue(1)===this.vm.stackValue(0));case 111:return this.popNandPushIfOK(1,this.vm.getClass(this.vm.top()));case 112:return this.popNandPushIfOK(1,this.vm.image.bytesLeft());case 113:return this.primitiveQuit(Yt);case 114:return this.primitiveExitToDebugger(Yt);case 115:return this.primitiveChangeClass(Yt);case 116:return this.vm.flushMethodCacheForMethod(this.vm.top());case 117:return this.doNamedPrimitive(Yt,Zt);case 118:return this.primitiveDoPrimitiveWithArgs(Yt);case 119:return this.vm.flushMethodCacheForSelector(this.vm.top());case 121:return this.primitiveImageName(Yt);case 122:return this.primitiveReverseDisplay(Yt);case 124:return this.popNandPushIfOK(2,this.registerSemaphore(Squeak.splOb_TheLowSpaceSemaphore));case 125:return this.popNandPushIfOK(2,this.setLowSpaceThreshold());case 126:return this.primitiveDeferDisplayUpdates(Yt);case 127:return this.primitiveShowDisplayRect(Yt)}else if(256>Bt)switch(Bt){case 128:return this.primitiveArrayBecome(Yt,!0);case 129:return this.popNandPushIfOK(1,this.vm.image.specialObjectsArray);case 130:return this.primitiveFullGC(Yt);case 131:return this.popNandPushIfOK(1,this.vm.image.partialGC());case 132:return this.pop2andPushBoolIfOK(this.pointsTo(this.stackNonInteger(1),this.vm.top()));case 133:return!0;case 134:return this.popNandPushIfOK(2,this.registerSemaphore(Squeak.splOb_TheInterruptSemaphore));case 135:return this.popNandPushIfOK(1,this.millisecondClockValue());case 136:return this.primitiveSignalAtMilliseconds(Yt);case 137:return this.popNandPushIfOK(1,this.secondClock());case 138:return this.popNandPushIfOK(1,this.someObject());case 139:return this.popNandPushIfOK(1,this.nextObject(this.vm.top()));case 140:return this.primitiveBeep(Yt);case 141:return this.primitiveClipboardText(Yt);case 142:return this.popNandPushIfOK(1,this.makeStString(this.filenameToSqueak(Squeak.vmPath)));case 143:case 144:return this.primitiveShortAtAndPut(Yt);case 145:return this.primitiveConstantFill(Yt);case 146:return this.namedPrimitive("JoystickTabletPlugin","primitiveReadJoystick",Yt);case 147:return this.namedPrimitive("BitBltPlugin","primitiveWarpBits",Yt);case 148:return this.popNandPushIfOK(1,this.vm.image.clone(this.vm.top()));case 149:return this.primitiveGetAttribute(Yt);case 150:if(this.oldPrims)return this.primitiveFileAtEnd(Yt);case 151:if(this.oldPrims)return this.primitiveFileClose(Yt);case 152:if(this.oldPrims)return this.primitiveFileGetPosition(Yt);case 153:if(this.oldPrims)return this.primitiveFileOpen(Yt);case 154:if(this.oldPrims)return this.primitiveFileRead(Yt);case 155:if(this.oldPrims)return this.primitiveFileSetPosition(Yt);case 156:if(this.oldPrims)return this.primitiveFileDelete(Yt);case 157:if(this.oldPrims)return this.primitiveFileSize(Yt);case 158:if(this.oldPrims)return this.primitiveFileWrite(Yt);case 159:if(this.oldPrims)return this.primitiveFileRename(Yt);case 160:if(this.oldPrims)return this.primitiveDirectoryCreate(Yt);case 161:if(this.oldPrims)return this.primitiveDirectoryDelimitor(Yt);case 162:if(this.oldPrims)return this.primitiveDirectoryLookup(Yt);case 163:if(this.oldPrims)return this.primitiveDirectoryDelete(Yt);break;case 165:case 166:return this.primitiveIntegerAtAndPut(Yt);case 167:return!1;case 168:return this.primitiveCopyObject(Yt);case 169:return this.oldPrims?this.primitiveDirectorySetMacTypeAndCreator(Yt):this.primitiveNotIdentical(Yt);case 170:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStart",Yt);case 171:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStartWithSemaphore",Yt);case 172:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStop",Yt);case 173:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundAvailableSpace",Yt);case 174:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundPlaySamples",Yt);case 175:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundPlaySilence",Yt);case 176:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primWaveTableSoundmixSampleCountintostartingAtpan",Yt);case 177:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primFMSoundmixSampleCountintostartingAtpan",Yt);case 178:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primPluckedSoundmixSampleCountintostartingAtpan",Yt);case 179:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primSampledSoundmixSampleCountintostartingAtpan",Yt);case 180:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveMixFMSound",Yt);case 181:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveMixPluckedSound",Yt);case 182:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","oldprimSampledSoundmixSampleCountintostartingAtleftVolrightVol",Yt);case 183:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveApplyReverb",Yt);case 184:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveMixLoopedSampledSound",Yt);case 185:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primitiveMixSampledSound",Yt);break;case 188:if(!this.oldPrims)return this.primitiveExecuteMethodArgsArray(Yt);break;case 189:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundInsertSamples",Yt);case 190:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStartRecording",Yt);case 191:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStopRecording",Yt);case 192:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundGetRecordingSampleRate",Yt);case 193:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundRecordSamples",Yt);case 194:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundSetRecordLevel",Yt);break;case 195:case 196:case 197:case 198:case 199:return!1;case 200:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveInitializeNetwork",Yt):this.primitiveClosureCopyWithCopiedValues(Yt);case 201:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverStartNameLookup",Yt):this.primitiveClosureValue(Yt);case 202:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverNameLookupResult",Yt):this.primitiveClosureValue(Yt);case 203:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverStartAddressLookup",Yt):this.primitiveClosureValue(Yt);case 204:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverAddressLookupResult",Yt):this.primitiveClosureValue(Yt);case 205:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverAbortLookup",Yt):this.primitiveClosureValue(Yt);case 206:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverLocalAddress",Yt):this.primitiveClosureValueWithArgs(Yt);case 207:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveResolverStatus",Yt);case 208:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveResolverError",Yt);case 209:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketCreate",Yt);break;case 210:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketDestroy",Yt):this.popNandPushIfOK(2,this.objectAt(!1,!1,!1));case 211:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketConnectionStatus",Yt):this.popNandPushIfOK(3,this.objectAtPut(!1,!1,!1));case 212:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketError",Yt):this.popNandPushIfOK(1,this.objectSize(!1));case 213:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketLocalAddress",Yt);case 214:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketLocalPort",Yt);case 215:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketRemoteAddress",Yt);case 216:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketRemotePort",Yt);case 217:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketConnectToPort",Yt);case 218:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketListenOnPort",Yt);case 219:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketCloseConnection",Yt);case 220:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketAbortConnection",Yt);break;case 221:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketReceiveDataBufCount",Yt):this.primitiveClosureValueNoContextSwitch(Yt);case 222:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketReceiveDataAvailable",Yt):this.primitiveClosureValueNoContextSwitch(Yt);case 223:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketSendDataBufCount",Yt);case 224:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketSendDone",Yt);break;case 230:return this.primitiveRelinquishProcessorForMicroseconds(Yt);case 231:return this.primitiveForceDisplayUpdate(Yt);case 233:return this.primitiveSetFullScreen(Yt);case 234:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveDecompressFromByteArray",Yt);case 235:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveCompareString",Yt);case 236:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveConvert8BitSigned",Yt);case 237:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveCompressToByteArray",Yt);case 238:if(this.oldPrims)return this.namedPrimitive("SerialPlugin","primitiveSerialPortOpen",Yt);case 239:if(this.oldPrims)return this.namedPrimitive("SerialPlugin","primitiveSerialPortClose",Yt);break;case 240:return this.oldPrims?this.namedPrimitive("SerialPlugin","primitiveSerialPortWrite",Yt):this.popNandPushIfOK(1,this.microsecondClockUTC());case 241:return this.oldPrims?this.namedPrimitive("SerialPlugin","primitiveSerialPortRead",Yt):this.popNandPushIfOK(1,this.microsecondClockLocal());case 243:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveTranslateStringWithTable",Yt);case 244:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveFindFirstInString",Yt);case 245:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveIndexOfAsciiInString",Yt);case 246:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveFindSubstring",Yt);break;case 248:return this.vm.primitiveInvokeObjectAsMethod(Yt,Zt);case 249:return this.primitiveArrayBecome(Yt,!1);case 254:return this.primitiveVMParameter(Yt)}else switch(Bt){case 521:return this.namedPrimitive("MIDIPlugin","primitiveMIDIClosePort",Yt);case 522:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetClock",Yt);case 523:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortCount",Yt);case 524:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortDirectionality",Yt);case 525:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortName",Yt);case 526:return this.namedPrimitive("MIDIPlugin","primitiveMIDIOpenPort",Yt);case 527:return this.namedPrimitive("MIDIPlugin","primitiveMIDIParameterGetOrSet",Yt);case 528:return this.namedPrimitive("MIDIPlugin","primitiveMIDIRead",Yt);case 529:return this.namedPrimitive("MIDIPlugin","primitiveMIDIWrite",Yt);case 550:return this.namedPrimitive("ADPCMCodecPlugin","primitiveDecodeMono",Yt);case 551:return this.namedPrimitive("ADPCMCodecPlugin","primitiveDecodeStereo",Yt);case 552:return this.namedPrimitive("ADPCMCodecPlugin","primitiveEncodeMono",Yt);case 553:return this.namedPrimitive("ADPCMCodecPlugin","primitiveEncodeStereo",Yt);case 571:return this.primitiveUnloadModule(Yt);case 572:return this.primitiveListBuiltinModule(Yt);case 573:return this.primitiveListLoadedModule(Yt)}return console.error("primitive "+Bt+" not implemented yet"),!1},namedPrimitive:function(Bt,Yt,Zt){var te=""===Bt?this:this.loadedModules[Bt];void 0===te&&(te=this.loadModule(Bt),this.loadedModules[Bt]=te);var ee=!1;if(te){this.interpreterProxy.argCount=Zt;var ie=te[Yt];"function"==typeof ie?ee=te[Yt](Zt):"string"==typeof ie?ee=this[ie](Zt):this.vm.warnOnce("missing primitive: "+Bt+"."+Yt)}else this.vm.warnOnce("missing module: "+Bt+" ("+Yt+")");return!0===ee||!1===ee?ee:this.success},doNamedPrimitive:function(Bt,Yt){if(Yt.pointersSize()<2)return!1;var Zt=Yt.pointers[1];if(4!==Zt.pointersSize())return!1;this.primMethod=Yt;var te=Zt.pointers[0].bytesAsString(),ee=Zt.pointers[1].bytesAsString();return this.namedPrimitive(te,ee,Bt)},fakePrimitive:function(Bt,Yt,Zt){return this.vm.warnOnce("faking primitive: "+Bt),void 0===Yt?this.vm.popN(Zt):this.vm.popNandPush(Zt+1,this.makeStObject(Yt)),!0}},"modules",{loadModule:function(Bt){var Yt=Squeak.externalModules[Bt]||this.builtinModules[Bt];if(!Yt)return null;if(this.patchModules[Bt]&&this.patchModule(Yt,Bt),Yt.setInterpreter&&!Yt.setInterpreter(this.interpreterProxy))return console.log("Wrong interpreter proxy version: "+Bt),null;var Zt=Yt.initialiseModule;return"function"==typeof Zt?Yt.initialiseModule():"string"==typeof Zt&&this[Zt](),this.interpreterProxy.failed()?(console.log("Module initialization failed: "+Bt),null):(console.log("Loaded module: "+Bt),Yt)},patchModule:function(Bt,Yt){var Zt=this.patchModules[Yt];for(var te in Zt)Bt[te]=Zt[te]},unloadModule:function(Bt){var Yt=this.loadedModules[Bt];if(!Bt||!Yt||Yt===this)return null;delete this.loadedModules[Bt];var Zt=Yt.unloadModule;return"function"==typeof Zt?Yt.unloadModule(this):"string"==typeof Zt&&this[Zt](this),console.log("Unloaded module: "+Bt),Yt},loadFunctionFrom:function(Bt,Yt){var Zt=""===Yt?this:this.loadedModules[Yt];if(void 0===Zt&&(Zt=this.loadModule(Yt),this.loadedModules[Yt]=Zt),!Zt)return null;var te=Zt[Bt];return"function"==typeof te?te.bind(Zt):"string"==typeof te?this[te].bind(this):(this.vm.warnOnce("missing primitive: "+Yt+"."+Bt),null)},primitiveUnloadModule:function(Bt){var Yt=this.stackNonInteger(0).bytesAsString();return!!Yt&&(this.unloadModule(Yt),this.popNIfOK(Bt))},primitiveListBuiltinModule:function(Bt){var Yt=this.stackInteger(0)-1;if(!this.success)return!1;var Zt=Object.keys(this.builtinModules);return this.popNandPushIfOK(Bt+1,this.makeStObject(Zt[Yt]))},primitiveListLoadedModule:function(Bt){var Yt=this.stackInteger(0)-1;if(!this.success)return!1;var Zt=[];for(var te in this.loadedModules){var ee=this.loadedModules[te];if(ee){var ie=ee.getModuleName?ee.getModuleName():te;Zt.push(ie)}}return this.popNandPushIfOK(Bt+1,this.makeStObject(Zt[Yt]))}},"stack access",{popNIfOK:function(Bt){return!!this.success&&(this.vm.popN(Bt),!0)},pop2andPushBoolIfOK:function(Bt){return this.vm.success=this.success,this.vm.pop2AndPushBoolResult(Bt)},popNandPushIfOK:function(Bt,Yt){return!(!this.success||null==Yt)&&(this.vm.popNandPush(Bt,Yt),!0)},popNandPushIntIfOK:function(Bt,Yt){return!(!this.success||!this.vm.canBeSmallInt(Yt))&&this.popNandPushIfOK(Bt,Yt)},popNandPushFloatIfOK:function(Bt,Yt){return!!this.success&&this.popNandPushIfOK(Bt,this.makeFloat(Yt))},stackNonInteger:function(Bt){return this.checkNonInteger(this.vm.stackValue(Bt))},stackInteger:function(Bt){return this.checkSmallInt(this.vm.stackValue(Bt))},stackPos32BitInt:function(Bt){return this.positive32BitValueOf(this.vm.stackValue(Bt))},pos32BitIntFor:function(Bt){if(Bt>=0&&Bt<=Squeak.MaxSmallInt)return Bt;for(var Yt=this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger],Zt=this.vm.instantiateClass(Yt,4),te=Zt.bytes,ee=0;4>ee;ee++)te[ee]=Bt>>>8*ee&255;return Zt},pos64BitIntFor:function(Bt){if(4294967295>=Bt)return this.pos32BitIntFor(Bt);for(var Yt=0xffffffffff>=Bt?5:0xffffffffffff>=Bt?6:72057594037927940>=Bt?7:8,Zt=this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger],te=this.vm.instantiateClass(Zt,Yt),ee=te.bytes,ie=0;Yt>ie;ie++)ee[ie]=255&Bt,Bt/=256;return te},stackSigned32BitInt:function(Bt){var Yt=this.vm.stackValue(Bt);if("number"==typeof Yt)return Yt;if(4!==Yt.bytesSize())return this.success=!1,0;for(var Zt=Yt.bytes,te=0,ee=0,ie=1;4>ee;ee++,ie*=256)te+=Zt[ee]*ie;return this.isA(Yt,Squeak.splOb_ClassLargePositiveInteger)?te:this.isA(Yt,Squeak.splOb_ClassLargeNegativeInteger)?-te:(this.success=!1,0)},signed32BitIntegerFor:function(Bt){if(Bt>=Squeak.MinSmallInt&&Bt<=Squeak.MaxSmallInt)return Bt;for(var Yt=0>Bt,Zt=Yt?-Bt:Bt,te=Yt?Squeak.splOb_ClassLargeNegativeInteger:Squeak.splOb_ClassLargePositiveInteger,ee=this.vm.instantiateClass(this.vm.specialObjects[te],4),ie=ee.bytes,re=0;4>re;re++)ie[re]=Zt>>>8*re&255;return ee},stackFloat:function(Bt){return this.checkFloat(this.vm.stackValue(Bt))},stackBoolean:function(Bt){return this.checkBoolean(this.vm.stackValue(Bt))},stackSigned53BitInt:function(Bt){var Yt=this.vm.stackValue(Bt);if("number"==typeof Yt)return Yt;var Zt=Yt.bytesSize();if(7>=Zt){for(var te=Yt.bytes,ee=0,ie=0,re=1;Zt>ie;ie++,re*=256)ee+=te[ie]*re;if(9007199254740992>ee){if(this.isA(Yt,Squeak.splOb_ClassLargePositiveInteger))return ee;if(this.isA(Yt,Squeak.splOb_ClassLargeNegativeInteger))return-ee}}return this.success=!1,0}},"numbers",{doBitAnd:function(){var Bt=this.stackPos32BitInt(1),Yt=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(Bt&Yt):0},doBitOr:function(){var Bt=this.stackPos32BitInt(1),Yt=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(Bt|Yt):0},doBitXor:function(){var Bt=this.stackPos32BitInt(1),Yt=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(Bt^Yt):0},doBitShift:function(){var Bt=this.stackPos32BitInt(1),Yt=this.stackInteger(0);return this.success?this.vm.safeShift(Bt,Yt)>0?this.pos32BitIntFor(this.vm.safeShift(Bt,Yt)):(this.success=!1,0):0},safeFDiv:function(Bt,Yt){return 0===Yt?(this.success=!1,1):Bt/Yt},floatAsSmallInt:function(Bt){var Yt=Bt>=0?Math.floor(Bt):Math.ceil(Bt);return this.ensureSmallInt(Yt)},frexp_exponent:function(Bt){if(0==Bt)return 0;var Yt=new DataView(new ArrayBuffer(8));Yt.setFloat64(0,Bt);var Zt=Yt.getUint32(0)>>>20&2047;return 0===Zt&&(Yt.setFloat64(0,Bt*Math.pow(2,64)),Zt=(Yt.getUint32(0)>>>20&2047)-64),Zt-1022},ldexp:function(Bt,Yt){return Yt>1023?Bt*Math.pow(2,1023)*Math.pow(2,Yt-1023):-1074>Yt?Bt*Math.pow(2,-1074)*Math.pow(2,Yt+1074):Bt*Math.pow(2,Yt)},primitiveLessThanLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)<this.stackSigned53BitInt(0))},primitiveGreaterThanLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)>this.stackSigned53BitInt(0))},primitiveLessOrEqualLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)<=this.stackSigned53BitInt(0))},primitiveGreaterOrEqualLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)>=this.stackSigned53BitInt(0))},primitiveEqualLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)===this.stackSigned53BitInt(0))},primitiveNotEqualLargeIntegers:function(){return this.pop2andPushBoolIfOK(this.stackSigned53BitInt(1)!==this.stackSigned53BitInt(0))}},"utils",{floatOrInt:function(Bt){return Bt.isFloat?Bt.float:"number"==typeof Bt?Bt:0},positive32BitValueOf:function(Bt){if("number"==typeof Bt)return Bt>=0?Bt:(this.success=!1,0);if(!this.isA(Bt,Squeak.splOb_ClassLargePositiveInteger)||4!==Bt.bytesSize())return this.success=!1,0;for(var Yt=Bt.bytes,Zt=0,te=0,ee=1;4>te;te++,ee*=256)Zt+=Yt[te]*ee;return Zt},checkFloat:function(Bt){return Bt.isFloat?Bt.float:"number"==typeof Bt?Bt:(this.success=!1,0)},checkSmallInt:function(Bt){return"number"==typeof Bt?Bt:(this.success=!1,0)},checkNonInteger:function(Bt){return"number"!=typeof Bt?Bt:(this.success=!1,this.vm.nilObj)},checkBoolean:function(Bt){return!!Bt.isTrue||!Bt.isFalse&&(this.success=!1)},indexableSize:function(Bt){if("number"==typeof Bt)return-1;var Yt=Bt.format;return 2>Yt?-1:3===Yt&&this.vm.isContext(Bt)&&!this.allowAccessBeyondSP?Bt.pointers[Squeak.Context_stackPointer]:6>Yt?Bt.pointersSize()-Bt.instSize():8>Yt?Bt.wordsSize():12>Yt?Bt.bytesSize():Bt.bytesSize()+4*Bt.pointersSize()},isA:function(Bt,Yt){return Bt.sqClass===this.vm.specialObjects[Yt]},isKindOf:function(Bt,Yt){for(var Zt=Bt.sqClass,te=this.vm.specialObjects[Yt];!Zt.isNil;){if(Zt===te)return!0;Zt=Zt.pointers[Squeak.Class_superclass]}return!1},isAssociation:function(Bt){return"number"!=typeof Bt&&2==Bt.pointersSize()},ensureSmallInt:function(Bt){return Bt===(0|Bt)&&this.vm.canBeSmallInt(Bt)?Bt:(this.success=!1,0)},charFromInt:function(Bt){return this.vm.specialObjects[Squeak.splOb_CharacterTable].pointers[Bt]},makeFloat:function(Bt){var Yt=this.vm.specialObjects[Squeak.splOb_ClassFloat],Zt=this.vm.instantiateClass(Yt,2);return Zt.float=Bt,Zt},makeLargeIfNeeded:function(Bt){return this.vm.canBeSmallInt(Bt)?Bt:this.makeLargeInt(Bt)},makeLargeInt:function(Bt){if(0>Bt)throw Error("negative large ints not implemented yet");if(Bt>4294967295)throw Error("large large ints not implemented yet");return this.pos32BitIntFor(Bt)},makePointWithXandY:function(Bt,Yt){var Zt=this.vm.specialObjects[Squeak.splOb_ClassPoint],te=this.vm.instantiateClass(Zt,0);return te.pointers[Squeak.Point_x]=Bt,te.pointers[Squeak.Point_y]=Yt,te},makeStArray:function(Bt,Yt){for(var Zt=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassArray],Bt.length),te=0;te<Bt.length;te++)Zt.pointers[te]=this.makeStObject(Bt[te],Yt);return Zt},makeStString:function(Bt){for(var Yt=[],Zt=0;Zt<Bt.length;++Zt)Yt.push(255&Bt.charCodeAt(Zt));var te=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassString],Yt.length);return te.bytes=Yt,te},makeStObject:function(Bt,Yt){if(null==Bt)return this.vm.nilObj;if(!0===Bt)return this.vm.trueObj;if(!1===Bt)return this.vm.falseObj;if(Bt.sqClass)return Bt;if("number"==typeof Bt)return Bt===(0|Bt)?this.makeLargeIfNeeded(Bt):this.makeFloat(Bt);if(Yt){var Zt=this.vm.instantiateClass(Yt,0);return Zt.jsObject=Bt,Zt}if("string"==typeof Bt||Bt.constructor===Uint8Array)return this.makeStString(Bt);if(Bt.constructor===Array)return this.makeStArray(Bt);throw Error("cannot make smalltalk object")},pointsTo:function(Bt,Yt){return!!Bt.pointers&&Bt.pointers.indexOf(Yt)>=0},asUint8Array:function(Bt){if(Bt.constructor===Uint8Array)return Bt;if(Bt.constructor===ArrayBuffer)return new Uint8Array(Bt);if("string"==typeof Bt){for(var Yt=new Uint8Array(Bt.length),Zt=0;Zt<Bt.length;Zt++)Yt[Zt]=Bt.charCodeAt(Zt);return Yt}throw Error("unknown buffer type")},filenameToSqueak:function(Bt){var Yt="/SqueakJS"+("/"!==Bt[0]?"/":"")+Bt;return this.emulateMac&&(Yt=("Macintosh HD"+Yt).replace(/\//g,"€").replace(/:/g,"/").replace(/€/g,":")),Yt},filenameFromSqueak:function(Bt){var Yt=this.emulateMac?Bt.replace(/^[^:]*:/,":").replace(/\//g,"€").replace(/:/g,"/").replace(/€/g,":"):Bt;return Yt.replace(/^\/*SqueakJS\/?/,"/")}},"indexing",{objectAt:function(Bt,Yt,Zt){var te,ee=this.stackNonInteger(1),ie=this.stackPos32BitInt(0);if(!this.success)return ee;if(Bt){if((te=this.atCache[ee.hash&this.atCacheMask]).array!==ee)return this.success=!1,ee}else{if(ee.isFloat){var re=ee.floatData();return 1==ie?this.pos32BitIntFor(re.getUint32(0,!1)):2==ie?this.pos32BitIntFor(re.getUint32(4,!1)):(this.success=!1,ee)}te=this.makeAtCacheInfo(this.atCache,this.vm.specialSelectors[32],ee,Yt,Zt)}if(1>ie||ie>te.size)return this.success=!1,ee;if(Zt)return ee.pointers[ie-1];if(ee.format<6)return ee.pointers[ie-1+te.ivarOffset];if(ee.format<8)return this.pos32BitIntFor(ee.words[ie-1]);if(ee.format<12)return te.convertChars?this.charFromInt(255&ee.bytes[ie-1]):255&ee.bytes[ie-1];var se=4*ee.pointersSize();return 0>ie-1-se?(this.success=!1,ee):255&ee.bytes[ie-1-se]},objectAtPut:function(Bt,Yt,Zt){var te,ee=this.stackNonInteger(2),ie=this.stackPos32BitInt(1);if(!this.success)return ee;if(Bt){if((te=this.atPutCache[ee.hash&this.atCacheMask]).array!==ee)return this.success=!1,ee}else{if(ee.isFloat){var re=this.stackPos32BitInt(0);if(!this.success||1!=ie&&2!=ie)this.success=!1;else{var se=ee.floatData();se.setUint32(1==ie?0:4,re,!1),ee.float=se.getFloat64(0)}return this.vm.stackValue(0)}te=this.makeAtCacheInfo(this.atPutCache,this.vm.specialSelectors[34],ee,Yt,Zt)}if(1>ie||ie>te.size)return this.success=!1,ee;var ne,ae=this.vm.stackValue(0);if(Zt)return ee.pointers[ie-1]=ae;if(ee.format<6)return ee.pointers[ie-1+te.ivarOffset]=ae;if(ee.format<8)return ne=this.stackPos32BitInt(0),this.success&&(ee.words[ie-1]=ne),ae;if(Yt){if(ae.sqClass!==this.vm.specialObjects[Squeak.splOb_ClassCharacter])return this.success=!1,ae;if("number"!=typeof(ne=ae.pointers[0]))return this.success=!1,ae}else{if("number"!=typeof ae)return this.success=!1,ae;ne=ae}if(0>ne||ne>255)return this.success=!1,ae;if(ee.format<8)return ee.bytes[ie-1]=ne;var oe=4*ee.pointersSize();return 0>ie-1-oe?(this.success=!1,ee):(ee.bytes[ie-1-oe]=ne,ae)},objectSize:function(Bt){var Yt=this.vm.stackValue(0),Zt=-1;return Bt?Yt.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray]?Zt=Yt.pointersSize():Yt.sqClass===this.vm.specialObjects[Squeak.splOb_ClassString]&&(Zt=Yt.bytesSize()):Zt=this.indexableSize(Yt),-1===Zt?(this.success=!1,-1):this.pos32BitIntFor(Zt)},initAtCache:function(){this.atCacheSize=32,this.atCacheMask=this.atCacheSize-1,this.atCache=[],this.atPutCache=[],this.nonCachedInfo={};for(var Bt=0;Bt<this.atCacheSize;Bt++)this.atCache.push({}),this.atPutCache.push({})},clearAtCache:function(){this.nonCachedInfo.array=null;for(var Bt=0;Bt<this.atCacheSize;Bt++)this.atCache[Bt].array=null,this.atPutCache[Bt].array=null},makeAtCacheInfo:function(Bt,Yt,Zt,te,ee){var ie;return(ie=this.vm.verifyAtSelector===Yt&&this.vm.verifyAtClass===Zt.sqClass&&!(3===Zt.format&&this.vm.isContext(Zt))?Bt[Zt.hash&this.atCacheMask]:this.nonCachedInfo).array=Zt,ie.convertChars=te,ee?(ie.size=Zt.instSize()+Math.max(0,this.indexableSize(Zt)),ie.ivarOffset=0):(ie.size=this.indexableSize(Zt),ie.ivarOffset=Zt.format<6?Zt.instSize():0),ie}},"basic",{instantiateClass:function(Bt,Yt){return 4*Yt>this.vm.image.bytesLeft()?(console.warn("squeak: out of memory"),this.success=!1,null):this.vm.instantiateClass(Bt,Yt)},someObject:function(){return this.vm.image.firstOldObject},nextObject:function(Bt){return this.vm.image.objectAfter(Bt)||0},someInstanceOf:function(Bt){var Yt=this.vm.image.someInstanceOf(Bt);return Yt||(this.success=!1,0)},nextInstanceAfter:function(Bt){var Yt=this.vm.image.nextInstanceAfter(Bt);return Yt||(this.success=!1,0)},primitiveFullGC:function(){this.vm.image.fullGC("primitive");var Bt=this.vm.image.bytesLeft();return this.popNandPushIfOK(1,this.makeLargeIfNeeded(Bt))},primitiveMakePoint:function(Bt,Yt){var Zt=this.vm.stackValue(1),te=this.vm.stackValue(0);return!(Yt&&(this.checkFloat(Zt),this.checkFloat(te),!this.success))&&(this.vm.popNandPush(1+Bt,this.makePointWithXandY(Zt,te)),!0)},primitiveStoreStackp:function(Bt){var Yt=this.stackNonInteger(1),Zt=this.stackInteger(0);if(!this.success||0>Zt||this.vm.decodeSqueakSP(Zt)>=Yt.pointers.length)return!1;for(var te=Yt.pointers[Squeak.Context_stackPointer];Zt>te;)Yt.pointers[this.vm.decodeSqueakSP(++te)]=this.vm.nilObj;return Yt.pointers[Squeak.Context_stackPointer]=Zt,this.vm.popN(Bt),!0},primitiveChangeClass:function(Bt){if(1!==Bt)return!1;var Yt=this.stackNonInteger(1),Zt=this.stackNonInteger(0);return!!this.success&&(Yt.format===Zt.format&&Yt.sqClass.isCompact===Zt.sqClass.isCompact&&Yt.sqClass.classInstSize()===Zt.sqClass.classInstSize()&&(Yt.sqClass=Zt.sqClass,this.popNIfOK(1)))},primitiveDoPrimitiveWithArgs:function(){var Bt=this.stackNonInteger(0),Yt=this.stackInteger(1);if(!this.success)return!1;var Zt=Bt.pointersSize(),te=this.vm.activeContext.pointersSize();if(this.vm.sp+Zt>=te)return!1;this.vm.popN(2);for(var ee=0;Zt>ee;ee++)this.vm.push(Bt.pointers[ee]);return!!this.vm.tryPrimitive(Yt,Zt)||(this.vm.popN(Zt),this.vm.push(Yt),this.vm.push(Bt),!1)},primitiveShortAtAndPut:function(Bt){var Yt,Zt=this.stackNonInteger(Bt),te=this.stackInteger(Bt-1)-1,ee=Zt.wordsAsInt16Array();if(!this.success||!ee||0>te||te>=ee.length)return!1;if(2>Bt)Yt=ee[te];else{if(-32768>(Yt=this.stackInteger(0))||Yt>32767)return!1;ee[te]=Yt}return this.popNandPushIfOK(Bt+1,Yt),!0},primitiveIntegerAtAndPut:function(Bt){var Yt,Zt=this.stackNonInteger(Bt),te=this.stackInteger(Bt-1)-1,ee=Zt.wordsAsInt32Array();if(!this.success||!ee||0>te||te>=ee.length)return!1;if(2>Bt)Yt=this.signed32BitIntegerFor(ee[te]);else{if(Yt=this.stackSigned32BitInt(0),!this.success)return!1;ee[te]=Yt}return this.popNandPushIfOK(Bt+1,Yt),!0},primitiveConstantFill:function(Bt){var Yt=this.stackNonInteger(1),Zt=this.stackPos32BitInt(0);if(!this.success||!Yt.isWordsOrBytes())return!1;var te=Yt.words||Yt.bytes;if(te){if(te===Yt.bytes&&Zt>255)return!1;for(var ee=0;ee<te.length;ee++)te[ee]=Zt}return this.vm.popN(Bt),!0},primitiveNewMethod:function(Bt){var Yt=this.stackInteger(0),Zt=this.stackInteger(1);if(!this.success)return 0;var te=Yt>>9&255,ee=this.vm.instantiateClass(this.vm.stackValue(2),Zt);ee.pointers=[Yt];for(var ie=0;te>ie;ie++)ee.pointers.push(this.vm.nilObj);return this.vm.popNandPush(1+Bt,ee),this.vm.breakOnNewMethod&&(this.vm.breakOnMethod=ee),!0},primitiveExecuteMethodArgsArray:function(Bt){var Yt=this.stackNonInteger(0),Zt=this.stackNonInteger(1),te=this.vm.stackValue(2);if(!this.success||!this.vm.isMethod(Yt)||Bt>4)return!1;var ee=Yt.methodNumArgs();if(ee!==Zt.pointersSize())return!1;this.vm.popNandPush(Bt+1,te);for(var ie=0;ee>ie;ie++)this.vm.push(Zt.pointers[ie]);return this.vm.executeNewMethod(te,Yt,ee,Yt.methodPrimitiveIndex(),null,null),!0},primitiveArrayBecome:function(Bt,Yt){var Zt=this.stackNonInteger(Bt),te=this.stackNonInteger(Bt-1),ee=!(Bt>1)||this.stackBoolean(Bt-2);return!!this.success&&(this.success=this.vm.image.bulkBecome(Zt.pointers,te.pointers,Yt,ee),this.popNIfOK(Bt))},doStringReplace:function(){var Bt=this.stackNonInteger(4),Yt=this.stackInteger(3)-1,Zt=this.stackInteger(2)-Yt,te=this.stackNonInteger(1),ee=this.stackInteger(0)-1;if(!this.success)return Bt;var ie=te.format,re=Bt.format;if(8>re){if(re!=ie)return this.success=!1,Bt;if((12&re)!=(12&ie))return this.success=!1,Bt}if(4>ie){var se=te.pointersSize();if(0>(ee+=te.instSize())||ee+Zt>se)return this.success=!1,Bt;if(se=Bt.pointersSize(),0>(Yt+=Bt.instSize())||Yt+Zt>se)return this.success=!1,Bt;for(var ne=0;Zt>ne;ne++)Bt.pointers[Yt+ne]=te.pointers[ee+ne];return Bt}if(8>ie){se=te.wordsSize();if(0>ee||ee+Zt>se)return this.success=!1,Bt;if(se=Bt.wordsSize(),0>Yt||Yt+Zt>se)return this.success=!1,Bt;for(ne=0;Zt>ne;ne++)Bt.words[Yt+ne]=te.words[ee+ne];return Bt}se=te.bytesSize();if(0>ee||ee+Zt>se)return this.success=!1,Bt;if(se=Bt.bytesSize(),0>Yt||Yt+Zt>se)return this.success=!1,Bt;for(ne=0;Zt>ne;ne++)Bt.bytes[Yt+ne]=te.bytes[ee+ne];return Bt},primitiveCopyObject:function(Bt){var Yt=this.stackNonInteger(1),Zt=this.stackNonInteger(0),te=Yt.pointersSize();if(!this.success||Yt.isWordsOrBytes()||Yt.sqClass!==Zt.sqClass||te!==Zt.pointersSize())return!1;for(var ee=0;te>ee;ee++)Zt.pointers[ee]=Yt.pointers[ee];return this.vm.pop(Bt),!0},primitiveLoadImageSegment:function(Bt){var Yt=this.stackNonInteger(1),Zt=this.stackNonInteger(0);if(!Yt.words||!Zt.pointers)return!1;var te=this.vm.image.loadImageSegment(Yt,Zt);return!!te&&this.popNandPushIfOK(Bt+1,te)}},"blocks/closures",{doBlockCopy:function(){var Bt=this.vm.stackValue(1),Yt=this.stackInteger(0),Zt=Bt;if(this.vm.isContext(Zt)||(this.success=!1),!this.success)return Bt;"number"==typeof Zt.pointers[Squeak.Context_method]&&(Zt=Zt.pointers[Squeak.BlockContext_home]);var te=Zt.pointersSize()-Zt.instSize(),ee=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassBlockContext],te),ie=this.vm.encodeSqueakPC(this.vm.pc+2,this.vm.method);return ee.pointers[Squeak.BlockContext_initialIP]=ie,ee.pointers[Squeak.Context_instructionPointer]=ie,ee.pointers[Squeak.Context_stackPointer]=0,ee.pointers[Squeak.BlockContext_argumentCount]=Yt,ee.pointers[Squeak.BlockContext_home]=Zt,ee.pointers[Squeak.Context_sender]=this.vm.nilObj,ee},primitiveBlockValue:function(Bt){var Yt=this.vm.stackValue(Bt);if(!this.isA(Yt,Squeak.splOb_ClassBlockContext))return!1;var Zt=Yt,te=Zt.pointers[Squeak.BlockContext_argumentCount];if("number"!=typeof te)return!1;if(te!=Bt)return!1;if(!Zt.pointers[Squeak.BlockContext_caller].isNil)return!1;this.vm.arrayCopy(this.vm.activeContext.pointers,this.vm.sp-Bt+1,Zt.pointers,Squeak.Context_tempFrameStart,Bt);var ee=Zt.pointers[Squeak.BlockContext_initialIP];return Zt.pointers[Squeak.Context_instructionPointer]=ee,Zt.pointers[Squeak.Context_stackPointer]=Bt,Zt.pointers[Squeak.BlockContext_caller]=this.vm.activeContext,this.vm.popN(Bt+1),this.vm.newActiveContext(Zt),!0},primitiveBlockValueWithArgs:function(Bt){var Yt=this.vm.stackValue(1),Zt=this.vm.stackValue(0);if(!this.isA(Yt,Squeak.splOb_ClassBlockContext))return!1;if(!this.isA(Zt,Squeak.splOb_ClassArray))return!1;var te=Yt.pointers[Squeak.BlockContext_argumentCount];if("number"!=typeof te)return!1;if(te!=Zt.pointersSize())return!1;if(!Yt.pointers[Squeak.BlockContext_caller].isNil)return!1;this.vm.arrayCopy(Zt.pointers,0,Yt.pointers,Squeak.Context_tempFrameStart,te);var ee=Yt.pointers[Squeak.BlockContext_initialIP];return Yt.pointers[Squeak.Context_instructionPointer]=ee,Yt.pointers[Squeak.Context_stackPointer]=te,Yt.pointers[Squeak.BlockContext_caller]=this.vm.activeContext,this.vm.popN(Bt+1),this.vm.newActiveContext(Yt),!0},primitiveClosureCopyWithCopiedValues:function(){return this.vm.breakNow("primitiveClosureCopyWithCopiedValues"),!1},primitiveClosureValue:function(Bt){var Yt=this.vm.stackValue(Bt);return Bt===Yt.pointers[Squeak.Closure_numArgs]&&this.activateNewClosureMethod(Yt,Bt)},primitiveClosureValueWithArgs:function(Bt){var Yt=this.vm.top(),Zt=Yt.pointersSize(),te=this.vm.stackValue(Bt);if(Zt!==te.pointers[Squeak.Closure_numArgs])return!1;this.vm.pop();for(var ee=0;Zt>ee;ee++)this.vm.push(Yt.pointers[ee]);return this.activateNewClosureMethod(te,Zt)},primitiveClosureValueNoContextSwitch:function(Bt){return this.primitiveClosureValue(Bt)},activateNewClosureMethod:function(Bt,Yt){var Zt=Bt.pointers[Squeak.Closure_outerContext],te=Zt.pointers[Squeak.Context_method],ee=this.vm.allocateOrRecycleContext(te.methodNeedsLargeFrame()),ie=Bt.pointers.length-Squeak.Closure_firstCopiedValue;ee.pointers[Squeak.Context_sender]=this.vm.activeContext,ee.pointers[Squeak.Context_instructionPointer]=Bt.pointers[Squeak.Closure_startpc],ee.pointers[Squeak.Context_stackPointer]=Yt+ie,ee.pointers[Squeak.Context_method]=Zt.pointers[Squeak.Context_method],ee.pointers[Squeak.Context_closure]=Bt,ee.pointers[Squeak.Context_receiver]=Zt.pointers[Squeak.Context_receiver];for(var re=Squeak.Context_tempFrameStart,se=0;Yt>se;se++)ee.pointers[re++]=this.vm.stackValue(Yt-se-1);for(se=0;ie>se;se++)ee.pointers[re++]=Bt.pointers[Squeak.Closure_firstCopiedValue+se];return this.vm.popN(Yt+1),this.vm.newActiveContext(ee),!0}},"scheduling",{primitiveResume:function(){return this.resume(this.vm.top()),!0},primitiveSuspend:function(){var Bt=this.getScheduler().pointers[Squeak.ProcSched_activeProcess];return this.vm.top()===Bt&&(this.vm.popNandPush(1,this.vm.nilObj),this.transferTo(this.pickTopProcess()),!0)},getScheduler:function(){return this.vm.specialObjects[Squeak.splOb_SchedulerAssociation].pointers[Squeak.Assn_value]},resume:function(Bt){var Yt=this.getScheduler().pointers[Squeak.ProcSched_activeProcess],Zt=Yt.pointers[Squeak.Proc_priority];Bt.pointers[Squeak.Proc_priority]>Zt?(this.putToSleep(Yt),this.transferTo(Bt)):this.putToSleep(Bt)},putToSleep:function(Bt){var Yt=Bt.pointers[Squeak.Proc_priority],Zt=this.getScheduler().pointers[Squeak.ProcSched_processLists].pointers[Yt-1];this.linkProcessToList(Bt,Zt)},transferTo:function(Bt){var Yt=this.getScheduler(),Zt=Yt.pointers[Squeak.ProcSched_activeProcess];Yt.pointers[Squeak.ProcSched_activeProcess]=Bt,Zt.pointers[Squeak.Proc_suspendedContext]=this.vm.activeContext,this.vm.newActiveContext(Bt.pointers[Squeak.Proc_suspendedContext]),Bt.pointers[Squeak.Proc_suspendedContext]=this.vm.nilObj,this.vm.reclaimableContextCount=0,this.vm.breakOnContextChanged&&(this.vm.breakOnContextChanged=!1,this.vm.breakNow())},pickTopProcess:function(){var Bt,Yt=this.getScheduler().pointers[Squeak.ProcSched_processLists],Zt=Yt.pointersSize()-1;do{if(0>Zt)throw Error("scheduler could not find a runnable process");Bt=Yt.pointers[Zt--]}while(this.isEmptyList(Bt));return this.removeFirstLinkOfList(Bt)},linkProcessToList:function(Bt,Yt){this.isEmptyList(Yt)?Yt.pointers[Squeak.LinkedList_firstLink]=Bt:Yt.pointers[Squeak.LinkedList_lastLink].pointers[Squeak.Link_nextLink]=Bt;Yt.pointers[Squeak.LinkedList_lastLink]=Bt,Bt.pointers[Squeak.Proc_myList]=Yt},isEmptyList:function(Bt){return Bt.pointers[Squeak.LinkedList_firstLink].isNil},removeFirstLinkOfList:function(Bt){var Yt=Bt.pointers[Squeak.LinkedList_firstLink];if(Yt===Bt.pointers[Squeak.LinkedList_lastLink])Bt.pointers[Squeak.LinkedList_firstLink]=this.vm.nilObj,Bt.pointers[Squeak.LinkedList_lastLink]=this.vm.nilObj;else{var Zt=Yt.pointers[Squeak.Link_nextLink];Bt.pointers[Squeak.LinkedList_firstLink]=Zt}return Yt.pointers[Squeak.Link_nextLink]=this.vm.nilObj,Yt},registerSemaphore:function(Bt){var Yt=this.vm.top();return this.vm.specialObjects[Bt]=this.isA(Yt,Squeak.splOb_ClassSemaphore)?Yt:this.vm.nilObj,this.vm.stackValue(1)},primitiveWait:function(){var Bt=this.vm.top();if(!this.isA(Bt,Squeak.splOb_ClassSemaphore))return!1;var Yt=Bt.pointers[Squeak.Semaphore_excessSignals];if(Yt>0)Bt.pointers[Squeak.Semaphore_excessSignals]=Yt-1;else{var Zt=this.getScheduler().pointers[Squeak.ProcSched_activeProcess];this.linkProcessToList(Zt,Bt),this.transferTo(this.pickTopProcess())}return!0},primitiveSignal:function(){var Bt=this.vm.top();return!!this.isA(Bt,Squeak.splOb_ClassSemaphore)&&(this.synchronousSignal(Bt),!0)},synchronousSignal:function(Bt){this.isEmptyList(Bt)?Bt.pointers[Squeak.Semaphore_excessSignals]++:this.resume(this.removeFirstLinkOfList(Bt))},primitiveSignalAtMilliseconds:function(Bt){var Yt=this.stackInteger(0),Zt=this.stackNonInteger(1);return this.stackNonInteger(2),!!this.success&&(this.isA(Zt,Squeak.splOb_ClassSemaphore)?(this.vm.specialObjects[Squeak.splOb_TheTimerSemaphore]=Zt,this.vm.nextWakeupTick=Yt):(this.vm.specialObjects[Squeak.splOb_TheTimerSemaphore]=this.vm.nilObj,this.vm.nextWakeupTick=0),this.vm.popN(Bt),!0)},signalSemaphoreWithIndex:function(Bt){this.semaphoresToSignal.push(Bt)},signalExternalSemaphores:function(){for(var Bt=this.vm.specialObjects[Squeak.splOb_ExternalObjectsArray].pointers,Yt=this.vm.specialObjects[Squeak.splOb_ClassSemaphore];this.semaphoresToSignal.length;){var Zt=Bt[this.semaphoresToSignal.shift()-1];Zt.sqClass==Yt&&this.synchronousSignal(Zt)}}},"vm functions",{primitiveGetAttribute:function(Bt){var Yt,Zt=this.stackInteger(0);if(!this.success)return!1;switch(Zt){case 0:Yt=this.filenameToSqueak(Squeak.vmPath+Squeak.vmFile);break;case 1:case 2:Yt=this.display.documentName||null;break;case 1001:Yt=Squeak.platformName;break;case 1002:Yt=Squeak.osVersion;break;case 1003:Yt=Squeak.platformSubtype;break;case 1004:case 1007:case 1009:Yt=Squeak.vmVersion;break;case 1005:Yt=Squeak.windowSystem;break;case 1006:Yt=Squeak.vmBuild;break;default:return!1}return this.vm.popNandPush(Bt+1,this.makeStObject(Yt)),!0},setLowSpaceThreshold:function(){var Bt=this.stackInteger(0);return this.success&&(this.vm.lowSpaceThreshold=Bt),this.vm.stackValue(1)},primitiveVMParameter:function(Bt){switch(Bt){case 0:for(var Yt=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassArray],41),Zt=0;41>Zt;Zt++)Yt.pointers[Zt]=this.makeStObject(this.vmParameterAt(Zt+1));return this.popNandPushIfOK(1,Yt);case 1:var te=this.stackInteger(0);return this.popNandPushIfOK(2,this.makeStObject(this.vmParameterAt(te)));case 2:return this.popNandPushIfOK(3,0)}return!1},vmParameterAt:function(Bt){switch(Bt){case 1:case 2:return this.vm.image.oldSpaceBytes;case 3:return this.vm.image.totalMemory;case 4:return this.vm.image.allocationCount+this.vm.image.newSpaceCount;case 7:return this.vm.image.gcCount;case 8:return this.vm.image.gcMilliseconds;case 9:return 1;case 10:return 0;case 11:return this.vm.image.gcTenured;case 40:return 4;case 41:return this.vm.image.formatVersion()}return null},primitiveImageName:function(Bt){return 0==Bt?this.popNandPushIfOK(1,this.makeStString(this.filenameToSqueak(this.vm.image.name))):(this.vm.image.name=this.filenameFromSqueak(this.vm.top().bytesAsString()),window.localStorage.squeakImageName=this.vm.image.name,!0)},primitiveSnapshot:function(){this.vm.popNandPush(1,this.vm.trueObj),this.vm.storeContextRegisters(),this.getScheduler().pointers[Squeak.ProcSched_activeProcess].pointers[Squeak.Proc_suspendedContext]=this.vm.activeContext,this.vm.image.fullGC("snapshot");var Bt=this.vm.image.writeToBuffer();return Squeak.flushAllFiles(),Squeak.filePut(this.vm.image.name,Bt),this.vm.popNandPush(1,this.vm.falseObj),!0},primitiveQuit:function(){return Squeak.flushAllFiles(),this.display.quitFlag=!0,this.vm.breakNow("quit"),!0},primitiveExitToDebugger:function(){return this.vm.breakNow("debugger primitive"),!0},primitiveSetGCBiasToGrow:function(Bt){return this.fakePrimitive(".primitiveSetGCBiasToGrow",0,Bt)},primitiveSetGCBiasToGrowGCLimit:function(Bt){return this.fakePrimitive(".primitiveSetGCBiasToGrowGCLimit",0,Bt)}},"display",{primitiveBeCursor:function(Bt){if(this.display.cursorCanvas){var Yt=this.loadForm(this.stackNonInteger(Bt),!0),Zt=1===Bt?this.loadForm(this.stackNonInteger(0)):null;if(!this.success||!Yt)return!1;var te=this.display.cursorCanvas,ee=te.getContext("2d"),ie={left:0,top:0,right:Yt.width,bottom:Yt.height};te.width=Yt.width,te.height=Yt.height,1===Yt.depth?Zt?(Yt=this.cursorMergeMask(Yt,Zt),this.showForm(ee,Yt,ie,[0,4278190335,4294967295,4278190080])):this.showForm(ee,Yt,ie,[0,4278190080]):this.showForm(ee,Yt,ie,!0);var re=this.display.context.canvas,se=re.offsetWidth/re.width;te.style.width=(te.width*se|0)+"px",te.style.height=(te.height*se|0)+"px",this.display.cursorOffsetX=Yt.offsetX*se|0,this.display.cursorOffsetY=Yt.offsetY*se|0}return this.vm.popN(Bt),!0},cursorMergeMask:function(Bt,Yt){for(var Zt=new Uint32Array(16),te=0;16>te;te++){for(var ee=Bt.bits[te],ie=Yt.bits[te],re=2147483648,se=0,ne=0;16>ne;ne++)se=se|(ie&re)>>ne|(ee&re)>>ne+1,re>>>=1;Zt[te]=se}return{obj:Bt.obj,bits:Zt,depth:2,width:16,height:16,offsetX:Bt.offsetX,offsetY:Bt.offsetY,msb:!0,pixPerWord:16,pitch:1}},primitiveBeDisplay:function(Bt){var Yt=this.vm.stackValue(0);return this.vm.specialObjects[Squeak.splOb_TheDisplay]=Yt,this.vm.popN(Bt),!0},primitiveReverseDisplay:function(){if(this.reverseDisplay=!this.reverseDisplay,this.redrawDisplay(),this.display.cursorCanvas){for(var Bt=this.display.cursorCanvas,Yt=Bt.getContext("2d"),Zt=Yt.getImageData(0,0,Bt.width,Bt.height),te=new Uint32Array(Zt.data.buffer),ee=0;ee<te.length;ee++)te[ee]=16777215^te[ee];Yt.putImageData(Zt,0,0)}return!0},primitiveShowDisplayRect:function(Bt){var Yt={left:this.stackInteger(3),top:this.stackInteger(1),right:this.stackInteger(2),bottom:this.stackInteger(0)};return!!this.success&&(this.redrawDisplay(Yt),this.vm.popN(Bt),!0)},redrawDisplay:function(Bt){var Yt=this.theDisplay(),Zt={left:0,top:0,right:Yt.width,bottom:Yt.height};Bt&&(Bt.left>Zt.left&&(Zt.left=Bt.left),Bt.right<Zt.right&&(Zt.right=Bt.right),Bt.top>Zt.top&&(Zt.top=Bt.top),Bt.bottom<Zt.bottom&&(Zt.bottom=Bt.bottom)),Zt.left<Zt.right&&Zt.top<Zt.bottom&&this.displayUpdate(Yt,Zt)},showForm:function(Bt,Yt,Zt,te){if(Zt){var ee=Zt.left,ie=Zt.top,re=Zt.right-ee,se=Zt.bottom-ie,ne=Bt.createImageData(re,se),ae=ne.data;ae.buffer||(ae=new Uint8Array(re*se*4));var oe=new Uint32Array(ae.buffer);switch(Yt.depth){case 1:case 2:case 4:case 8:var ue=te||this.swappedColors;if(!ue){ue=[];for(var le=0;256>le;le++){var ce=(4278255360&(Fe=this.indexedColors[le]))+((16711680&Fe)>>16)+((255&Fe)<<16);ue[le]=ce}this.swappedColors=ue}this.reverseDisplay&&(te?ue=te.map((function(Bt){return 16777215^Bt})):(this.reversedColors||(this.reversedColors=ue.map((function(Bt){return 16777215^Bt}))),ue=this.reversedColors));for(var fe=(1<<Yt.depth)-1,he=32-(ee%Yt.pixPerWord+1)*Yt.depth,pe=0;se>pe;pe++){for(var de=Yt.pitch*ie+(ee/Yt.pixPerWord|0),me=he,ve=Yt.bits[de],ke=ne.width*pe,ge=0;re>ge;ge++)oe[ke++]=ue[ve>>>me&fe],(me-=Yt.depth)<0&&(me=32-Yt.depth,ve=Yt.bits[++de]);ie++}break;case 16:for(he=ee%2?0:16,pe=0;se>pe;pe++){for(de=Yt.pitch*ie+(ee/2|0),me=he,ve=Yt.bits[de],ke=ne.width*pe,ge=0;re>ge;ge++){var be=ve>>>me;oe[ke++]=((31744&be)>>7)+((992&be)<<6)+((31&be)<<19)+4278190080,(me-=16)<0&&(me=16,ve=Yt.bits[++de])}ie++}break;case 32:var ye=te?0:4278190080;for(pe=0;se>pe;pe++){for(de=Yt.pitch*ie+ee,ke=ne.width*pe,ge=0;re>ge;ge++){var Fe;ce=4278255360&(Fe=Yt.bits[de++])|(16711680&Fe)>>16|(255&Fe)<<16|ye;oe[ke++]=ce}ie++}break;default:throw Error("depth not implemented")}ne.data!==ae&&ne.data.set(ae),Bt.putImageData(ne,Zt.left,Zt.top)}},primitiveDeferDisplayUpdates:function(Bt){var Yt=this.stackBoolean(0);return!!this.success&&(this.deferDisplayUpdates=Yt,this.vm.popN(Bt),!0)},primitiveForceDisplayUpdate:function(Bt){return this.vm.breakOut(),this.vm.popN(Bt),!0},primitiveScreenSize:function(Bt){var Yt=this.display,Zt=Yt.width||Yt.context.canvas.width,te=Yt.height||Yt.context.canvas.height;return this.popNandPushIfOK(Bt+1,this.makePointWithXandY(Zt,te))},primitiveSetFullScreen:function(Bt){var Yt=this.stackBoolean(0);if(!this.success)return!1;if(this.display.fullscreen!=Yt)if(this.display.fullscreenRequest){var Zt=this.vm.freeze();this.display.fullscreenRequest(Yt,(function(){Zt()}))}else this.display.fullscreen=Yt,this.vm.breakOut();return this.vm.popN(Bt),!0},primitiveTestDisplayDepth:function(){return this.pop2andPushBoolIfOK([1,2,4,8,16,32].indexOf(this.stackInteger(0))>=0)},loadForm:function(Bt,Yt){if(Bt.isNil)return null;var Zt={obj:Bt,bits:Bt.pointers[Squeak.Form_bits].wordsOrBytes(),depth:Bt.pointers[Squeak.Form_depth],width:Bt.pointers[Squeak.Form_width],height:Bt.pointers[Squeak.Form_height]};if(Yt){var te=Bt.pointers[Squeak.Form_offset];Zt.offsetX=te.pointers?te.pointers[Squeak.Point_x]:0,Zt.offsetY=te.pointers?te.pointers[Squeak.Point_y]:0}return 0===Zt.width||0===Zt.height?Zt:Zt.width>0&&Zt.height>0?(Zt.msb=Zt.depth>0,Zt.msb||(Zt.depth=-Zt.depth),Zt.depth>0?(Zt.pixPerWord=32/Zt.depth,Zt.pitch=(Zt.width+(Zt.pixPerWord-1))/Zt.pixPerWord|0,Zt.bits.length!==Zt.pitch*Zt.height?null:Zt):null):null},theDisplay:function(){return this.loadForm(this.vm.specialObjects[Squeak.splOb_TheDisplay])},displayDirty:function(Bt,Yt){this.deferDisplayUpdates||Bt!=this.vm.specialObjects[Squeak.splOb_TheDisplay]||this.displayUpdate(this.theDisplay(),Yt)},displayUpdate:function(Bt,Yt){this.showForm(this.display.context,Bt,Yt),this.display.lastTick=this.vm.lastTick,this.display.idle=0},primitiveBeep:function(Bt){var Yt=Squeak.startAudioOut();if(Yt){var Zt=Yt.createOscillator();Zt.connect(Yt.destination),Zt.frequency.value=880,Zt.noteOn(0),Zt.noteOff(Yt.currentTime+.2)}else this.vm.warnOnce("could not initialize audio");return this.popNIfOK(Bt)}},"input",{primitiveClipboardText:function(Bt){if(0===Bt){if("string"!=typeof this.display.clipboardString)return!1;this.vm.popNandPush(1,this.makeStString(this.display.clipboardString))}else if(1===Bt){var Yt=this.vm.top();Yt.bytes&&(this.display.clipboardString=Yt.bytesAsString(),this.display.clipboardStringChanged=!0),this.vm.pop()}return!0},primitiveKeyboardNext:function(Bt){return this.popNandPushIfOK(Bt+1,this.ensureSmallInt(this.display.keys.shift()))},primitiveKeyboardPeek:function(Bt){var Yt=this.display.keys.length;return this.popNandPushIfOK(Bt+1,Yt?this.ensureSmallInt(this.display.keys[0]||0):this.vm.nilObj)},primitiveMouseButtons:function(Bt){return this.popNandPushIfOK(Bt+1,this.ensureSmallInt(this.display.buttons)),this.vm.breakOut(),this.display.idle++>20&&this.vm.goIdle(),!0},primitiveMousePoint:function(Bt){var Yt=this.ensureSmallInt(this.display.mouseX),Zt=this.ensureSmallInt(this.display.mouseY);return this.popNandPushIfOK(Bt+1,this.makePointWithXandY(Yt,Zt))},primitiveInputSemaphore:function(){var Bt=this.stackInteger(0);return!!this.success&&(this.inputEventSemaIndex=Bt,this.display.signalInputEvent=function(){this.signalSemaphoreWithIndex(this.inputEventSemaIndex)}.bind(this),!0)},primitiveInputWord:function(){return this.popNandPushIfOK(1,0)},primitiveGetNextEvent:function(){this.display.idle++;var Bt=this.stackNonInteger(0);return!!this.display.getNextEvent&&(this.display.getNextEvent(Bt.pointers,this.vm.startupTime),!0)}},"time",{primitiveRelinquishProcessorForMicroseconds:function(Bt){return this.vm.pop(Bt),this.vm.goIdle(),!0},millisecondClockValue:function(){return Date.now()-this.vm.startupTime&Squeak.MillisecondClockMask},millisecondClockValueSet:function(Bt){this.vm.startupTime=Date.now()-Bt},secondClock:function(){return this.pos32BitIntFor(Squeak.totalSeconds())},microsecondClockUTC:function(){var Bt=Date.now()-Squeak.EpochUTC;return this.pos64BitIntFor(1e3*Bt)},microsecondClockLocal:function(){var Bt=Date.now()-Squeak.Epoch;return this.pos64BitIntFor(1e3*Bt)}},"FilePlugin",{primitiveDirectoryCreate:function(Bt){var Yt=this.stackNonInteger(0);if(!this.success)return!1;var Zt=this.filenameFromSqueak(Yt.bytesAsString());if(this.success=Squeak.dirCreate(Zt),!this.success){var te=Squeak.splitFilePath(Zt);console.log("Directory not created: "+te.fullname)}return this.popNIfOK(Bt)},primitiveDirectoryDelete:function(Bt){var Yt=this.stackNonInteger(0);if(!this.success)return!1;var Zt=this.filenameFromSqueak(Yt.bytesAsString());return this.success=Squeak.dirDelete(Zt),this.popNIfOK(Bt)},primitiveDirectoryDelimitor:function(){var Bt=this.emulateMac?":":"/";return this.popNandPushIfOK(1,this.charFromInt(Bt.charCodeAt(0)))},primitiveDirectoryEntry:function(){return this.vm.warnOnce("Not yet implemented: primitiveDirectoryEntry"),!1},primitiveDirectoryLookup:function(Bt){var Yt=this.stackInteger(0),Zt=this.stackNonInteger(1);if(!this.success)return!1;var te=Zt.bytesAsString(),ee=this.filenameFromSqueak(te),ie=Squeak.dirList(ee,!0);if(!ie){var re=Squeak.splitFilePath(ee);return console.log("Directory not found: "+re.fullname),!1}var se=ie[Object.keys(ie).sort()[Yt-1]];return"/"===te&&(1===Yt?(se||(se=[0,0,0,0,0]),se[0]="SqueakJS",se[3]=!0):se=null),this.popNandPushIfOK(Bt+1,this.makeStObject(se)),!0},primitiveDirectorySetMacTypeAndCreator:function(Bt){return this.popNIfOK(Bt)},primitiveFileAtEnd:function(Bt){var Yt=this.stackNonInteger(0);return!(!this.success||!Yt.file)&&(this.popNandPushIfOK(Bt+1,this.makeStObject(Yt.filePos>=Yt.file.size)),!0)},primitiveFileClose:function(Bt){var Yt=this.stackNonInteger(0);return!(!this.success||!Yt.file)&&(this.fileClose(Yt.file),this.vm.breakOut(),Yt.file=null,this.popNIfOK(Bt))},primitiveFileDelete:function(Bt){var Yt=this.stackNonInteger(0);if(!this.success)return!1;var Zt=this.filenameFromSqueak(Yt.bytesAsString());return this.success=Squeak.fileDelete(Zt),this.popNIfOK(Bt)},primitiveFileFlush:function(Bt){var Yt=this.stackNonInteger(0);return!(!this.success||!Yt.file)&&(Squeak.flushFile(Yt.file),this.vm.breakOut(),this.popNIfOK(Bt))},primitiveFileGetPosition:function(Bt){var Yt=this.stackNonInteger(0);return!(!this.success||!Yt.file)&&(this.popNandPushIfOK(Bt+1,this.makeLargeIfNeeded(Yt.filePos)),!0)},primitiveFileOpen:function(Bt){var Yt=this.stackBoolean(0),Zt=this.stackNonInteger(1);if(!this.success)return!1;var te=this.filenameFromSqueak(Zt.bytesAsString()),ee=this.fileOpen(te,Yt);if(!ee)return!1;var ie=this.makeStArray([ee.name]);return ie.file=ee,ie.fileWrite=Yt,ie.filePos=0,this.popNandPushIfOK(Bt+1,ie),!0},primitiveFileRead:function(Bt){var Yt=this.stackInteger(0),Zt=this.stackInteger(1)-1,te=this.stackNonInteger(2),ee=this.stackNonInteger(3);return!(!this.success||!ee.file)&&(Yt?te.bytes?!(0>Zt||Zt+Yt>te.bytes.length)&&this.fileContentsDo(ee.file,function(ie){if(!ie.contents)return this.popNandPushIfOK(Bt+1,0);var re=ie.contents,se=te.bytes;Yt=Math.min(Yt,ie.size-ee.filePos);for(var ne=0;Yt>ne;ne++)se[Zt+ne]=re[ee.filePos++];this.popNandPushIfOK(Bt+1,Yt)}.bind(this)):(console.log("File reading into non-bytes object not implemented yet"),!1):this.popNandPushIfOK(Bt+1,0))},primitiveFileRename:function(Bt){var Yt=this.stackNonInteger(1),Zt=this.stackNonInteger(0);if(!this.success)return!1;var te=this.filenameFromSqueak(Yt.bytesAsString()),ee=this.filenameFromSqueak(Zt.bytesAsString());return this.success=Squeak.fileRename(te,ee),this.vm.breakOut(),this.popNIfOK(Bt)},primitiveFileSetPosition:function(Bt){var Yt=this.stackPos32BitInt(0),Zt=this.stackNonInteger(1);return!(!this.success||!Zt.file)&&(Zt.filePos=Yt,this.popNIfOK(Bt))},primitiveFileSize:function(Bt){var Yt=this.stackNonInteger(0);return!(!this.success||!Yt.file)&&(this.popNandPushIfOK(Bt+1,this.makeLargeIfNeeded(Yt.file.size)),!0)},primitiveFileStdioHandles:function(){return this.vm.warnOnce("Not yet implemented: primitiveFileStdioHandles"),!1},primitiveFileTruncate:function(){return console.warn("Not yet implemented: primitiveFileTruncate"),!1},primitiveDisableFileAccess:function(Bt){return this.fakePrimitive("FilePlugin.primitiveDisableFileAccess",0,Bt)},primitiveFileWrite:function(Bt){var Yt=this.stackInteger(0),Zt=this.stackInteger(1)-1,te=this.stackNonInteger(2),ee=this.stackNonInteger(3);if(!this.success||!ee.file||!ee.fileWrite)return!1;if(!Yt)return this.popNandPushIfOK(Bt+1,0);var ie=te.bytes||te.wordsAsUint8Array();return!!ie&&(!(0>Zt||Zt+Yt>ie.length)&&this.fileContentsDo(ee.file,function(te){var re=ie,se=te.contents||[];if(ee.filePos+Yt>se.length){var ne=0===se.length?ee.filePos+Yt:Math.max(ee.filePos+Yt,se.length+1e4);te.contents=new Uint8Array(ne),te.contents.set(se),se=te.contents}for(var ae=0;Yt>ae;ae++)se[ee.filePos++]=re[Zt+ae];ee.filePos>te.size&&(te.size=ee.filePos),te.modified=!0,this.popNandPushIfOK(Bt+1,Yt)}.bind(this)))},fileOpen:function(Bt,Yt){"undefined"==typeof SqueakFiles&&(window.SqueakFiles={});var Zt=Squeak.splitFilePath(Bt);if(!Zt.basename)return null;var te=Squeak.dirList(Zt.dirname,!0);if(!te)return null;var ee=te[Zt.basename],ie=null;if(ee){if(re=SqueakFiles[Zt.fullname])return++re.refCount,re}else{if(!Yt)return console.log("File not found: "+Zt.fullname),null;if(ie=new Uint8Array,!(ee=Squeak.filePut(Zt.fullname,ie.buffer)))return console.log("Cannot create file: "+Zt.fullname),null}var re={name:Zt.fullname,size:ee[4],contents:ie,modified:!1,refCount:1};return SqueakFiles[re.name]=re,re},fileClose:function(Bt){Squeak.flushFile(Bt),0==--Bt.refCount&&delete SqueakFiles[Bt.name]},fileContentsDo:function(Bt,Yt){if(Bt.contents)Yt(Bt);else{if(!1===Bt.contents)return!1;this.vm.freeze(function(Zt){Squeak.fileGet(Bt.name,function(te){Bt.contents=this.asUint8Array(te),Zt(),Yt(Bt)}.bind(this),function(te){console.log("File get failed: "+te),Bt.contents=!1,Zt(),Yt(Bt)}.bind(this))}.bind(this))}return!0}},"DropPlugin",{primitiveDropRequestFileHandle:function(Bt){var Yt=this.stackInteger(0),Zt=this.display.droppedFiles||[];if(1>Yt||Yt>Zt.length)return!1;var te=Zt[Yt-1],ee=this.fileOpen(te,!1);if(!ee)return!1;var ie=this.makeStArray([te]);return ie.file=ee,ie.fileWrite=!1,ie.filePos=0,this.popNandPushIfOK(Bt+1,ie),!0},primitiveDropRequestFileName:function(Bt){var Yt=this.stackInteger(0),Zt=this.display.droppedFiles||[];if(1>Yt||Yt>Zt.length)return!1;var te=this.makeStString(this.filenameToSqueak(Zt[Yt-1]));return this.popNandPushIfOK(Bt,te)}},"SoundPlugin",{snd_primitiveSoundStart:function(Bt){return this.snd_primitiveSoundStartWithSemaphore(Bt)},snd_primitiveSoundStartWithSemaphore:function(Bt){var Yt=this.stackInteger(Bt-1),Zt=this.stackInteger(Bt-2),te=this.stackBoolean(Bt-3),ee=Bt>3?this.stackInteger(Bt-4):0;return!!this.success&&(this.audioContext=Squeak.startAudioOut(),this.audioContext?(this.audioSema=ee,this.audioNextTimeSlot=0,this.audioBuffersReady=[],this.audioBuffersUnused=[this.audioContext.createBuffer(te?2:1,Yt,Zt),this.audioContext.createBuffer(te?2:1,Yt,Zt)],console.log("sound: started"),this.popNIfOK(Bt)):(this.vm.warnOnce("could not initialize audio"),!1))},snd_playNextBuffer:function(){if(this.audioContext&&0!==this.audioBuffersReady.length){var Bt=this.audioContext.createBufferSource();Bt.buffer=this.audioBuffersReady.shift(),Bt.connect(this.audioContext.destination),this.audioNextTimeSlot<this.audioContext.currentTime&&(this.audioNextTimeSlot>0&&console.warn("sound "+this.audioContext.currentTime.toFixed(3)+": buffer underrun by "+(this.audioContext.currentTime-this.audioNextTimeSlot).toFixed(3)+" s"),this.audioNextTimeSlot=this.audioContext.currentTime),Bt.start(this.audioNextTimeSlot),this.audioNextTimeSlot+=Bt.buffer.duration,window.setTimeout(function(){this.audioContext&&(this.audioBuffersUnused.push(Bt.buffer),this.audioSema&&this.signalSemaphoreWithIndex(this.audioSema),this.vm.forceInterruptCheck())}.bind(this),1e3*(this.audioNextTimeSlot-this.audioContext.currentTime)),this.snd_playNextBuffer()}},snd_primitiveSoundAvailableSpace:function(Bt){if(!this.audioContext)return console.log("sound: no audio context"),!1;var Yt=0;if(this.audioBuffersUnused.length>0){var Zt=this.audioBuffersUnused[0];Yt=Zt.length*Zt.numberOfChannels*2}return this.popNandPushIfOK(Bt+1,Yt)},snd_primitiveSoundPlaySamples:function(Bt){if(!this.audioContext||0===this.audioBuffersUnused.length)return console.log("sound: play but no free buffers"),!1;var Yt=this.stackInteger(2),Zt=this.stackNonInteger(1).wordsAsInt16Array(),te=this.stackInteger(0)-1;if(!this.success||!Zt)return!1;for(var ee=this.audioBuffersUnused.shift(),ie=ee.numberOfChannels,re=0;ie>re;re++)for(var se=ee.getChannelData(re),ne=te+re,ae=0;Yt>ae;ae++)se[ae]=Zt[ne]/32768,ne+=ie;return this.audioBuffersReady.push(ee),this.snd_playNextBuffer(),this.popNIfOK(Bt)},snd_primitiveSoundPlaySilence:function(Bt){if(!this.audioContext||0===this.audioBuffersUnused.length)return console.log("sound: play but no free buffers"),!1;for(var Yt=this.audioBuffersUnused.shift(),Zt=Yt.numberOfChannels,te=Yt.length,ee=0;Zt>ee;ee++)for(var ie=Yt.getChannelData(ee),re=0;te>re;re++)ie[re]=0;return this.audioBuffersReady.push(Yt),this.snd_playNextBuffer(),this.popNandPushIfOK(Bt+1,te)},snd_primitiveSoundStop:function(Bt){return this.audioContext&&(this.audioContext=null,this.audioBuffersReady=null,this.audioBuffersUnused=null,this.audioNextTimeSlot=0,this.audioSema=0,console.log("sound: stopped")),this.popNIfOK(Bt)},snd_primitiveSoundStartRecording:function(Bt){if(3!==Bt)return!1;var Yt=this.stackNonInteger(3),Zt=this.stackInteger(2),te=this.stackBoolean(1),ee=this.stackInteger(0);if(!this.success)return!1;var ie=this.primMethod,re=this.vm.freeze(),se=this;return Squeak.startAudioIn((function(Yt,ie){for(console.log("sound: recording started"),se.audioInContext=Yt,se.audioInSource=ie,se.audioInSema=ee,se.audioInBuffers=[],se.audioInBufferIndex=0,se.audioInOverSample=1;Zt*se.audioInOverSample<se.audioInContext.sampleRate;)se.audioInOverSample*=2;for(var ne=1024*se.audioInOverSample;ne/se.audioInContext.sampleRate<.1;)ne*=2;se.audioInProcessor=Yt.createScriptProcessor(ne,te?2:1,te?2:1),se.audioInProcessor.onaudioprocess=function(Bt){se.snd_recordNextBuffer(Bt.inputBuffer)},se.audioInSource.connect(se.audioInProcessor),se.audioInProcessor.connect(Yt.destination),se.vm.popN(Bt),window.setTimeout(re,0)}),(function(Zt){console.warn(Zt),se.vm.sendAsPrimitiveFailure(Yt,ie,Bt),window.setTimeout(re,0)})),!0},snd_recordNextBuffer:function(Bt){this.audioInContext&&(this.audioInBuffers.length>5&&this.audioInBuffers.shift(),this.audioInBuffers.push(Bt),this.audioInSema&&this.signalSemaphoreWithIndex(this.audioInSema),this.vm.forceInterruptCheck())},snd_primitiveSoundGetRecordingSampleRate:function(Bt){if(!this.audioInContext)return!1;var Yt=this.audioInContext.sampleRate/this.audioInOverSample|0;return console.log("sound: actual recording rate "+Yt+"x"+this.audioInOverSample),this.popNandPushIfOK(Bt+1,Yt)},snd_primitiveSoundRecordSamples:function(Bt){var Yt=this.stackNonInteger(1).wordsAsInt16Array(),Zt=this.stackInteger(0)-1;if(!this.success)return!1;for(var te=0;Zt<Yt.length&&0!==this.audioInBuffers.length;){for(var ee=this.audioInBuffers[0],ie=ee.numberOfChannels,re=ie,se=this.audioInOverSample,ne=(Yt.length-Zt)/re,ae=(ee.length-this.audioInBufferIndex)/se,oe=Math.min(ae,ne),ue=0;ie>ue;ue++)for(var le=ee.getChannelData(ue),ce=this.audioInBufferIndex,fe=Zt+ue,he=0;oe>he;he++)Yt[fe]=32768*le[ce]&65535,fe+=re,ce+=se;te+=oe*ie,Zt+=oe*ie,ce<ee.length?this.audioInBufferIndex=ce:(this.audioInBufferIndex=0,this.audioInBuffers.shift())}return this.popNandPushIfOK(Bt+1,te)},snd_primitiveSoundStopRecording:function(){return this.audioInContext&&(this.audioInSource.disconnect(),this.audioInProcessor.disconnect(),this.audioInContext=null,this.audioInSema=0,this.audioInBuffers=null,this.audioInSource=null,this.audioInProcessor=null,console.log("sound recording stopped")),!0},snd_primitiveSoundSetRecordLevel:function(){return!0}},"JPEGReadWriter2Plugin",{jpeg2_primJPEGPluginIsPresent:function(Bt){return this.popNandPushIfOK(Bt+1,this.vm.trueObj)},jpeg2_primImageHeight:function(Bt){var Yt=this.stackNonInteger(0).wordsOrBytes();if(!Yt)return!1;var Zt=Yt[1];return this.popNandPushIfOK(Bt+1,Zt)},jpeg2_primImageWidth:function(Bt){var Yt=this.stackNonInteger(0).wordsOrBytes();if(!Yt)return!1;var Zt=Yt[0];return this.popNandPushIfOK(Bt+1,Zt)},jpeg2_primJPEGCompressStructSize:function(Bt){return this.popNandPushIfOK(Bt+1,0)},jpeg2_primJPEGDecompressStructSize:function(Bt){return this.popNandPushIfOK(Bt+1,8)},jpeg2_primJPEGErrorMgr2StructSize:function(Bt){return this.popNandPushIfOK(Bt+1,0)},jpeg2_primJPEGReadHeaderfromByteArrayerrorMgr:function(Bt){var Yt=this.stackNonInteger(2).wordsOrBytes(),Zt=this.stackNonInteger(1).bytes;if(!Yt||!Zt)return!1;var te=this.vm.freeze();return this.jpeg2_readImageFromBytes(Zt,function(Bt){this.jpeg2state={src:Zt,img:Bt},Yt[0]=Bt.width,Yt[1]=Bt.height,te()}.bind(this),function(){Yt[0]=0,Yt[1]=0,te()}.bind(this)),this.popNIfOK(Bt)},jpeg2_primJPEGReadImagefromByteArrayonFormdoDitheringerrorMgr:function(Bt){var Yt=this.stackNonInteger(3).bytes,Zt=this.stackNonInteger(2).pointers,te=this.stackBoolean(1);if(!this.success||!Yt||!Zt)return!1;var ee=this.jpeg2state;if(!ee||ee.src!==Yt)return console.error("jpeg read did not match header info"),!1;var ie=Zt[Squeak.Form_depth],re=this.jpeg2_getPixelsFromImage(ee.img),se=Zt[Squeak.Form_bits].words;if(32===ie)this.jpeg2_copyPixelsToForm32(re,se);else{if(16!==ie)return!1;te?this.jpeg2_ditherPixelsToForm16(re,se):this.jpeg2_copyPixelsToForm16(re,se)}return this.popNIfOK(Bt)},jpeg2_primJPEGWriteImageonByteArrayformqualityprogressiveJPEGerrorMgr:function(){return this.vm.warnOnce("JPEGReadWritePlugin2: writing not implemented yet"),!1},jpeg2_readImageFromBytes:function(Bt,Yt,Zt){var te=new Blob([Bt],{type:"image/jpeg"}),ee=new Image;ee.onload=function(){Yt(ee)},ee.onerror=function(){console.warn("could not render JPEG"),Zt()},ee.src=(window.URL||window.webkitURL).createObjectURL(te)},jpeg2_getPixelsFromImage:function(Bt){var Yt=document.createElement("canvas"),Zt=Yt.getContext("2d");return Yt.width=Bt.width,Yt.height=Bt.height,Zt.drawImage(Bt,0,0),Zt.getImageData(0,0,Bt.width,Bt.height)},jpeg2_copyPixelsToForm32:function(Bt,Yt){for(var Zt=Bt.data,te=0;te<Yt.length;te++){var ee=Zt[4*te+0],ie=Zt[4*te+1],re=Zt[4*te+2];Yt[te]=4278190080|ee<<16|ie<<8|re}},jpeg2_copyPixelsToForm16:function(Bt,Yt){for(var Zt=Bt.width,te=Bt.height,ee=Bt.data,ie=0;te>ie;ie++)for(var re=0;Zt>re;re+=2){var se=ie*te+re,ne=ee[4*se+0]>>3<<10|ee[4*se+1]>>3<<5|ee[4*se+2]>>3;0===ne&&(ne=1),0==(65535&(ne=ne<<16|ee[4*se+4]>>3<<10|ee[4*se+5]>>3<<5|ee[4*se+6]>>3))&&(ne|=1),Yt[se>>1]=ne}},jpeg2_ditherPixelsToForm16:function(Bt,Yt){for(var Zt=Bt.width>>1,te=Bt.height,ee=Bt.data,ie=[2,0,14,12,1,3,13,15],re=[10,8,6,4,9,11,5,7],se=0;te>se;se++)for(var ne=0;Zt>ne;ne++){var ae,oe,ue=se*te+2*ne<<2,le=ee[ue+0],ce=ee[ue+1],fe=ee[ue+2],he=ee[ue+4],pe=ee[ue+5],de=ee[ue+6],me=(3&se)<<1|1&ne,ve=ie[me],ke=re[me];oe=(ae=496*le>>8)>>4,le=(15&ae)>ve?oe+1:oe,oe=(ae=496*ce>>8)>>4,ce=(15&ae)>ve?oe+1:oe,oe=(ae=496*fe>>8)>>4,fe=(15&ae)>ve?oe+1:oe,oe=(ae=496*he>>8)>>4,he=(15&ae)>ke?oe+1:oe,oe=(ae=496*pe>>8)>>4,pe=(15&ae)>ke?oe+1:oe,oe=(ae=496*de>>8)>>4;var ge=le<<10|ce<<5|fe;0===ge&&(ge=1),0==(65535&(ge=ge<<16|he<<10|pe<<5|(de=(15&ae)>ke?oe+1:oe)))&&(ge|=1),Yt[ue>>3]=ge}}},"ScratchPluginAdditions",{scratch_primitiveOpenURL:function(Yt){var Zt=this.stackNonInteger(0).bytesAsString();if(""==Zt)return!1;if(/^\/SqueakJS\//.test(Zt)){Zt=Zt.slice(10);var te=Squeak.splitFilePath(Zt),ee=Bt["squeak-template:"+te.dirname];ee&&(Zt=JSON.parse(ee).url+"/"+te.basename)}return window.open(Zt,"_blank"),this.popNIfOK(Yt)},scratch_primitiveGetFolderPath:function(Bt){var Yt,Zt=this.stackInteger(0);if(!this.success)return!1;if(1===Zt)Yt="/";return!!Yt&&(this.vm.popNandPush(Bt+1,this.makeStString(this.filenameToSqueak(Yt))),!0)}},"JavaScriptPlugin",{js_primitiveDoUnderstand:function(Bt){var Yt=this.stackNonInteger(1),Zt=this.js_objectOrGlobal(Yt),te=this.stackNonInteger(0).pointers,ee=te[0].bytesAsString(),ie=te[1].pointers||[],re=!("jsObject"in Yt),se=null;try{this.js_activeCallback="Callbacks must be asynchronous";var ne=ee.match(/([^:]*)/)[0];if(re||"new"!==ne){if(!(ne in Zt))return this.js_setError("Property not found: "+ne);var ae=Zt[ne];if("function"==typeof ae&&(!re||ie.length>0))se=ae.apply(Zt,this.js_fromStArray(ie));else if(0==ie.length)se=ae;else{if(1!=ie.length)return this.js_setError("Property "+ne+" is not a function");Zt[ne]=this.js_fromStObject(ie[0])}}else if(0===ie.length)se=new Zt;else{var oe=[null].concat(this.js_fromStArray(ie));se=new(Function.prototype.bind.apply(Zt,oe))}}catch(Bt){return this.js_setError(Bt.message)}finally{this.js_activeCallback=null}var ue=this.makeStObject(se,Yt.sqClass);return this.popNandPushIfOK(Bt+1,ue)},js_primitiveAsString:function(Bt){var Yt=this.js_objectOrGlobal(this.stackNonInteger(0));return this.popNandPushIfOK(Bt+1,this.makeStString(String(Yt)))},js_primitiveTypeof:function(Bt){var Yt=this.js_objectOrGlobal(this.stackNonInteger(0));return this.popNandPushIfOK(Bt+1,this.makeStString(typeof Yt))},js_primitiveAt:function(Bt){var Yt,Zt=this.stackNonInteger(1),te=this.vm.stackValue(0);try{var ee=this.js_objectOrGlobal(Zt)[this.js_fromStObject(te)];Yt=this.makeStObject(ee,Zt.sqClass)}catch(Bt){return this.js_setError(Bt.message)}return this.popNandPushIfOK(Bt+1,Yt)},js_primitiveAtPut:function(Bt){var Yt=this.stackNonInteger(2),Zt=this.vm.stackValue(1),te=this.vm.stackValue(0);try{var ee=this.js_objectOrGlobal(Yt),ie=this.js_fromStObject(Zt),re=this.js_fromStObject(te);ee[ie]=re}catch(Bt){return this.js_setError(Bt.message)}return this.popNandPushIfOK(Bt+1,te)},js_primitiveSqueakAsJSObject:function(Bt){var Yt=this.stackNonInteger(1),Zt=this.vm.stackValue(0);return this.success&&(Yt.jsObject=Zt),this.popNIfOK(Bt)},js_primitiveInitCallbacks:function(Bt){return this.js_callbackSema=this.stackInteger(0),this.js_activeCallback=null,this.popNIfOK(Bt)},js_primitiveGetActiveCallbackBlock:function(Bt){var Yt=this.js_activeCallback;return Yt?this.popNandPushIfOK(Bt,Yt.block):this.js_setError("No active callback")},js_primitiveGetActiveCallbackArgs:function(Bt){var Yt=this.stackNonInteger(Bt),Zt=this.js_activeCallback;if(!Zt)return this.js_setError("No active callback");try{var te=Zt.block.pointers[Squeak.BlockContext_argumentCount],ee=[];"number"!=typeof te&&(te=Zt.block.pointers[Squeak.Closure_numArgs]);for(var ie=0;te>ie;ie++)ee.push(Zt.args[ie]);return this.popNandPushIfOK(Bt,this.makeStArray(ee,Yt))}catch(Bt){return this.js_setError(Bt.message)}},js_primitiveReturnFromCallback:function(Bt){return 1===Bt&&(this.js_activeCallback?(this.js_activeCallback.result=this.vm.pop(),this.vm.breakOut(),!0):this.js_setError("No active callback"))},js_primitiveGetError:function(Bt){var Yt=this.makeStObject(this.js_error);return this.js_error=null,this.popNandPushIfOK(Bt+1,Yt)},js_setError:function(Bt){return this.js_error=String(Bt),!1},js_fromStObject:function(Bt){if("number"==typeof Bt)return Bt;if(Bt.jsObject)return Bt.jsObject;if(Bt.isFloat)return Bt.float;if(Bt.isNil)return null;if(Bt.isTrue)return!0;if(Bt.isFalse)return!1;if(Bt.bytes||Bt.sqClass===this.vm.specialObjects[Squeak.splOb_ClassString])return Bt.bytesAsString();if(Bt.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray])return this.js_fromStArray(Bt.pointers||[],!0);if(Bt.sqClass===this.vm.specialObjects[Squeak.splOb_ClassBlockContext]||Bt.sqClass===this.vm.specialObjects[Squeak.splOb_ClassBlockClosure])return this.js_fromStBlock(Bt);throw Error("asJSArgument needed for "+Bt)},js_fromStArray:function(Bt,Yt){if(Bt.length>0&&Yt&&this.isAssociation(Bt[0]))return this.js_fromStDict(Bt);for(var Zt=[],te=0;te<Bt.length;te++)Zt.push(this.js_fromStObject(Bt[te]));return Zt},js_fromStDict:function(Bt){for(var Yt={},Zt=0;Zt<Bt.length;Zt++){var te=Bt[Zt].pointers;if(!te||2!==te.length)throw Error(te+" is not an Association");var ee=this.js_fromStObject(te[0]),ie=this.js_fromStObject(te[1]);Yt[ee]=ie}return Yt},js_fromStBlock:function(Bt){if(!this.js_callbackSema)throw Error("CallbackSemaphore not set");this.vm.reclaimableContextCount=0;var Yt=this;return function(){return Yt.js_executeCallback(Bt,arguments)}},js_executeCallback:function(Bt,Yt){if(this.js_activeCallback){if("string"==typeof this.js_activeCallback)throw Error(this.js_activeCallback);return console.error("Callback: already active")}this.js_activeCallback={block:Bt,args:Yt,result:null},this.signalSemaphoreWithIndex(this.js_callbackSema),this.vm.forceInterruptCheck();for(var Zt=Date.now()+500;Date.now()<Zt&&!this.js_activeCallback.result;)this.vm.interpret();var te=this.js_activeCallback.result;if(this.js_activeCallback=null,te)try{return this.js_fromStObject(te)}catch(Bt){return te.toString()}else console.error("Callback error: "+(this.vm.frozen?"frozen":"timeout"))},js_objectOrGlobal:function(Bt){return"jsObject"in Bt?Bt.jsObject:window}},"Obsolete",{primitiveFloatArrayAt:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveAt",Bt)},primitiveFloatArrayMulFloatArray:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveMulFloatArray",Bt)},primitiveFloatArrayAddScalar:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveAddScalar",Bt)},primitiveFloatArrayDivFloatArray:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveDivFloatArray",Bt)},primitiveFloatArrayDivScalar:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveDivScalar",Bt)},primitiveFloatArrayHash:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveHash",Bt)},primitiveFloatArrayAtPut:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveAtPut",Bt)},primitiveFloatArrayMulScalar:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveMulScalar",Bt)},primitiveFloatArrayAddFloatArray:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveAddFloatArray",Bt)},primitiveFloatArraySubScalar:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveSubScalar",Bt)},primitiveFloatArraySubFloatArray:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveSubFloatArray",Bt)},primitiveFloatArrayEqual:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveEqual",Bt)},primitiveFloatArrayDotProduct:function(Bt){return this.namedPrimitive("FloatArrayPlugin","primitiveDotProduct",Bt)},m23PrimitiveInvertRectInto:function(Bt){return this.namedPrimitive("Matrix2x3Plugin","primitiveInvertRectInto",Bt)},m23PrimitiveTransformPoint:function(Bt){return this.namedPrimitive("Matrix2x3Plugin","primitiveTransformPoint",Bt)},m23PrimitiveIsPureTranslation:function(Bt){return this.namedPrimitive("Matrix2x3Plugin","primitiveIsPureTranslation",Bt)},m23PrimitiveComposeMatrix:function(Bt){return this.namedPrimitive("Matrix2x3Plugin","primitiveComposeMatrix",Bt)},m23PrimitiveTransformRectInto:function(Bt){return this.namedPrimitive("Matrix2x3Plugin","primitiveTransformRectInto",Bt)},m23PrimitiveIsIdentity:function(Bt){return this.namedPrimitive("Matrix2x3Plugin","primitiveIsIdentity",Bt)},m23PrimitiveInvertPoint:function(Bt){return this.namedPrimitive("Matrix2x3Plugin","primitiveInvertPoint",Bt)},primitiveDeflateBlock:function(Bt){return this.namedPrimitive("ZipPlugin","primitiveDeflateBlock",Bt)},primitiveDeflateUpdateHashTable:function(Bt){return this.namedPrimitive("ZipPlugin","primitiveDeflateUpdateHashTable",Bt)},primitiveUpdateGZipCrc32:function(Bt){return this.namedPrimitive("ZipPlugin","primitiveUpdateGZipCrc32",Bt)},primitiveInflateDecompressBlock:function(Bt){return this.namedPrimitive("ZipPlugin","primitiveInflateDecompressBlock",Bt)},primitiveZipSendBlock:function(Bt){return this.namedPrimitive("ZipPlugin","primitiveZipSendBlock",Bt)},primitiveFFTTransformData:function(Bt){return this.namedPrimitive("FFTPlugin","primitiveFFTTransformData",Bt)},primitiveFFTScaleData:function(Bt){return this.namedPrimitive("FFTPlugin","primitiveFFTScaleData",Bt)},primitiveFFTPermuteData:function(Bt){return this.namedPrimitive("FFTPlugin","primitiveFFTPermuteData",Bt)},gePrimitiveMergeFillFrom:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveMergeFillFrom",Bt)},gePrimitiveCopyBuffer:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveCopyBuffer",Bt)},gePrimitiveAddRect:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddRect",Bt)},gePrimitiveAddGradientFill:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddGradientFill",Bt)},gePrimitiveSetClipRect:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveSetClipRect",Bt)},gePrimitiveSetBitBltPlugin:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveSetBitBltPlugin",Bt)},gePrimitiveRegisterExternalEdge:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveRegisterExternalEdge",Bt)},gePrimitiveGetClipRect:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveGetClipRect",Bt)},gePrimitiveAddBezier:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddBezier",Bt)},gePrimitiveInitializeProcessing:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveInitializeProcessing",Bt)},gePrimitiveRenderImage:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveRenderImage",Bt)},gePrimitiveGetOffset:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveGetOffset",Bt)},gePrimitiveSetDepth:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveSetDepth",Bt)},gePrimitiveAddBezierShape:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddBezierShape",Bt)},gePrimitiveSetEdgeTransform:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveSetEdgeTransform",Bt)},gePrimitiveGetTimes:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveGetTimes",Bt)},gePrimitiveNextActiveEdgeEntry:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveNextActiveEdgeEntry",Bt)},gePrimitiveAddBitmapFill:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddBitmapFill",Bt)},gePrimitiveGetDepth:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveGetDepth",Bt)},gePrimitiveAbortProcessing:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAbortProcessing",Bt)},gePrimitiveNextGlobalEdgeEntry:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveNextGlobalEdgeEntry",Bt)},gePrimitiveGetFailureReason:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveGetFailureReason",Bt)},gePrimitiveDisplaySpanBuffer:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveDisplaySpanBuffer",Bt)},gePrimitiveGetCounts:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveGetCounts",Bt)},gePrimitiveChangedActiveEdgeEntry:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveChangedActiveEdgeEntry",Bt)},gePrimitiveRenderScanline:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveRenderScanline",Bt)},gePrimitiveGetBezierStats:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveGetBezierStats",Bt)},gePrimitiveFinishedProcessing:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveFinishedProcessing",Bt)},gePrimitiveNeedsFlush:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveNeedsFlush",Bt)},gePrimitiveAddLine:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddLine",Bt)},gePrimitiveSetOffset:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveSetOffset",Bt)},gePrimitiveNextFillEntry:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveNextFillEntry",Bt)},gePrimitiveInitializeBuffer:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveInitializeBuffer",Bt)},gePrimitiveDoProfileStats:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveDoProfileStats",Bt)},gePrimitiveAddActiveEdgeEntry:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddActiveEdgeEntry",Bt)},gePrimitiveSetAALevel:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveSetAALevel",Bt)},gePrimitiveNeedsFlushPut:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveNeedsFlushPut",Bt)},gePrimitiveAddCompressedShape:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddCompressedShape",Bt)},gePrimitiveSetColorTransform:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveSetColorTransform",Bt)},gePrimitiveAddOval:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddOval",Bt)},gePrimitiveRegisterExternalFill:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveRegisterExternalFill",Bt)},gePrimitiveAddPolygon:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveAddPolygon",Bt)},gePrimitiveGetAALevel:function(Bt){return this.namedPrimitive("B2DPlugin","primitiveGetAALevel",Bt)}}),Object.subclass("Squeak.InterpreterProxy","initialization",{VM_PROXY_MAJOR:1,VM_PROXY_MINOR:11,initialize:function(Bt){this.vm=Bt,this.remappableOops=[],Object.defineProperty(this,"successFlag",{get:function(){return Bt.primHandler.success},set:function(Yt){Bt.primHandler.success=Yt}})},majorVersion:function(){return this.VM_PROXY_MAJOR},minorVersion:function(){return this.VM_PROXY_MINOR}},"success",{failed:function(){return!this.successFlag},primitiveFail:function(){this.successFlag=!1},primitiveFailFor:function(){this.successFlag=!1},success:function(Bt){Bt||(this.successFlag=!1)}},"stack access",{pop:function(Bt){this.vm.popN(Bt)},popthenPush:function(Bt,Yt){this.vm.popNandPush(Bt,Yt)},push:function(Bt){this.vm.push(Bt)},pushBool:function(Bt){this.vm.push(Bt?this.vm.trueObj:this.vm.falseObj)},pushInteger:function(Bt){this.vm.push(Bt)},pushFloat:function(Bt){this.vm.push(this.floatObjectOf(Bt))},stackValue:function(Bt){return this.vm.stackValue(Bt)},stackIntegerValue:function(Bt){var Yt=this.vm.stackValue(Bt);return"number"==typeof Yt?Yt:(this.successFlag=!1,0)},stackFloatValue:function(Bt){this.vm.success=!0;var Yt=this.vm.stackIntOrFloat(Bt);return this.vm.success?Yt:(this.successFlag=!1,0)},stackObjectValue:function(Bt){var Yt=this.vm.stackValue(Bt);return"number"!=typeof Yt?Yt:(this.successFlag=!1,this.vm.nilObj)},stackBytes:function(Bt){var Yt=this.vm.stackValue(Bt);return Yt.bytes?Yt.bytes:("number"!=typeof Yt&&Yt.isBytes()||(this.successFlag=!1),[])},stackWords:function(Bt){var Yt=this.vm.stackValue(Bt);return Yt.words?Yt.words:("number"!=typeof Yt&&Yt.isWords()||(this.successFlag=!1),[])},stackInt32Array:function(Bt){var Yt=this.vm.stackValue(Bt);return Yt.words?Yt.wordsAsInt32Array():("number"!=typeof Yt&&Yt.isWords()||(this.successFlag=!1),[])},stackInt16Array:function(Bt){var Yt=this.vm.stackValue(Bt);return Yt.words?Yt.wordsAsInt16Array():("number"!=typeof Yt&&Yt.isWords()||(this.successFlag=!1),[])},stackUint16Array:function(Bt){var Yt=this.vm.stackValue(Bt);return Yt.words?Yt.wordsAsUint16Array():("number"!=typeof Yt&&Yt.isWords()||(this.successFlag=!1),[])}},"object access",{isBytes:function(Bt){return"number"!=typeof Bt&&Bt.isBytes()},isWords:function(Bt){return"number"!=typeof Bt&&Bt.isWords()},isWordsOrBytes:function(Bt){return"number"!=typeof Bt&&Bt.isWordsOrBytes()},isPointers:function(Bt){return"number"!=typeof Bt&&Bt.isPointers()},isIntegerValue:function(Bt){return"number"==typeof Bt&&Bt>=-1073741824&&1073741823>=Bt},isArray:function(Bt){return Bt.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray]},isMemberOf:function(Bt,Yt){var Zt=Bt.sqClass.pointers[Squeak.Class_name].bytes;if(Yt.length!==Zt.length)return!1;for(var te=0;te<Yt.length;te++)if(Yt.charCodeAt(te)!==Zt[te])return!1;return!0},booleanValueOf:function(Bt){return!!Bt.isTrue||(Bt.isFalse||(this.successFlag=!1),!1)},positive32BitValueOf:function(Bt){return this.vm.primHandler.positive32BitValueOf(Bt)},positive32BitIntegerFor:function(Bt){return this.vm.primHandler.pos32BitIntFor(Bt)},floatValueOf:function(Bt){return Bt.isFloat?Bt.float:(this.successFlag=!1,0)},floatObjectOf:function(Bt){return this.vm.primHandler.makeFloat(Bt)},fetchPointerofObject:function(Bt,Yt){return Yt.pointers[Bt]},fetchBytesofObject:function(Bt,Yt){var Zt=Yt.pointers[Bt];return Zt.bytes?Zt.bytes:Zt.words?Zt.wordsAsUint8Array():("number"!=typeof Zt&&Zt.isWordsOrBytes()||(this.successFlag=!1),[])},fetchWordsofObject:function(Bt,Yt){var Zt=Yt.pointers[Bt];return Zt.words?Zt.words:("number"!=typeof Zt&&Zt.isWords()||(this.successFlag=!1),[])},fetchInt32ArrayofObject:function(Bt,Yt){var Zt=Yt.pointers[Bt];return Zt.words?Zt.wordsAsInt32Array():("number"!=typeof Zt&&Zt.isWords()||(this.successFlag=!1),[])},fetchInt16ArrayofObject:function(Bt,Yt){var Zt=Yt.pointers[Bt];return Zt.words?Zt.wordsAsInt16Array():("number"!=typeof Zt&&Zt.isWords()||(this.successFlag=!1),[])},fetchUint16ArrayofObject:function(Bt,Yt){var Zt=Yt.pointers[Bt];return Zt.words?Zt.wordsAsUint16Array():("number"!=typeof Zt&&Zt.isWords()||(this.successFlag=!1),[])},fetchIntegerofObject:function(Bt,Yt){var Zt=Yt.pointers[Bt];return"number"==typeof Zt?Zt:(this.successFlag=!1,0)},fetchLong32ofObject:function(Bt,Yt){return Yt.words[Bt]},fetchFloatofObject:function(Bt,Yt){return this.floatValueOf(Yt.pointers[Bt])},storeIntegerofObjectwithValue:function(Bt,Yt,Zt){"number"==typeof Zt?Yt.pointers[Bt]=Zt:this.successFlag=!1},storePointerofObjectwithValue:function(Bt,Yt,Zt){Yt.pointers[Bt]=Zt},stObjectatput:function(Bt,Yt,Zt){if(Bt.sqClass!==this.classArray())throw Error("Array expected");return 1>Yt||Yt>=Bt.pointers.length?this.successFlag=!1:void(Bt.pointers[Yt]=Zt)}},"constant access",{isKindOfInteger:function(Bt){return"number"==typeof Bt||Bt.sqClass==this.classLargeNegativeInteger()||Bt.sqClass==this.classLargePositiveInteger()},classArray:function(){return this.vm.specialObjects[Squeak.splOb_ClassArray]},classBitmap:function(){return this.vm.specialObjects[Squeak.splOb_ClassBitmap]},classSmallInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassInteger]},classLargePositiveInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger]},classLargeNegativeInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassLargeNegativeInteger]},classPoint:function(){return this.vm.specialObjects[Squeak.splOb_ClassPoint]},classString:function(){return this.vm.specialObjects[Squeak.splOb_ClassString]},nilObject:function(){return this.vm.nilObj},falseObject:function(){return this.vm.falseObj},trueObject:function(){return this.vm.trueObj}},"vm functions",{instantiateClassindexableSize:function(Bt,Yt){return this.vm.instantiateClass(Bt,Yt)},methodArgumentCount:function(){return this.argCount},makePointwithxValueyValue:function(Bt,Yt){return this.vm.primHandler.makePointWithXandY(Bt,Yt)},pushRemappableOop:function(Bt){this.remappableOops.push(Bt)},popRemappableOop:function(){return this.remappableOops.pop()},showDisplayBitsLeftTopRightBottom:function(Bt,Yt,Zt,te,ee){if(te>Yt&&ee>Zt){var ie={left:Yt,top:Zt,right:te,bottom:ee};this.vm.primHandler.displayDirty(Bt,ie)}},ioLoadFunctionFrom:function(Bt,Yt){return this.vm.primHandler.loadFunctionFrom(Bt,Yt)}}),Object.subclass("Squeak.InstructionPrinter","initialization",{initialize:function(Bt,Yt){this.method=Bt,this.vm=Yt}},"printing",{printInstructions:function(Bt,Yt,Zt){for(this.indent=Bt,this.highlight=Yt,this.highlightPC=Zt,this.innerIndents={},this.result="",this.scanner=new Squeak.InstructionStream(this.method,this.vm),this.oldPC=this.scanner.pc,this.endPC=0,this.done=!1;!this.done;)this.scanner.interpretNextInstructionFor(this);return this.result},print:function(Bt){this.oldPC===this.highlightPC?this.highlight&&(this.result+=this.highlight):this.indent&&(this.result+=this.indent),this.result+=this.oldPC;for(var Yt=0;Yt<this.innerIndents[this.oldPC];Yt++)this.result+="   ";this.result+=" <";for(Yt=this.oldPC;Yt<this.scanner.pc;Yt++)Yt>this.oldPC&&(this.result+=" "),this.result+=(this.method.bytes[Yt]+256).toString(16).substr(-2).toUpperCase();this.result+="> "+Bt+"\n",this.oldPC=this.scanner.pc}},"decoding",{blockReturnTop:function(){this.print("blockReturn")},doDup:function(){this.print("dup")},doPop:function(){this.print("pop")},jump:function(Bt){this.print("jumpTo: "+(this.scanner.pc+Bt)),this.scanner.pc+Bt>this.endPC&&(this.endPC=this.scanner.pc+Bt)},jumpIf:function(Bt,Yt){this.print((Bt?"jumpIfTrue: ":"jumpIfFalse: ")+(this.scanner.pc+Yt)),this.scanner.pc+Yt>this.endPC&&(this.endPC=this.scanner.pc+Yt)},methodReturnReceiver:function(){this.print("return: receiver"),this.done=this.scanner.pc>this.endPC},methodReturnTop:function(){this.print("return: topOfStack"),this.done=this.scanner.pc>this.endPC},methodReturnConstant:function(Bt){this.print("returnConst: "+Bt.toString()),this.done=this.scanner.pc>this.endPC},popIntoLiteralVariable:function(Bt){this.print("popIntoBinding: "+Bt.assnKeyAsString())},popIntoReceiverVariable:function(Bt){this.print("popIntoInstVar: "+Bt)},popIntoTemporaryVariable:function(Bt){this.print("popIntoTemp: "+Bt)},pushActiveContext:function(){this.print("push: thisContext")},pushConstant:function(Bt){var Yt=Bt.sqInstName?Bt.sqInstName():Bt.toString();this.print("pushConst: "+Yt)},pushLiteralVariable:function(Bt){this.print("pushBinding: "+Bt.assnKeyAsString())},pushReceiver:function(){this.print("push: self")},pushReceiverVariable:function(Bt){this.print("pushInstVar: "+Bt)},pushTemporaryVariable:function(Bt){this.print("pushTemp: "+Bt)},send:function(Bt,Yt,Zt){this.print((Zt?"superSend: #":"send: #")+(Bt.bytesAsString?Bt.bytesAsString():Bt))},storeIntoLiteralVariable:function(Bt){this.print("storeIntoBinding: "+Bt.assnKeyAsString())},storeIntoReceiverVariable:function(Bt){this.print("storeIntoInstVar: "+Bt)},storeIntoTemporaryVariable:function(Bt){this.print("storeIntoTemp: "+Bt)},pushNewArray:function(Bt){this.print("push: (Array new: "+Bt+")")},popIntoNewArray:function(Bt){this.print("pop: "+Bt+" into: (Array new: "+Bt+")")},pushRemoteTemp:function(Bt,Yt){this.print("push: "+Bt+" ofTemp: "+Yt)},storeIntoRemoteTemp:function(Bt,Yt){this.print("storeInto: "+Bt+" ofTemp: "+Yt)},popIntoRemoteTemp:function(Bt,Yt){this.print("popInto: "+Bt+" ofTemp: "+Yt)},pushClosureCopy:function(Bt,Yt,Zt){var te=this.scanner.pc,ee=te+Zt;this.print("closure("+te+"-"+(ee-1)+"): "+Bt+" copied, "+Yt+" args");for(var ie=te;ee>ie;ie++)this.innerIndents[ie]=(this.innerIndents[ie]||0)+1;ee>this.endPC&&(this.endPC=ee)}}),Object.subclass("Squeak.InstructionStream","initialization",{initialize:function(Bt,Yt){this.vm=Yt,this.method=Bt,this.pc=0,this.specialConstants=[Yt.trueObj,Yt.falseObj,Yt.nilObj,-1,0,1,2]}},"decoding",{interpretNextInstructionFor:function(Bt){var Yt=this.method,Zt=Yt.bytes[this.pc++],te=Zt/16|0,ee=Zt%16;if(0===te)return Bt.pushReceiverVariable(ee);if(1===te)return Bt.pushTemporaryVariable(ee);if(2===te)return Bt.pushConstant(Yt.methodGetLiteral(ee));if(3===te)return Bt.pushConstant(Yt.methodGetLiteral(ee+16));if(4===te)return Bt.pushLiteralVariable(Yt.methodGetLiteral(ee));if(5===te)return Bt.pushLiteralVariable(Yt.methodGetLiteral(ee+16));if(6===te)return 8>ee?Bt.popIntoReceiverVariable(ee):Bt.popIntoTemporaryVariable(ee-8);if(7===te){if(0===ee)return Bt.pushReceiver();if(8>ee)return Bt.pushConstant(this.specialConstants[ee-1]);if(8===ee)return Bt.methodReturnReceiver();if(12>ee)return Bt.methodReturnConstant(this.specialConstants[ee-9]);if(12===ee)return Bt.methodReturnTop();if(13===ee)return Bt.blockReturnTop();if(ee>13)throw Error("unusedBytecode")}return 8===te?this.interpretExtension(ee,Yt,Bt):9===te?8>ee?Bt.jump(ee+1):Bt.jumpIf(!1,ee-8+1):10===te?(Zt=this.method.bytes[this.pc++],8>ee?Bt.jump(256*(ee-4)+Zt):Bt.jumpIf(12>ee,256*(3&ee)+Zt)):11===te?Bt.send(this.vm.specialSelectors[2*ee],this.vm.specialSelectors[2*ee+1],!1):12===te?Bt.send(this.vm.specialSelectors[2*(ee+16)],this.vm.specialSelectors[2*(ee+16)+1],!1):te>12?Bt.send(Yt.methodGetLiteral(ee),te-13,!1):void 0},interpretExtension:function(Bt,Yt,Zt){if(6>=Bt){var te=this.method.bytes[this.pc++];if(2>=Bt){var ee=te/64|0,ie=te%64;if(0===Bt){if(0===ee)return Zt.pushReceiverVariable(ie);if(1===ee)return Zt.pushTemporaryVariable(ie);if(2===ee)return Zt.pushConstant(this.method.methodGetLiteral(ie));if(3===ee)return Zt.pushLiteralVariable(this.method.methodGetLiteral(ie))}if(1===Bt){if(0===ee)return Zt.storeIntoReceiverVariable(ie);if(1===ee)return Zt.storeIntoTemporaryVariable(ie);if(2===ee)throw Error("illegalStore");if(3===ee)return Zt.storeIntoLiteralVariable(this.method.methodGetLiteral(ie))}if(2===Bt){if(0===ee)return Zt.popIntoReceiverVariable(ie);if(1===ee)return Zt.popIntoTemporaryVariable(ie);if(2===ee)throw Error("illegalStore");if(3===ee)return Zt.popIntoLiteralVariable(this.method.methodGetLiteral(ie))}}if(3===Bt)return Zt.send(this.method.methodGetLiteral(te%32),te/32|0,!1);if(4===Bt){var re=this.method.bytes[this.pc++];if(0===(ee=te/32|0))return Zt.send(this.method.methodGetLiteral(re),te%32,!1);if(1===ee)return Zt.send(this.method.methodGetLiteral(re),te%32,!0);if(2===ee)return Zt.pushReceiverVariable(re);if(3===ee)return Zt.pushConstant(this.method.methodGetLiteral(re));if(4===ee)return Zt.pushLiteralVariable(this.method.methodGetLiteral(re));if(5===ee)return Zt.storeIntoReceiverVariable(re);if(6===ee)return Zt.popIntoReceiverVariable(re);if(7===ee)return Zt.storeIntoLiteralVariable(this.method.methodGetLiteral(re))}if(5===Bt)return Zt.send(this.method.methodGetLiteral(31&te),te>>5,!0);if(6===Bt)return Zt.send(this.method.methodGetLiteral(63&te),te>>6,!1)}if(7===Bt)return Zt.doPop();if(8===Bt)return Zt.doDup();if(9===Bt)return Zt.pushActiveContext();te=this.method.bytes[this.pc++];if(10===Bt)return 128>te?Zt.pushNewArray(te):Zt.popIntoNewArray(te-128);if(11===Bt)throw Error("unusedBytecode");re=this.method.bytes[this.pc++];if(12===Bt)return Zt.pushRemoteTemp(te,re);if(13===Bt)return Zt.storeIntoRemoteTemp(te,re);if(14===Bt)return Zt.popIntoRemoteTemp(te,re);var se=this.method.bytes[this.pc++];return Zt.pushClosureCopy(te>>4,15&te,256*re+se)}})})),module("users.bert.SqueakJS.jit").requires("users.bert.SqueakJS.vm").toRun((function(){Object.subclass("Squeak.Compiler","initialization",{initialize:function(Bt){this.vm=Bt,this.comments=!!Squeak.Compiler.comments,this.specialSelectors=["+","-","<",">","<=",">=","=","~=","*","/","\\","@","bitShift:","//","bitAnd:","bitOr:","at:","at:put:","size","next","nextPut:","atEnd","==","class","blockCopy:","value","value:","do:","new","new:","x","y"]}},"accessing",{compile:function(Bt,Yt,Zt){if(Bt.isHot){this.singleStep=!1,this.debug=this.comments;var te=Yt&&Yt.className(),ee=Zt&&Zt.bytesAsString();Bt.compiled=this.generate(Bt,te,ee)}else Bt.isHot=!0},enableSingleStepping:function(Bt,Yt,Zt){if(!Bt.compiled||!Bt.compiled.canSingleStep){this.singleStep=!0,this.debug=!0;var te=this.vm.printMethod(Bt,Yt,Zt).split(">>");Bt.compiled=this.generate(Bt,te[0],te[1]),Bt.compiled.canSingleStep=!0}return!0},functionNameFor:function(Bt,Yt){if(!Bt||!Yt)return"Squeak_DOIT";if(!/[^a-zA-Z0-9:_]/.test(Yt))return(Bt+"_"+Yt).replace(/[: ]/g,"_");var Zt=Yt.replace(/./g,(function(Bt){return{"|":"OR","~":"NOT","<":"LT","=":"EQ",">":"GT","&":"AND","@":"AT","*":"TIMES","+":"PLUS","\\":"MOD","-":"MINUS",",":"COMMA","/":"DIV","?":"IF"}[Bt]||"OPERATOR"}));return Bt.replace(/[ ]/,"_")+"__"+Zt+"__"}},"generating",{generate:function(Bt,Yt,Zt){for(this.method=Bt,this.pc=0,this.endPC=0,this.prevPC=0,this.source=[],this.sourceLabels={},this.needsLabel={0:!0},this.needsBreak=!1,Yt&&Zt&&this.source.push("// ",Yt,">>",Zt,"\n"),this.source.push("var context = vm.activeContext,\n","    stack = context.pointers,\n","    rcvr = vm.receiver,\n","    inst = rcvr.pointers,\n","    temp = vm.homeContext.pointers,\n","    lit = vm.method.pointers,\n","    bytecodes = 0 - vm.pc;\n","while (true) switch (vm.pc) {\n"),this.done=!1;!this.done;){var te=Bt.bytes[this.pc++],ee=0;switch(248&te){case 0:case 8:this.generatePush("inst[",15&te,"]");break;case 16:case 24:this.generatePush("temp[",6+(15&te),"]");break;case 32:case 40:case 48:case 56:this.generatePush("lit[",1+(31&te),"]");break;case 64:case 72:case 80:case 88:this.generatePush("lit[",1+(31&te),"].pointers[1]");break;case 96:this.generatePopInto("inst[",7&te,"]");break;case 104:this.generatePopInto("temp[",6+(7&te),"]");break;case 112:switch(te){case 112:this.generatePush("rcvr");break;case 113:this.generatePush("vm.trueObj");break;case 114:this.generatePush("vm.falseObj");break;case 115:this.generatePush("vm.nilObj");break;case 116:this.generatePush("-1");break;case 117:this.generatePush("0");break;case 118:this.generatePush("1");break;case 119:this.generatePush("2")}break;case 120:switch(te){case 120:this.generateReturn("rcvr");break;case 121:this.generateReturn("vm.trueObj");break;case 122:this.generateReturn("vm.falseObj");break;case 123:this.generateReturn("vm.nilObj");break;case 124:this.generateReturn("stack[vm.sp]");break;case 125:this.generateBlockReturn();break;default:throw Error("unusedBytecode")}break;case 128:case 136:this.generateExtended(te);break;case 144:this.generateJump(1+(7&te));break;case 152:this.generateJumpIf(!1,1+(7&te));break;case 160:ee=Bt.bytes[this.pc++],this.generateJump(256*((7&te)-4)+ee);break;case 168:ee=Bt.bytes[this.pc++],this.generateJumpIf(172>te,256*(3&te)+ee);break;case 176:case 184:this.generateNumericOp(te);break;case 192:case 200:this.generateQuickPrim(te);break;case 208:case 216:this.generateSend("lit[",1+(15&te),"]",0,!1);break;case 224:case 232:this.generateSend("lit[",1+(15&te),"]",1,!1);break;case 240:case 248:this.generateSend("lit[",1+(15&te),"]",2,!1)}}var ie=this.functionNameFor(Yt,Zt);return this.singleStep?(this.debug&&this.source.push("// all valid PCs have a label;\n"),this.source.push("default: throw Error('invalid PC'); }"),new Function("return function "+ie+"(vm, singleStep) {\n"+this.source.join("")+"\n}")()):(this.debug&&this.source.push("// fall back to single-stepping\n"),this.source.push("default: bytecodes += vm.pc; vm.interpretOne(true); return bytecodes;}"),this.deleteUnneededLabels(),new Function("return function "+ie+"(vm) {\n"+this.source.join("")+"\n}")())},generateExtended:function(Bt){var Yt,Zt;switch(Bt){case 128:switch((Yt=this.method.bytes[this.pc++])>>6){case 0:return void this.generatePush("inst[",63&Yt,"]");case 1:return void this.generatePush("temp[",6+(63&Yt),"]");case 2:return void this.generatePush("lit[",1+(63&Yt),"]");case 3:return void this.generatePush("lit[",1+(63&Yt),"].pointers[1]")}case 129:switch((Yt=this.method.bytes[this.pc++])>>6){case 0:return void this.generateStoreInto("inst[",63&Yt,"]");case 1:return void this.generateStoreInto("temp[",6+(63&Yt),"]");case 2:throw Error("illegal store into literal");case 3:return void this.generateStoreInto("lit[",1+(63&Yt),"].pointers[1]")}return;case 130:switch((Yt=this.method.bytes[this.pc++])>>6){case 0:return void this.generatePopInto("inst[",63&Yt,"]");case 1:return void this.generatePopInto("temp[",6+(63&Yt),"]");case 2:throw Error("illegal pop into literal");case 3:return void this.generatePopInto("lit[",1+(63&Yt),"].pointers[1]")}case 131:return Yt=this.method.bytes[this.pc++],void this.generateSend("lit[",1+(31&Yt),"]",Yt>>5,!1);case 132:switch(Yt=this.method.bytes[this.pc++],Zt=this.method.bytes[this.pc++],Yt>>5){case 0:return void this.generateSend("lit[",1+Zt,"]",31&Yt,!1);case 1:return void this.generateSend("lit[",1+Zt,"]",31&Yt,!0);case 2:return void this.generatePush("inst[",Zt,"]");case 3:return void this.generatePush("lit[",1+Zt,"]");case 4:return void this.generatePush("lit[",1+Zt,"].pointers[1]");case 5:return void this.generateStoreInto("inst[",Zt,"]");case 6:return void this.generatePopInto("inst[",Zt,"]");case 7:return void this.generateStoreInto("lit[",1+Zt,"].pointers[1]")}case 133:return Yt=this.method.bytes[this.pc++],void this.generateSend("lit[",1+(31&Yt),"]",Yt>>5,!0);case 134:return Yt=this.method.bytes[this.pc++],void this.generateSend("lit[",1+(63&Yt),"]",Yt>>6,!1);case 135:return void this.generateInstruction("pop","vm.sp--");case 136:return void this.generateInstruction("dup","var dup = stack[vm.sp]; stack[++vm.sp] = dup");case 137:return void this.generateInstruction("thisContext","stack[++vm.sp] = vm.exportThisContext()");case 138:var te=(Yt=this.method.bytes[this.pc++])>127,ee=127&Yt;return void this.generateClosureTemps(ee,te);case 139:throw Error("unusedBytecode");case 140:return Yt=this.method.bytes[this.pc++],Zt=this.method.bytes[this.pc++],void this.generatePush("temp[",6+Zt,"].pointers[",Yt,"]");case 141:return Yt=this.method.bytes[this.pc++],Zt=this.method.bytes[this.pc++],void this.generateStoreInto("temp[",6+Zt,"].pointers[",Yt,"]");case 142:return Yt=this.method.bytes[this.pc++],Zt=this.method.bytes[this.pc++],void this.generatePopInto("temp[",6+Zt,"].pointers[",Yt,"]");case 143:var ie=15&(Yt=this.method.bytes[this.pc++]),re=Yt>>4,se=(Zt=this.method.bytes[this.pc++])<<8|this.method.bytes[this.pc++];return void this.generateClosureCopy(ie,re,se)}},generatePush:function(Bt,Yt,Zt,te,ee){this.debug&&this.generateDebugCode("push"),this.generateLabel(),this.source.push("stack[++vm.sp] = ",Bt),void 0!==Yt&&(this.source.push(Yt,Zt),void 0!==te&&this.source.push(te,ee)),this.source.push(";\n")},generateStoreInto:function(Bt,Yt,Zt,te,ee){this.debug&&this.generateDebugCode("store into"),this.generateLabel(),this.source.push(Bt),void 0!==Yt&&(this.source.push(Yt,Zt),void 0!==te&&this.source.push(te,ee)),this.source.push(" = stack[vm.sp];\n")},generatePopInto:function(Bt,Yt,Zt,te,ee){this.debug&&this.generateDebugCode("pop into"),this.generateLabel(),this.source.push(Bt),void 0!==Yt&&(this.source.push(Yt,Zt),void 0!==te&&this.source.push(te,ee)),this.source.push(" = stack[vm.sp--];\n")},generateReturn:function(Bt){this.debug&&this.generateDebugCode("return"),this.generateLabel(),this.source.push("vm.pc = ",this.pc,"; vm.doReturn(",Bt,"); return bytecodes + ",this.pc,";\n"),this.needsBreak=!1,this.done=this.pc>this.endPC},generateBlockReturn:function(){this.debug&&this.generateDebugCode("block return"),this.generateLabel(),this.source.push("vm.pc = ",this.pc,"; vm.doReturn(stack[vm.sp--], context.pointers[0]); return bytecodes + ",this.pc,";\n"),this.needsBreak=!1},generateJump:function(Bt){var Yt=this.pc+Bt;this.debug&&this.generateDebugCode("jump to "+Yt),this.generateLabel(),this.source.push("vm.pc = ",Yt,"; "),0>Bt?this.source.push("bytecodes += ",-Bt,"; "):this.source.push("bytecodes -= ",Bt,"; "),0>Bt&&this.source.push("\nif (vm.interruptCheckCounter-- <= 0) {\n","   vm.checkForInterrupts();\n","   if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",Yt,";\n","}\n"),this.singleStep&&this.source.push("\nif (vm.breakOutOfInterpreter) return bytecodes + ",Yt,";\n"),this.source.push("continue;\n"),this.needsBreak=!1,this.needsLabel[Yt]=!0,Yt>this.endPC&&(this.endPC=Yt)},generateJumpIf:function(Bt,Yt){var Zt=this.pc+Yt;this.debug&&this.generateDebugCode("jump if "+Bt+" to "+Zt),this.generateLabel(),this.source.push("var cond = stack[vm.sp--]; if (cond === vm.",Bt,"Obj) {vm.pc = ",Zt,"; bytecodes -= ",Yt,"; "),this.singleStep&&this.source.push("if (vm.breakOutOfInterpreter) return bytecodes + ",Zt,"; else "),this.source.push("continue}\n","else if (cond !== vm.",!Bt,"Obj) {vm.sp++; vm.pc = ",this.pc,"; vm.send(vm.specialObjects[25], 0, false); return bytecodes + ",this.pc,"}\n"),this.needsLabel[this.pc]=!0,this.needsLabel[Zt]=!0,Zt>this.endPC&&(this.endPC=Zt)},generateQuickPrim:function(Bt){switch(this.debug&&this.generateDebugCode("quick prim "+this.specialSelectors[16+(15&Bt)]),this.generateLabel(),Bt){case 194:return this.source.push("if (stack[vm.sp].sqClass === vm.specialObjects[7]) stack[vm.sp] = stack[vm.sp].pointersSize();\n","else if (stack[vm.sp].sqClass === vm.specialObjects[6]) stack[vm.sp] = stack[vm.sp].bytesSize();\n","else { vm.pc = ",this.pc,"; vm.sendSpecial(18); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"; }\n"),void(this.needsLabel[this.pc]=!0);case 198:return void this.source.push("var cond = stack[vm.sp-1] === stack[vm.sp];\nstack[--vm.sp] = cond ? vm.trueObj : vm.falseObj;\n");case 199:return void this.source.push("stack[vm.sp] = typeof stack[vm.sp] === 'number' ? vm.specialObjects[5] : stack[vm.sp].sqClass;\n");case 200:return this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&Bt,")) ","{vm.sendSpecial(",16+(15&Bt),"); return bytecodes + ",this.pc,"}\n"),this.needsLabel[this.pc]=!0,void(this.needsLabel[this.pc+2]=!0);case 201:case 202:case 203:return this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&Bt,")) vm.sendSpecial(",16+(15&Bt),"); return bytecodes + ",this.pc,";\n"),void(this.needsLabel[this.pc]=!0)}this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&Bt,"))"," vm.sendSpecial(",16+(15&Bt),");\n","if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,";\n","if (vm.pc !== ",this.pc,") throw Error('Huh?');\n"),this.needsBreak=!1,this.needsLabel[this.pc]=!0},generateNumericOp:function(Bt){switch(this.debug&&this.generateDebugCode("numeric op "+this.specialSelectors[15&Bt]),this.generateLabel(),this.needsLabel[this.pc]=!0,Bt){case 176:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = vm.primHandler.signed32BitIntegerFor(a + b);\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(0); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 177:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = vm.primHandler.signed32BitIntegerFor(a - b);\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(1); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 178:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a < b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(2); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 179:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a > b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(3); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 180:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a <= b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(4); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 181:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a >= b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(5); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 182:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a === b ? vm.trueObj : vm.falseObj;\n","} else if (a === b && a.float === a.float) {\n","   stack[--vm.sp] = vm.trueObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(6); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 183:return void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a !== b ? vm.trueObj : vm.falseObj;\n","} else if (a === b && a.float === a.float) {\n","   stack[--vm.sp] = vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(7); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,"}\n");case 184:return void this.source.push("vm.success = true; vm.resultIsFloat = false; if(!vm.pop2AndPushNumResult(vm.stackIntOrFloat(1) * vm.stackIntOrFloat(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(8); return bytecodes + ",this.pc,"}\n");case 185:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.quickDivide(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(9); return bytecodes + ",this.pc,"}\n");case 186:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.mod(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(10); return bytecodes + ",this.pc,"}\n");case 187:return void this.source.push("vm.success = true; if(!vm.primHandler.primitiveMakePoint(1, true)) { vm.pc = ",this.pc,"; vm.sendSpecial(11); return bytecodes + ",this.pc,"}\n");case 188:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.safeShift(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(12); return bytecodes + ",this.pc,"}\n");case 189:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.div(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(13); return bytecodes + ",this.pc,"}\n");case 190:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.stackInteger(1) & vm.stackInteger(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(14); return bytecodes + ",this.pc,"}\n");case 191:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.stackInteger(1) | vm.stackInteger(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(15); return bytecodes + ",this.pc,"}\n")}},generateSend:function(Bt,Yt,Zt,te,ee){this.debug&&this.generateDebugCode("send "+("lit["===Bt?this.method.pointers[Yt].bytesAsString():"...")),this.generateLabel(),this.source.push("vm.pc = ",this.pc,"; vm.send(",Bt,Yt,Zt,", ",te,", ",ee,"); ","if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return bytecodes + ",this.pc,";\n"),this.needsBreak=!1,this.needsLabel[this.pc]=!0},generateClosureTemps:function(Bt,Yt){if(this.debug&&this.generateDebugCode("closure temps"),this.generateLabel(),this.source.push("var array = vm.instantiateClass(vm.specialObjects[7], ",Bt,");\n"),Yt){for(var Zt=0;Bt>Zt;Zt++)this.source.push("array.pointers[",Zt,"] = stack[vm.sp - ",Bt-Zt-1,"];\n");this.source.push("stack[vm.sp -= ",Bt-1,"] = array;\n")}else this.source.push("stack[++vm.sp] = array;\n")},generateClosureCopy:function(Bt,Yt,Zt){var te=this.pc,ee=te+Zt;if(this.debug&&this.generateDebugCode("push closure("+te+"-"+(ee-1)+"): "+Yt+" copied, "+Bt+" args"),this.generateLabel(),this.source.push("var closure = vm.instantiateClass(vm.specialObjects[36], ",Yt,");\n","closure.pointers[0] = context; vm.reclaimableContextCount = 0;\n","closure.pointers[1] = ",te+4*this.method.pointers.length+1,";\n","closure.pointers[2] = ",Bt,";\n"),Yt>0){for(var ie=0;Yt>ie;ie++)this.source.push("closure.pointers[",ie+3,"] = stack[vm.sp - ",Yt-ie-1,"];\n");this.source.push("stack[vm.sp -= ",Yt-1,"] = closure;\n")}else this.source.push("stack[++vm.sp] = closure;\n");this.source.push("vm.pc = ",ee,";\n"),this.source.push("bytecodes -= ",Zt,";\n"),this.singleStep&&this.source.push("if (vm.breakOutOfInterpreter) return bytecodes + ",ee,";\n"),this.source.push("continue;\n"),this.needsBreak=!1,this.needsLabel[te]=!0,this.needsLabel[ee]=!0,ee>this.endPC&&(this.endPC=ee)},generateLabel:function(){this.sourceLabels[this.prevPC]=this.source.length,this.source.push("case ",this.prevPC,":\n"),this.prevPC=this.pc},generateDebugCode:function(Bt){this.needsBreak&&(this.source.push("if (vm.breakOutOfInterpreter) return bytecodes + (vm.pc = ",this.prevPC,");\n"),this.needsLabel[this.prevPC]=!0);for(var Yt=[],Zt=this.prevPC;Zt<this.pc;Zt++)Yt.push((this.method.bytes[Zt]+256).toString(16).slice(-2).toUpperCase());this.source.push("// ",this.prevPC," <",Yt.join(" "),"> ",Bt,"\n"),this.needsBreak=this.singleStep},generateInstruction:function(Bt,Yt){this.debug&&this.generateDebugCode(Bt),this.generateLabel(),this.source.push(Yt,";\n")},deleteUnneededLabels:function(){for(var Bt in this.sourceLabels)if(!this.needsLabel[Bt])for(var Yt=0;3>Yt;Yt++)this.source[this.sourceLabels[Bt]+Yt]=""}})})),module("users.bert.SqueakJS.plugins.ADPCMCodecPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function u(Bt,Yt){return Yt>31?0:Bt<<Yt}function l(Bt,Yt){return Yt>31?0:Bt>>>Yt}function v(Bt,Yt){var Zt,te,ee;for(0>(te=Yt-Bt)&&(te=0-te),Zt=63,ee=1;62>=ee;ee++)63===Zt&&ne[ee-1]>=te&&(Zt=ee);return Zt}function n(Bt){var Yt,re,se;for(re=0,Yt=Bt;;){if(!((se=Yt-Zt)>0))return re+=l(ee,0-se),ee&=l(255,8-(Zt-=Yt)),re;re+=u(ee,se),Yt-=Zt,ee=ie[++te-1],Zt=8}}function o(Bt,Yt){var re,se,ne,ae;for(se=Yt,ne=Bt;;){if(!(0>(ae=(re=8-Zt)-ne)))return ee+=u(se,ae),Zt+=ne,self;ee+=l(se,0-ae),ie[++te-1]=ee,Zt=0,ee=0,se&=u(1,0-ae)-1,ne-=re}}var Bt=1,Yt=11,Zt=0,te=0,ee=0,ie=null,re=null,se="ADPCMCodecPlugin 3 November 2014 (e)",ne=null;Squeak.registerExternalModule("ADPCMCodecPlugin",{primitiveDecodeStereo:function d(){var Bt,Yt,se,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe,Se,Oe,Ie,Ae,Pe,we;if(Bt=re.stackValue(1),Yt=re.stackIntegerValue(0),Ie=re.fetchInt16ArrayofObject(0,Bt),Se=re.fetchInt16ArrayofObject(1,Bt),ge=re.fetchIntegerofObject(2,Bt),ye=re.fetchIntegerofObject(3,Bt),be=re.fetchIntegerofObject(4,Bt),Fe=re.fetchIntegerofObject(5,Bt),ee=re.fetchIntegerofObject(6,Bt),Zt=re.fetchIntegerofObject(7,Bt),te=re.fetchIntegerofObject(8,Bt),ie=re.fetchBytesofObject(9,Bt),we=re.fetchInt16ArrayofObject(10,Bt),Ae=re.fetchInt16ArrayofObject(11,Bt),Pe=re.fetchIntegerofObject(12,Bt),ke=re.fetchIntegerofObject(13,Bt),ne=re.fetchInt16ArrayofObject(14,Bt),Oe=re.fetchInt16ArrayofObject(15,Bt),re.failed())return null;for(pe=Ie[0],de=Ie[1],le=Se[0],ce=Se[1],ue=1;Yt>=ue;ue++)if(1==(ue&Fe))pe=n(16),le=n(6),de=n(16),ce=n(6),pe>32767&&(pe-=65536),de>32767&&(de-=65536),we[++Pe-1]=pe,Ae[Pe-1]=de;else{for(ae=n(ke),oe=n(ke),me=ne[le],ve=ne[ce],fe=he=0,se=be;se>0;)(ae&se)>0&&(fe+=me),(oe&se)>0&&(he+=ve),me>>>=1,ve>>>=1,se>>>=1;fe+=me,he+=ve,(ae&ge)>0?pe-=fe:pe+=fe,(oe&ge)>0?de-=he:de+=he,pe>32767?pe=32767:-32768>pe&&(pe=-32768),de>32767?de=32767:-32768>de&&(de=-32768),0>(le+=Oe[ae&ye])?le=0:le>88&&(le=88),0>(ce+=Oe[oe&ye])?ce=0:ce>88&&(ce=88),we[++Pe-1]=pe,Ae[Pe-1]=de}return Ie[0]=pe,Ie[1]=de,Se[0]=le,Se[1]=ce,re.failed()?null:(re.storeIntegerofObjectwithValue(6,Bt,ee),re.storeIntegerofObjectwithValue(7,Bt,Zt),re.storeIntegerofObjectwithValue(8,Bt,te),re.storeIntegerofObjectwithValue(12,Bt,Pe),void re.pop(1))},primitiveEncodeStereo:function c(){var Bt;return Bt=re.stackValue(1),re.stackIntegerValue(0),ee=re.fetchIntegerofObject(6,Bt),Zt=re.fetchIntegerofObject(7,Bt),te=re.fetchIntegerofObject(8,Bt),ie=re.fetchIntegerofObject(9,Bt),ne=re.fetchIntegerofObject(14,Bt),re.failed()?null:(success(!1),re.failed()?null:(re.storeIntegerofObjectwithValue(6,Bt,ee),re.storeIntegerofObjectwithValue(7,Bt,Zt),re.storeIntegerofObjectwithValue(8,Bt,te),void re.pop(1)))},setInterpreter:function b(Zt){return!1!==((re=Zt).majorVersion()==Bt)&&re.minorVersion()>=Yt},primitiveEncodeMono:function p(){var Bt,Yt,se,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe;if(Bt=re.stackValue(1),Yt=re.stackIntegerValue(0),be=re.fetchIntegerofObject(0,Bt),ke=re.fetchIntegerofObject(1,Bt),de=re.fetchIntegerofObject(2,Bt),me=re.fetchIntegerofObject(4,Bt),ve=re.fetchIntegerofObject(5,Bt),ee=re.fetchIntegerofObject(6,Bt),Zt=re.fetchIntegerofObject(7,Bt),te=re.fetchIntegerofObject(8,Bt),ie=re.fetchBytesofObject(9,Bt),Fe=re.fetchInt16ArrayofObject(10,Bt),ye=re.fetchIntegerofObject(12,Bt),pe=re.fetchIntegerofObject(13,Bt),ne=re.fetchInt16ArrayofObject(14,Bt),ge=re.fetchInt16ArrayofObject(15,Bt),re.failed())return null;for(he=ne[0],ue=1;Yt>=ue;ue++)if(1==(ue&ve))(le=be=Fe[++ye-1])<0&&(le+=65536),o(16,le),Yt>ue&&(ke=v(be,Fe[ye])),o(6,ke);else{for(fe=0,0>(oe=Fe[++ye-1]-be)&&(fe=de,oe=0-oe),ae=0,ce=0,se=me;se>0;)oe>=he&&(ae+=se,ce+=he,oe-=he),he>>>=1,se>>>=1;ce+=he,fe>0?be-=ce:be+=ce,be>32767?be=32767:-32768>be&&(be=-32768),0>(ke+=ge[ae])?ke=0:ke>88&&(ke=88),he=ne[ke],o(pe,fe|ae)}return Zt>0&&(ie[++te-1]=ee),re.failed()?null:(re.storeIntegerofObjectwithValue(0,Bt,be),re.storeIntegerofObjectwithValue(1,Bt,ke),re.storeIntegerofObjectwithValue(6,Bt,ee),re.storeIntegerofObjectwithValue(7,Bt,Zt),re.storeIntegerofObjectwithValue(8,Bt,te),re.storeIntegerofObjectwithValue(12,Bt,ye),void re.pop(1))},primitiveDecodeMono:function m(){var Bt,Yt,se,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be;if(Bt=re.stackValue(1),Yt=re.stackIntegerValue(0),ke=re.fetchIntegerofObject(0,Bt),me=re.fetchIntegerofObject(1,Bt),fe=re.fetchIntegerofObject(2,Bt),pe=re.fetchIntegerofObject(3,Bt),he=re.fetchIntegerofObject(4,Bt),de=re.fetchIntegerofObject(5,Bt),ee=re.fetchIntegerofObject(6,Bt),Zt=re.fetchIntegerofObject(7,Bt),te=re.fetchIntegerofObject(8,Bt),ie=re.fetchBytesofObject(9,Bt),be=re.fetchInt16ArrayofObject(10,Bt),ge=re.fetchIntegerofObject(12,Bt),ce=re.fetchIntegerofObject(13,Bt),ne=re.fetchInt16ArrayofObject(14,Bt),ve=re.fetchInt16ArrayofObject(15,Bt),re.failed())return null;for(oe=1;Yt>=oe;oe++)if(1==(oe&de))(ke=n(16))>32767&&(ke-=65536),me=n(6),be[++ge-1]=ke;else{for(ae=n(ce),le=ne[me],ue=0,se=he;se>0;)(ae&se)>0&&(ue+=le),le>>>=1,se>>>=1;ue+=le,(ae&fe)>0?ke-=ue:ke+=ue,ke>32767?ke=32767:-32768>ke&&(ke=-32768),0>(me+=ve[ae&pe])?me=0:me>88&&(me=88),be[++ge-1]=ke}return re.failed()?null:(re.storeIntegerofObjectwithValue(0,Bt,ke),re.storeIntegerofObjectwithValue(1,Bt,me),re.storeIntegerofObjectwithValue(6,Bt,ee),re.storeIntegerofObjectwithValue(7,Bt,Zt),re.storeIntegerofObjectwithValue(8,Bt,te),re.storeIntegerofObjectwithValue(12,Bt,ge),void re.pop(1))},getModuleName:function k(){return se}})})),module("users.bert.SqueakJS.plugins.B2DPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function nt(Bt){return"number"==typeof Bt?Gc.classSmallInteger():Bt.sqClass}function p(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function Ot(Bt,Yt){return 0|Math.floor(Bt/Yt)}function M(Bt,Yt){return Yt>31?0:Bt<<Yt}function s(Bt,Yt){return Yt>31?0:Bt>>>Yt}function x(Bt,Yt){return new Int32Array(Bt.buffer,Bt.byteOffset+4*Yt)}function nu(Bt,Yt){return new Float32Array(Bt.buffer,Bt.byteOffset+4*Yt)}function D(){return gf[Wa]}function Qs(Bt){return gf[Wa]=Bt}function tt(){return gf[Da]}function Dh(Bt){return gf[Da]=Bt}function Ni(Bt,Yt){var Zt;return(Zt=Bt+P()-1&~(P()-1))>Yt?Yt:Zt}function _h(Bt){return gf[Ta]=Bt}function _i(Bt,Yt){return Yt-1&~(P()-1)}function P(){return gf[La]}function Vh(Bt){return gf[La]=Bt}function mt(){return gf[Ra]}function Hs(Bt){return gf[Ra]=Bt}function g(){return gf[za]}function Os(Bt){return gf[za]=Bt}function br(Bt,Yt){return 0===Bt?0>Yt?0-Yt:Yt:0===Yt?0>Bt?0-Bt:Bt:function yc(Bt){return 32>Bt?function Ec(){var Bt=[0,1,1,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6];return Bt}()[Bt]:Math.sqrt(Bt)+.5|0}(Bt*Bt+Yt*Yt)}function bs(Bt){return ma(1)?(Wc[K()]=Bt,void fs(K()+1)):0}function w(){return gf[Ka]}function ot(Bt){return gf[Ka]=Bt}function W(){return gf[Ga]}function Ki(Bt){return gf[Ga]=Bt}function au(Bt){return X(Bt)}function ah(){var Bt;return bt(me)?(df=(Bt=df)+me,U(Bt,Gs),st(Bt,0),pt(Bt,me),Bt):0}function Hr(){return lu(6),E()}function pf(Bt,Yt){var Zt,te,ee,ie;if(!bt(ee=Pe+Bt))return 0;if(df=(te=df)+ee,U(te,Us),st(te,0),pt(te,ee),Zt=Ia(te),gr())for(ie=0;Bt-1>=ie;ie++)Zt[ie]=q(Yt[ie]);else for(ie=0;Bt-1>=ie;ie++)Zt[ie]=Yt[ie];return function Qf(Bt,Yt){return a(Bt,Se,Yt)}(te,Bt),te}function ma(Bt){var Yt,Zt,te,ee;if(!au(Bt))return!1;if(0!==W())for(te=W(),Yt=W()+Bt,Zt=1,ee=W();ee>=Zt;Zt++)Xl[--Yt]=Xl[--te];return Xl=x(Xl,Bt),!0}function bt(Bt){var Yt,Zt,te,ee;if(!ma(Bt))return!1;if(0!==K())for(te=K(),Yt=K()+Bt,Zt=1,ee=K();ee>=Zt;Zt++)Wc[--Yt]=Wc[--te];return Wc=x(Wc,Bt),!0}function An(){return lu(3)}function $u(){var Bt;return bt(Re)?(df=(Bt=df)+Re,U(Bt,Sn),st(Bt,0),pt(Bt,Re),Bt):0}function Yu(Bt){return 0==(function Ru(Bt){return n(Bt,Ks)}(Bt)&Ue)}function sn(Bt,Yt,Zt){if(Yt>Zt){if(Bt>Yt)return Yt;if(Zt>Bt)return Zt}else{if(Yt>Bt)return Yt;if(Bt>Zt)return Zt}return Bt}function Nr(Bt){return n(Bt,Oe)}function $s(Bt,Yt){return a(Bt,Oe,Yt)}function Mr(Bt){return n(Bt,Ie)}function Yo(Bt,Yt){return a(Bt,Ie,Yt)}function Po(Bt){return n(Bt,Ae)}function Fo(Bt,Yt){return a(Bt,Ae,Yt)}function z(Bt){return x(ff,Bt+qe)}function Oh(Bt){return n(Bt,_e)}function ru(Bt,Yt){return a(Bt,_e,Yt)}function Lu(Bt){return n(Bt,Ne)}function Un(Bt,Yt){return a(Bt,Ne,Yt)}function Jc(Bt){return n(Bt,Se)}function fh(Bt){return n(Bt,ve)}function mh(Bt,Yt){return a(Bt,ve,Yt)}function du(Bt){return n(Bt,ke)}function Ll(Bt,Yt){return a(Bt,ke,Yt)}function Uh(Bt){return n(Bt,ge)}function af(Bt,Yt){return a(Bt,ge,Yt)}function zh(Bt){return n(Bt,be)}function Rh(Bt,Yt){return a(Bt,be,Yt)}function pu(Bt){return n(Bt,we)}function Nh(Bt,Yt){return a(Bt,we,Yt)}function Ui(Bt,Yt,Zt,te){var ee,ie,re,se,ne,ae,oe,ue;return ie=fh(Bt),re=Uh(Bt),32===ie?(0!==(ue=0|Yt[re*te+Zt])&&0==(4278190080&ue)&&(ue|=4278190080),ou(ue)):(oe=function Pc(){var Bt=[0,5,4,0,3,0,0,0,2,0,0,0,0,0,0,0,1];return Bt}()[ie],ue=Yt[re*te+s(Zt,oe)],se=M(1,ie)-1,ue=s(ue,oe=32-ie-(Zt&M(1,oe)-1)*ie)&se,16===ie?0!==ue&&(ee=(31&ue)<<3,ne=(ue>>>5&31)<<3,ae=(ue>>>10&31)<<3,255,ue=(ee+=ee>>>5)+((ne+=ne>>>5)<<8)+((ae+=ae>>>5)<<16)+(255<<24)):ue=0===Jc(Bt)?0:Ia(Bt)[ue],ou(ue))}function hu(Bt){return n(Bt,ye)}function Mh(Bt,Yt){return a(Bt,ye,Yt)}function Tt(Bt){return dt(E()-Bt+4)}function qi(Bt,Yt){return ht(E()-Bt+4,Yt)}function jt(Bt){return dt(E()-Bt+5)}function xi(Bt,Yt){return ht(E()-Bt+5,Yt)}function $t(Bt){return dt(E()-Bt+0)}function Zs(Bt,Yt){return ht(E()-Bt+0,Yt)}function Ct(Bt){return dt(E()-Bt+1)}function Ys(Bt,Yt){return ht(E()-Bt+1,Yt)}function Vi(Bt){return dt(E()-Bt+2)}function wi(Bt,Yt){return ht(E()-Bt+2,Yt)}function Pi(Bt){return dt(E()-Bt+3)}function Ai(Bt,Yt){return ht(E()-Bt+3,Yt)}function Xs(Bt,Yt,Zt){var te,ee,ie,re,se,ne;for(ie=p(Bt),te=Bt.wordsAsInt32Array(),re=0,ee=0;ie-1>=ee;ee++){if(se=Wt(ee,te),!((ne=Ii(ee,te))>=0&&Yt>=ne))return!1;re+=se}return re===Zt}function Ch(Bt){var Yt,Zt,te;if(!Gc.isWords(Bt))return!1;for(te=p(Bt),Yt=Bt.wordsAsInt32Array(),Zt=0;te-1>=Zt;Zt++)if(!L(Yt[Zt]))return!1;return!0}function Ah(Bt,Yt){var Zt;return!!Gc.isWords(Bt)&&((Zt=p(Bt))===3*Yt||Zt===6*Yt)}function Ih(Bt,Yt,Zt,te,ee,ie,re){var se;return!(!Ah(Bt,Yt)||!Ch(re))&&!!(Xs(Zt,se=p(re),Yt)&&Xs(te,se,Yt)&&Xs(ie,se,Yt)&&function Ph(Bt,Yt){var Zt,te,ee,ie;for(te=p(Bt),ie=Bt.wordsAsInt32Array(),ee=0,Zt=0;te-1>=Zt;Zt++)ee+=Wt(Zt,ie);return ee===Yt}(ee,Yt))}function Yf(Bt){return function Iu(Bt){return(J(Bt)&In)===mn}(Bt)?function Nf(Bt){var Yt;return Yt=Ut(Bt)?fr(Bt):0,xr(Bt)+Yt<Qi()||A(Bt)-Yt>=rt()&&Nn(Bt)-Yt>=rt()?0:void bs(Bt)}(Bt):function Jf(Bt){return(J(Bt)&In)===Gs}(Bt)?function yh(Bt){var Yt;return Yt=Ut(Bt)?os(Bt):0,Mr(Bt)+Yt<Qi()||A(Bt)-Yt>=rt()&&Nr(Bt)-Yt>=rt()?0:void bs(Bt)}(Bt):void bs(Bt)}function St(Bt,Yt){return 0>Bt?0:Bt>=Yt?Yt-1:Bt}function pr(){var Bt,Yt;for(0>(Bt=s(Er(),g()))&&(Bt=0),(Yt=s(Gi(),g())+1)>Ft()&&(Yt=Ft());Yt>Bt;)vf[Bt]=0,++Bt;Kr(Ft()),zi(0)}function Ns(){return gf[Za]}function Lt(Bt){return gf[Za]=Bt}function Rt(){return gf[$a]}function xs(Bt){return gf[$a]=Bt}function Vs(){return gf[to]}function Ea(Bt){return gf[to]=Bt}function zt(){return gf[eo]}function As(Bt){return gf[eo]=Bt}function Is(){return gf[io]}function Aa(Bt){return gf[io]=Bt}function $i(){return nu(gf,ro)}function Ia(Bt){return x(ff,Bt+Fe)}function Sa(Bt,Yt){var Zt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe;return ee=ue=$t(Bt),ie=le=Ct(Bt),se=ce=Vi(Bt),ne=fe=Pi(Bt),ae=ee+=(ce-ue)*Yt|0,oe=ie+=(fe-le)*Yt|0,ae+=((se+=((Zt=Tt(Bt))-ce)*Yt|0)-ee)*Yt|0,ie=sn(ie,le,oe+=((ne+=((te=jt(Bt))-fe)*Yt|0)-ie)*Yt|0),ne=sn(ne,oe,te),re=Hr(),kc?0:(wi(Bt,ee),Ai(Bt,ie),qi(Bt,ae),xi(Bt,oe),Zs(re,ae),Ys(re,oe),wi(re,se),Ai(re,ne),qi(re,Zt),xi(re,te),re)}function Fa(Bt){var Yt,Zt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;return ie=Hr(),kc?0:(te=oe=$t(Bt),ee=ue=Ct(Bt),re=le=Vi(Bt),se=ce=Pi(Bt),ne=re+=(Yt=Tt(Bt))-le>>1,ae=se+=(Zt=jt(Bt))-ce>>1,ne+=(te+=le-oe>>1)-re>>1,ae+=(ee+=ce-ue>>1)-se>>1,wi(Bt,te),Ai(Bt,ee),qi(Bt,ne),xi(Bt,ae),Zs(ie,ne),Ys(ie,ae),wi(ie,re),Ai(ie,se),qi(ie,Yt),xi(ie,Zt),ie)}function ya(Bt,Yt){var Zt,te,ee;(Zt=z(Bt)[Me]>>8)>(te=et(Bt)[Me]>>8)&&(ee=Zt,Zt=te,te=ee),G(Bt,Zt),us(Bt,te-Zt>Yt?te-Zt:Yt)}function y(){return gf[go]}function Jt(Bt){return gf[go]=Bt}function ks(){return gf[bo]}function Hn(Bt){return gf[bo]=Bt}function ms(){return gf[Co]}function pl(Bt){return gf[Co]=Bt}function hs(){return gf[Vo]}function Tu(Bt){return gf[Vo]=Bt}function ls(Bt){var Yt,Zt,te;return(Yt=s(Er(),g()))<zt()&&(Yt=zt()),(Zt=s(Gi()+P()-1,g()))>Rt()&&(Zt=Rt()),(te=s(Bt,g()))<Is()||te>=Vs()||Zt<zt()||Yt>=Rt()?0:void function bc(Bt,Yt,Zt){return!(!oc&&!kr())&&oc(Bt,Yt,Zt)}(Yt,Zt,te)}function or(Bt){return U(Bt,J(Bt)|Ue)}function lr(Bt){return U(Bt,J(Bt)&~Ue)}function as(Bt,Yt){return a(Bt,Ts,Yt)}function ft(Bt){return n(Bt,Rs)}function H(Bt,Yt){return a(Bt,Rs,Yt)}function ns(Bt,Yt){return a(Bt,Ls,Yt)}function ss(){return nu(gf,jo)}function A(Bt){return n(Bt,_n)}function G(Bt,Yt){return a(Bt,_n,Yt)}function Q(Bt){return n(Bt,Wn)}function hi(Bt,Yt){return a(Bt,Wn,Yt)}function Jr(Bt){return n(Bt,Ln)}function tr(Bt,Yt){return a(Bt,Ln,Yt)}function fo(Bt,Yt){var Zt,te,ee;for(Zt=Zi(),te=Bt,ee=rs();Yt>ee;){if(0!==(Zt=Zi())&&cn(Zt,te,ee))return!0;Xi(ee),te=ee,ee=rs()}return 0!==(Zt=Zi())&&cn(Zt,te,Yt)}function qf(){return function cf(Bt,Yt,Zt,te){var ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me;if(1!==P())return lf(Bt,Yt,Zt,te);if(ee=wa(Bt),!ee)return null;for(re=hu(Bt),ie=du(Bt),fe=1===pu(Bt),se=Yt-gt(Bt),ne=te-ar(Bt),oe=mr(Bt),le=Wr(Bt),ae=se*oe+ne*Fr(Bt),ue=se*le+ne*_r(Bt),he=Yt,pe=Zt;pe>he;)fe&&(ae=yt(ae,re<<16),ue=yt(ue,ie<<16)),de=ae>>16,me=ue>>16,fe||(de=St(de,re),me=St(me,ie)),de>=0&&me>=0&&re>de&&ie>me&&(ce=Ui(Bt,ee,de,me),vf[he]=ce),ae+=oe,ue+=le,++he}(Di(),xt(),_t(),y())}function hf(Bt,Yt,Zt){var te,ee,ie,re,se,ne,ae,oe;if(ae=Yt,oe=Zt,ee=-1,1===P())for(;oe>ae;)se=0|Bt[++ee],vf[ae]=se,++ae;else for(ie=D(),re=tt(),te=g();oe>ae;)ne=s(ae,te),se=s((se=0|Bt[++ee])&ie,re),vf[ne]=vf[ne]+se,++ae;oe>Gi()&&zi(oe),oe>Ji()&&Oi(oe)}function lf(Bt,Yt,Zt,te){var ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe;if(!(re=wa(Bt)))return null;for(ne=hu(Bt),se=du(Bt),ge=1===pu(Bt),ue=Yt-gt(Bt),le=te-ar(Bt),fe=mr(Bt),pe=Wr(Bt),ce=ue*fe+le*Fr(Bt),he=ue*pe+le*_r(Bt),ee=P(),me=Ni(Yt,Zt),ke=_i(0,Zt),ie=g(),ae=D(),oe=tt(),be=Yt;me>be;)ge&&(ce=yt(ce,ne<<16),he=yt(he,se<<16)),ye=ce>>16,Fe=he>>16,ge||(ye=St(ye,ne),Fe=St(Fe,se)),ye>=0&&Fe>=0&&ne>ye&&se>Fe&&(de=s((de=Ui(Bt,re,ye,Fe))&ae,oe),ve=s(be,ie),vf[ve]=vf[ve]+de),ce+=fe,he+=pe,++be;for(ae=4042322160|s(D(),g()),oe=g();ke>be;)ge&&(ce=yt(ce,ne<<16),he=yt(he,se<<16)),ye=ce>>16,Fe=he>>16,ge||(ye=St(ye,ne),Fe=St(Fe,se)),ye>=0&&Fe>=0&&ne>ye&&se>Fe&&(de=s((de=Ui(Bt,re,ye,Fe))&ae,oe),ve=s(be,ie),vf[ve]=vf[ve]+de),ce+=M(fe,oe),he+=M(pe,oe),be+=ee;for(ae=D(),oe=tt();Zt>be;)ge&&(ce=yt(ce,ne<<16),he=yt(he,se<<16)),ye=ce>>16,Fe=he>>16,ge||(ye=St(ye,ne),Fe=St(Fe,se)),ye>=0&&Fe>=0&&ne>ye&&se>Fe&&(de=s((de=Ui(Bt,re,ye,Fe))&ae,oe),ve=s(be,ie),vf[ve]=vf[ve]+de),ce+=fe,he+=pe,++be}function bi(Bt,Yt,Zt){var te,ee;if(1!==P())return nf(Bt,Yt,Zt);for(te=Yt,ee=Zt;ee>te+4;)vf[te]=Bt,vf[te+1]=Bt,vf[te+2]=Bt,vf[te+3]=Bt,te+=4;for(;ee>te;)vf[te]=Bt,++te}function nf(Bt,Yt,Zt){var te,ee,ie,re,se,ne,ae,oe;if(re=Ni(Yt,Zt),ne=_i(0,Zt),te=P(),ee=g(),re>(oe=Yt))for(ae=s(Bt&D(),tt());re>oe;)se=s(oe,ee),vf[se]=vf[se]+ae,++oe;if(ne>oe)for(ie=4042322160|s(D(),g()),ae=s(Bt&ie,g());ne>oe;)se=s(oe,ee),vf[se]=vf[se]+ae,oe+=te;if(Zt>oe)for(ae=s(Bt&D(),tt());Zt>oe;)se=s(oe,ee),vf[se]=vf[se]+ae,++oe}function mr(Bt){return n(Bt,Xn)}function rf(Bt,Yt){return a(Bt,Xn,Yt)}function Fr(Bt){return n(Bt,Qn)}function tf(Bt,Yt){return a(Bt,Qn,Yt)}function Yc(){return function Xc(Bt,Yt,Zt,te){var ee,ie,re,se,ne,ae,oe,ue;for(re=Pr(Bt),ne=Li(Bt),ie=mr(Bt),ee=(Yt-gt(Bt))*ie+(te-ar(Bt))*Fr(Bt),ae=oe=Yt,ue=Zt;((se=ee>>16)<0||se>=ne)&&ue>ae;)++ae,ee+=ie;if(ae>oe&&(0>se&&(se=0),se>=ne&&(se=ne-1),bi(re[se],oe,ae)),1===P())for(;(se=ee>>16)<ne&&se>=0&&ue>ae;)vf[ae]=re[se],++ae,ee+=ie;else ae=Hc(Bt,re,ee,ie,ae,Zt);ue>ae&&(0>se&&(se=0),se>=ne&&(se=ne-1),bi(re[se],ae,ue))}(Di(),xt(),_t(),y())}function Hc(Bt,Yt,Zt,te,ee,ie){var re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de;for(re=P(),se=g(),he=Li(Bt),de=ee,fe=(oe=Zt)>>16,ue=Ni(ee,ie),ce=_i(0,ie),ne=D(),ae=tt();ue>de&&he>fe&&fe>=0;){for(pe=s((pe=Yt[fe])&ne,ae);ue>de&&oe>>16===fe;)le=s(de,se),vf[le]=vf[le]+pe,++de,oe+=te;fe=oe>>16}for(ne=4042322160|s(D(),g()),ae=g();ce>de&&he>fe&&fe>=0;){for(pe=s((pe=Yt[fe])&ne,ae);ce>de&&oe>>16===fe;)le=s(de,se),vf[le]=vf[le]+pe,de+=re,oe+=M(te,ae);fe=oe>>16}for(ne=D(),ae=tt();ie>de&&he>fe&&fe>=0;){for(pe=s((pe=Yt[fe])&ne,ae);ie>de&&oe>>16===fe;)le=s(de,se),vf[le]=vf[le]+pe,++de,oe+=te;fe=oe>>16}return de}function rt(){return gf[xo]}function Rr(){return gf[qo]}function Lr(){return gf[Mo]}function Qi(){return gf[Bo]}function Wr(Bt){return n(Bt,$n)}function Uu(Bt,Yt){return a(Bt,$n,Yt)}function _r(Bt){return n(Bt,ta)}function xu(Bt,Yt){return a(Bt,ta,Yt)}function gt(Bt){return n(Bt,ia)}function Wh(Bt,Yt){return a(Bt,ia,Yt)}function ar(Bt){return n(Bt,sa)}function jh(Bt,Yt){return a(Bt,sa,Yt)}function wh(Bt,Yt,Zt,te,ee,ie,re){var se,ne,ae,oe,ue,le,ce,fe;for(le=Yt[ue=br((se=0|Zt[0])>>16,(ne=0|Zt[1])>>16)],ae=(ue-1)*(ue-1),ce=ie,(fe=re)>gt(Bt)&&(fe=gt(Bt));fe>ce;){for(;fe>ce&&j(se>>16,ne>>16)>=ae;)vf[ce]=le,++ce,se+=te,ne+=ee;for(oe=j(se>>16,ne>>16);ae>oe;)le=Yt[--ue],ae=(ue-1)*(ue-1)}return Zt[0]=se,Zt[1]=ne,ce}function Sh(Bt,Yt,Zt,te,ee,ie,re){var se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge;if(ue=0|Zt[0],le=0|Zt[1],se=P(),ne=g(),pe=((me=br(ue>>16,le>>16))-1)*(me-1),ke=ie,(ge=gt(Bt))>re&&(ge=re),ce=Ni(ie,ge),he=_i(0,ge),ce>ke)for(ae=D(),oe=tt(),ve=s((ve=Yt[me])&ae,oe);ce>ke;){for(;ce>ke&&j(ue>>16,le>>16)>=pe;)fe=s(ke,ne),vf[fe]=vf[fe]+ve,++ke,ue+=te,le+=ee;for(de=j(ue>>16,le>>16);pe>de;)ve=s((ve=Yt[--me])&ae,oe),pe=(me-1)*(me-1)}if(he>ke)for(ae=4042322160|s(D(),g()),oe=g(),ve=s((ve=Yt[me])&ae,oe);he>ke;){for(;he>ke&&j(ue>>16,le>>16)>=pe;)fe=s(ke,ne),vf[fe]=vf[fe]+ve,ke+=se,ue+=M(te,oe),le+=M(ee,oe);for(de=j(ue>>16,le>>16);pe>de;)ve=s((ve=Yt[--me])&ae,oe),pe=(me-1)*(me-1)}if(ge>ke)for(ae=D(),oe=tt(),ve=s((ve=Yt[me])&ae,oe);ge>ke;){for(;ge>ke&&j(ue>>16,le>>16)>=pe;)fe=s(ke,ne),vf[fe]=vf[fe]+ve,++ke,ue+=te,le+=ee;for(de=j(ue>>16,le>>16);pe>de;)ve=s((ve=Yt[--me])&ae,oe),pe=(me-1)*(me-1)}return Zt[0]=ue,Zt[1]=le,ke}function Of(){return function of(Bt,Yt,Zt,te){var ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he;for(le=Pr(Bt),ce=Li(Bt),ie=Yt-gt(Bt),re=te-ar(Bt),ne=mr(Bt),oe=Wr(Bt),se=ie*ne+re*Fr(Bt),ae=ie*oe+re*_r(Bt),fe=Yt,he=Zt,ue=(ce-1)*(ce-1);j(se>>16,ae>>16)>=ue&&he>fe;)++fe,se+=ne,ae+=oe;fe>Yt&&bi(le[ce-1],Yt,fe),ee=i(),ee[0]=se,ee[1]=ae,fe<gt(Bt)&&(fe=1===P()?wh(Bt,le,ee,ne,oe,fe,he):Sh(Bt,le,ee,ne,oe,fe,he)),he>fe&&(fe=1===P()?Hu(Bt,le,ee,ne,oe,fe,he):zu(Bt,le,ee,ne,oe,fe,he)),Zt>fe&&bi(le[ce-1],fe,Zt)}(Di(),xt(),_t(),y())}function Hu(Bt,Yt,Zt,te,ee,ie,re){var se,ne,ae,oe,ue,le,ce,fe,he,pe;for(fe=Yt[le=br((se=0|Zt[0])>>16,(ne=0|Zt[1])>>16)],oe=((ce=Li(Bt))-1)*(ce-1),ue=(le+1)*(le+1),ae=j(se>>16,ne>>16),he=ie,pe=re;pe>he&&oe>ae;){for(;pe>he&&j(se>>16,ne>>16)<=ue;)vf[he]=fe,++he,se+=te,ne+=ee;for(ae=j(se>>16,ne>>16);ae>ue;)fe=Yt[++le],ue=(le+1)*(le+1)}return Zt[0]=se,Zt[1]=ne,he}function zu(Bt,Yt,Zt,te,ee,ie,re){var se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be;if(ue=0|Zt[0],le=0|Zt[1],se=P(),ne=g(),ve=br(ue>>16,le>>16),de=((ke=Li(Bt))-1)*(ke-1),me=(ve+1)*(ve+1),he=j(ue>>16,le>>16),be=ie,ce=Ni(ie,re),pe=_i(0,re),ce>be&&de>he)for(ae=D(),oe=tt(),ge=s((ge=Yt[ve])&ae,oe);ce>be&&de>he;){for(;ce>be&&j(ue>>16,le>>16)<=me;)fe=s(be,ne),vf[fe]=vf[fe]+ge,++be,ue+=te,le+=ee;for(he=j(ue>>16,le>>16);he>me;)ge=s((ge=Yt[++ve])&ae,oe),me=(ve+1)*(ve+1)}if(pe>be&&de>he)for(ae=4042322160|s(D(),g()),oe=g(),ge=s((ge=Yt[ve])&ae,oe);pe>be&&de>he;){for(;pe>be&&j(ue>>16,le>>16)<=me;)fe=s(be,ne),vf[fe]=vf[fe]+ge,be+=se,ue+=M(te,oe),le+=M(ee,oe);for(he=j(ue>>16,le>>16);he>me;)ge=s((ge=Yt[++ve])&ae,oe),me=(ve+1)*(ve+1)}if(re>be&&de>he)for(ae=D(),oe=tt(),ge=s((ge=Yt[ve])&ae,oe);re>be&&de>he;){for(;re>be&&j(ue>>16,le>>16)<=me;)fe=s(be,ne),vf[fe]=vf[fe]+ge,++be,ue+=te,le+=ee;for(he=j(ue>>16,le>>16);he>me;)ge=s((ge=Yt[++ve])&ae,oe),me=(ve+1)*(ve+1)}return Zt[0]=ue,Zt[1]=le,be}function vn(Bt,Yt){var Zt;return 0!==(Zt=Et(Bt)-Et(Yt))?Zt>0:Kt(Bt)>>>0<Kt(Yt)>>>0}function cn(Bt,Yt,Zt){var te,ee,ie;if(0===Bt)return!1;if(ee=Yt<Ji()?Ji():Yt,ie=Zt>M(Ft(),g())?M(Ft(),g()):Zt,ee<Lr()&&(ee=Lr()),ie>rt()&&(ie=rt()),ee<Er()&&Kr(ee),ie>Gi()&&zi(ie),ie>Ji()&&Oi(ie),ee>=ie)return!1;if(vr(Bt))bi(Bt,ee,ie);else{if(Ku(Bt),Ju(ee),Xu(ie),te=function vh(Bt){return(J(Bt)&dn)>>>8}(Bt),1>=te)return!0;switch(te){case 0:case 1:break;case 2:Yc();break;case 3:Of();break;case 4:case 5:qf()}}return!1}function jr(){var Bt,Yt,Zt;for(Zt=y();Y()<K();){if(Q(Bt=Wc[Y()])>Zt)return!1;if(((Yt=J(Bt))&In)===Js)return!0;if(!X(1))return!1;switch(Yt){case 0:case 1:case 2:case 3:break;case 4:Pa(Wc[Y()],y());break;case 5:(function Ff(Bt,Yt){var Zt,te,ee,ie,re,se,ne,ae,oe;if(ee=fr(Bt),te=wt(ee),re=A(Bt),se=Q(Bt),Pa(Bt,se),ie=ft(Bt),ne=qr(Bt),G(Bt,re-te),H(Bt,ie+ee),ne>0?sr(Bt,Ht(Bt)+ee):(sr(Bt,ee-Ht(Bt)),G(Bt,A(Bt)+Ht(Bt))),ae=0,oe=0-ie-te,an(Bt,ae),un(Bt,oe),ae>=te&&0>oe?lr(Bt):or(Bt),se!==Yt){for(Zt=se;Yt-1>=Zt;Zt++)Qa(Bt,Zt);H(Bt,ft(Bt)-(Yt-se))}})(Wc[Y()],y());break;case 6:Oa(Wc[Y()],y());break;case 7:(function bf(Bt,Yt){var Zt,te,ee,ie,re,se,ne,ae,oe;for(ie=os(Bt),ee=wt(ie),Zt=Nr(Bt),se=Q(Bt),Oa(Bt,se),re=ft(Bt),te=0;5>=te;te++)et(Bt)[te]=z(Bt)[te];if(ne=z(Bt)[je],0===ne&&z(Bt)[Ce],ne=ne>=0?1:-1,0>ne?function vl(Bt,Yt,Zt,te){var ee,ie;z(Bt)[Me]=z(Bt)[Me]-256*Zt,ee=et(Bt)[Me],et(Bt)[Me]=ee+256*(Yt-Zt),ie=et(Bt)[Be],et(Bt)[Be]=ie+256*Yt,Fo(Bt,te-Zt)}(Bt,ie,ee,Zt):function yu(Bt,Yt,Zt,te){var ee,ie;z(Bt)[Me]=z(Bt)[Me]+256*Zt,ee=et(Bt)[Me],et(Bt)[Me]=ee-256*(Yt-Zt),ie=et(Bt)[Be],et(Bt)[Be]=ie+256*Yt,Fo(Bt,te-Zt+Yt)}(Bt,ie,ee,Zt),0===re&&(z(Bt)[Me]=256*Po(Bt)),H(Bt,re+ie),ae=0,oe=0-re-ee,en(Bt,ae),tn(Bt,oe),ae>=ee&&0>oe?lr(Bt):or(Bt),ya(Bt,ie),se!==Yt){for(te=se;Yt-1>=te;te++)Ba(Bt,te);H(Bt,ft(Bt)-(Yt-se))}})(Wc[Y()],y())}rn(Bt),yr(Y()+1)}return!1}function wr(){var Bt,Yt,Zt;for(Yt=Zt=rt();w()<W();){if((Yt=Zt=A(Bt=Xl[w()]))>=rt())return!1;if(Xi(Yt),Ut(Bt)&&Xf(Bt),Yu(Bt)&&(Hf(Bt),kc))return!1;ot(w()+1),w()<W()&&((Zt=A(Xl[w()]))>=Lr()&&fo(Yt,Zt))}return Zt<rt()&&fo(Zt,rt()),!1}function Ar(){for(var Bt,Yt,Zt;w()<W();)if(0===(Bt=ft(Yt=Xl[w()])-1))Dn();else{if(H(Yt,Bt),((Zt=J(Yt))&In)===Js)return!0;switch(Zt){case 0:case 1:case 2:case 3:break;case 4:Gr(Xl[w()],y());break;case 5:Qa(Xl[w()],y());break;case 6:xa(Xl[w()],y());break;case 7:Ba(Xl[w()],y())}Yn(),ot(w()+1)}return!1}function Tn(Bt,Yt){var Zt;for(Zt=0;Zt<V()&&(Kt(Zt)!==Bt||Et(Zt)!==Yt);)Zt+=3;return Zt>=V()?-1:Zt}function Ri(){return Nt()===Cn}function fu(){!function Fh(Bt){hr($()+Bt)}(3)}function ei(Bt,Yt){var Zt;return Bt===Yt||(0!==(Zt=Q(Bt)-Q(Yt))||(Zt=A(Bt)-A(Yt)),0>Zt)}function Y(){return gf[_o]}function yr(Bt){return gf[_o]=Bt}function K(){return gf[No]}function fs(Bt){return gf[No]=Bt}function Li(Bt){return n(Bt,na)}function Mf(Bt,Yt){return a(Bt,na,Yt)}function Pr(Bt){return x(ff,Bt+aa)}function gr(){return 0!==function tl(){return gf[Wo]}()}function Cr(Bt){return gf[Wo]=Bt}function _f(){return 0!==function Df(){return gf[Do]}()}function Vr(Bt){return gf[Do]=Bt}function oa(Bt,Yt){var Zt,te,ee,ie,re;if(-1===(Zt=Tn(Bt,Yt)))return!1;if(0===Zt)return fu(),!0;if(ki(Zt,Kt(0)),yi(Zt,Et(0)),Xt(Zt,dr(0)),fu(),V()<=3)return!0;for(re=0,Zt=3;Zt<V();)vn(Zt,re)&&(re=Zt),Zt+=3;return re+3===V()||(ie=Kt(re),ki(re,ts()),is(ie),te=Et(re),yi(re,Zr()),Qr(te),ee=dr(re),Xt(re,$r()),es(ee)),!0}function h(Bt,Yt){return gf[Bt]=gf[Bt]+Yt}function kr(){return Uc=Gc.ioLoadFunctionFrom("loadBitBltFrom",Zl),oc=Gc.ioLoadFunctionFrom("copyBitsFromtoat",Zl),!!Uc&&!!oc}function cu(){return Zn(P()),zt()<0&&As(0),Rt()>Ft()&&xs(Ft()),function Ic(Bt){return gf[Mo]=Bt}(M(zt(),g())),function el(Bt){return gf[Bo]=Bt}(M(Is(),g())),function zc(Bt){return gf[xo]=Bt}(M(Rt(),g())),function Tc(Bt){return gf[qo]=Bt}(M(Vs(),g())),fs(0),Ki(0),Wc=x(ff,df),Xl=x(ff,df),function Yl(){var Bt,Yt;for(Yt=0,Bt=df;Bt>Yt;)$f(Yt)&&(Q(Yt)>=Rr()||Yf(Yt)),Yt+=Gu(Yt)}(),kc?null:0===K()?(Jt(Rr()),0):(function Kc(){Tr(Wc,0,K()-1)}(),Jt(Q(Wc[0])),y()<Qi()&&Jt(Qi()),Kr(0),zi(M(Ft(),g())-1),void pr())}function rn(Bt){var Yt;return ft(Bt)<=0?null:(Yt=function Fc(Bt){var Yt,Zt;for(Zt=A(Bt),Yt=0;Yt<W()&&A(Xl[Yt])<Zt;)++Yt;for(;Yt<W()&&A(Xl[Yt])===Zt&&ei(Xl[Yt],Bt);)++Yt;return Yt}(Bt),void function Kf(Bt,Yt){var Zt;if(!au(1))return null;for(Zt=W()-1;!(Yt>Zt);)Xl[Zt+1]=Xl[Zt],--Zt;Xl[Yt]=Bt,Ki(W()+1)}(Bt,Yt))}function $f(Bt){return!(J(Bt)>hn)&&0!=(J(Bt)&hn)}function sh(Bt){return vr(Bt)||function qu(Bt){return 0!=(J(Bt)&dn)}(Bt)}function vr(Bt){return 0!=(4278190080&Bt)}function L(Bt){return 0===Bt||vr(Bt)||function Au(Bt){return Bt>=0&&df>Bt}(Bt)&&sh(Bt)}function Ut(Bt){return 0!=(J(Bt)&yn)}function Nu(){return gf[Lo]}function Du(Bt){return gf[Lo]=Bt}function Di(){return gf[Ro]}function Ku(Bt){return gf[Ro]=Bt}function xt(){return gf[Eo]}function Ju(Bt){return gf[Eo]=Bt}function _t(){return gf[zo]}function Xu(Bt){return gf[zo]=Bt}function Nn(Bt){return n(Bt,ca)}function hc(Bt,Yt){return a(Bt,ca,Yt)}function xr(Bt){return n(Bt,fa)}function Ac(Bt,Yt){return a(Bt,fa,Yt)}function Cc(Bt,Yt){return a(Bt,da,Yt)}function _c(Bt,Yt){return a(Bt,va,Yt)}function ea(Bt,Yt){return a(Bt,ha,Yt)}function qr(Bt){return n(Bt,qa)}function $c(Bt,Yt){return a(Bt,qa,Yt)}function Ht(Bt){return n(Bt,_a)}function mf(Bt,Yt){return a(Bt,_a,Yt)}function kf(Bt,Yt){return a(Bt,Na,Yt)}function cr(Bt,Yt,Zt,te){var ee,ie,re,se,ne;if(ee=Hr(),kc)return 0;for(Zs(ee,Bt[0]),Ys(ee,Bt[1]),wi(ee,Yt[0]),Ai(ee,Yt[1]),qi(ee,Zt[0]),xi(ee,Zt[1]),ne=ie=function zf(Bt,Yt){var Zt,te,ee;return Zt=te=ee=function Uf(Bt){var Yt,Zt,te,ee,ie,re,se;return re=Ct(Bt),se=Pi(Bt),ee=jt(Bt),Zt=se-re,te=ee-se,Zt*te>=0?Bt:(h(Ja,1),Yt=te-Zt,ie=Zt,0>ie&&(ie=0-ie),0>Yt&&(Yt=0-Yt),Sa(Bt,ie/Yt))}(Bt),Yt&&(te=Oo(Bt)),te>ee&&(ee=te),Bt!==Zt&&Yt&&(te=Oo(Zt)),te>ee&&(ee=te),ee}(ee,te),re=ee;ie>=re;re+=6)if((se=Yr(re))>ne&&(ne=se),kc)return 0;return Ot(ne,6)}function If(Bt,Yt,Zt,te,ee){var ie,re,se,ne,ae;if(I(i(),Gc.fetchPointerofObject(0,Bt)),Gc.failed())return null;for(re=i()[0],ne=i()[1],ie=1;Yt-1>=ie;ie++){if(I(i(),Gc.fetchPointerofObject(ie,Bt)),Gc.failed())return null;if(se=i()[0],ae=i()[1],i()[0]=re,i()[1]=ne,l()[0]=se,l()[1]=ae,at(2),ct(te,i(),l(),ee,Zt,0),kc)return null;re=se,ne=ae}}function Pf(Bt,Yt,Zt,te,ee){var ie,re,se,ne,ae,oe,ue,le,ce;for(ie=0;Yt-1>=ie;ie++){if(re=Gc.fetchPointerofObject(3*ie,Bt),I(i(),re),re=Gc.fetchPointerofObject(3*ie+1,Bt),I(l(),re),re=Gc.fetchPointerofObject(3*ie+2,Bt),I(F(),re),Gc.failed())return null;if(at(3),ne=i()[0],ue=i()[1],ae=l()[0],le=l()[1],oe=F()[0],ce=F()[1],ne===ue&&ae===le||ae===oe&&le===ce)ct(te,i(),F(),ee,Zt,0);else{if(se=cr(i(),l(),F(),0!==te&&0!==ee),kc)return null;ur(te,ee,Zt,0,se)}if(kc)return null}}function xf(Bt,Yt,Zt,te,ee){jt(Yt)>=Ct(Yt)?(G(Bt,$t(Yt)),hi(Bt,Ct(Yt)-ee),ru(Bt,Vi(Yt)),Un(Bt,Pi(Yt)-ee),$s(Bt,Tt(Yt)),Yo(Bt,jt(Yt)-ee)):(G(Bt,Tt(Yt)),hi(Bt,jt(Yt)-ee),ru(Bt,Vi(Yt)),Un(Bt,Pi(Yt)-ee),$s(Bt,$t(Yt)),Yo(Bt,Ct(Yt)-ee)),tr(Bt,ks()),as(Bt,Zt),ns(Bt,te)}function pa(Bt){return!(!Uc&&!kr())&&Uc(Bt)}function Bf(Bt,Yt,Zt,te,ee,ie,re){var se,ne,ae,oe,ue,le,ce,fe,he,pe;if(Yt.isNil)he=0,fe=null;else{if(nt(Yt)!==Gc.classBitmap())return Gc.primitiveFail();he=p(Yt),fe=Yt.wordsAsInt32Array()}return"number"==typeof Bt?Gc.primitiveFail():Gc.isPointers(Bt)?p(Bt)<5?Gc.primitiveFail():nt(se=Gc.fetchPointerofObject(0,Bt))!==Gc.classBitmap()?Gc.primitiveFail():(ne=p(se),ce=Gc.fetchIntegerofObject(1,Bt),ue=Gc.fetchIntegerofObject(2,Bt),ae=Gc.fetchIntegerofObject(3,Bt),Gc.failed()?null:ce>=0&&ue>=0?32!==ae&&8!==ae&&16!==ae&&1!==ae&&2!==ae&&4!==ae||0!==he&&he!==M(1,ae)?Gc.primitiveFail():(pe=Ot(32,ae),ne!==(le=Ot(ce+(pe-1),pe))*ue?Gc.primitiveFail():(oe=pf(he,fe),kc?null:(Mh(oe,ce),Ll(oe,ue),mh(oe,ae),af(oe,le),Rh(oe,ne),Nh(oe,Zt),st(oe,re),ho(oe,te,ee,ie,ce,ue),oe))):Gc.primitiveFail()):Gc.primitiveFail()}function wa(Bt){var Yt,Zt,te;return(te=ir(Bt))>p(gc)?null:(Zt=Gc.fetchPointerofObject(te,gc),p(Yt=Gc.fetchPointerofObject(0,Zt))!==zh(Bt)?null:Yt.wordsAsInt32Array())}function Ma(Bt,Yt,Zt,te,ee,ie,re){var se,ne,ae,oe,ue,le,ce,fe;return te!==ee||0!==ie&&0!==re?(se=6*Bt,Zt?(ae=(Yt.int16Array||(Yt.int16Array=new Int16Array(Yt.buffer,Yt.byteOffset)))[se+0],le=(Yt.int16Array||(Yt.int16Array=new Int16Array(Yt.buffer,Yt.byteOffset)))[se+1],oe=(Yt.int16Array||(Yt.int16Array=new Int16Array(Yt.buffer,Yt.byteOffset)))[se+2],ce=(Yt.int16Array||(Yt.int16Array=new Int16Array(Yt.buffer,Yt.byteOffset)))[se+3],ue=(Yt.int16Array||(Yt.int16Array=new Int16Array(Yt.buffer,Yt.byteOffset)))[se+4],fe=(Yt.int16Array||(Yt.int16Array=new Int16Array(Yt.buffer,Yt.byteOffset)))[se+5]):(ae=0|Yt[se+0],le=0|Yt[se+1],oe=0|Yt[se+2],ce=0|Yt[se+3],ue=0|Yt[se+4],fe=0|Yt[se+5]),ae===oe&&le===ce||oe===ue&&ce===fe?ae===ue&&le===fe?null:(i()[0]=ae,i()[1]=le,l()[0]=ue,l()[1]=fe,at(2),ct(ie,i(),l(),re,te,ee)):(i()[0]=ae,i()[1]=le,l()[0]=oe,l()[1]=ce,F()[0]=ue,F()[1]=fe,at(3),ne=cr(i(),l(),F(),0!==ie&&0!==re),kc?null:void ur(ie,re,te,ee,ne))):null}function lo(Bt){var Yt;return Yt=Nu(),p(Bt)<se?null:(G(Yt,Gc.fetchIntegerofObject(oe,Bt)),hi(Yt,Gc.fetchIntegerofObject(ue,Bt)),tr(Yt,Gc.fetchIntegerofObject(le,Bt)),H(Yt,Gc.fetchIntegerofObject(ae,Bt)),Yt)}function ho(Bt,Yt,Zt,te,ee,ie){var re,se,ne,ae,oe,ue,le,ce,fe,he;Zt[0]=Zt[0]+Yt[0],Zt[1]=Zt[1]+Yt[1],te[0]=te[0]+Yt[0],te[1]=te[1]+Yt[1],Pt(Yt),Pt(Zt),Pt(te),(ne=(re=Zt[0]-Yt[0])*re+(se=Zt[1]-Yt[1])*se)>0?(ae=re*ee*65536/ne|0,oe=se*ee*65536/ne|0):(ae=0,oe=0),(ue=(fe=te[0]-Yt[0])*fe+(he=te[1]-Yt[1])*he)>0?(le=fe*ie*65536/ue|0,ce=he*ie*65536/ue|0):(le=0,ce=0),Wh(Bt,Yt[0]),jh(Bt,Yt[1]),rf(Bt,ae),tf(Bt,oe),Uu(Bt,le),xu(Bt,ce)}function po(Bt){var Yt,Zt,te,ee,ie,re,se,ne;if(!Gc.isArray(Bt))return!1;for(gc=Bt,se=0;se<=p(gc)-1;se++){if("number"==typeof(re=Gc.fetchPointerofObject(se,gc)))return!1;if(!Gc.isPointers(re))return!1;if(p(re)<5)return!1;if(nt(Yt=Gc.fetchPointerofObject(0,re))!==Gc.classBitmap())return!1;if(Zt=p(Yt),ie=Gc.fetchIntegerofObject(1,re),ee=Gc.fetchIntegerofObject(2,re),te=Gc.fetchIntegerofObject(3,re),Gc.failed())return!1;if(!(ie>=0&&ee>=0))return!1;if(ne=Ot(32,te),Zt!==Ot(ie+(ne-1),ne)*ee)return!1}return!0}function eh(Bt,Yt,Zt,te,ee){var ie,re;return nt(Bt)!==Gc.classBitmap()?Gc.primitiveFail():(re=p(Bt),ie=function sf(Bt,Yt,Zt){var te,ee,ie,re;if(!bt(ee=ua+Yt))return 0;if(df=(te=df)+ee,U(te,Zt?gn:kn),st(te,0),pt(te,ee),re=Pr(te),gr())for(ie=0;Yt-1>=ie;ie++)re[ie]=q(Bt[ie]);else for(ie=0;Yt-1>=ie;ie++)re[ie]=Bt[ie];return Mf(te,Yt),te}(Bt.wordsAsInt32Array(),re,ee),kc?null:(ho(ie,Yt,Zt,te,re,re),ie))}function rh(Bt,Yt,Zt,te,ee){var ie,re,se,ne,ae,oe;ie=[1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0,.1950903220161282,.38268343236509,.555570233019602,.707106781186547,.831469612302545,.9238795325112865,.98078528040323,1][2*Bt+0]*Yt+te|0,ne=[0,.1950903220161282,.3826834323650897,.555570233019602,.707106781186547,.831469612302545,.923879532511287,.98078528040323,1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0][2*Bt+0]*Zt+ee|0,i()[0]=ie,i()[1]=ne,se=[1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0,.1950903220161282,.38268343236509,.555570233019602,.707106781186547,.831469612302545,.9238795325112865,.98078528040323,1][2*Bt+2]*Yt+te|0,oe=[0,.1950903220161282,.3826834323650897,.555570233019602,.707106781186547,.831469612302545,.923879532511287,.98078528040323,1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0][2*Bt+2]*Zt+ee|0,F()[0]=se,F()[1]=oe,re=2*(re=[1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0,.1950903220161282,.38268343236509,.555570233019602,.707106781186547,.831469612302545,.9238795325112865,.98078528040323,1][2*Bt+1]*Yt+te|0)-(ie+se>>1),ae=2*(ae=[0,.1950903220161282,.3826834323650897,.555570233019602,.707106781186547,.831469612302545,.923879532511287,.98078528040323,1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0][2*Bt+1]*Zt+ee|0)-(ne+oe>>1),l()[0]=re,l()[1]=ae}function I(Bt,Yt){var Zt;return nt(Yt)!==Gc.classPoint()?Gc.primitiveFail():"number"==typeof(Zt=Gc.fetchPointerofObject(0,Yt))||Zt.isFloat?(Bt[0]="number"==typeof Zt?Zt:0|Gc.floatValueOf(Zt),"number"==typeof(Zt=Gc.fetchPointerofObject(1,Yt))||Zt.isFloat?void(Bt[1]="number"==typeof Zt?Zt:0|Gc.floatValueOf(Zt)):Gc.primitiveFail()):Gc.primitiveFail()}function nh(Bt,Yt,Zt,te,ee,ie){var re,se,ne,ae,oe;for(ie?(se=(Bt.int16Array||(Bt.int16Array=new Int16Array(Bt.buffer,Bt.byteOffset)))[0],ae=(Bt.int16Array||(Bt.int16Array=new Int16Array(Bt.buffer,Bt.byteOffset)))[1]):(se=0|Bt[0],ae=0|Bt[1]),re=1;Yt-1>=re;re++){if(ie?(ne=(Bt.int16Array||(Bt.int16Array=new Int16Array(Bt.buffer,Bt.byteOffset)))[2*re],oe=(Bt.int16Array||(Bt.int16Array=new Int16Array(Bt.buffer,Bt.byteOffset)))[2*re+1]):(ne=0|Bt[2*re],oe=0|Bt[2*re+1]),i()[0]=se,i()[1]=ae,l()[0]=ne,l()[1]=oe,at(2),ct(te,i(),l(),ee,Zt,0),kc)return null;se=ne,ae=oe}}function So(){var Bt,Yt,Zt,re;return 2!==Gc.methodArgumentCount()?Jl:0!==(Yt=R(Gc.stackValue(2)))?Yt:(Zt=Gc.stackObjectValue(0),Bt=Gc.stackObjectValue(1),Gc.failed()?Hl:0!==(Yt=Bi(Gc.fetchPointerofObject(ie,vc)))?Yt:pa(Gc.fetchPointerofObject(te,vc))?po(Gc.fetchPointerofObject(ee,vc))?p(Bt)<se?Qe:p(Zt)<ce?pi:(re=Nt())===Mn||re===Bn||re===qn?Ds:0:Si:Xe)}function Bi(Bt){return nt(Bt)!==Gc.classBitmap()?Ye:(vf=Bt.words,Zc(p(Bt)-1),0)}function Ao(Bt,Yt,Zt){return!Bt.isNil&&("number"==typeof Bt||p(Bt)!==Zt?Gc.primitiveFail():(Gc.isWords(Bt)?function qh(Bt,Yt,Zt){var te,ee;for(ee=Bt.wordsAsFloat32Array(),te=0;Zt-1>=te;te++)Yt[te]=ee[te]}(Bt,Yt,Zt):function Vf(Bt,Yt,Zt){var te,ee;for(te=0;Zt-1>=te;te++){if("number"!=typeof(ee=Gc.fetchPointerofObject(te,Bt))&&!ee.isFloat)return Gc.primitiveFail();Yt[te]="number"==typeof ee?ee:Gc.floatValueOf(ee)}}(Bt,Yt,Zt),!0))}function ur(Bt,Yt,Zt,te,ee){var ie,re,se,ne;for(0===Bt||0===Yt?(ne=!1,se=0):(ne=!0,se=wt(Bt)),re=6*ee;re>0;){if(ie=ne?$u():ah(),kc)return 0;xf(ie,re,Zt,te,se),ne&&(bu(ie,Yt),us(ie,Bt),ku(ie,Bt)),re-=6}vt()}function ct(Bt,Yt,Zt,te,ee,ie){var re,se;return 0===Bt||0===te?(re=function ef(){var Bt;return bt(la)?(df=(Bt=df)+la,U(Bt,mn),st(Bt,0),pt(Bt,la),Bt):0}(),se=0):(re=function Qu(){var Bt;return bt(Va)?(df=(Bt=df)+Va,U(Bt,On),st(Bt,0),pt(Bt,Va),Bt):0}(),se=wt(Bt)),kc?0:(function th(Bt,Yt,Zt,te,ee,ie){var re,se,ne;Yt[1]<=Zt[1]?(re=Yt,se=Zt,ne=1):(re=Zt,se=Yt,ne=-1),G(Bt,re[0]),hi(Bt,re[1]-te),tr(Bt,ks()),as(Bt,ee),ns(Bt,ie),hc(Bt,se[0]),Ac(Bt,se[1]-te),kf(Bt,ne)}(re,Yt,Zt,se,ee,ie),void(Ut(re)&&(ju(re,te),sr(re,Bt),Cu(re,Bt))))}function nr(Bt){return"number"==typeof Bt?Hi:Gc.isWords(Bt)?p(Bt)<Uo?qs:(fn(Bt),function Lh(){return gf[Ko]}()!==Go?Ei:Qt()!==p(Bt)?Ms:su()!==To?js:(ff=x(gf,su()),Wc=x(ff,Br()),Xl=x(Wc,K()),To+Br()+K()+W()>Qt()?Bs:0)):Yi}function X(Bt){return!(To+df+K()+W()+Bt>$())||(It(Jn),!1)}function wo(){return 0!==function Pu(){return gf[Ho]}()}function Vt(Bt){return gf[Ho]=Bt}function n(Bt,Yt){return ff[Bt+Yt]}function a(Bt,Yt,Zt){return ff[Bt+Yt]=Zt}function su(){return gf[Jo]}function Br(){return gf[Xo]}function uu(Bt){return gf[Xo]=Bt}function ir(Bt){return n(Bt,Es)}function st(Bt,Yt){return a(Bt,Es,Yt)}function Gu(Bt){return n(Bt,zs)}function pt(Bt,Yt){return a(Bt,zs,Yt)}function J(Bt){return n(Bt,Ks)&bn}function U(Bt,Yt){return a(Bt,Ks,Yt)}function wt(Bt){return Bt>>1}function i(){return x(gf,Qo)}function l(){return x(gf,Zo)}function F(){return x(gf,$o)}function Ci(){return x(gf,tu)}function Dr(){Y()>=K()&&0===W()&&v(Cn),y()>=Rr()&&v(Cn)}function Fn(){var Bt,Yt;if((Yt=Nt())===jn){if(cu(),kc)return 0;Yt=Pn}if(Yt===Pn){if(mc&&(Nc=Gc.ioMicroMSecs()),Bt=jr(),mc&&(h(ko,1),h(Ul,Gc.ioMicroMSecs()-Nc)),kc)return v(Pn);if(Bt)return v(Mn),It(Kn);ot(0),vt(),Lt(1),Yt=Vn}if(Yt===Vn){if(mc&&(Nc=Gc.ioMicroMSecs()),0!==Ns()&&0==(y()&mt())&&pr(),Lt(0),Bt=wr(),mc&&(h(vo,1),h(Gl,Gc.ioMicroMSecs()-Nc)),kc)return v(Vn);if(Bt)return v(Bn),It(zn);Yt=wn,vt(),Oi(0)}if(Yt===wn){if(mc&&(Nc=Gc.ioMicroMSecs()),(y()&mt())===mt()&&(ls(y()),Dr()),mc&&(h(ao,1),h(Al,Gc.ioMicroMSecs()-Nc)),kc)return v(wn);if(Ri())return 0;Yt=xn,ot(0),Jt(y()+1)}if(Yt===xn){if(mc&&(Nc=Gc.ioMicroMSecs()),Bt=Ar(),mc&&(h(mo,1),h(Kl,Gc.ioMicroMSecs()-Nc)),kc)return v(xn);if(Bt)return v(qn),It(Rn);v(Pn)}}function R(Bt){var Yt;return Gc.failed()?He:"number"==typeof Bt?Ze:Gc.isPointers(Bt)?p(Bt)<Zt?ai:(vc=Bt,0!==(Yt=nr(Gc.fetchPointerofObject(re,Bt)))?Yt:(di(0),df=Br(),kc=!1,0)):$e}function S(Bt,Yt){var Zt;return 0!==(Zt=R(Bt))?Zt:Nt()===Yt?0:(di(En),Ds)}function Xi(Bt){if(0===V())return null;for(;rs()<=Bt;)if(oa(Zi(),0===V()?-1:Zr()),0===V())return null}function Tr(Bt,Yt,Zt){var te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if((ue=Zt+1-Yt)<=1)return 0;if((ee=ei(ie=Bt[Yt],se=Bt[Zt]))||(le=Bt[Yt],Bt[Yt]=Bt[Zt],Bt[Zt]=le,ce=ie,ie=se,se=ce),2>=ue)return 0;if((ee=ei(ie,re=Bt[ne=Yt+Zt>>1]))?(ee=ei(re,se))||(le=Bt[Zt],Bt[Zt]=Bt[ne],Bt[ne]=le,re=se):(le=Bt[Yt],Bt[Yt]=Bt[ne],Bt[ne]=le,re=ie),3>=ue)return 0;for(ae=Yt,oe=Zt,te=!0;te;){for(ee=!0;ee;)ae<=--oe?ee=ei(re,le=Bt[oe]):ee=!1;for(ee=!0;ee;)++ae<=oe?ee=ei(le=Bt[ae],re):ee=!1;(te=oe>=ae)&&(le=Bt[ae],Bt[ae]=Bt[oe],Bt[oe]=le)}Tr(Bt,Yt,oe),Tr(Bt,ae,Zt)}function Dn(){var Bt;for(Bt=w(),Ki(W()-1);Bt<W();)Xl[Bt]=Xl[Bt+1],++Bt}function yt(Bt,Yt){var Zt;for(Zt=Bt;0>Zt;)Zt+=Yt;for(;Zt>=Yt;)Zt-=Yt;return Zt}function Yn(){var Bt,Yt;return 0===w()?null:(Yt=A(Bt=Xl[w()]),A(Xl[w()-1])<=Yt?null:void function Ou(Bt,Yt,Zt){var te;for(te=Bt;te>0&&A(Xl[te-1])>Zt;)Xl[te]=Xl[te-1],--te;Xl[te]=Yt}(w(),Bt,Yt))}function xc(){return pc=function gu(Bt){return n(Bt,Le)}(dc)}function qc(){return pc=function Fu(Bt){return n(Bt,ze)}(dc)}function Mc(){return pc=function Vu(Bt){return n(Bt,Ca)}(dc)}function Zn(Bt){var Yt;Bt>=4&&(Yt=4),Bt>=2&&4>Bt&&(Yt=2),2>Bt&&(Yt=1),Vh(Yt),1===Yt&&(Os(0),Qs(4294967295),Hs(0)),2===Yt&&(Os(1),Qs(4244438268),Hs(1)),4===Yt&&(Os(2),Qs(4042322160),Hs(3)),Dh(2*g()),_h(g())}function Wt(Bt,Yt){return(0|Yt[Bt])>>>16}function Ii(Bt,Yt){return 65535&(0|Yt[Bt])}function ra(Bt,Yt,Zt){return An()?(ki(0,Bt),yi(0,Yt),Xt(0,Zt),3===V()?null:void(vn(0,V()-3)&&(ki(0,ts()),yi(0,Zr()),Xt(0,$r()),is(Bt),Qr(Yt),es(Zt)))):null}function Ji(){return gf[Bu]}function Oi(Bt){return gf[Bu]=Bt}function Gi(){return gf[iu]}function zi(Bt){return gf[iu]=Bt}function Ft(){return gf[_u]}function Zc(Bt){return gf[_u]=Bt}function Er(){return gf[Eu]}function Kr(Bt){return gf[Eu]=Bt}function j(Bt,Yt){return Bt*Bt+Yt*Yt}function Et(Bt){return dt(Bt+1)}function yi(Bt,Yt){return ht(Bt+1,Yt)}function dr(Bt){return dt(Bt+2)}function Xt(Bt,Yt){return ht(Bt+2,Yt)}function V(){return E()}function Kt(Bt){return dt(Bt)}function ki(Bt,Yt){return ht(Bt,Yt)}function Nt(){return gf[Zu]}function v(Bt){return gf[Zu]=Bt}function Oa(Bt,Yt){var Zt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve;return!Ut(Bt)&&Yt>=Mr(Bt)?H(Bt,0):(he=A(Bt),pe=Q(Bt),me=Oh(Bt),ve=Lu(Bt),ne=2*(me-he),ae=he+Nr(Bt)-2*me,oe=2*(ve-pe),ue=pe+(te=Mr(Bt))-2*ve,2>(le=2*(Zt=te-pe))&&(le=2),fe=function Ql(Bt){var Yt,Zt;return((Yt=65535&Bt)*Yt>>>16)+Yt*(Zt=Bt>>>16&255)*2+(Zt*Zt<<16)>>>8}(ce=Ot(16777216,le)),re=ne*ce,re+=(ee=ae*fe*2)>>1,se=oe*ce,se+=(ie=ue*fe*2)>>1,H(Bt,Zt),(de=z(Bt))[Me]=256*he,de[Be]=256*pe,de[je]=re,de[xe]=se,de[Ce]=ee,de[Ve]=ie,void((pe=Q(Bt))!==Yt&&(xa(Bt,Yt),H(Bt,Zt-(Yt-pe)))))}function Pa(Bt,Yt){var Zt,te,ee,ie,re,se,ne,ae,oe;if(!Ut(Bt)&&Yt>=xr(Bt))return H(Bt,0);if(Zt=Nn(Bt)-A(Bt),te=xr(Bt)-Q(Bt),Zt>=0?(ae=1,ne=Zt,ee=0):(ae=-1,ne=0-Zt,ee=1-te),0===te?(ee=0,oe=Zt,ie=0):te>ne?(oe=0,ie=ne):(oe=Ot(ne,te)*ae,ie=function Kh(Bt,Yt){return Bt-Ot(Bt,Yt)*Yt|0}(ne,te)),H(Bt,te),$c(Bt,ae),mf(Bt,oe),ea(Bt,ee),_c(Bt,ie),Cc(Bt,te),(se=Q(Bt))!==Yt){for(re=se;Yt-1>=re;re++)Gr(Bt);H(Bt,te-(Yt-se))}}function zr(Bt,Yt){var Zt,te,ee,ie,re;for(ee=Bt[Me],ie=Bt[Be],Zt=Bt[je],te=Bt[xe],re=256*Yt;re>ie&&te>=0;)ee+=Zt+32768>>16,ie+=te+32768>>16,Zt+=Bt[Ce],te+=Bt[Ve];return Bt[Me]=ee,Bt[Be]=ie,Bt[je]=Zt,Bt[xe]=te,ee>>8}function xa(Bt,Yt){G(Bt,zr(z(Bt),Yt))}function Gr(Bt){var Yt,Zt;Zt=A(Bt)+Ht(Bt),Yt=function Lc(Bt){return n(Bt,ha)}(Bt)+function jc(Bt){return n(Bt,va)}(Bt),Yt>0&&(Zt+=qr(Bt),Yt-=function wc(Bt){return n(Bt,da)}(Bt)),ea(Bt,Yt),G(Bt,Zt)}function Ba(Bt,Yt){var Zt,te,ee,ie;Zt=wt(te=os(Bt)),ee=Bh(Bt)+1,ie=Th(Bt)+1,en(Bt,ee),tn(Bt,ie),ee>=Zt&&lr(Bt),ie>=0&&or(Bt),0>ie+Zt?zr(z(Bt),Yt):z(Bt)[Me]=256*Po(Bt),zr(et(Bt),Yt),ya(Bt,te)}function Qa(Bt,Yt){var Zt,te,ee,ie,re,se;re=nn(Bt)+1,se=on(Bt)+1,an(Bt,re),un(Bt,se),re>=(te=wt(ee=fr(Bt)))&&lr(Bt),se>=0&&or(Bt),Zt=A(Bt),Gr(Bt),ie=A(Bt),(ee>=re||se+te>=0)&&function xh(Bt,Yt,Zt){var te,ee,ie,re,se,ne,ae;ne=nn(Bt),ae=on(Bt),ie=wt(te=fr(Bt)),re=ln(Bt),se=qr(Bt),ee=Zt-Yt,te>ne&&(0>se?re-=ee:(re+=ee,G(Bt,Yt))),ae+ie===0&&(se>0?re-=Ht(Bt):(re+=Ht(Bt),G(Bt,Yt))),ae+ie>0&&(0>se?(re+=ee,G(Bt,Yt)):re-=ee),sr(Bt,re)}(Bt,Zt,ie)}function It(Bt){di(Bt),kc=!0}function Ur(){return gf[sl]}function di(Bt){return gf[sl]=Bt}function er(Bt,Yt){return p(Yt)<se?Gc.primitiveFail():(Gc.storeIntegerofObjectwithValue(ne,Yt,ir(Bt)),Gc.storeIntegerofObjectwithValue(oe,Yt,A(Bt)),Gc.storeIntegerofObjectwithValue(ue,Yt,y()),Gc.storeIntegerofObjectwithValue(le,Yt,Jr(Bt)),Gc.storeIntegerofObjectwithValue(ae,Yt,ft(Bt)),void Du(Bt))}function k(){uu(df)}function yo(Bt){var Yt,Zt,te;return Yt=Di(),Zt=xt(),te=_t(),p(Bt)<ce?Gc.primitiveFail():(Gc.storeIntegerofObjectwithValue(fe,Bt,ir(Yt)),Gc.storeIntegerofObjectwithValue(pe,Bt,Zt),Gc.storeIntegerofObjectwithValue(he,Bt,te),void Gc.storeIntegerofObjectwithValue(de,Bt,y()))}function Xr(){return Gc.failed()?null:(kc&&function Lf(Bt,Yt){var Zt,te;te=Ur(),te===Kn&&(Zt=Wc[Y()],er(Zt,Bt),yr(Y()+1)),te===zn&&yo(Yt),te===Rn&&(Zt=Xl[w()],er(Zt,Bt))}(Gc.stackObjectValue(1),Gc.stackObjectValue(0)),k(),Gc.pop(3),void Gc.pushInteger(Ur()))}function Yr(Bt){var Yt,Zt,te;return te=function Ef(Bt){var Yt,Zt,te,ee,ie;return ie=Ct(Bt),(te=jt(Bt))===ie?Bt:(0>(Zt=te-ie)&&(Zt=0-Zt),Zt>255?(h(Ua,1),Fa(Bt)):(ee=$t(Bt),0>(Yt=Tt(Bt)-ee)&&(Yt=0-Yt),Yt>32*Zt?(h(Xa,1),Fa(Bt)):Bt))}(Bt),te!==Bt?(Yt=Yr(Bt),kc?0:(Zt=Yr(te),kc?0:Yt>=Zt?Yt:Zt)):Bt}function Oo(Bt){var Yt,Zt,te,ee,ie,re;return ie=$t(Bt),(Zt=(re=Vi(Bt))-ie)*(te=Tt(Bt)-re)>=0?Bt:(h(Ja,1),0>(ee=Zt)&&(ee=0-ee),0>(Yt=te-Zt)&&(Yt=0-Yt),Sa(Bt,ee/Yt))}function Io(Bt,Yt,Zt){0===V()?An()&&(is(Bt),Qr(Yt),es(Zt)):oa(Bt,Yt)||ra(Bt,Yt,Zt)}function Hf(Bt){var Yt,Zt;return X(6)?(Yt=Jr(Bt)<<1,0!==(Zt=function wu(Bt){return n(Bt,Ts)}(Bt))&&Io(Zt,Yt,999999999),0!==(Zt=function mu(Bt){return n(Bt,Ls)}(Bt))&&Io(Zt,Yt,999999999),void Xi(A(Bt))):null}function Xf(Bt){var Yt,Zt,te,ee,ie,re;switch(re=function kh(Bt){return J(Bt)>>>1}(Bt),dc=Bt,re){case 0:case 1:break;case 2:!function Bc(){return pc=ln(dc)}();break;case 3:qc()}switch(ee=pc,re){case 0:case 1:break;case 2:Mc();break;case 3:xc()}return 0===(Zt=pc)?null:X(3)?(Yt=1+(Jr(Bt)<<1),ie=A(Bt)+ee,-1===(te=Tn(Zt,Yt))?ra(Zt,Yt,ie):dr(te)<ie&&Xt(te,ie),void Xi(A(Bt))):null}function Zi(){return 0===V()?0:ts()}function Zr(){return Et(V()-3)}function Qr(Bt){return yi(V()-3,Bt)}function $r(){return dr(V()-3)}function es(Bt){return Xt(V()-3,Bt)}function ts(){return Kt(V()-3)}function is(Bt){return ki(V()-3,Bt)}function rs(){return 0===V()?999999999:$r()}function q(Bt){var Yt,Zt,te,ee,ie,re;return 0===Bt||vr(Bt)?(te=255&Bt,ee=Bt>>>8&255,ie=Bt>>>16&255,Yt=Bt>>>24&255,gr()&&(Zt=(Yt*(re=$i())[6]+re[7])/Yt,ie=(ie*re[0]+re[1])*Zt|0,ee=(ee*re[2]+re[3])*Zt|0,te=(te*re[4]+re[5])*Zt|0,Yt=Yt*Zt|0,ie=Math.max(ie,0),ie=Math.min(ie,255),ee=Math.max(ee,0),ee=Math.min(ee,255),te=Math.max(te,0),te=Math.min(te,255),Yt=Math.max(Yt,0),Yt=Math.min(Yt,255)),1>Yt?0:(255>Yt&&wo()&&It(Gn),te+(ee<<8)+(ie<<16)+(Yt<<24))):Bt}function Pt(Bt){_f()?function hh(Bt,Yt){!function ph(Bt,Yt,Zt){var te,ee,ie;te=ss(),ee=(te[0]*Bt+te[1]*Yt+te[2])*P()|0,ie=(te[3]*Bt+te[4]*Yt+te[5])*P()|0,Zt[0]=ee,Zt[1]=ie}(0|Bt[0],0|Bt[1],Yt)}(Bt,Bt):(Bt[0]=(Bt[0]+ms())*P(),Bt[1]=(Bt[1]+hs())*P())}function at(Bt){Bt>0&&Pt(i()),Bt>1&&Pt(l()),Bt>2&&Pt(F()),Bt>3&&Pt(Ci())}function ci(Bt){var Yt,Zt,te,ee;return 0===Bt?0:(i()[0]=0,i()[1]=0,l()[0]=256*Bt,l()[1]=0,F()[0]=0,F()[1]=256*Bt,at(3),Yt=l()[0]-i()[0],Zt=l()[1]-i()[1],te=128+(0|Math.sqrt(Yt*Yt+Zt*Zt))>>8,Yt=F()[0]-i()[0],Zt=F()[1]-i()[1],te>(ee=128+(0|Math.sqrt(Yt*Yt+Zt*Zt))>>8)&&(te=ee),0===te?1:te)}function ou(Bt){var Yt,Zt,te,ee,ie;return gr()?(Zt=255&Bt,te=Bt>>>8&255,Yt=Bt>>>24&255,ee=(ee=Bt>>>16&255)*(ie=$i())[0]+ie[1]|0,te=te*ie[2]+ie[3]|0,Zt=Zt*ie[4]+ie[5]|0,Yt=Yt*ie[6]+ie[7]|0,ee=Math.max(ee,0),ee=Math.min(ee,255),te=Math.max(te,0),te=Math.min(te,255),Zt=Math.max(Zt,0),Zt=Math.min(Zt,255),Yt=Math.max(Yt,0),16>(Yt=Math.min(Yt,255))?0:Zt+(te<<8)+(ee<<16)+(Yt<<24)):Bt}function Qt(){return gf[eu]}function vt(){hr(Qt())}function lu(Bt){return!!function Sc(Bt){return X(Bt)}(Bt)&&(hr($()-Bt),!0)}function E(){return Qt()-$()}function dt(Bt){return gf[$()+Bt]}function ht(Bt,Yt){return gf[$()+Bt]=Yt}function $(){return gf[Ya]}function hr(Bt){return gf[Ya]=Bt}function Bh(Bt){return n(Bt,We)}function en(Bt,Yt){return a(Bt,We,Yt)}function Th(Bt){return n(Bt,De)}function tn(Bt,Yt){return a(Bt,De,Yt)}function os(Bt){return n(Bt,Te)}function ku(Bt,Yt){return a(Bt,Te,Yt)}function bu(Bt,Yt){return a(Bt,Le,Yt)}function et(Bt){return x(ff,Bt+Ee)}function us(Bt,Yt){return a(Bt,ze,Yt)}function nn(Bt){return n(Bt,ka)}function an(Bt,Yt){return a(Bt,ka,Yt)}function on(Bt){return n(Bt,ga)}function un(Bt,Yt){return a(Bt,ga,Yt)}function fr(Bt){return n(Bt,ba)}function Cu(Bt,Yt){return a(Bt,ba,Yt)}function ju(Bt,Yt){return a(Bt,Ca,Yt)}function ln(Bt){return n(Bt,ja)}function sr(Bt,Yt){return a(Bt,ja,Yt)}function fn(Bt){gf=Bt.wordsAsInt32Array()}var Bt=1,Yt=11,Zt=12,te=2,ee=3,ie=1,re=0,se=6,ne=0,ae=4,oe=1,ue=2,le=3,ce=6,fe=0,he=2,pe=1,de=3,me=16,ve=12,ke=11,ge=14,be=13,ye=10,Fe=18,Se=15,Oe=14,Ie=15,Ae=21,Pe=18,we=16,Ce=4,Ve=5,je=2,xe=3,qe=10,Me=0,Be=1,_e=12,Ne=13,We=18,De=19,Te=20,Le=16,Re=28,Ee=22,ze=17,Ke=10,Ge=4,Ue=65536,He=100,Je=121,Xe=122,Ye=114,Qe=112,Ze=101,$e=102,ti=104,ai=103,oi=120,li=119,pi=113,Si=123,Wi=115,Ei=108,Hi=105,Yi=106,js=110,qs=107,Ms=109,Bs=111,_s=118,Ws=117,Ds=116,Ts=8,Ls=9,Rs=7,Es=2,zs=1,Ks=0,Gs=6,Us=1024,Js=2,hn=255,pn=256,dn=65280,mn=4,kn=512,gn=768,bn=65535,yn=1,Sn=7,On=5,In=254,Pn=1,wn=5,Cn=8,Vn=3,jn=0,xn=6,qn=7,Mn=2,Bn=4,_n=4,Wn=5,Ln=6,Rn=6,En=2,zn=5,Kn=4,Gn=3,Jn=1,Xn=6,Qn=7,$n=8,ta=9,ia=4,sa=5,na=10,aa=12,ua=12,la=16,ca=14,fa=15,ha=13,da=15,va=14,ka=18,ga=19,ba=20,Ca=16,Va=21,ja=17,qa=10,_a=12,Na=11,Wa=51,Da=50,Ta=53,La=48,Ra=52,za=49,Ka=13,Ga=14,Ua=109,Ha=111,Ja=108,Xa=110,Ya=10,Za=69,$a=43,to=45,eo=42,io=44,ro=24,so=97,no=107,ao=103,oo=93,uo=91,co=101,mo=105,vo=99,ko=95,go=88,bo=113,Co=46,Vo=47,jo=18,xo=37,qo=39,Mo=36,Bo=38,_o=11,No=12,Wo=17,Do=16,To=128,Lo=65,Ro=66,Eo=67,zo=68,Ko=0,Go=1097753705,Uo=256,Ho=63,Jo=8,Xo=9,Qo=80,Zo=82,$o=84,tu=86,eu=1,iu=34,Bu=35,_u=33,Eu=32,Zu=2,sl=64,ll=96,ml=106,Al=102,jl=92,Tl=90,zl=100,Kl=104,Gl=98,Ul=94,Hl=3,Jl=5,Xl=null,Zl="BitBltPlugin",oc=null,pc=0,dc=0,mc=0,vc=0,kc=0,gc=0,Nc=0,Wc=null,Gc=null,Uc=null,uf="B2DPlugin 14 November 2014 (e)",ff=null,df=0,vf=null,gf=null;Squeak.registerExternalModule("B2DPlugin",{primitiveMergeFillFrom:function _l(){var Bt,Yt,Zt,te;return mc&&(Nc=Gc.ioMicroMSecs()),2!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Yt=S(Gc.stackValue(2),Bn))||0!==(Yt=Bi(Gc.fetchPointerofObject(ie,vc)))?Gc.primitiveFailFor(Yt):(Zt=Gc.stackObjectValue(0),Bt=Gc.stackObjectValue(1),Gc.failed()||nt(Bt)!==Gc.classBitmap()?Gc.primitiveFailFor(Hl):p(Zt)<ce?Gc.primitiveFailFor(pi):(te=Gc.fetchIntegerofObject(fe,Zt),ir(Di())!==te?Gc.primitiveFailFor(Ws):(te=Gc.fetchIntegerofObject(pe,Zt),xt()!==te?Gc.primitiveFailFor(Ws):(te=Gc.fetchIntegerofObject(he,Zt),_t()!==te?Gc.primitiveFailFor(Ws):p(Bt)<_t()-xt()?Gc.primitiveFailFor(Hl):Gc.failed()?null:(hf(Bt.wordsAsInt32Array(),xt(),_t()),v(Vn),k(),Gc.pop(2),void(mc&&(h(co,1),h(zl,Gc.ioMicroMSecs()-Nc))))))))},primitiveCopyBuffer:function bl(){var Bt,Yt,Zt,te,ee,ie,re,se;if(2!==Gc.methodArgumentCount())return Gc.primitiveFailFor(Jl);if(Yt=Gc.stackValue(0),0!==(ee=nr(Bt=Gc.stackValue(1))))return Gc.primitiveFailFor(ee);if(nt(Bt)!==nt(Yt))return Gc.primitiveFailFor(Ye);if(0>(Zt=p(Yt)-p(Bt)))return Gc.primitiveFailFor(Wi);for(re=gf,te=Yt.wordsAsInt32Array(),ie=0,se=$()-1;se>=ie;ie++)te[ie]=re[ie];for(te[Ya]=$()+Zt,te[eu]=Qt()+Zt,re=x(re,$()),te=x(te,$()+Zt),ie=0,se=Qt()-$()-1;se>=ie;ie++)te[ie]=re[ie];return 0!==(ee=nr(Yt))?Gc.primitiveFailFor(ee):void Gc.pop(2)},primitiveAddRect:function kl(){var Bt,Yt,Zt,te,ee,ie;return 5!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):(Bt=Gc.positive32BitValueOf(Gc.stackValue(0)),Yt=Gc.stackIntegerValue(1),ee=Gc.positive32BitValueOf(Gc.stackValue(2)),Zt=Gc.stackObjectValue(3),ie=Gc.stackObjectValue(4),Gc.failed()?Gc.primitiveFailFor(Hl):0!==(te=S(Gc.stackValue(5),jn))?Gc.primitiveFailFor(te):L(Bt)&&L(ee)?(Bt=q(Bt),ee=q(ee),kc?Gc.primitiveFailFor(ti):0!==ee||0!==Bt&&0!==Yt?X(4*la)?(Yt=Yt>0&&0!==Bt?ci(Yt):0,I(i(),ie),I(F(),Zt),Gc.failed()?Gc.primitiveFailFor(Je):(l()[0]=F()[0],l()[1]=i()[1],Ci()[0]=i()[0],Ci()[1]=F()[1],at(4),function dh(Bt,Yt,Zt,te){ct(Bt,i(),l(),Yt,Zt,te),ct(Bt,l(),F(),Yt,Zt,te),ct(Bt,F(),Ci(),Yt,Zt,te),ct(Bt,Ci(),i(),Yt,Zt,te)}(Yt,Bt,0,ee),Gc.failed()?Gc.primitiveFailFor(li):(Vt(1),k(),void Gc.pop(5)))):Gc.primitiveFailFor(Bs):Gc.pop(5)):Gc.primitiveFailFor(Ws))},primitiveAddGradientFill:function cl(){var Bt,Yt,Zt,te,ee,ie,re;return 5!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):(te=Gc.booleanValueOf(Gc.stackValue(0)),ee=Gc.stackValue(1),Bt=Gc.stackValue(2),ie=Gc.stackValue(3),re=Gc.stackValue(4),Gc.failed()?Gc.primitiveFailFor(Hl):0!==(Yt=S(Gc.stackValue(5),jn))?Gc.primitiveFailFor(Yt):(I(i(),ie),I(l(),Bt),I(F(),ee),Gc.failed()?Gc.primitiveFailFor(Je):(Zt=eh(re,i(),l(),F(),te),kc?Gc.primitiveFailFor(ti):Gc.failed()?Gc.primitiveFailFor(li):(k(),void Gc.popthenPush(6,Gc.positive32BitIntegerFor(Zt))))))},primitiveSetClipRect:function nc(){var Bt,Yt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=S(Gc.stackValue(1),jn))?Gc.primitiveFailFor(Bt):(Yt=Gc.stackObjectValue(0),!Gc.failed()&&Gc.isPointers(Yt)&&p(Yt)>=2?(I(i(),Gc.fetchPointerofObject(0,Yt)),I(l(),Gc.fetchPointerofObject(1,Yt)),Gc.failed()?Gc.primitiveFailFor(Hl):(As(i()[0]),Aa(i()[1]),xs(l()[0]),Ea(l()[1]),k(),void Gc.pop(1))):Gc.primitiveFailFor(Hl))},initialiseModule:kr,primitiveSetBitBltPlugin:function sc(){var Bt,Yt,Zt;if(Zt=Gc.stackValue(0),!Gc.isBytes(Zt))return Gc.primitiveFail();if(Bt=function Gh(Bt){return Bt.bytes?Bt.bytes.length:Bt.words?4*Bt.words.length:0}(Zt),Bt>=256)return Gc.primitiveFail();Zt.bytes,Yt=!1;var te=Zt.bytesAsString();return te!==Zl&&(Zl=te,Yt=!0),Yt&&!kr()?Gc.primitiveFail():void Gc.pop(1)},primitiveRegisterExternalEdge:function $l(){var Bt,Yt,Zt,te,ee,ie,re,se;return 6!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Yt=S(Gc.stackValue(6),jn))?Gc.primitiveFailFor(Yt):(se=Gc.positive32BitValueOf(Gc.stackValue(0)),re=Gc.positive32BitValueOf(Gc.stackValue(1)),ie=Gc.stackIntegerValue(2),ee=Gc.stackIntegerValue(3),te=Gc.stackIntegerValue(4),Zt=Gc.stackIntegerValue(5),Gc.failed()?Gc.primitiveFailFor(Hl):bt(Ke)?L(re)&&L(se)?(df=(Bt=df)+Ke,U(Bt,Js),pt(Bt,Ke),st(Bt,Zt),G(Bt,te),hi(Bt,ee),tr(Bt,ie),as(Bt,q(re)),ns(Bt,q(se)),kc?Gc.primitiveFailFor(ti):void(Gc.failed()||(k(),Gc.pop(6)))):Gc.primitiveFailFor(Ws):Gc.primitiveFailFor(Bs))},primitiveGetClipRect:function Pl(){var Bt,Yt,Zt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(1)))?Gc.primitiveFailFor(Bt):(Zt=Gc.stackObjectValue(0),!Gc.failed()&&Gc.isPointers(Zt)&&p(Zt)>=2?(Gc.pushRemappableOop(Zt),Yt=Gc.makePointwithxValueyValue(zt(),Is()),Gc.storePointerofObjectwithValue(0,Gc.topRemappableOop(),Yt),Yt=Gc.makePointwithxValueyValue(Rt(),Vs()),Zt=Gc.popRemappableOop(),Gc.storePointerofObjectwithValue(1,Zt,Yt),void Gc.popthenPush(2,Zt)):Gc.primitiveFailFor(Hl))},primitiveAddBezier:function nl(){var Bt,Yt,Zt,te,ee,ie,re;return 5!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):(ee=Gc.positive32BitValueOf(Gc.stackValue(0)),Zt=Gc.positive32BitValueOf(Gc.stackValue(1)),re=Gc.stackObjectValue(2),Bt=Gc.stackObjectValue(3),ie=Gc.stackObjectValue(4),Gc.failed()?Gc.primitiveFailFor(Hl):0!==(Yt=S(Gc.stackValue(5),jn))?Gc.primitiveFailFor(Yt):L(Zt)&&L(ee)?(I(i(),ie),I(l(),re),I(F(),Bt),Gc.failed()?Gc.primitiveFailFor(Hl):(at(3),X((te=cr(i(),l(),F(),!1))*me),kc||(Zt=q(Zt),ee=q(ee)),kc||ur(0,0,Zt,ee,te),kc?(vt(),Gc.primitiveFailFor(ti)):Gc.failed()?Gc.primitiveFailFor(li):(k(),void Gc.pop(5)))):Gc.primitiveFailFor(Ws))},primitiveInitializeProcessing:function Bl(){var Bt;return mc&&(Nc=Gc.ioMicroMSecs()),0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=S(Gc.stackValue(0),jn))||0!==(Bt=Bi(Gc.fetchPointerofObject(ie,vc)))?Gc.primitiveFailFor(Bt):(cu(),kc?Gc.primitiveFailFor(ti):(v(Pn),Gc.failed()||k(),void(mc&&(h(uo,1),h(Tl,Gc.ioMicroMSecs()-Nc)))))},primitiveRenderImage:function tc(){var Bt;return 0!==(Bt=So())?Gc.primitiveFailFor(Bt):(Fn(),kc?Xr():(function fc(){for(var Bt;!Ri();){if(mc&&(Nc=Gc.ioMicroMSecs()),Bt=jr(),mc&&(h(ko,1),h(Ul,Gc.ioMicroMSecs()-Nc)),kc)return v(Pn);if(Bt)return v(Mn),It(Kn);if(ot(0),vt(),Lt(1),mc&&(Nc=Gc.ioMicroMSecs()),0!==Ns()&&0==(y()&mt())&&pr(),Lt(0),Bt=wr(),mc&&(h(vo,1),h(Gl,Gc.ioMicroMSecs()-Nc)),kc)return v(Vn);if(Bt)return v(Bn),It(zn);if(vt(),Oi(0),mc&&(Nc=Gc.ioMicroMSecs()),(y()&mt())===mt()&&(ls(y()),Dr()),mc&&(h(ao,1),h(Al,Gc.ioMicroMSecs()-Nc)),kc)return v(wn);if(Ri())return 0;if(ot(0),Jt(y()+1),mc&&(Nc=Gc.ioMicroMSecs()),Bt=Ar(),mc&&(h(mo,1),h(Kl,Gc.ioMicroMSecs()-Nc)),kc)return v(xn);if(Bt)return v(qn),It(Rn)}}(),void Xr()))},primitiveGetOffset:function xl(){var Bt,Yt;return 0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(0)))?Gc.primitiveFailFor(Bt):(Yt=Gc.makePointwithxValueyValue(ms(),hs()),void Gc.popthenPush(1,Yt))},primitiveSetDepth:function uc(){var Bt,Yt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Yt=S(Gc.stackValue(1),jn))?Gc.primitiveFailFor(Yt):(Bt=Gc.stackIntegerValue(0),Gc.failed()?Gc.primitiveFailFor(Hl):(Hn(Bt),k(),void Gc.pop(1)))},primitiveAddBezierShape:function al(){var Bt,Yt,Zt,te,ee,ie,re,se;if(5!==Gc.methodArgumentCount())return Gc.primitiveFailFor(Jl);if(te=Gc.positive32BitValueOf(Gc.stackValue(0)),ee=Gc.stackIntegerValue(1),Yt=Gc.positive32BitValueOf(Gc.stackValue(2)),ie=Gc.stackIntegerValue(3),re=Gc.stackObjectValue(4),Gc.failed())return Gc.primitiveFailFor(Hl);if(0!==(Bt=S(Gc.stackValue(5),jn)))return Gc.primitiveFailFor(Bt);if(Zt=p(re),Gc.isWords(re)){if(se=!1,Zt!==3*ie&&Zt!==6*ie)return Gc.primitiveFailFor(Hl)}else{if(!Gc.isArray(re))return Gc.primitiveFailFor(Hl);if(Zt!==3*ie)return Gc.primitiveFailFor(Hl);se=!0}return X((0===ee||0===te?la:Va)*ie)?L(te)&&L(Yt)?(te=q(te),Yt=q(Yt),kc?Gc.primitiveFailFor(ti):0!==te&&0!==ee||0!==Yt?(0!==ee&&(1>(ee=ci(ee))&&(ee=1)),se?Pf(re,ie,Yt,ee,te):function bh(Bt,Yt,Zt,te,ee,ie){var re;for(re=1;Yt>=re;re++)if(Ma(re-1,Bt,ie,Zt,0,te,ee),kc)return null}(re.wordsAsInt32Array(),ie,Yt,ee,te,3*ie===Zt),kc?Gc.primitiveFailFor(ti):Gc.failed()?Gc.primitiveFailFor(li):(Vt(1),k(),void Gc.pop(5))):Gc.pop(5)):Gc.primitiveFailFor(Ws):Gc.primitiveFailFor(Bs)},primitiveSetEdgeTransform:function lc(){var Bt,Yt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=S(Gc.stackValue(1),jn))?Gc.primitiveFailFor(Bt):(Yt=Gc.stackObjectValue(0),Gc.failed()?Gc.primitiveFailFor(Hl):(function Gf(Bt){var Yt,Zt;return Vr(0),Yt=Ao(Bt,Zt=ss(),6),Gc.failed()?null:!!Yt&&(Vr(1),Zt[2]=Zt[2]+ms(),Zt[5]=Zt[5]+hs(),!0)}(Yt),Gc.failed()?Gc.primitiveFailFor(Hl):(k(),void Gc.pop(1))))},getModuleName:function Mu(){return uf},primitiveGetTimes:function ql(){var Bt,Yt,Zt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(1)))?Gc.primitiveFailFor(Bt):(Yt=Gc.stackObjectValue(0),!Gc.failed()&&Gc.isWords(Yt)&&p(Yt)>=9?((Zt=Yt.wordsAsInt32Array())[0]=Zt[0]+gf[Tl],Zt[1]=Zt[1]+gf[jl],Zt[2]=Zt[2]+gf[Ul],Zt[3]=Zt[3]+gf[ll],Zt[4]=Zt[4]+gf[Gl],Zt[5]=Zt[5]+gf[zl],Zt[6]=Zt[6]+gf[Al],Zt[7]=Zt[7]+gf[Kl],Zt[8]=Zt[8]+gf[ml],void Gc.pop(1)):Gc.primitiveFailFor(Hl))},primitiveNextActiveEdgeEntry:function Dl(){var Bt,Yt,Zt;return mc&&(Nc=Gc.ioMicroMSecs()),1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Yt=function Oc(Bt,Yt,Zt){var te;return 0!==(te=R(Bt))?te:Nt()===Yt||Nt()===Zt?0:(di(En),Ds)}(Gc.stackValue(1),xn,Cn))?Gc.primitiveFailFor(Yt):(Bt=Gc.stackObjectValue(0),Gc.failed()?Gc.primitiveFailFor(Hl):(Zt=!1,Nt()!==Cn&&((Zt=Ar())?(er(Xl[w()],Bt),v(qn)):v(Pn)),Gc.failed()?null:(k(),Gc.pop(2),Gc.pushBool(!Zt),void(mc&&(h(mo,1),h(Kl,Gc.ioMicroMSecs()-Nc))))))},primitiveAddBitmapFill:function ol(){var Bt,Yt,Zt,te,ee,ie,re,se,ne;return 7!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0>=(ne=Gc.stackIntegerValue(0))?Gc.primitiveFailFor(Hl):(ie=Gc.stackObjectValue(1),Yt=Gc.stackObjectValue(2),re=Gc.stackObjectValue(3),se=Gc.booleanValueOf(Gc.stackValue(4)),Bt=Gc.stackObjectValue(5),ee=Gc.stackObjectValue(6),Gc.failed()?Gc.primitiveFailFor(Hl):0!==(Zt=S(Gc.stackValue(7),jn))?Gc.primitiveFailFor(Zt):(I(i(),re),I(l(),Yt),I(F(),ie),Gc.failed()?Gc.primitiveFailFor(Je):(te=Bf(ee,Bt,se?1:0,i(),l(),F(),ne-1),kc?Gc.primitiveFailFor(ti):Gc.failed()?Gc.primitiveFailFor(li):(k(),void Gc.popthenPush(8,Gc.positive32BitIntegerFor(te))))))},primitiveGetDepth:function Cl(){var Bt;return 0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(0)))?Gc.primitiveFailFor(Bt):(Gc.pop(1),void Gc.pushInteger(ks()))},primitiveAbortProcessing:function il(){var Bt;return 0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(0)))?Gc.primitiveFailFor(Bt):(v(Cn),void k())},primitiveNextGlobalEdgeEntry:function El(){var Bt,Yt,Zt;return mc&&(Nc=Gc.ioMicroMSecs()),1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Yt=S(Gc.stackValue(1),Pn))?Gc.primitiveFailFor(Yt):(Bt=Gc.stackObjectValue(0),(Zt=jr())&&(er(Wc[Y()],Bt),yr(Y()+1)),Gc.failed()?Gc.primitiveFailFor(_s):(Zt?v(Mn):(v(Vn),Lt(1),ot(0),vt()),k(),Gc.pop(2),Gc.pushBool(!Zt),void(mc&&(h(ko,1),h(Ul,Gc.ioMicroMSecs()-Nc)))))},primitiveGetFailureReason:function Vl(){var Bt;return 0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):"number"==typeof(vc=Gc.stackValue(0))?Gc.primitiveFailFor(Ze):Gc.isPointers(vc)?p(vc)<Zt?Gc.primitiveFailFor(ai):0!==(Bt=nr(Gc.fetchPointerofObject(re,vc)))?Gc.primitiveFailFor(Bt):(Gc.pop(1),void Gc.pushInteger(Ur())):Gc.primitiveFailFor($e)},primitiveDisplaySpanBuffer:function yl(){var Bt;return mc&&(Nc=Gc.ioMicroMSecs()),0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=S(Gc.stackValue(0),wn))||0!==(Bt=Bi(Gc.fetchPointerofObject(ie,vc)))?Gc.primitiveFailFor(Bt):pa(Gc.fetchPointerofObject(te,vc))?((y()&mt())===mt()&&(ls(y()),Dr()),Ri()||(ot(0),Jt(y()+1),v(xn)),k(),void(mc&&(h(ao,1),h(Al,Gc.ioMicroMSecs()-Nc)))):Gc.primitiveFailFor(Xe)},moduleUnloaded:function Su(Bt){0===strcmp(Bt,Zl)&&(Uc=0,oc=0)},primitiveGetCounts:function wl(){var Bt,Yt,Zt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(1)))?Gc.primitiveFailFor(Bt):(Yt=Gc.stackObjectValue(0),!Gc.failed()&&Gc.isWords(Yt)&&p(Yt)>=9?((Zt=Yt.wordsAsInt32Array())[0]=Zt[0]+gf[uo],Zt[1]=Zt[1]+gf[oo],Zt[2]=Zt[2]+gf[ko],Zt[3]=Zt[3]+gf[so],Zt[4]=Zt[4]+gf[vo],Zt[5]=Zt[5]+gf[co],Zt[6]=Zt[6]+gf[ao],Zt[7]=Zt[7]+gf[mo],Zt[8]=Zt[8]+gf[no],void Gc.pop(1)):Gc.primitiveFailFor(Hl))},primitiveChangedActiveEdgeEntry:function gl(){var Bt,Yt,Zt;return mc&&(Nc=Gc.ioMicroMSecs()),1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Zt=S(Gc.stackValue(1),qn))?Gc.primitiveFailFor(Zt):(Yt=Gc.stackObjectValue(0),Gc.failed()?Gc.primitiveFailFor(Hl):(Bt=lo(Yt))?(0===ft(Bt)?Dn():(Yn(),ot(w()+1)),v(xn),k(),Gc.pop(1),void(mc&&(h(no,1),h(ml,Gc.ioMicroMSecs()-Nc)))):Gc.primitiveFailFor(Qe))},primitiveRenderScanline:function ic(){var Bt;return 0!==(Bt=So())?Gc.primitiveFailFor(Bt):(Fn(),void Xr())},primitiveGetBezierStats:function Il(){var Bt,Yt,Zt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(1)))?Gc.primitiveFailFor(Bt):(Yt=Gc.stackObjectValue(0),!Gc.failed()&&Gc.isWords(Yt)&&p(Yt)>=4?((Zt=Yt.wordsAsInt32Array())[0]=Zt[0]+gf[Ja],Zt[1]=Zt[1]+gf[Ua],Zt[2]=Zt[2]+gf[Xa],Zt[3]=Zt[3]+gf[Ha],void Gc.pop(1)):Gc.primitiveFailFor(Hl))},primitiveFinishedProcessing:function Sl(){var Bt,Yt;return mc&&(Nc=Gc.ioMicroMSecs()),0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(0)))?Gc.primitiveFailFor(Bt):(Yt=Ri(),k(),Gc.pop(1),Gc.pushBool(Yt),void(mc&&(h(oo,1),h(jl,Gc.ioMicroMSecs()-Nc))))},setInterpreter:function Dc(Zt){return!1!==((Gc=Zt).majorVersion()==Bt)&&Gc.minorVersion()>=Yt},primitiveNeedsFlush:function Nl(){var Bt,Yt;return 0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(0)))?Gc.primitiveFailFor(Bt):(Yt=wo(),k(),Gc.pop(1),void Gc.pushBool(Yt))},primitiveAddLine:function fl(){var Bt,Yt,Zt,te,ee;return 4!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):(te=Gc.positive32BitValueOf(Gc.stackValue(0)),Zt=Gc.positive32BitValueOf(Gc.stackValue(1)),Bt=Gc.stackObjectValue(2),ee=Gc.stackObjectValue(3),Gc.failed()?Gc.primitiveFailFor(Hl):0!==(Yt=S(Gc.stackValue(4),jn))?Gc.primitiveFailFor(Yt):L(Zt)&&L(te)?(I(i(),ee),I(l(),Bt),Gc.failed()?Gc.primitiveFailFor(Je):(at(2),Zt=q(Zt),te=q(te),kc?Gc.primitiveFailFor(ti):(ct(0,i(),l(),0,Zt,te),kc?Gc.primitiveFailFor(ti):Gc.failed()?Gc.primitiveFailFor(li):(k(),void Gc.pop(4))))):Gc.primitiveFailFor(Ws))},primitiveSetOffset:function cc(){var Bt,Yt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=S(Gc.stackValue(1),jn))?Gc.primitiveFailFor(Bt):nt(Yt=Gc.stackValue(0))!==Gc.classPoint()?Gc.primitiveFailFor(Hl):(I(i(),Yt),Gc.failed()?Gc.primitiveFailFor(Hl):(pl(i()[0]),Tu(i()[1]),k(),void Gc.pop(1)))},primitiveNextFillEntry:function Rl(){var Bt,Yt,Zt;return mc&&(Nc=Gc.ioMicroMSecs()),1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=S(Gc.stackValue(1),Vn))||0!==(Bt=Bi(Gc.fetchPointerofObject(ie,vc)))?Gc.primitiveFailFor(Bt):po(Gc.fetchPointerofObject(ee,vc))?(0!==Ns()&&(0==(y()&mt())&&pr(),Lt(0)),Yt=Gc.stackObjectValue(0),Zt=wr(),kc?Gc.primitiveFailFor(ti):(Zt&&yo(Yt),Gc.failed()?Gc.primitiveFailFor(Ws):(Zt?v(Bn):(vt(),Oi(0),v(wn)),k(),Gc.pop(2),Gc.pushBool(!Zt),void(mc&&(h(vo,1),h(Gl,Gc.ioMicroMSecs()-Nc)))))):Gc.primitiveFailFor(Si)},primitiveInitializeBuffer:function Ml(){var Bt,Yt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFail():(Yt=Gc.stackObjectValue(0),Gc.failed()?null:Gc.isWords(Yt)?(Bt=p(Yt))<Uo?Gc.primitiveFail():(fn(Yt),ff=x(gf,To),function vu(Bt){return gf[Ko]=Bt}(Go),function gh(Bt){return gf[eu]=Bt}(Bt),hr(Bt),v(jn),function Wu(Bt){return gf[Jo]=Bt}(To),uu(4),U(0,pn),pt(0,4),st(0,0),yr(0),fs(0),ot(0),Ki(0),di(0),Vt(0),As(0),xs(0),Aa(0),Ea(0),Hn(0),function Vc(){gf[Tl]=0,gf[jl]=0,gf[Ul]=0,gf[ll]=0,gf[Gl]=0,gf[zl]=0,gf[Al]=0,gf[Kl]=0,gf[ml]=0,gf[uo]=0,gf[oo]=0,gf[ko]=0,gf[so]=0,gf[vo]=0,gf[co]=0,gf[ao]=0,gf[mo]=0,gf[no]=0,gf[Ja]=0,gf[Ua]=0,gf[Xa]=0,gf[Ha]=0}(),function Qc(){var Bt;(Bt=ss())[0]=1,Bt[1]=0,Bt[2]=0,Bt[3]=0,Bt[4]=1,Bt[5]=0,Vr(0)}(),function Rc(){var Bt;(Bt=$i())[0]=1,Bt[1]=0,Bt[2]=1,Bt[3]=0,Bt[4]=1,Bt[5]=0,Bt[6]=1,Bt[7]=0,Cr(0)}(),Gc.pop(2),void Gc.push(Yt)):Gc.primitiveFail())},primitiveDoProfileStats:function Fl(){var Bt,Yt;Yt=mc,Bt=Gc.stackObjectValue(0),Bt=Gc.booleanValueOf(Bt),Gc.failed()||(mc=Bt,Gc.pop(2),Gc.pushBool(Yt))},primitiveAddActiveEdgeEntry:function rl(){var Bt,Yt,Zt;return mc&&(Nc=Gc.ioMicroMSecs()),1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Zt=S(Gc.stackValue(1),Mn))?Gc.primitiveFailFor(Zt):(Yt=Gc.stackObjectValue(0),Gc.failed()?Gc.primitiveFailFor(Hl):(Bt=lo(Yt))?X(1)?(ft(Bt)>0&&rn(Bt),kc?Gc.primitiveFailFor(ti):(v(Pn),k(),Gc.pop(1),void(mc&&(h(so,1),h(ll,Gc.ioMicroMSecs()-Nc))))):Gc.primitiveFailFor(Bs):Gc.primitiveFailFor(Qe))},primitiveSetAALevel:function rc(){var Bt,Yt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=S(Gc.stackValue(1),jn))?Gc.primitiveFailFor(Bt):(Yt=Gc.stackIntegerValue(0),Gc.failed()?Gc.primitiveFailFor(Hl):(Zn(Yt),k(),void Gc.pop(1)))},primitiveNeedsFlushPut:function Wl(){var Bt,Yt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(1)))?Gc.primitiveFailFor(Bt):(Yt=Gc.booleanValueOf(Gc.stackValue(0)),Gc.failed()?Gc.primitiveFailFor(Hl):(Vt(!0===Yt?1:0),k(),void Gc.pop(1)))},primitiveAddCompressedShape:function ul(){var Bt,Yt,Zt,te,ee,ie,re,se,ne;return 7!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):(Yt=Gc.stackObjectValue(0),te=Gc.stackObjectValue(1),ee=Gc.stackObjectValue(2),ne=Gc.stackObjectValue(3),Zt=Gc.stackObjectValue(4),ie=Gc.stackIntegerValue(5),re=Gc.stackObjectValue(6),Gc.failed()?Gc.primitiveFailFor(Hl):0!==(Bt=S(Gc.stackValue(7),jn))?Gc.primitiveFailFor(Bt):Ih(re,ie,Zt,ne,ee,te,Yt)?X(Math.max(me,la)*ie)?(se=p(re)===3*ie,function Tf(Bt,Yt,Zt,te,ee,ie,re,se){var ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke;if(0===Yt)return 0;for(oe=pe=ve=ce=-1,ae=he=me=le=1,ue=de=ke=fe=0,ne=1;Yt>=ne;ne++){if(--ae<=0&&(ae=Wt(++oe,Zt),0!==(ue=Ii(oe,Zt))&&(ue=q(ue=re[ue-1]),kc)))return null;if(--he<=0&&(he=Wt(++pe,te),0!==(de=Ii(pe,te))&&(de=q(de=re[de-1]))),--me<=0&&(me=Wt(++ve,ee),0!==(ke=Ii(ve,ee))&&(ke=ci(ke))),--le<=0&&(le=Wt(++ce,ie),0!==(fe=Ii(ce,ie))&&(fe=re[fe-1])),Ma(ne-1,Bt,se,ue,de,ke,fe),kc)return null}}(re.wordsAsInt32Array(),ie,Zt.wordsAsInt32Array(),ne.wordsAsInt32Array(),ee.wordsAsInt32Array(),te.wordsAsInt32Array(),Yt.wordsAsInt32Array(),se),kc?Gc.primitiveFailFor(ti):Gc.failed()?Gc.primitiveFailFor(li):(Vt(1),k(),void Gc.pop(7))):Gc.primitiveFailFor(Bs):Gc.primitiveFailFor(oi))},primitiveSetColorTransform:function ac(){var Bt,Yt;return 1!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=S(Gc.stackValue(1),jn))?Gc.primitiveFailFor(Bt):(Yt=Gc.stackObjectValue(0),Gc.failed()?Gc.primitiveFailFor(Hl):(function Wf(Bt){var Yt,Zt;return Zt=$i(),Cr(0),!!(Yt=Ao(Bt,Zt,8))&&(Cr(1),Zt[1]=256*Zt[1],Zt[3]=256*Zt[3],Zt[5]=256*Zt[5],Zt[7]=256*Zt[7],Yt)}(Yt),Gc.failed()?Gc.primitiveFailFor(li):(k(),void Gc.pop(1))))},primitiveAddOval:function hl(){var Bt,Yt,Zt,te,ee,ie;return 5!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):(Bt=Gc.positive32BitValueOf(Gc.stackValue(0)),Yt=Gc.stackIntegerValue(1),ee=Gc.positive32BitValueOf(Gc.stackValue(2)),Zt=Gc.stackObjectValue(3),ie=Gc.stackObjectValue(4),Gc.failed()?Gc.primitiveFailFor(Hl):0!==(te=S(Gc.stackValue(5),jn))?Gc.primitiveFailFor(te):L(Bt)&&L(ee)?(ee=q(ee),Bt=q(Bt),kc?Gc.primitiveFailFor(ti):0===ee&&(0===Bt||0>=Yt)?Gc.pop(5):X(16*me)?(Yt=Yt>0&&0!==Bt?ci(Yt):0,I(i(),ie),I(l(),Zt),Gc.failed()?Gc.primitiveFailFor(Je):(function ih(Bt,Yt,Zt,te){var ee,ie,re,se,ne,ae;for(ae=l()[0]-i()[0]>>1,re=l()[1]-i()[1]>>1,ee=l()[0]+i()[0]>>1,ie=l()[1]+i()[1]>>1,se=0;15>=se;se++){if(rh(se,ae,re,ee,ie),at(3),ne=cr(i(),l(),F(),0!==Bt&&0!==Yt),kc)return null;if(ur(Bt,Yt,Zt,te,ne),kc)return null}}(Yt,Bt,0,ee),kc?(vt(),Gc.primitiveFailFor(ti)):Gc.failed()?Gc.primitiveFailFor(li):(Vt(1),k(),void Gc.pop(5)))):Gc.primitiveFailFor(Bs)):Gc.primitiveFailFor(Ws))},primitiveRegisterExternalFill:function ec(){var Bt,Yt,Zt;if(1!==Gc.methodArgumentCount())return Gc.primitiveFailFor(Jl);if(0!==(Bt=S(Gc.stackValue(1),jn)))return Gc.primitiveFailFor(Bt);if(Zt=Gc.stackIntegerValue(0),Gc.failed())return Gc.primitiveFailFor(Hl);for(Yt=0;0===Yt;){if(!bt(Ke))return Gc.primitiveFailFor(Bs);df=(Yt=df)+Ge,U(Yt,pn),pt(Yt,Ge),st(Yt,Zt)}Gc.failed()||(k(),Gc.pop(2),Gc.pushInteger(Yt))},primitiveAddPolygon:function dl(){var Bt,Yt,Zt,te,ee,ie,re,se;if(5!==Gc.methodArgumentCount())return Gc.primitiveFailFor(Jl);if(te=Gc.positive32BitValueOf(Gc.stackValue(0)),ee=Gc.stackIntegerValue(1),Yt=Gc.positive32BitValueOf(Gc.stackValue(2)),ie=Gc.stackIntegerValue(3),re=Gc.stackObjectValue(4),Gc.failed())return Gc.primitiveFailFor(Hl);if(0!==(Bt=S(Gc.stackValue(5),jn)))return Gc.primitiveFailFor(Bt);if(Zt=p(re),Gc.isWords(re)){if(se=!1,Zt!==ie&&2*ie!==Zt)return Gc.primitiveFailFor(Hl)}else{if(!Gc.isArray(re))return Gc.primitiveFailFor(Hl);if(Zt!==ie)return Gc.primitiveFailFor(Hl);se=!0}return X((0===ee||0===te?la:Va)*ie)?L(te)&&L(Yt)?(te=q(te),Yt=q(Yt),kc?Gc.primitiveFailFor(ti):0!==te&&0!==ee||0!==Yt?(0!==ee&&(ee=ci(ee)),se?If(re,ie,Yt,ee,te):nh(re.wordsAsInt32Array(),ie,Yt,ee,te,ie===Zt),kc?Gc.primitiveFailFor(ti):Gc.failed()?Gc.primitiveFailFor(li):(Vt(1),k(),void Gc.pop(5))):Gc.pop(5)):Gc.primitiveFailFor(Ws):Gc.primitiveFail()},primitiveGetAALevel:function Ol(){var Bt;return 0!==Gc.methodArgumentCount()?Gc.primitiveFailFor(Jl):0!==(Bt=R(Gc.stackValue(0)))?Gc.primitiveFailFor(Bt):(Gc.pop(1),void Gc.pushInteger(P()))}})})),module("users.bert.SqueakJS.plugins.BitBltPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function Ni(Bt){return"number"==typeof Bt?Us.classSmallInteger():Bt.sqClass}function E(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function Xt(Bt){return Bt.bytes?Bt.bytes.length:Bt.words?4*Bt.words.length:0}function v(Bt,Yt){return 0|Math.floor(Bt/Yt)}function i(Bt,Yt){return Yt>31?0:Bt<<Yt}function u(Bt,Yt){return Yt>31?0:Bt>>>Yt}function z(Bt,Yt){return 0>Yt?-31>Yt?0:Bt>>>0-Yt:Yt>31?0:Bt<<Yt}function Ps(Bt,Yt){var Zt,te;if(16>$e){for(Zt=Bt^Yt,te=mn[$e];0!==Zt;)0!=(Zt&te)&&++We,Zt=u(Zt,$e);return Yt}return 16===$e?(Zt=ht(Bt,Yt,5,3),We=We+(31&Zt)+(Zt>>>5&31)+(Zt>>>10&31),Zt=ht(Bt>>>16,Yt>>>16,5,3),We=We+(31&Zt)+(Zt>>>5&31)+(Zt>>>10&31)):(Zt=ht(Bt,Yt,8,3),We=We+(255&Zt)+(Zt>>>8&255)+(Zt>>>16&255)),Yt}function As(Bt,Yt){var Zt,te,ee,ie;if((ze&(Fe|be))!=(Fe|be))return Yt;if(16>$e){for(Zt=mn[$e]&Ge,ie=Yt,ee=1;Si>=ee;ee++)Lt(te=ie&Zt,Mt(te)+1),ie=u(ie,$e);return Yt}return 16===$e?(Lt(te=mt(65535&Yt,5,Ee),Mt(te)+1),Lt(te=mt(Yt>>>16,5,Ee),Mt(te)+1)):Lt(te=mt(Yt,8,Ee),Mt(te)+1),Yt}function Is(Bt,Yt){return Bt+Yt}function Os(Bt,Yt){var Zt,te,ee,ie;return 0===(ie=Bt>>>24)?Yt:255===ie?Bt:(te=(te=(16711935&Bt)*ie+(16711935&Yt)*(Zt=255-ie)+16711935)+(te-65537>>>8&16711935)>>>8&16711935)|(ee=(ee=(16711935&(Bt>>>8|16711680))*ie+(Yt>>>8&16711935)*Zt+16711935)+(ee-65537>>>8&16711935)>>>8&16711935)<<8}function Ss(Bt,Yt){return _i(Bt,Yt,!1)}function _i(Bt,Yt,Zt){var te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe;if(16>$e)return Yt;if(ue=255-wn,se=Yt,1===Si)Zt&&0===Bt||(se=(ce=(ce=(16711935&Bt)*wn+(16711935&Yt)*ue+16711935)+(ce-65537>>>8&16711935)>>>8&16711935)|(fe=(fe=(Bt>>>8&16711935)*wn+(Yt>>>8&16711935)*ue+16711935)+(fe-65537>>>8&16711935)>>>8&16711935)<<8);else for(te=mn[$e],5,31,pe=pi,he=Yt,re=Bt,ie=1;Si>=ie;ie++){if(ae=re&te,!(0==(pe&te)||Zt&&0===ae)){for(le=he&te,ee=0,oe=1;3>=oe;oe++)ee|=i(31&v((31&u(ae,ne=5*(oe-1)))*wn+(31&u(le,ne))*ue+254,255),ne);se=se&~i(te,16*(ie-1))|i(ee,16*(ie-1))}pe=u(pe,$e),re=u(re,$e),he=u(he,$e)}return se}function xt(Bt,Yt){var Zt,te,ee;return(ee=(16711935&(ee=((Yt>>>8&16711935)*(Zt=255-(Bt>>>24))>>>8&16711935)+(Bt>>>8&16711935)))<<8|255*(16777472&ee))|(te=16711935&(te=((16711935&Yt)*Zt>>>8&16711935)+(16711935&Bt))|255*(16777472&te)>>>8)}function Fs(Bt,Yt){return 0===Bt?Yt:_i(Bt,Yt,!0)}function ks(Bt,Yt){return Bt&Yt}function vs(Bt,Yt){return Bt&~Yt}function ms(Bt,Yt){return~Bt&Yt}function ds(Bt,Yt){return~Bt&~Yt}function ps(Bt,Yt){return~Yt}function hs(Bt,Yt){return~Bt|Yt}function fs(Bt,Yt){return~Bt|~Yt}function cs(Bt){return~Bt}function ls(Bt,Yt){return~Bt^Yt}function us(Bt,Yt){return Bt|Yt}function os(Bt,Yt){return Bt|~Yt}function as(Bt,Yt){return Bt^Yt}function ss(){return 0}function vi(){return Hi>=Le?(Kn=Rn,Ws=Hi,_e=aa):(Kn=Rn+(Le-Hi),_e=aa-(Le-Hi),Ws=Le),Ws+_e>Le+Te&&(_e-=Ws+_e-(Le+Te)),Yi>=Re?(Gn=En,Ds=Yi,Be=Gs):(Gn=En+Re-Yi,Be=Gs-(Re-Yi),Ds=Re),Ds+Be>Re+De&&(Be-=Ds+Be-(Re+De)),yn?null:(0>Kn&&(Ws-=Kn,_e+=Kn,Kn=0),Kn+_e>Ln&&(_e-=Kn+_e-Ln),0>Gn&&(Ds-=Gn,Be+=Gn,Gn=0),void(Gn+Be>qn&&(Be-=Gn+Be-qn)))}function qt(){return vi(),0>=_e||0>=Be?(xe=qe=Me=je=0,null):Di()?(function is(){if(function ts(){var Bt,Yt;if(41===Je)if(Xe=255,Ye=16777215,Ts=null,Jn=null,Us.methodArgumentCount()>=2){if(Xe=Us.stackIntegerValue(Us.methodArgumentCount()-2),Us.failed())return Us.primitiveFail();if(Ye=Us.stackIntegerValue(Us.methodArgumentCount()-1),Us.failed())return Us.primitiveFail();4===Us.methodArgumentCount()&&(Yt=Us.stackObjectValue(1),Us.isBytes(Yt)&&(Ts=Yt.bytes),Bt=Us.stackObjectValue(0),Us.isBytes(Bt)&&(Jn=Bt.bytes))}else{if(1!==Us.methodArgumentCount())return Us.primitiveFail();if(Ye=Us.stackIntegerValue(0),Us.failed())return Us.primitiveFail()}}(),Us.failed())return Us.primitiveFail();if(nr())return null;if(30===Je||31===Je){if(1!==Us.methodArgumentCount())return Us.primitiveFail();if(wn=Us.stackIntegerValue(0),!(!Us.failed()&&wn>=0&&255>=wn))return Us.primitiveFail()}We=0,Nr(),(22===Je||32===Je)&&(xe=qe=Me=je=0),Ls>0?(xe=Ws,qe=Ws+_e):(xe=Ws-_e+1,qe=Ws+1),Qn>0?(Me=Ds,je=Ds+Be):(Me=Ds-Be+1,je=Ds+1)}(),void Ai()):Us.primitiveFail()}function Oi(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke;for(oe=Sn[Je+1],_n=v(32,jn),ee=mn[jn],he=mn[$e],Bt=ze&~ye,Mn=Gn*Wn+4*v(Kn,_n),ie=(ke=_n-(Kn&_n-1))>_e?0:v(_e-ke,_n)+1,Vn=Wn-4*ie,me=1+(Ws+_e-1&Si-1),(ae=Si-(Ws&Si-1))>_e&&(ae=_e),de=(Kn&_n-1)*jn,ue=(Ws&Si-1)*$e,Yt=jn,pe=$e,te=0,Bn&&(de=32-jn-de,Yt=0-Yt),li&&(ue=32-$e-ue,pe=0-pe,te=32-$e),le=1;Be>=le;le++){ce=bn?Zt:Gt(Ds+le-1),zn=de,_s=ue,pi=pn,ve=ae,se=gn;do{re=_r(ve,Bt,ee,he,Yt,pe),_s=te,pi===Zt?(fe=oe(re&ce,Qe[oi>>>2]),Qe[oi>>>2]=pi&fe):(fe=oe(re&ce,(ne=Qe[oi>>>2])&pi),ne=pi&fe|ne&~pi,Qe[oi>>>2]=ne),oi+=4,2===se?(pi=dn,ve=me):(pi=Zt,ve=Si)}while(0!=--se);Mn+=Vn,oi+=Ze}}function wt(Bt,Yt,Zt){return Yt>Bt?v(Yt-Bt+Se,Zt+1)+1:Yt===Bt?0:0-(v(Bt-Yt+Se,Zt+1)+1)}function ni(){var Bt,Yt,te;Yt=Si-(Ws&(te=Si-1)),pn=li?u(Zt,32-Yt*$e):i(Zt,32-Yt*$e),Bt=1+(Ws+_e-1&te),dn=li?i(Zt,32-Bt*$e):u(Zt,32-Bt*$e),Yt>_e?(pn&=dn,dn=0,gn=1):gn=v(_e-Yt+te,Si)+1,Ls=Qn=1,oi=Ds*Wi+4*v(Ws,Si),Ze=Wi*Qn-4*gn*Ls}function Qt(Bt,Yt){return Yt}function di(Bt,Yt){var Zt;return(js[(Zt=Yt<<8)+(Bt>>>16&255)]<<10)+(js[Zt+(Bt>>>8&255)]<<5)+js[Zt+(255&Bt)]}function Ut(Bt,Yt,Zt){var te;te=Qe[Bt>>>2],te&=Zt,te|=Yt,Qe[Bt>>>2]=te}function Zr(Bt,Yt){var Zt,te,ee,ie;return te=Ms[7&(Zt=255&Bt)],ee=Bs[Zt>>>3],ie=te>Yt?ee+1:ee,te=Ms[7&(Zt=Bt>>>8&255)],ee=Bs[Zt>>>3],ie|=te>Yt?ee+1<<5:ee<<5,te=Ms[7&(Zt=Bt>>>16&255)],ee=Bs[Zt>>>3],ie|(te>Yt?ee+1<<10:ee<<10)}function H(Bt,Yt){var Zt,te;return"number"==typeof(te=Us.fetchPointerofObject(Bt,Yt))?te:(Zt=Us.floatValueOf(te))>=-2147483648&&2147483647>=Zt?0|Zt:(Us.primitiveFail(),0)}function Q(Bt,Yt,Zt){var te,ee;return"number"==typeof(ee=Us.fetchPointerofObject(Bt,Yt))?ee:ee.isNil?Zt:(te=Us.floatValueOf(ee))>=-2147483648&&2147483647>=te?0|te:(Us.primitiveFail(),0)}function Xr(Bt,Yt){return 32!==$e?Yt:0===Yt?0:0!=(4278190080&Yt)?Yt:Yt|4278190080&Bt}function Gt(Bt){return Rs[function ws(Bt,Yt){return Bt-v(Bt,Yt)*Yt|0}(Bt,zs)]}function xi(Bt){return!!Bt.isNil||(0===Je||(5===Je||(10===Je||15===Je)))}function Kr(){var Bt;if(Qe=Us.fetchPointerofObject(Oe,ti),Ei=Us.fetchIntegerofObject(Pe,ti),ai=Us.fetchIntegerofObject(Ae,ti),!(Ei>=0&&ai>=0))return!1;if($e=Us.fetchIntegerofObject(Ie,ti),li=$e>0,0>$e&&($e=0-$e),"number"==typeof Qe){if(!function Ar(Bt){return!(!In&&!Rt())&&In(Bt,(function(Bt,Yt,Zt,te){Ei=Bt,ai=Yt,$e=Zt,li=te}))}(Qe))return!1;Si=v(32,$e),Qe=Wi=0}else{if(Si=v(32,$e),Wi=4*v(Ei+(Si-1),Si),Bt=Xt(Qe),!Us.isWordsOrBytes(Qe)||Bt!==Wi*ai)return!1;Qe=Qe.wordsOrBytes()}return!0}function Ht(Bt){return wi(Bt,!1)}function wi(Bt,Yt){var Zt;if(Ne=Bt,Js=Yt,Je=Us.fetchIntegerofObject(fe,Ne),Us.failed()||0>Je||Je>Ce-2)return!1;if(Je>=16&&17>=Je)return!1;if(xn=Us.fetchPointerofObject(he,Ne),yn=xi(xn),Es=Us.fetchPointerofObject(le,Ne),bn=xi(Es),ti=Us.fetchPointerofObject(ae,Bt),!(Us.isPointers(ti)&&E(ti)>=4))return!1;if(!(Zt=Kr()))return!1;if(Hi=Q(oe,Ne,0),Yi=Q(ue,Ne,0),aa=Q(ve,Ne,Ei),Gs=Q(ce,Ne,ai),Us.failed())return!1;if(yn)Rn=En=0;else{if(!(Us.isPointers(xn)&&E(xn)>=4))return!1;if(Zt=function Er(){var Bt;if(Cn=Us.fetchPointerofObject(Oe,xn),Ln=H(Pe,xn),qn=H(Ae,xn),!(Ln>=0&&qn>=0))return!1;if(jn=Us.fetchIntegerofObject(Ie,xn),Bn=jn>0,0>jn&&(jn=0-jn),"number"==typeof Cn){if(!function Ir(Bt){return!(!In&&!Rt())&&In(Bt,(function(Bt,Yt,Zt,te){Ln=Bt,qn=Yt,jn=Zt,Bn=te}))}(Cn))return!1;_n=v(32,jn),Cn=Wn=0}else{if(_n=v(32,jn),Wn=4*v(Ln+(_n-1),_n),Bt=Xt(Cn),!Us.isWordsOrBytes(Cn)||Bt!==Wn*qn)return!1;Cn=Cn.wordsOrBytes()}return!0}(),!Zt)return!1;if(Zt=function Rr(){var Bt,Yt,Zt,ee;if(ze=Ge=Ee=0,He=null,Ue=null,Ke=null,Yt=Us.fetchPointerofObject(ne,Ne),Yt.isNil)return!0;if(ze=Fe,ee=!1,Us.isWords(Yt))Zt=E(Yt),Ke=Yt.words,ee=!0;else{if(!(Us.isPointers(Yt)&&E(Yt)>=3))return!1;if(He=Bi(Us.fetchPointerofObject(0,Yt)),Ue=Bi(Us.fetchPointerofObject(1,Yt)),(Bt=Us.fetchPointerofObject(2,Yt)).isNil)Zt=0;else{if(!Us.isWords(Bt))return!1;Zt=E(Bt),Ke=Bt.words}ze|=ye}return 0==(Zt&Zt-1)&&(Ge=Zt-1,Ee=0,512===Zt&&(Ee=3),4096===Zt&&(Ee=4),32768===Zt&&(Ee=5),0===Zt?(Ke=null,Ge=0):ze|=be,ee&&ji(),function zr(Bt,Yt){return!Bt||!Yt||0===Bt[Ve]&&0===Bt[we]&&0===Bt[ke]&&0===Bt[te]&&16711680===Yt[Ve]&&65280===Yt[we]&&255===Yt[ke]&&4278190080===Yt[te]}(He,Ue)?(Ue=null,He=null):ze|=ge,!0)}(),!Zt)return!1;0==(ze&ye)&&ji(),Rn=Q(pe,Ne,0),En=Q(de,Ne,0)}return!!(Zt=function Lr(){var Bt;if(bn)return Rs=null,!0;if(Us.isPointers(Es)&&E(Es)>=4)Bt=Us.fetchPointerofObject(Oe,Es),zs=Us.fetchIntegerofObject(Ae,Es),Us.isWords(Bt)||(bn=!0);else{if(Us.isPointers(Es)||!Us.isWords(Es))return!1;zs=E(Bt=Es)}return Rs=Bt.wordsOrBytes(),!0}())&&(Le=Q(re,Ne,0),Re=Q(se,Ne,0),Te=Q(ie,Ne,Ei),De=Q(ee,Ne,ai),!Us.failed()&&(0>Le&&(Te+=Le,Le=0),0>Re&&(De+=Re,Re=0),Le+Te>Ei&&(Te=Ei-Le),Re+De>ai&&(De=ai-Re),!0))}function Bi(Bt){return Bt.isNil?null:"number"==typeof Bt?(Us.primitiveFail(),null):Us.isWords(Bt)&&4===E(Bt)?Bt.words:(Us.primitiveFail(),null)}function Rt(){return In=Us.ioLoadFunctionFrom("ioGetSurfaceFormat","SurfacePlugin"),hn=Us.ioLoadFunctionFrom("ioLockSurface","SurfacePlugin"),Xn=Us.ioLoadFunctionFrom("ioUnlockSurface","SurfacePlugin"),!!In&&!!hn&&!!Xn}function Di(){var Bt,Yt,Zt,te,ee,ie,re;if(Ks=!1,0===Qe){if(!hn&&!Rt())return null;if(te=hn,Bt=Us.fetchIntegerofObject(Oe,ti),0===Cn&&!yn&&(Yt=Us.fetchIntegerofObject(Oe,xn))===Bt)return Js?(re=Math.min(Kn,Ws),ee=Math.max(Kn,Ws)+_e,Zt=Math.min(Gn,Ds),ie=Math.max(Gn,Ds)+Be,Cn=te(Yt,(function(Bt){Wn=Bt}),re,Zt,ee-re,ie-Zt)):Cn=te(Yt,(function(Bt){Wn=Bt}),0,0,Ln,qn),Wi=Wn,Ks=!0,0!==(Qe=Cn);Qe=te(Bt,(function(Bt){Wi=Bt}),Ws,Ds,_e,Be),Ks=!0}if(0===Cn&&!yn){if(Yt=Us.fetchIntegerofObject(Oe,xn),!hn&&!Rt())return null;te=hn,Cn=Js?te(Yt,(function(Bt){Wn=Bt}),0,0,Ln,qn):te(Yt,(function(Bt){Wn=Bt}),Kn,Gn,_e,Be),Ks=!0}return 0!==Qe&&(0!==Cn||yn)}function Dt(Bt,Yt){var Zt;return Zt=Bt,0!=(Yt&Fe)&&(0!=(Yt&ge)&&(Zt=function vr(Bt){var Yt;return Yt=z(Bt&Ue[0],He[0]),Yt|=z(Bt&Ue[1],He[1]),Yt|=z(Bt&Ue[2],He[2]),Yt|z(Bt&Ue[3],He[3])}(Bt),0===Zt&&0!==Bt&&(Zt=1)),0!=(Yt&be)&&(Zt=Ke[Zt&Ge])),Zt}function Pi(Bt,Yt,Zt,te){var ee,ie,re;for(re=mn[Zt],ee=0,ie=1;te>=ie;ie++)(Bt&re)===re&&(ee|=Yt&re),re=i(re,Zt);return ee}function gi(Bt,Yt,Zt,te,ee){var ie,re,se;return(re=(Bt^(se=Bt&ee))+(Yt^(ie=Yt&ee)))^se^ie|u(se&ie|(se|ie)&re,Zt-1)*te}function ri(Bt,Yt,Zt,te){var ee,ie,re;for(re=mn[Zt],ee=0,ie=1;te>=ie;ie++)ee|=Math.max(Yt&re,Bt&re),re=i(re,Zt);return ee}function kt(Bt,Yt,Zt,te){var ee,ie,re;for(re=mn[Zt],ee=0,ie=1;te>=ie;ie++)ee|=Math.min(Yt&re,Bt&re),re=i(re,Zt);return ee}function si(Bt,Yt,Zt,te){var ee,ie,re;return ie=u((1+(Bt&(re=mn[Zt])))*(1+(Yt&re))-1&(ee=i(re,Zt)),Zt),1===te?ie:(ie|=(1+(u(Bt,Zt)&re))*(1+(u(Yt,Zt)&re))-1&ee,2===te?ie:(ie|=i((1+(u(Bt,2*Zt)&re))*(1+(u(Yt,2*Zt)&re))-1&ee,Zt),3===te?ie:ie|=i((1+(u(Bt,3*Zt)&re))*(1+(u(Yt,3*Zt)&re))-1&ee,2*Zt)))}function Wr(Bt,Yt,Zt,te){var ee,ie,re,se,ne,ae;for(ae=mn[Zt],ie=0,se=1;te>=se;se++)re=u(Bt&ae,(se-1)*Zt),ee=u(Yt&ae,(se-1)*Zt),32!==Zt&&(16===Zt?(re=4278190080|ui(re),ee=4278190080|ui(ee)):(re=4278190080|mt(re,Zt,32),ee=4278190080|mt(ee,Zt,32))),ne=ii(re,ee),32!==Zt&&(ne=mt(ne,32,Zt)),ie|=i(ne,(se-1)*Zt),ae=i(ae,Zt);return ie}function ht(Bt,Yt,Zt,te){var ee,ie,re,se,ne;for(ne=mn[Zt],ie=0,se=1;te>=se;se++)ie|=(ee=Yt&ne)>(re=Bt&ne)?ee-re:re-ee,ne=i(ne,Zt);return ie}function Nr(){ni(),yn?function $r(){var Bt,Yt,te,ee,ie,re;for(te=Sn[Je+1],re=1;Be>=re;re++){if(Yt=bn?Zt:Gt(Ds+re-1),pi=pn,Bt=te(Yt,ee=Qe[oi>>>2]),ee=pi&Bt|ee&~pi,Qe[oi>>>2]=ee,oi+=4,pi=Zt,3===Je)for(ee=Yt,ie=2;gn-1>=ie;ie++)Qe[oi>>>2]=ee,oi+=4;else for(ie=2;gn-1>=ie;ie++)Bt=te(Yt,ee=Qe[oi>>>2]),Qe[oi>>>2]=Bt,oi+=4;gn>1&&(pi=dn,Bt=te(Yt,ee=Qe[oi>>>2]),ee=pi&Bt|ee&~pi,Qe[oi>>>2]=ee,oi+=4),oi+=Ze}}():(function ns(){var Bt;xn===ti&&Ds>=Gn&&(Ds>Gn?(Qn=-1,Gn=Gn+Be-1,Ds=Ds+Be-1):Ds===Gn&&Ws>Kn&&(Ls=-1,Kn=Kn+_e-1,Ws=Ws+_e-1,gn>1&&(Bt=pn,pn=dn,dn=Bt)),oi=Ds*Wi+4*v(Ws,Si),Ze=Wi*Qn-4*gn*Ls)}(),jn!==$e||0!==ze||Bn!==li?Oi():(function lr(){var Bt,Yt,Zt,te;te=Si-1,Yt=Kn&te,Bt=Ws&te,Ls>0?(Zt=Math.min(_e,Si-Bt),On=Yt+Zt>te):(Zt=Math.min(_e,Bt+1),On=0>Yt-Zt+1),Pn=Bn?(Yt-Bt)*$e:(Bt-Yt)*$e,On&&(0>Pn?Pn+=32:Pn-=32),Mn=Gn*Wn+4*v(Kn,v(32,jn)),Vn=Wn*Qn-4*gn*Ls,On&&(Vn-=4*Ls)}(),function es(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe;for(re=Sn[Je+1],se=4*Ls,-32===Pn?Pn=ie=te=0:0>Pn?(ie=Pn+32,te=i(Zt,0-Pn)):0===Pn?(ie=0,te=Zt):(ie=Pn-32,te=u(Zt,Pn)),fe=~te,bn?(ee=Zt,zs=0):ee=Gt(0),ue=Ds,le=1;Be>=le;le++){if(zs>1&&(ee=Gt(ue),ue+=Qn),On?(oe=Cn[Mn>>>2],Mn+=se):oe=0,pi=pn,ce=Cn[Mn>>>2],Mn+=se,Yt=z(oe&fe,ie)|z(ce&te,Pn),oe=ce,Bt=re(Yt&ee,ne=Qe[oi>>>2]),ne=pi&Bt|ne&~pi,Qe[oi>>>2]=ne,oi+=se,pi=Zt,3===Je)if(0===Pn&&ee===Zt)if(-1===Ls)for(ae=2;gn-1>=ae;ae++)ce=Cn[Mn>>>2],Mn+=se,Qe[oi>>>2]=ce,oi+=se;else for(ae=2;gn-1>=ae;ae++)Qe[oi>>>2]=oe,oi+=se,oe=Cn[Mn>>>2],Mn+=se;else for(ae=2;gn-1>=ae;ae++)ce=Cn[Mn>>>2],Mn+=se,Yt=z(oe&fe,ie)|z(ce&te,Pn),oe=ce,Qe[oi>>>2]=Yt&ee,oi+=se;else for(ae=2;gn-1>=ae;ae++)ce=Cn[Mn>>>2],Mn+=se,Yt=z(oe&fe,ie)|z(ce&te,Pn),oe=ce,Bt=re(Yt&ee,Qe[oi>>>2]),Qe[oi>>>2]=Bt,oi+=se;gn>1&&(pi=dn,ce=Cn[Mn>>>2],Mn+=se,Bt=re((Yt=z(oe&fe,ie)|z(ce&te,Pn))&ee,ne=Qe[oi>>>2]),ne=pi&Bt|ne&~pi,Qe[oi>>>2]=ne,oi+=se),Mn+=Vn,oi+=Ze}}()))}function _r(Bt,Yt,Zt,te,ee,ie){var re,se,ne,ae,oe,ue;if(ne=Cn[Mn>>>2],ue=0,se=zn,ae=_s,oe=Bt,Yt===(Fe|be))do{re=u(ne,se)&Zt,ue|=i(Ke[re&Ge]&te,ae),ae+=ie,0!=(4294967264&(se+=ee))&&(Bn?se+=32:se-=32,ne=Cn[(Mn+=4)>>>2])}while(0!=--oe);else do{ue|=i(Dt(re=u(ne,se)&Zt,Yt)&te,ae),ae+=ie,0!=(4294967264&(se+=ee))&&(Bn?se+=32:se-=32,ne=Cn[(Mn+=4)>>>2])}while(0!=--oe);return zn=se,ue}function fi(Bt,Yt){var Zt,te,ee;return 0>Bt||0>Yt||(te=Bt>>>14)>=Ln||(ee=Yt>>>14)>=qn?0:(Zt=ee*Wn+4*u(te,ta),u(Cn[Zt>>>2],zn=ia[te&$n])&sa)}function Ti(Bt,Yt){var Zt,te,ee,ie,re;if(32===$e)return Bt===Yt?0:Yt;for(re=mn[te=$e],ee=0,ie=1;Si>=ie;ie++)(Bt&re)===(Zt=Yt&re)&&(Zt=0),ee|=Zt,re=i(re,te);return ee}function Mr(Bt,Yt){return Pi(~Bt,Yt,$e,Si)}function qr(Bt,Yt){return 0===Bt?Yt:Bt|Pi(~Bt,Yt,$e,Si)}function xr(Bt,Yt){var Zt,te,ee,ie,re;if(1===Si)return Yt;if(Zt=0,ee=i(1,$e)-1,ie=i(ee,(Si-1)*$e),Zt|=i(Yt&ee,te=32-$e)|u(Yt&ie,te),2>=Si)return Zt;for(re=2;Si>>1>=re;re++)ee=i(ee,$e),ie=u(ie,$e),Zt|=i(Yt&ee,te-=2*$e)|u(Yt&ie,te);return Zt}function Or(Bt,Yt){var Zt,te;return 16>$e?(te=i(1,$e)-1,Zt=i(v(4294967295,te),$e-1),gi(Bt,Yt,$e,te,Zt)):16===$e?gi(2147450879&Bt,2147450879&Yt,5,te=31,Zt=1108361744):gi(Bt,Yt,8,te=255,Zt=2155905152)}function ii(Bt,Yt){var Zt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he;return 0===(fe=Bt)?Yt:(ce=255&fe,ee=255&(fe>>>=8),ne=255&(fe>>>=8),se=255&(fe>>>=8),255!==(oe=255&Xe)&&(se=se*oe>>>8,ne=ne*oe>>>8,ee=ee*oe>>>8,ce=ce*oe>>>8),ie=255&(ae=Yt),he=255&(te=Ye),Jn&&(ie=Jn[ie],he=Jn[he]),(le=(ie*(255-ce)>>>8)+(he*ce>>>8))>255&&(le=255),Ts&&(le=Ts[le]),ie=255&(ae>>>=8),he=255&(te>>>=8),Jn&&(ie=Jn[ie],he=Jn[he]),(Zt=(ie*(255-ee)>>>8)+(he*ee>>>8))>255&&(Zt=255),Ts&&(Zt=Ts[Zt]),ie=255&(ae>>>=8),he=255&(te>>>=8),Jn&&(ie=Jn[ie],he=Jn[he]),(ue=(ie*(255-ne)>>>8)+(he*ne>>>8))>255&&(ue=255),Ts&&(ue=Ts[ue]),te>>>=8,(re=((255&(ae>>>=8))*(255-se)>>>8)+se)>255&&(re=255),(((re<<8)+ue<<8)+Zt<<8)+le)}function br(Bt,Yt){return 0===Bt?Yt:Wr(Bt,Yt,$e,Si)}function gr(Bt,Yt){var Zt,te,ee,ie,re,se,ne,ae,oe,ue;for(re=mn[$e],16===$e?(te=5,se=31):(te=8,se=255),oe=pi,ne=Yt,ie=Bt,ae=1;Si>=ae;ae++)(oe&re)>0&&(ue=ne&re,Zt=ie&re,16>$e?ee=Zt===ue?0:1:ee=((ee=ht(Zt,ue,te,3))&se)+(u(ee,te)&se)+(u(u(ee,te),te)&se),We+=ee),oe=u(oe,$e),ie=u(ie,$e),ne=u(ne,$e);return Yt}function ui(Bt){return(31&Bt)<<3|(992&Bt)<<6|(31744&Bt)<<9}function mt(Bt,Yt,Zt){var te,ee,ie,re;return(te=Zt-Yt)>0?(re=i(1,Yt)-1,ee=(ie=i(Bt,te))&(re=i(re,te)),re=i(re,Zt),ee+((ie=i(ie,te))&re)+(i(ie,te)&i(re,Zt))):0===te?5===Yt?32767&Bt:8===Yt?16777215&Bt:Bt:0===Bt?Bt:(te=Yt-Zt,re=i(1,Zt)-1,ee=(ie=u(Bt,te))&re,re=i(re,Zt),0===(ee=ee+((ie=u(ie,te))&re)+(u(ie,te)&i(re,Zt)))?1:ee)}function mr(Bt,Yt){return 16>$e?ri(Bt,Yt,$e,Si):16===$e?ri(Bt,Yt,5,3)+(ri(Bt>>>16,Yt>>>16,5,3)<<16):ri(Bt,Yt,8,4)}function dr(Bt,Yt){return 16>$e?kt(Bt,Yt,$e,Si):16===$e?kt(Bt,Yt,5,3)+(kt(Bt>>>16,Yt>>>16,5,3)<<16):kt(Bt,Yt,8,4)}function pr(Bt,Yt){var Zt;return Zt=~Bt,16>$e?kt(Zt,Yt,$e,Si):16===$e?kt(Zt,Yt,5,3)+(kt(Zt>>>16,Yt>>>16,5,3)<<16):kt(Zt,Yt,8,4)}function hr(Bt,Yt){return 16>$e?si(Bt,Yt,$e,Si):16===$e?si(Bt,Yt,5,3)+(si(Bt>>>16,Yt>>>16,5,3)<<16):si(Bt,Yt,8,4)}function fr(Bt,Yt){return 16>$e?ht(Bt,Yt,$e,Si):16===$e?ht(Bt,Yt,5,3)+(ht(Bt>>>16,Yt>>>16,5,3)<<16):ht(Bt,Yt,8,4)}function ji(){var Bt,Yt;if(Bt=Yt=0,8>=jn)return null;if(16===jn&&(Bt=5),32===jn&&(Bt=8),0===Ee){if(8>=$e)return null;16===$e&&(Yt=5),32===$e&&(Yt=8)}else Yt=Ee;ci(Bt,Yt)}function ci(Bt,Yt){var Zt,ee,ie=[0,0,0,0],re=[0,0,0,0];return 0===(Zt=Yt-Bt)?0:(0>=Zt?(ee=i(1,Yt)-1,re[Ve]=i(ee,2*Bt-Zt),re[we]=i(ee,Bt-Zt),re[ke]=i(ee,0-Zt),re[te]=0):(ee=i(1,Bt)-1,re[Ve]=i(ee,2*Bt),re[we]=i(ee,Bt),re[ke]=ee),ie[Ve]=3*Zt,ie[we]=2*Zt,ie[ke]=Zt,ie[te]=0,He=ie,Ue=re,void(ze|=Fe|ge))}function gt(){Us.showDisplayBitsLeftTopRightBottom(ti,xe,Me,qe,je)}function ur(Bt){return Bt}function or(Bt,Yt){return Bt-Yt}function ar(Bt,Yt){var Zt,te,ee,ie,re,se;if((ze&(Fe|be))!=(Fe|be))return Yt;for(Zt=mn[$e],ee=Yt,re=pi,ie=1;Si>=ie;ie++)0!=(re&Zt)&&(se=ee&Zt,Lt(te=16>$e?se:mt(se,16===$e?5:8,Ee),Mt(te)+1)),re=u(re,$e),ee=u(ee,$e);return Yt}function Mt(Bt){return Ke[Bt&Ge]}function Lt(Bt,Yt){return Ke[Bt&Ge]=Yt}function nr(){return!yn&&((34===Je||41===Je)&&(32===jn&&(xn!==ti&&(41===Je?32===$e?(function Fr(){var Bt,Yt,Zt,te,ee,ie,re,se;for(ee=Be+1,ie=Gn,se=Ds;0!=--ee;){for(Yt=ie*Wn+4*Kn,te=se*Wi+4*Ws,Zt=_e+1;0!=--Zt;)if(0==(16777215&(Bt=Cn[Yt>>>2]))){for(Yt+=4,te+=4;0!=--Zt&&0==(16777215&(Bt=Cn[Yt>>>2]));)Yt+=4,te+=4;++Zt}else re=ii(Bt,re=Qe[te>>>2]),Qe[te>>>2]=re,Yt+=4,te+=4;++ie,++se}}(),xe=Ws,qe=Ws+_e,Me=Ds,je=Ds+Be,!0):16===$e?(function Sr(){var Bt,Yt,Zt,te,ee,ie,re,se,ne,ae,oe,ue,le;for(ne=Be+1,ae=Gn,ue=Ds,Zt=16*(1&Ws),li&&(Zt=16-Zt),pn=i(65535,16-Zt);0!=--ne;){for(ee=ae*Wn+4*Kn,re=ue*Wi+4*(Ws>>1),Bt=4*(3&ue),le=(3&Kn)-1,ie=_e+1,Zt=65535===(se=pn)?16:0;0!=--ie;)Yt=qs[Bt+(le=le+1&3)],0!=(16777215&(te=Cn[ee>>>2]))&&(oe=Qe[re>>>2],Ut(re,te=i(0===(te=di(te=ii(te,oe=(31744&(oe=u(oe&=~se,Zt)))<<9|(992&oe)<<6|(31&oe)<<3|4278190080),Yt))?1:te,Zt),se)),ee+=4,li?0===Zt&&(re+=4):0!==Zt&&(re+=4),Zt^=16,se=~se;++ae,++ue}}(),xe=Ws,qe=Ws+_e,Me=Ds,je=Ds+Be,!0):8===$e&&(function yr(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe;for(ie=[0,4278190081,4294967295,4286611584,4294901760,4278255360,4278190335,4278255615,4294967040,4294902015,4280295456,4282400832,4284506208,4288651167,4290756543,4292861919,4278716424,4279242768,4279769112,4280821800,4281348144,4281874488,4282927176,4283453520,4283979864,4285032552,4285558896,4286085240,4287072135,4287598479,4288124823,4289177511,4289703855,4290230199,4291282887,4291809231,4292335575,4293388263,4293914607,4294440951,4278190081,4278203136,4278216192,4278229248,4278242304,4278255360,4278190131,4278203187,4278216243,4278229299,4278242355,4278255411,4278190182,4278203238,4278216294,4278229350,4278242406,4278255462,4278190233,4278203289,4278216345,4278229401,4278242457,4278255513,4278190284,4278203340,4278216396,4278229452,4278242508,4278255564,4278190335,4278203391,4278216447,4278229503,4278242559,4278255615,4281532416,4281545472,4281558528,4281571584,4281584640,4281597696,4281532467,4281545523,4281558579,4281571635,4281584691,4281597747,4281532518,4281545574,4281558630,4281571686,4281584742,4281597798,4281532569,4281545625,4281558681,4281571737,4281584793,4281597849,4281532620,4281545676,4281558732,4281571788,4281584844,4281597900,4281532671,4281545727,4281558783,4281571839,4281584895,4281597951,4284874752,4284887808,4284900864,4284913920,4284926976,4284940032,4284874803,4284887859,4284900915,4284913971,4284927027,4284940083,4284874854,4284887910,4284900966,4284914022,4284927078,4284940134,4284874905,4284887961,4284901017,4284914073,4284927129,4284940185,4284874956,4284888012,4284901068,4284914124,4284927180,4284940236,4284875007,4284888063,4284901119,4284914175,4284927231,4284940287,4288217088,4288230144,4288243200,4288256256,4288269312,4288282368,4288217139,4288230195,4288243251,4288256307,4288269363,4288282419,4288217190,4288230246,4288243302,4288256358,4288269414,4288282470,4288217241,4288230297,4288243353,4288256409,4288269465,4288282521,4288217292,4288230348,4288243404,4288256460,4288269516,4288282572,4288217343,4288230399,4288243455,4288256511,4288269567,4288282623,4291559424,4291572480,4291585536,4291598592,4291611648,4291624704,4291559475,4291572531,4291585587,4291598643,4291611699,4291624755,4291559526,4291572582,4291585638,4291598694,4291611750,4291624806,4291559577,4291572633,4291585689,4291598745,4291611801,4291624857,4291559628,4291572684,4291585740,4291598796,4291611852,4291624908,4291559679,4291572735,4291585791,4291598847,4291611903,4291624959,4294901760,4294914816,4294927872,4294940928,4294953984,4294967040,4294901811,4294914867,4294927923,4294940979,4294954035,4294967091,4294901862,4294914918,4294927974,4294941030,4294954086,4294967142,4294901913,4294914969,4294928025,4294941081,4294954137,4294967193,4294901964,4294915020,4294928076,4294941132,4294954188,4294967244,4294902015,4294915071,4294928127,4294941183,4294954239,4294967295],ne=ze&~ye,ue=Be+1,le=Gn,fe=Ds,pn=8*(3&Ws),li&&(pn=24-pn),dn=Zt^i(255,pn),se=0==(1&Ws)?0:522133279,0==(1&Ds)&&(se^=522133279);0!=--ue;){for(se^=522133279,te=le*Wn+4*Kn,re=fe*Wi+4*(Ws>>2),ee=_e+1,Bt=pn,oe=dn;0!=--ee;)(ae=v(((ae=16777215&(Yt=(Cn[te>>>2]&~se)+se))>>>16)+(ae>>>8&255)+(255&ae),3))>31&&(ae>224&&(Yt=4294967295),ce=Qe[re>>>2],Ut(re,Yt=i(Yt=Dt(Yt=ii(Yt,ce=ie[ce=u(ce&=~oe,Bt)]),ne),Bt),oe)),te+=4,li?0===Bt?(re+=4,Bt=24,oe=16777215):(Bt-=8,oe=oe>>>8|4278190080):32===Bt?(re+=4,Bt=0,oe=4294967040):(Bt+=8,oe=oe<<8|255),se^=522133279;++le,++fe}}(),xe=Ws,qe=Ws+_e,Me=Ds,je=Ds+Be,!0):!(8>$e)&&((8!==$e||0!=(ze&Fe))&&(32===$e&&function bs(){var Bt,Yt,Zt,te,ee,ie,re,se,ne;for(ie=Be+1,re=Gn,ne=Ds;0!=--ie;){for(Yt=re*Wn+4*Kn,te=ne*Wi+4*Ws,Zt=_e+1;0!=--Zt;)if(255==(ee=(Bt=Cn[Yt>>>2])>>>24)){for(Qe[te>>>2]=Bt,Yt+=4,te+=4;0!=--Zt&&(Bt=Cn[Yt>>>2])>>>24==255;)Qe[te>>>2]=Bt,Yt+=4,te+=4;++Zt}else if(0===ee){for(Yt+=4,te+=4;0!=--Zt&&(Bt=Cn[Yt>>>2])>>>24==0;)Yt+=4,te+=4;++Zt}else se=xt(Bt,se=Qe[te>>>2]),Qe[te>>>2]=se,Yt+=4,te+=4;++re,++ne}}(),16===$e&&function ys(){var Bt,Yt,Zt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;for(ae=Be+1,oe=Gn,le=Ds,Zt=16*(1&Ws),li&&(Zt=16-Zt),pn=i(65535,16-Zt);0!=--ae;){for(ee=oe*Wn+4*Kn,re=le*Wi+4*(Ws>>1),Bt=4*(3&le),ce=(3&Kn)-1,ie=_e+1,Zt=65535===(ne=pn)?16:0;0!=--ie;)Yt=qs[Bt+(ce=ce+1&3)],255==(se=(te=Cn[ee>>>2])>>>24)?Ut(re,te=i(0===(te=di(te,Yt))?1:te,Zt),ne):0!==se&&(ue=Qe[re>>>2],Ut(re,te=i(0===(te=di(te=xt(te,ue=(31744&(ue=u(ue&=~ne,Zt)))<<9|(992&ue)<<6|(31&ue)<<3|4278190080),Yt))?1:te,Zt),ne)),ee+=4,li?0===Zt&&(re+=4):0!==Zt&&(re+=4),Zt^=16,ne=~ne;++oe,++le}}(),8===$e&&function gs(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe;for(ie=[0,4278190081,4294967295,4286611584,4294901760,4278255360,4278190335,4278255615,4294967040,4294902015,4280295456,4282400832,4284506208,4288651167,4290756543,4292861919,4278716424,4279242768,4279769112,4280821800,4281348144,4281874488,4282927176,4283453520,4283979864,4285032552,4285558896,4286085240,4287072135,4287598479,4288124823,4289177511,4289703855,4290230199,4291282887,4291809231,4292335575,4293388263,4293914607,4294440951,4278190081,4278203136,4278216192,4278229248,4278242304,4278255360,4278190131,4278203187,4278216243,4278229299,4278242355,4278255411,4278190182,4278203238,4278216294,4278229350,4278242406,4278255462,4278190233,4278203289,4278216345,4278229401,4278242457,4278255513,4278190284,4278203340,4278216396,4278229452,4278242508,4278255564,4278190335,4278203391,4278216447,4278229503,4278242559,4278255615,4281532416,4281545472,4281558528,4281571584,4281584640,4281597696,4281532467,4281545523,4281558579,4281571635,4281584691,4281597747,4281532518,4281545574,4281558630,4281571686,4281584742,4281597798,4281532569,4281545625,4281558681,4281571737,4281584793,4281597849,4281532620,4281545676,4281558732,4281571788,4281584844,4281597900,4281532671,4281545727,4281558783,4281571839,4281584895,4281597951,4284874752,4284887808,4284900864,4284913920,4284926976,4284940032,4284874803,4284887859,4284900915,4284913971,4284927027,4284940083,4284874854,4284887910,4284900966,4284914022,4284927078,4284940134,4284874905,4284887961,4284901017,4284914073,4284927129,4284940185,4284874956,4284888012,4284901068,4284914124,4284927180,4284940236,4284875007,4284888063,4284901119,4284914175,4284927231,4284940287,4288217088,4288230144,4288243200,4288256256,4288269312,4288282368,4288217139,4288230195,4288243251,4288256307,4288269363,4288282419,4288217190,4288230246,4288243302,4288256358,4288269414,4288282470,4288217241,4288230297,4288243353,4288256409,4288269465,4288282521,4288217292,4288230348,4288243404,4288256460,4288269516,4288282572,4288217343,4288230399,4288243455,4288256511,4288269567,4288282623,4291559424,4291572480,4291585536,4291598592,4291611648,4291624704,4291559475,4291572531,4291585587,4291598643,4291611699,4291624755,4291559526,4291572582,4291585638,4291598694,4291611750,4291624806,4291559577,4291572633,4291585689,4291598745,4291611801,4291624857,4291559628,4291572684,4291585740,4291598796,4291611852,4291624908,4291559679,4291572735,4291585791,4291598847,4291611903,4291624959,4294901760,4294914816,4294927872,4294940928,4294953984,4294967040,4294901811,4294914867,4294927923,4294940979,4294954035,4294967091,4294901862,4294914918,4294927974,4294941030,4294954086,4294967142,4294901913,4294914969,4294928025,4294941081,4294954137,4294967193,4294901964,4294915020,4294928076,4294941132,4294954188,4294967244,4294902015,4294915071,4294928127,4294941183,4294954239,4294967295],ne=ze&~ye,ue=Be+1,le=Gn,fe=Ds,pn=8*(3&Ws),li&&(pn=24-pn),dn=Zt^i(255,pn),se=0==(1&Ws)?0:522133279,0==(1&Ds)&&(se^=522133279);0!=--ue;){for(se^=522133279,te=le*Wn+4*Kn,re=fe*Wi+4*(Ws>>2),ee=_e+1,Bt=pn,oe=dn;0!=--ee;)(ae=(Yt=(Cn[te>>>2]&~se)+se)>>>24)>31&&(224>ae&&(ce=Qe[re>>>2],Yt=xt(Yt,ce=ie[ce=u(ce&=~oe,Bt)])),Ut(re,Yt=i(Yt=Dt(Yt,ne),Bt),oe)),te+=4,li?0===Bt?(re+=4,Bt=24,oe=16777215):(Bt-=8,oe=oe>>>8|4278190080):24===Bt?(re+=4,Bt=0,oe=4294967040):(Bt+=8,oe=oe<<8|255),se^=522133279;++le,++fe}}(),xe=Ws,qe=Ws+_e,Me=Ds,je=Ds+Be,!0))))))}function Ai(){var Bt,Yt,Zt,te;if(Ks){if(!Xn&&!Rt())return null;Zt=Xn,te=!1,"number"==typeof(Bt=Us.fetchPointerofObject(Oe,ti))&&(Zt(Bt,xe,Me,qe-xe,je-Me),Qe=Wi=0,te=!0),yn||"number"==typeof(Yt=Us.fetchPointerofObject(Oe,xn))&&(te&&Yt===Bt||Zt(Yt,0,0,0,0),Cn=Wn=0),Ks=!1}}function rr(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,ve,ke,ge,be,Fe,Se,Oe,Ie,Ae;if(ae=Sn[Je+1],!(E(Ne)>=me+12))return Us.primitiveFail();if(0>=(ie=Gs-1)&&(ie=1),0>(Ie=wt(be=H(me,Ne),te=H(me+3,Ne),ie))&&(be=te-ie*Ie),0>(Fe=wt(pe=H(me+1,Ne),te=H(me+4,Ne),ie))&&(pe=te-ie*Fe),0>(oe=wt(ve=H(me+9,Ne),te=H(me+6,Ne),ie))&&(ve=te-ie*oe),0>(re=wt(ue=H(me+10,Ne),te=H(me+7,Ne),ie))&&(ue=te-ie*re),Us.failed())return!1;if(2===Us.methodArgumentCount())if(Ae=Us.stackIntegerValue(1),(ke=Us.stackValue(0)).isNil){if(16>jn)return Us.primitiveFail()}else{if(E(ke)<i(1,jn))return Us.primitiveFail();ke=ke.wordsOrBytes()}else Ae=1,ke=Us.nilObject();for(0>=(ie=aa-1)&&(ie=1),Se=1+(Ws+_e-1&Si-1),(ne=Si-(Ws&Si-1))>_e&&(ne=_e),Re>Yi&&(be+=(Re-Yi)*Ie,pe+=(Re-Yi)*Fe,ve+=(Re-Yi)*oe,ue+=(Re-Yi)*re),Cs(),Ae>1&&0==(ze&ye)&&(Ke?ci(8,Ee):16===$e&&ci(8,5)),Bt=ze&~ye,li?(de=0-$e,Yt=32-$e):(de=$e,Yt=0),le=1;Be>=le;le++){ge=wt(be,ve,ie),Kn=ge>=0?be:ve-ie*ge,ce=wt(pe,ue,ie),Gn=ce>=0?pe:ue-ie*ce,_s=li?32-(1+(Ws&Si-1))*$e:(Ws&Si-1)*$e,Le>Hi&&(Kn+=(Le-Hi)*ge,Gn+=(Le-Hi)*ce),fe=bn?Zt:Gt(Ds+le-1),pi=pn,Oe=ne,te=gn;do{ee=1===Ae?tr(Oe,ge,ce,Ie,Fe,de,Bt):ir(Oe,ge,ce,Ie,Fe,ke,Ae,de),_s=Yt,pi===Zt?(he=ae(ee&fe,Qe[oi>>>2]),Qe[oi>>>2]=pi&he):(he=ae(ee&fe,(se=Qe[oi>>>2])&pi),se=pi&he|se&~pi,Qe[oi>>>2]=se),oi+=4,2===te?(pi=dn,Oe=Se):(pi=Zt,Oe=Si)}while(0!=--te);be+=Ie,pe+=Fe,ve+=oe,ue+=re,oi+=Ze}}function Cs(){var Bt,Yt;for(na=0,Yt=jn;1!==Yt;)++na,Yt>>>=1;for(sa=mn[jn],$n=i(1,ta=5-na)-1,Bt=0;$n>=Bt;Bt++)ia[Bt]=Bn?32-i(Bt+1,na):i(Bt,na)}function ir(Bt,Yt,Zt,te,ee,ie,re,se){var ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe,Se,Oe;he=mn[$e],ae=0,2===re?(oe=Yt>>1,le=Zt>>1,fe=te>>1,pe=ee>>1):(oe=v(Yt,re),le=v(Zt,re),fe=v(te,re),pe=v(ee,re)),ce=Bt;do{be=Kn,me=Gn,ye=Fe=ge=ve=0,Se=0,ue=re;do{Oe=be,ke=me,ne=re;do{de=fi(Oe,ke),(25!==Je||0!==de)&&(++Se,ve+=255&(de=16>jn?ie[de]:16===jn?ui(de):de),ge+=de>>>8&255,Fe+=de>>>16&255,ye+=de>>>24),Oe+=oe,ke+=le}while(0!=--ne);be+=fe,me+=pe}while(0!=--ue);0===Se||25===Je&&re*re>>1>Se?de=0:(4===Se?(Fe>>>=2,ge>>>=2,ve>>>=2,ye>>>=2):(Fe=v(Fe,Se),ge=v(ge,Se),ve=v(ve,Se),ye=v(ye,Se)),0===(de=(ye<<24)+(Fe<<16)+(ge<<8)+ve)&&Fe+ge+ve+ye>0&&(de=1),de=Dt(de,ze)),ae|=i(de&he,_s),_s+=se,Kn+=Yt,Gn+=Zt}while(0!=--ce);return ae}function tr(Bt,Yt,Zt,te,ee,ie,re){var se,ne,ae,oe;if(ae=mn[$e],oe=0,ne=Bt,re===(Fe|be))do{se=fi(Kn,Gn),oe|=i(Ke[se&Ge]&ae,_s),_s+=ie,Kn+=Yt,Gn+=Zt}while(0!=--ne);else do{oe|=i(Dt(se=fi(Kn,Gn),re)&ae,_s),_s+=ie,Kn+=Yt,Gn+=Zt}while(0!=--ne);return oe}var Bt=1,Yt=11,Zt=4294967295,te=3,ee=13,ie=12,re=10,se=11,ne=14,ae=0,oe=4,ue=5,le=2,ce=7,fe=3,he=1,pe=8,de=9,me=15,ve=6,ke=2,ge=2,be=4,ye=8,Fe=1,Se=16384,Oe=0,Ie=3,Ae=2,Pe=1,we=1,Ce=43,Ve=0,je=0,xe=0,qe=0,Me=0,Be=0,_e=0,Ne=0,We=0,De=0,Te=0,Le=0,Re=0,Ee=0,ze=0,Ke=null,Ge=0,Ue=null,He=null,Je=0,Xe=0,Ye=0,Qe=0,Ze=0,$e=0,ti=0,ai=0,oi=0,li=0,pi=0,Si=0,Wi=0,Ei=0,Hi=0,Yi=0,js=new Array(4096),qs=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5],Ms=[0,2,4,6,8,12,14,16],Bs=[0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],_s=0,Ws=0,Ds=0,Ts=null,Ls=0,Rs=0,Es=0,zs=0,Ks=0,Gs=0,Us=null,Js=0,hn=null,pn=0,dn=0,mn=[0,1,3,0,15,31,0,0,255,0,0,0,0,0,0,0,65535,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1],kn="BitBltPlugin 3 November 2014 (e)",gn=0,bn=0,yn=0,Sn=new Array(43),On=0,In=null,Pn=0,wn=0,Cn=0,Vn=0,jn=0,xn=0,qn=0,Mn=0,Bn=0,_n=0,Wn=0,Ln=0,Rn=0,En=0,zn=0,Kn=0,Gn=0,Jn=null,Xn=null,Qn=0,$n=0,ta=0,ia=new Array(32),sa=0,na=0,aa=0;Squeak.registerExternalModule("BitBltPlugin",{primitiveCopyBits:function jr(){return Ht(Us.stackValue(Us.methodArgumentCount()))?(qt(),Us.failed()?null:(gt(),Us.failed()?null:(Us.pop(Us.methodArgumentCount()),22===Je||32===Je?(Us.pop(1),Us.pushInteger(We)):void 0))):Us.primitiveFail()},copyBits:qt,moduleUnloaded:function Dr(Bt){0===strcmp(Bt,"SurfacePlugin")&&(In=hn=Xn=0)},primitiveDrawLoop:function Cr(){var Bt,Yt,Zt;return Yt=Us.stackValue(2),Zt=Us.stackIntegerValue(1),Bt=Us.stackIntegerValue(0),Ht(Yt)?(Us.failed()||(function Qr(Bt,Yt){var Zt,te,ee,ie,re,se,ne,ae,le,ce;if(ee=Bt>0?1:0===Bt?0:-1,ce=Yt>0?1:0===Yt?0:-1,ie=Math.abs(Yt),se=te=9999,re=le=-9999,(ne=Math.abs(Bt))>ie){for(Zt=ne>>1,ae=1;ne>=ae;ae++)if(Hi+=ee,(Zt-=ie)<0&&(Yi+=ce,Zt+=ne),ne>ae){if(qt(),Us.failed())return null;qe>xe&&je>Me&&(se=Math.min(se,xe),re=Math.max(re,qe),te=Math.min(te,Me),(re-se)*((le=Math.max(le,je))-te)>4e3&&(xe=se,qe=re,Me=te,je=le,gt(),se=te=9999,re=le=-9999))}}else for(Zt=ie>>1,ae=1;ie>=ae;ae++)if(Yi+=ce,(Zt-=ne)<0&&(Hi+=ee,Zt+=ie),ie>ae){if(qt(),Us.failed())return null;qe>xe&&je>Me&&(se=Math.min(se,xe),re=Math.max(re,qe),te=Math.min(te,Me),(re-se)*((le=Math.max(le,je))-te)>4e3&&(xe=se,qe=re,Me=te,je=le,gt(),se=te=9999,re=le=-9999))}xe=se,qe=re,Me=te,je=le,Us.storeIntegerofObjectwithValue(oe,Ne,Hi),Us.storeIntegerofObjectwithValue(ue,Ne,Yi)}(Zt,Bt),gt()),void(Us.failed()||Us.pop(2))):Us.primitiveFail()},primitiveDisplayString:function Vr(){var Bt,Yt,Zt,te,ee,ie,re,se,ne,ae,ue,le,ce,fe;if(6!==Us.methodArgumentCount())return Us.primitiveFail();if(ue=Us.stackIntegerValue(0),ee=Us.stackObjectValue(1),ne=Us.stackObjectValue(2),Ni(ee)!==Us.classArray()||Ni(ne)!==Us.classArray())return Us.primitiveFail();if(256!==E(ne))return Us.primitiveFail();if(Us.failed())return null;if(ie=E(ee)-2,Zt=Us.stackIntegerValue(3),le=Us.stackIntegerValue(4),fe=Us.stackObjectValue(5),!Us.isBytes(fe))return Us.primitiveFail();if(!(le>0&&Zt>0&&Zt<=Xt(fe)))return Us.primitiveFail();if(!Ht(te=Us.stackObjectValue(6)))return Us.primitiveFail();if(30===Je||31===Je)return Us.primitiveFail();for(re=0!==Qe&&0!==Cn&&!1===yn&&xn!==ti&&(0!==ze||Bn!==li||jn!==$e),ae=Hi,Yt=fe.bytes,Bt=le;Zt>=Bt;Bt++){if(ce=Yt[Bt-1],0>(se=Us.fetchIntegerofObject(ce,ne))||se>ie)return Us.primitiveFail();if(Rn=Us.fetchIntegerofObject(se,ee),aa=Us.fetchIntegerofObject(se+1,ee)-Rn,Us.failed())return null;if(vi(),_e>0&&Be>0&&(re?(ni(),Oi(),xe=Ws,qe=Ws+_e,Me=Ds,je=Ds+Be):qt()),Us.failed())return null;Hi=Hi+aa+ue}xe=ae,gt(),Us.storeIntegerofObjectwithValue(oe,te,Hi),Us.pop(6)},initialiseModule:function Gr(){return function Jr(){Sn[1]=ss,Sn[2]=ks,Sn[3]=vs,Sn[4]=ur,Sn[5]=ms,Sn[6]=Qt,Sn[7]=as,Sn[8]=us,Sn[9]=ds,Sn[10]=ls,Sn[11]=ps,Sn[12]=os,Sn[13]=cs,Sn[14]=hs,Sn[15]=fs,Sn[16]=Qt,Sn[17]=Qt,Sn[18]=Qt,Sn[19]=Is,Sn[20]=or,Sn[21]=Or,Sn[22]=fr,Sn[23]=Ps,Sn[24]=As,Sn[25]=Os,Sn[26]=qr,Sn[27]=Mr,Sn[28]=mr,Sn[29]=dr,Sn[30]=pr,Sn[31]=Ss,Sn[32]=Fs,Sn[33]=gr,Sn[34]=ar,Sn[35]=xt,Sn[36]=xt,Sn[37]=xt,Sn[38]=hr,Sn[39]=xr,Sn[40]=Ti,Sn[41]=Xr,Sn[42]=br}(),function Ur(){var Bt,Yt,Zt;for(Yt=0;255>=Yt;Yt++)for(Bt=0;15>=Bt;Bt++)Zt=Zr(Yt,Bt),js[(Bt<<8)+Yt]=Zt}(),!0},loadBitBltFrom:Ht,setInterpreter:function cr(Zt){return!1!==((Us=Zt).majorVersion()==Bt)&&Us.minorVersion()>=Yt},primitiveWarpBits:function Pr(){return function Tr(Bt){return wi(Bt,!0)}(Us.stackValue(Us.methodArgumentCount()))?(function sr(){var Bt;return Bt=yn,yn=!0,vi(),yn=Bt,yn||0>=_e||0>=Be?(xe=qe=Me=je=0,null):Di()?(ni(),rr(),Ls>0?(xe=Ws,qe=Ws+_e):(xe=Ws-_e+1,qe=Ws+1),Qn>0?(Me=Ds,je=Ds+Be):(Me=Ds-Be+1,je=Ds+1),void Ai()):Us.primitiveFail()}(),Us.failed()?null:(gt(),Us.failed()?null:void Us.pop(Us.methodArgumentCount()))):Us.primitiveFail()},getModuleName:function Hr(){return kn},primitivePixelValueAt:function wr(){var Bt,Yt,Zt,te,ee,ie,re,se,ne,ae,oe;return ne=Us.stackIntegerValue(1),ae=Us.stackIntegerValue(0),Yt=Us.stackValue(2),Us.failed()?null:0>ne||0>ae?(oe=0,Us.failed()||Us.popthenPush(3,oe),null):(Yt=Us.stackValue(Us.methodArgumentCount()),Us.isPointers(Yt)&&E(Yt)>=4?(te=Us.fetchPointerofObject(Oe,Yt),Us.isWordsOrBytes(te)?(aa=Us.fetchIntegerofObject(Pe,Yt),Gs=Us.fetchIntegerofObject(Ae,Yt),Zt=Us.fetchIntegerofObject(Ie,Yt),Us.failed()?null:ne>=aa||ae>=Gs?(oe=0,Us.failed()||Us.popthenPush(3,oe),null):0>Zt?(Us.primitiveFail(),null):(ee=v(32,Zt),re=v(aa+(ee-1),ee),Xt(te)!==re*Gs*4?(Us.primitiveFail(),null):(ie=Us.fetchLong32ofObject(ae*re+v(ne,ee),te),se=u(4294967295,32-Zt),Bt=u(ie,32-(1+(ne&ee-1))*Zt)&se,oe=Us.positive32BitIntegerFor(Bt),Us.failed()||Us.popthenPush(3,oe),null))):(Us.primitiveFail(),null)):(Us.primitiveFail(),null))},copyBitsFromtoat:function rs(Bt,Yt,Zt){Hi=Bt,Yi=Zt,Rn=Bt,aa=Yt-Bt,qt(),gt()}})})),module("users.bert.SqueakJS.plugins.FFTPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function s(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function b(Bt,Yt){return 0|Math.floor(Bt/Yt)}function v(Bt,Yt){return Yt>31?0:Bt<<Yt}function c(Bt){return ie.success(ie.isWords(Bt)),ie.failed()?0:Bt.wordsAsFloat32Array()}function h(Bt){var Yt;return ie.success(s(Bt)>=6),!ie.failed()&&(se=ie.fetchIntegerofObject(0,Bt),Zt=ie.fetchIntegerofObject(1,Bt),Yt=ie.fetchPointerofObject(2,Bt),ce=s(Yt),le=c(Yt),Yt=ie.fetchPointerofObject(3,Bt),ae=s(Yt),ne=function P(Bt){return ie.success(ie.isWords(Bt)),Bt.words}(Yt),Yt=ie.fetchPointerofObject(4,Bt),ue=s(Yt),oe=c(Yt),Yt=ie.fetchPointerofObject(5,Bt),ee=s(Yt),te=c(Yt),ie.success(v(1,se)===Zt&&1+(Zt>>2)===ce&&Zt===ue&&Zt===ee&&ue===ee),!1===ie.failed())}function o(){var Bt,Yt,Zt,ee,re;for(ee=0,Zt=ae;Zt>ee;){if(Bt=ne[ee]-1,Yt=ne[ee+1]-1,!(ue>Bt&&ue>Yt))return ie.success(!1);re=oe[Bt],oe[Bt]=oe[Yt],oe[Yt]=re,re=te[Bt],te[Bt]=te[Yt],te[Yt]=re,ee+=2}}function d(){var Bt,Yt;if(1>=Zt)return null;for(Yt=1/Zt,Bt=0;Zt-1>=Bt;Bt++)oe[Bt]=oe[Bt]*Yt,te[Bt]=te[Bt]*Yt}function C(Bt){var Yt,ee,ie,re,ne,ae,ue,fe,he,pe,de,me,ve,ke,ge;for(ee=Zt>>1,ie=Zt>>2,me=1;se>=me;me++)for(de=(pe=v(1,me))>>1,Yt=b(Zt,pe),he=1;de>=he;he++)for(ie>(ge=(he-1)*Yt)?(ke=le[ce-ge-1],ue=le[ge]):(ke=0-le[ge-ie],ue=le[ee-ge]),Bt||(ue=0-ue),re=he;Zt>=re;)ne=re-1,ve=oe[fe=re+de-1]*ke-te[fe]*ue,ae=oe[fe]*ue+te[fe]*ke,oe[fe]=oe[ne]-ve,te[fe]=te[ne]-ae,oe[ne]=oe[ne]+ve,te[ne]=te[ne]+ae,re+=pe}var Bt=1,Yt=11,Zt=0,te=null,ee=0,ie=null,re="FFTPlugin 3 November 2014 (e)",se=0,ne=null,ae=0,oe=null,ue=0,le=null,ce=0;Squeak.registerExternalModule("FFTPlugin",{primitiveFFTTransformData:function y(){var Bt;return Bt=ie.booleanValueOf(ie.stackValue(0)),h(ie.stackObjectValue(1))?(function w(Bt){return o(),ie.failed()?(o(),null):(C(Bt),void(Bt||d()))}(Bt),void(ie.failed()||ie.pop(1))):null},setInterpreter:function g(Zt){return!1!==((ie=Zt).majorVersion()==Bt)&&ie.minorVersion()>=Yt},primitiveFFTPermuteData:function O(){return h(ie.stackObjectValue(0))?(o(),void(ie.failed()&&o())):null},primitiveFFTScaleData:function S(){return h(ie.stackObjectValue(0))?void d():null},getModuleName:function A(){return re}})})),module("users.bert.SqueakJS.plugins.FloatArrayPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function t(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}var Bt=1,Yt=11,Zt=null,te="FloatArrayPlugin 3 November 2014 (e)";Squeak.registerExternalModule("FloatArrayPlugin",{primitiveMulFloatArray:function h(){var Bt,Yt,te,ee,ie,re;if(Bt=Zt.stackObjectValue(0),ie=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ie)),Zt.failed())return null;if(ee=t(Bt),Zt.success(ee===t(ie)),Zt.failed())return null;for(re=ie.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),te=0;ee-1>=te;te++)re[te]=re[te]*Yt[te];Zt.pop(1)},primitiveEqual:function l(){var Bt,Yt,te,ee,ie,re;if(Bt=Zt.stackObjectValue(0),ie=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ie)),Zt.failed())return null;if(Zt.pop(2),(ee=t(Bt))!==t(ie))return Zt.pushBool(!1);for(re=ie.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),te=0;ee-1>=te;te++)if(re[te]!==Yt[te])return Zt.pushBool(!1);return Zt.pushBool(!0)},primitiveAtPut:function n(){var Bt,Yt,te,ee;return Bt="number"==typeof(ee=Zt.stackValue(0))?ee:Zt.floatValueOf(ee),Yt=Zt.stackIntegerValue(1),te=Zt.stackObjectValue(2),Zt.failed()?null:(Zt.success(Zt.isWords(te)),Zt.success(Yt>0&&Yt<=t(te)),Zt.failed()?null:(te.wordsAsFloat32Array()[Yt-1]=Bt,void(Zt.failed()||Zt.popthenPush(3,ee))))},primitiveAt:function s(){var Bt,Yt,te;return Yt=Zt.stackIntegerValue(0),te=Zt.stackObjectValue(1),Zt.failed()?null:(Zt.success(Zt.isWords(te)),Zt.success(Yt>0&&Yt<=t(te)),Zt.failed()?null:(Bt=te.wordsAsFloat32Array()[Yt-1],Zt.pop(2),void Zt.pushFloat(Bt)))},primitiveNormalize:function d(){var Bt,Yt,te,ee,ie;if(ee=Zt.stackObjectValue(0),Zt.failed())return null;if(Zt.success(Zt.isWords(ee)),Zt.failed())return null;for(te=t(ee),Zt.success(!0),ie=ee.wordsAsFloat32Array(),Yt=0,Bt=0;te-1>=Bt;Bt++)Yt+=ie[Bt]*ie[Bt];if(Zt.success(Yt>0),Zt.failed())return null;for(Yt=Math.sqrt(Yt),Bt=0;te-1>=Bt;Bt++)ie[Bt]=ie[Bt]/Yt},primitiveSubFloatArray:function m(){var Bt,Yt,te,ee,ie,re;if(Bt=Zt.stackObjectValue(0),ie=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ie)),Zt.failed())return null;if(ee=t(Bt),Zt.success(ee===t(ie)),Zt.failed())return null;for(re=ie.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),te=0;ee-1>=te;te++)re[te]=re[te]-Yt[te];Zt.pop(1)},primitiveDivFloatArray:function a(){var Bt,Yt,te,ee,ie,re;if(Bt=Zt.stackObjectValue(0),ie=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ie)),Zt.failed())return null;if(ee=t(Bt),Zt.success(ee===t(ie)),Zt.failed())return null;for(re=ie.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),te=0;ee-1>=te;te++)if(0===Yt[te])return Zt.primitiveFail();for(te=0;ee-1>=te;te++)re[te]=re[te]/Yt[te];Zt.pop(1)},primitiveAddScalar:function r(){var Bt,Yt,te,ee,ie;if(ie=Zt.stackFloatValue(0),te=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(te)),Zt.failed())return null;for(Yt=t(te),ee=te.wordsAsFloat32Array(),Bt=0;Yt-1>=Bt;Bt++)ee[Bt]=ee[Bt]+ie;Zt.pop(1)},primitiveDotProduct:function u(){var Bt,Yt,te,ee,ie,re,se;if(Bt=Zt.stackObjectValue(0),ie=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ie)),Zt.failed())return null;if(ee=t(Bt),Zt.success(ee===t(ie)),Zt.failed())return null;for(re=ie.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),se=0,te=0;ee-1>=te;te++)se+=re[te]*Yt[te];Zt.pop(2),Zt.pushFloat(se)},primitiveSubScalar:function v(){var Bt,Yt,te,ee,ie;if(ie=Zt.stackFloatValue(0),te=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(te)),Zt.failed())return null;for(Yt=t(te),ee=te.wordsAsFloat32Array(),Bt=0;Yt-1>=Bt;Bt++)ee[Bt]=ee[Bt]-ie;Zt.pop(1)},setInterpreter:function g(te){return!1!==((Zt=te).majorVersion()==Bt)&&Zt.minorVersion()>=Yt},primitiveSum:function k(){var Bt,Yt,te,ee,ie;if(te=Zt.stackObjectValue(0),Zt.failed())return null;if(Zt.success(Zt.isWords(te)),Zt.failed())return null;for(Yt=t(te),ee=te.wordsAsFloat32Array(),ie=0,Bt=0;Yt-1>=Bt;Bt++)ie+=ee[Bt];Zt.popthenPush(1,Zt.floatObjectOf(ie))},getModuleName:function f(){return te},primitiveHashArray:function c(){var Bt,Yt,te,ee,ie;if(te=Zt.stackObjectValue(0),Zt.failed())return null;if(Zt.success(Zt.isWords(te)),Zt.failed())return null;for(Yt=t(te),ee=te.wordsAsInt32Array(),ie=0,Bt=0;Yt-1>=Bt;Bt++)ie+=ee[Bt];return Zt.pop(1),Zt.pushInteger(536870911&ie)},primitiveMulScalar:function p(){var Bt,Yt,te,ee,ie;if(ie=Zt.stackFloatValue(0),te=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(te)),Zt.failed())return null;for(Yt=t(te),ee=te.wordsAsFloat32Array(),Bt=0;Yt-1>=Bt;Bt++)ee[Bt]=ee[Bt]*ie;Zt.pop(1)},primitiveLength:function S(){var Bt,Yt,te,ee,ie;if(te=Zt.stackObjectValue(0),Zt.failed())return null;if(Zt.success(Zt.isWords(te)),Zt.failed())return null;for(Yt=t(te),Zt.success(!0),ee=te.wordsAsFloat32Array(),ie=0,Bt=0;Yt-1>=Bt;Bt++)ie+=ee[Bt]*ee[Bt];ie=Math.sqrt(ie),Zt.popthenPush(1,Zt.floatObjectOf(ie))},primitiveAddFloatArray:function i(){var Bt,Yt,te,ee,ie,re;if(Bt=Zt.stackObjectValue(0),ie=Zt.stackObjectValue(1),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ie)),Zt.failed())return null;if(ee=t(Bt),Zt.success(ee===t(ie)),Zt.failed())return null;for(re=ie.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),te=0;ee-1>=te;te++)re[te]=re[te]+Yt[te];Zt.pop(1)},primitiveDivScalar:function o(){var Bt,Yt,te,ee,ie,re;if(re=Zt.stackFloatValue(0),ee=Zt.stackObjectValue(1),Zt.failed())return null;if(0===re)return Zt.primitiveFail();if(Zt.success(Zt.isWords(ee)),Zt.failed())return null;for(te=t(ee),ie=ee.wordsAsFloat32Array(),Yt=1/re,Bt=0;te-1>=Bt;Bt++)ie[Bt]=ie[Bt]*Yt;Zt.pop(1)}})})),module("users.bert.SqueakJS.plugins.GeniePlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function t(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function i(Bt,Yt){return new Int32Array(Bt.buffer,Bt.byteOffset+4*Yt)}function r(Bt,Yt){var Zt,te,ee,ie;return Zt=Bt[0],ee=Bt[1],(te=Yt[0]-Zt)*te+(ie=Yt[1]-ee)*ie}function d(Bt,Yt){var Zt;return(Zt=Math.abs(Yt-Bt))>180&&(Zt=360-Zt),Zt*Zt>>>6}function s(Bt){console.log(te+": "+Bt)}var Bt=1,Yt=11,Zt=null,te="GeniePlugin v2.0 14 November 2014 (e)";Squeak.registerExternalModule("GeniePlugin",{primVersionNO:function c(){return 2e3,Zt.failed()||Zt.popthenPush(1,2e3),null},setInterpreter:function f(te){return!1!==((Zt=te).majorVersion()==Bt)&&Zt.minorVersion()>=Yt},primSameClassAbsoluteStrokeDistanceMyPoints_otherPoints_myVectors_otherVectors_mySquaredLengths_otherSquaredLengths_myAngles_otherAngles_maxSizeAndReferenceFlag_rowBase_rowInsertRemove_rowInsertRemoveCount:function l(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe,Se,Oe,Ie,Ae,Pe,we,Ce,Ve,je,xe,qe,Me,Be,_e,Ne,We,De,Te,Le,Re,Ee,ze,Ke,Ge;if(Me=Zt.stackValue(11),Be=Zt.stackValue(10),_e=Zt.stackValue(9),Ne=Zt.stackValue(8),We=Zt.stackValue(7),De=Zt.stackValue(6),Te=Zt.stackValue(5),Le=Zt.stackValue(4),Re=Zt.stackIntegerValue(3),Ee=Zt.stackValue(2),ze=Zt.stackValue(1),Ke=Zt.stackValue(0),Zt.failed())return null;if(Zt.failed())return s("failed 1"),null;if(Zt.success(Zt.isWords(Me)&&Zt.isWords(Be)&&Zt.isWords(_e)&&Zt.isWords(Ne)&&Zt.isWords(We)&&Zt.isWords(De)&&Zt.isWords(Te)&&Zt.isWords(Le)&&Zt.isWords(Ee)&&Zt.isWords(ze)&&Zt.isWords(Ke)),Zt.failed())return s("failed 2"),null;if(Zt.success(Zt.isMemberOf(Me,"PointArray")&&Zt.isMemberOf(Be,"PointArray")),Zt.failed())return s("failed 3"),null;if(ce=Me.wordsAsInt32Array(),me=Be.wordsAsInt32Array(),ke=_e.wordsAsInt32Array(),ae=Ne.wordsAsInt32Array(),he=We.wordsAsInt32Array(),ue=De.wordsAsInt32Array(),Ve=Te.wordsAsInt32Array(),Bt=Le.wordsAsInt32Array(),be=Ee.wordsAsInt32Array(),xe=ze.wordsAsInt32Array(),ge=Ke.wordsAsInt32Array(),ve=t(Be)>>>1,Ae=t(_e)>>>1,oe=t(Ne)>>>1,Yt=t(De),le=t(Ee),Zt.success(le===t(ze)&&le===t(Ke)&&le>oe),Zt.failed())return s("failed 4"),null;if(Zt.success(t(We)>=Ae-1&&t(Me)>>>1>=Ae&&Yt>=oe-1&&ve>=oe&&t(Te)>=Ae-1&&t(Le)>=oe-1),Zt.failed())return s("failed 5"),null;if(Pe=Re>>>1,ye=1<<29,pe=(te=1&Re)?0:Pe*Pe>>>10,be[0]=0,xe[0]=0,ge[0]=2,Oe=0-pe,!(ve>=(fe=oe)-1&&Yt>=fe-1))return Zt.primitiveFail(),null;for(Se=1;fe>=Se;Se++)Oe=Oe+(ue[ee=Se-1]+r(i(me,ee<<1),ce)>>>7)+pe,xe[Se]=Oe,be[Se]=Oe*Se,ge[Se]=Se+1;for(Oe=xe[0]-pe,Ie=1;Ae>=Ie;Ie++){for(Fe=(ie=Ie-1)<<1,Ce=be[0],Oe=Oe+(he[ie]+r(i(ce,Fe),me)>>>7)+pe,xe[0]=Oe,be[0]=Oe*Ie,ge[0]=Ie+1,fe=oe,Se=1;fe>=Se;Se++)re=(ee=Se-1)<<1,we=be[Se],qe=be[ee],de=he[ie]+r(i(ce,Fe),i(me,Se<<1))>>>7,0===(Oe=xe[Se])?we+=de:(we=we+Oe+de*ge[Se],de+=Oe),ne=ue[ee]+r(i(me,re),i(ce,Ie<<1))>>>7,0===(Oe=xe[ee])?qe+=ne:(qe=qe+Oe+ne*ge[ee],ne+=Oe),te?Ce=ye:Ce+=(r(i(ae,re),i(ke,Fe))+r(i(me,re),i(ce,Fe)))*(16+d(Bt[ee],Ve[ie]))>>>11,we>=Ce&&qe>=Ce?(se=Ce,Oe=0,je=1):qe>=we?(se=we,Oe=de+pe,je=ge[Se]+1):(se=qe,Oe=ne+pe,je=ge[ee]+1),Ce=be[Se],be[Se]=Math.min(se,ye),xe[Se]=Math.min(Oe,ye),ge[Se]=je;Oe=xe[0]}return Ge=se,Zt.failed()||Zt.popthenPush(13,Ge),null},getModuleName:function u(){return te}})})),module("users.bert.SqueakJS.plugins.JPEGReaderPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function s(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function v(Bt,Yt){return 0|Math.floor(Bt/Yt)}function V(Bt,Yt){return Yt>31?0:Bt<<Yt}function P(Bt,Yt){return"number"!=typeof Yt&&(!!Ee.isPointers(Yt)&&(!(s(Yt)<Ce)&&(Bt[ee]=Ee.fetchIntegerofObject(ee,Yt),Bt[ie]=Ee.fetchIntegerofObject(ie,Yt),Bt[Se]=Ee.fetchIntegerofObject(Se,Yt),Bt[qe]=Ee.fetchIntegerofObject(qe,Yt),Bt[Zt]=Ee.fetchIntegerofObject(Zt,Yt),Bt[Ie]=Ee.fetchIntegerofObject(Ie,Yt),Bt[Ve]=Ee.fetchIntegerofObject(Ve,Yt),!Ee.failed())))}function C(Bt,Yt){var Zt,te,ee,ie;if("number"==typeof Yt)return!1;if(!Ee.isPointers(Yt))return!1;if(s(Yt)<Ce)return!1;if("number"==typeof(Zt=Ee.fetchPointerofObject(Oe,Yt)))return!1;if(!Ee.isPointers(Zt))return!1;if((ie=s(Zt))>Pe)return!1;for(ee=0;ie-1>=ee;ee++){if("number"==typeof(te=Ee.fetchPointerofObject(ee,Zt)))return!1;if(!Ee.isWords(te))return!1;if(s(te)!==se)return!1;Bt[ee]=te.wordsAsInt32Array()}return!Ee.failed()}function w(Bt){var Yt;return Bt>He&&(function wt(){for(var Bt;16>=He;){if(!(Ye>Xe))return He;if(Bt=Je[Xe],++Xe,255===Bt){if(!(Ye>Xe&&0===Je[Xe]))return--Xe,He;++Xe}Ue=Ue<<8|Bt,He+=8}return He}(),Bt>He)?-1:(Yt=function ft(Bt,Yt){return Yt>31?0:Bt>>>Yt}(Ue,He-=Bt),Ue&=V(1,He)-1,Yt)}function At(Bt,Yt){var Zt,te,ee,ie,ae,le,pe,me,Fe,Se,Oe,Ie,Ae,Pe,Ce,Ve,je,qe,Me,Be=new Array(64);for(ee=0;re-1>=ee;ee++){for(Zt=-1,ae=1;re-1>=ae;ae++)-1===Zt&&0!==Bt[ae*re+ee]&&(Zt=ae);if(-1===Zt)for(te=Bt[ee]*Yt[0]<<2,ie=0;re-1>=ie;ie++)Be[ie*re+ee]=te;else Ie=(Ce=((Ve=Bt[2*re+ee]*Yt[2*re+ee])+(je=Bt[6*re+ee]*Yt[6*re+ee]))*ue)+je*(0-ve),Ae=Ce+Ve*ce,me=(le=(Ve=Bt[ee]*Yt[ee])+(je=Bt[4*re+ee]*Yt[4*re+ee])<<13)+Ae,Oe=le-Ae,Fe=(pe=Ve-je<<13)+Ie,Se=pe-Ie,le=Bt[7*re+ee]*Yt[7*re+ee],pe=Bt[5*re+ee]*Yt[5*re+ee],Ie=Bt[3*re+ee]*Yt[3*re+ee],Ce=le+(Ae=Bt[re+ee]*Yt[re+ee]),Ve=pe+Ie,Me=((je=le+Ie)+(qe=pe+Ae))*he,je*=0-ke,qe*=0-oe,le=(le*=ne)+(Ce*=0-fe)+(je+=Me),pe=(pe*=ge)+(Ve*=0-be)+(qe+=Me),Ie=(Ie*=ye)+Ve+je,Ae=(Ae*=de)+Ce+qe,Be[ee]=me+Ae>>11,Be[7*re+ee]=me-Ae>>11,Be[1*re+ee]=Fe+Ie>>11,Be[6*re+ee]=Fe-Ie>>11,Be[2*re+ee]=Se+pe>>11,Be[5*re+ee]=Se-pe>>11,Be[3*re+ee]=Oe+le>>11,Be[4*re+ee]=Oe-le>>11}for(ee=0;se-re>=ee;ee+=re)Ie=(Ce=((Ve=Be[ee+2])+(je=Be[ee+6]))*ue)+je*(0-ve),Ae=Ce+Ve*ce,me=(le=Be[ee]+Be[ee+4]<<13)+Ae,Oe=le-Ae,Fe=(pe=Be[ee]-Be[ee+4]<<13)+Ie,Se=pe-Ie,le=Be[ee+7],pe=Be[ee+5],Ie=Be[ee+3],Ce=le+(Ae=Be[ee+1]),Ve=pe+Ie,Me=((je=le+Ie)+(qe=pe+Ae))*he,je*=0-ke,qe*=0-oe,le=(le*=ne)+(Ce*=0-fe)+(je+=Me),pe=(pe*=ge)+(Ve*=0-be)+(qe+=Me),Ie=(Ie*=ye)+Ve+je,Pe=(me+(Ae=(Ae*=de)+Ce+qe)>>18)+xe,Pe=Math.min(Pe,we),Pe=Math.max(Pe,0),Bt[ee]=Pe,Pe=(me-Ae>>18)+xe,Pe=Math.min(Pe,we),Pe=Math.max(Pe,0),Bt[ee+7]=Pe,Pe=(Fe+Ie>>18)+xe,Pe=Math.min(Pe,we),Pe=Math.max(Pe,0),Bt[ee+1]=Pe,Pe=(Fe-Ie>>18)+xe,Pe=Math.min(Pe,we),Pe=Math.max(Pe,0),Bt[ee+6]=Pe,Pe=(Se+pe>>18)+xe,Pe=Math.min(Pe,we),Pe=Math.max(Pe,0),Bt[ee+2]=Pe,Pe=(Se-pe>>18)+xe,Pe=Math.min(Pe,we),Pe=Math.max(Pe,0),Bt[ee+5]=Pe,Pe=(Oe+le>>18)+xe,Pe=Math.min(Pe,we),Pe=Math.max(Pe,0),Bt[ee+3]=Pe,Pe=(Oe-le>>18)+xe,Pe=Math.min(Pe,we),Pe=Math.max(Pe,0),Bt[ee+4]=Pe}function et(Bt,Yt){var Zt,te,ee,ie,re;if((te=Bt[0]>>>24)>Ae)return-1;for(ie=2;;){if(0>(Zt=w(te)))return-1;if((ee=ie+Zt-1)>=Yt)return-1;if(0==(1056964608&(re=Bt[ee])))return re;if(ie=65535&re,(te=re>>>24&255)>Ae)return-1}return-1}function St(){var Bt,Yt,te,re,se,ne,ae,oe;return te=Yt=Ne[ee],re=Ne[ie],ae=Ne[Se],oe=Ne[qe],0!==ae&&0!==oe&&(te=v(te,ae),re=v(re,oe)),Bt=(re>>>3)*Ne[Zt]+(te>>>3),ne=((7&re)<<3)+(7&te),se=_e[Bt][ne],++Yt<8*Ne[Ie]?Ne[ee]=Yt:(Ne[ee]=0,Ne[ie]++),se}function Ft(){var Bt,Yt,te,re,se,ne,ae,oe;return te=Yt=De[ee],re=De[ie],ae=De[Se],oe=De[qe],0!==ae&&0!==oe&&(te=v(te,ae),re=v(re,oe)),Bt=(re>>>3)*De[Zt]+(te>>>3),ne=((7&re)<<3)+(7&te),se=We[Bt][ne],++Yt<8*De[Ie]?De[ee]=Yt:(De[ee]=0,De[ie]++),se}function q(){var Bt,Yt,te,re,se,ne,ae,oe;return te=Yt=ti[ee],re=ti[ie],ae=ti[Se],oe=ti[qe],0!==ae&&0!==oe&&(te=v(te,ae),re=v(re,oe)),Bt=(re>>>3)*ti[Zt]+(te>>>3),ne=((7&re)<<3)+(7&te),se=$e[Bt][ne],++Yt<8*ti[Ie]?ti[ee]=Yt:(ti[ee]=0,ti[ie]++),se}function z(Bt,Yt){return Bt<V(1,Yt-1)?Bt-V(1,Yt)+1:Bt}function tt(Bt){return P(ti,Bt)&&C($e,Bt)}var Bt=1,Yt=11,Zt=5,te=2,ee=0,ie=1,re=8,se=64,ne=2446,ae=22554,oe=3196,ue=4433,le=46802,ce=6270,fe=7373,he=9633,pe=91881,de=12299,me=116130,ve=15137,ke=16069,ge=16819,be=20995,ye=25172,Fe=1,Se=2,Oe=4,Ie=8,Ae=16,Pe=128,we=255,Ce=11,Ve=10,je=0,xe=127,qe=3,Me=null,Be=0,_e=new Array(128),Ne=new Array(11),We=new Array(128),De=new Array(11),Te=null,Le=0,Re=0,Ee=null,ze=null,Ke=0,Ge=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63],Ue=0,He=0,Je=null,Xe=0,Ye=0,Qe="JPEGReaderPlugin 3 November 2014 (e)",Ze=null,$e=new Array(128),ti=new Array(11);Squeak.registerExternalModule("JPEGReaderPlugin",{setInterpreter:function vt(Zt){return!1!==((Ee=Zt).majorVersion()==Bt)&&Ee.minorVersion()>=Yt},primitiveIdctInt:function kt(){var Bt,Yt;return 2!==Ee.methodArgumentCount()?Ee.primitiveFail():(Bt=Ee.stackObjectValue(0),Ee.failed()?null:Ee.isWords(Bt)&&s(Bt)===se?(Yt=Bt.wordsAsInt32Array(),Bt=Ee.stackObjectValue(1),Ee.failed()?null:Ee.isWords(Bt)&&s(Bt)===se?(At(Bt.wordsAsInt32Array(),Yt),void Ee.pop(2)):Ee.primitiveFail()):Ee.primitiveFail())},primitiveColorConvertMCU:function Mt(){var Bt;return 4!==Ee.methodArgumentCount()?Ee.primitiveFail():(Re=Ee.stackIntegerValue(0),Bt=Ee.stackObjectValue(1),Ee.failed()?null:Ee.isWords(Bt)&&3===s(Bt)?(Ze=Bt.wordsAsInt32Array(),Bt=Ee.stackObjectValue(2),Ee.failed()?null:Ee.isWords(Bt)?(Ke=s(Bt),ze=Bt.wordsAsInt32Array(),Bt=Ee.stackObjectValue(3),Ee.failed()?null:Ee.isPointers(Bt)&&3===s(Bt)&&tt(Ee.fetchPointerofObject(0,Bt))&&function ht(Bt){return P(Ne,Bt)&&C(_e,Bt)}(Ee.fetchPointerofObject(1,Bt))&&function Vt(Bt){return P(De,Bt)&&C(We,Bt)}(Ee.fetchPointerofObject(2,Bt))?(function xt(){var Bt,Yt,Zt,re,se,ne,oe;for(ti[ee]=0,ti[ie]=0,Ne[ee]=0,Ne[ie]=0,De[ee]=0,De[ie]=0,se=0;Ke-1>=se;se++)oe=q(),Yt=St(),Yt-=xe,Zt=Ft(),ne=oe+(pe*(Zt-=xe)>>16)+Ze[je],ne=Math.min(ne,we),ne=Math.max(ne,0),Ze[je]=ne&Re,ne&=we-Re,ne=Math.max(ne,1),re=oe-(ae*Yt>>16)-(le*Zt>>16)+Ze[Fe],re=Math.min(re,we),re=Math.max(re,0),Ze[Fe]=re&Re,re&=we-Re,re=Math.max(re,1),Bt=oe+(me*Yt>>16)+Ze[te],Bt=Math.min(Bt,we),Bt=Math.max(Bt,0),Ze[te]=Bt&Re,Bt&=we-Re,Bt=Math.max(Bt,1),ze[se]=4278190080+(ne<<16)+(re<<8)+Bt}(),void Ee.pop(4)):Ee.primitiveFail()):Ee.primitiveFail()):Ee.primitiveFail())},primitiveColorConvertGrayscaleMCU:function yt(){var Bt;return 4!==Ee.methodArgumentCount()?Ee.primitiveFail():(Re=Ee.stackIntegerValue(0),Bt=Ee.stackObjectValue(1),Ee.failed()?null:Ee.isWords(Bt)&&3===s(Bt)?(Ze=Bt.wordsAsInt32Array(),Bt=Ee.stackObjectValue(2),Ee.failed()?null:Ee.isWords(Bt)?(Ke=s(Bt),ze=Bt.wordsAsInt32Array(),Bt=Ee.stackObjectValue(3),Ee.failed()?null:tt(Bt)?(function qt(){var Bt,Yt;for(ti[ee]=0,ti[ie]=0,Bt=0;Ke-1>=Bt;Bt++)Yt=q(),Yt+=Ze[Fe],Yt=Math.min(Yt,we),Ze[Fe]=Yt&Re,Yt&=we-Re,Yt=Math.max(Yt,1),ze[Bt]=4278190080+(Yt<<16)+(Yt<<8)+Yt}(),void Ee.pop(4)):Ee.primitiveFail()):Ee.primitiveFail()):Ee.primitiveFail())},primitiveDecodeMCU:function gt(){var Bt,Yt,Zt;return 5!==Ee.methodArgumentCount()?Ee.primitiveFail():(Zt=Ee.stackObjectValue(0),Ee.failed()?null:function Ot(Bt){var Yt,Zt;return!(s(Bt)<5||!Ee.isPointers(Bt)||"number"==typeof(Yt=Ee.fetchPointerofObject(0,Bt))||!Ee.isBytes(Yt)||(Je=Yt.bytes,Zt=function ut(Bt){return Bt.bytes?Bt.bytes.length:Bt.words?4*Bt.words.length:0}(Yt),Xe=Ee.fetchIntegerofObject(1,Bt),Ye=Ee.fetchIntegerofObject(2,Bt),Ue=Ee.fetchIntegerofObject(3,Bt),He=Ee.fetchIntegerofObject(4,Bt),Ee.failed()||Ye>Zt||0>Xe||Xe>=Ye))}(Zt)?(Yt=Ee.stackObjectValue(1),Ee.failed()?null:Ee.isWords(Yt)?(Be=s(Yt),Me=Yt.wordsAsInt32Array(),Yt=Ee.stackObjectValue(2),Ee.failed()?null:Ee.isWords(Yt)?(Le=s(Yt),Te=Yt.wordsAsInt32Array(),Zt=Ee.stackObjectValue(3),Ee.failed()?null:P(ti,Zt)?(Yt=Ee.stackObjectValue(4),Ee.failed()?null:Ee.isWords(Yt)?s(Yt)!==se?Ee.primitiveFail():(Bt=Yt.wordsAsInt32Array(),Ee.failed()?null:(function Ct(Bt,Yt){var Zt,te,ee,ie;if(0>(Zt=et(Te,Le)))return Ee.primitiveFail();for(0!==Zt&&(Zt=z(w(Zt),Zt)),Zt=Yt[Ve]=Yt[Ve]+Zt,Bt[0]=Zt,te=1;se-1>=te;te++)Bt[te]=0;for(ee=1;se>ee;){if(0>(Zt=et(Me,Be)))return Ee.primitiveFail();if(ie=Zt>>>4,0!=(Zt&=15)){if(ee+=ie,Zt=z(w(Zt),Zt),0>ee||ee>=se)return Ee.primitiveFail();Bt[Ge[ee]]=Zt}else{if(15!==ie)return null;ee+=ie}++ee}}(Bt,ti),Ee.failed()?null:(function mt(Bt){Ee.storeIntegerofObjectwithValue(1,Bt,Xe),Ee.storeIntegerofObjectwithValue(3,Bt,Ue),Ee.storeIntegerofObjectwithValue(4,Bt,He)}(Ee.stackValue(0)),Ee.storeIntegerofObjectwithValue(Ve,Ee.stackValue(3),ti[Ve]),void Ee.pop(5)))):Ee.primitiveFail()):Ee.primitiveFail()):Ee.primitiveFail()):Ee.primitiveFail()):Ee.primitiveFail())},getModuleName:function Pt(){return Qe}})})),module("users.bert.SqueakJS.plugins.KedamaPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function t(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function a(Bt,Yt){return 0|Math.floor(Bt/Yt)}function h(Bt,Yt){return Bt-a(Bt,Yt)*Yt|0}function rt(Bt,Yt){return 0>Yt?-31>Yt?0:Bt>>>0-Yt:Yt>31?0:Bt<<Yt}function c(Bt,Yt){var Zt,te;return 0===Bt?Yt>=0?90:270:(Zt=Yt/Bt,te=Math.atan(Zt),Bt>=0?Yt>=0?te/.0174532925199433:360+te/.0174532925199433:180+te/.0174532925199433)}function o(Bt){var Yt,Zt;return Zt=(Yt=90-Bt)/360|0,0>Yt&&--Zt,.0174532925199433*(Yt-360*Zt)}function f(Bt){var Yt,Zt,ee,re;return ee=0>Bt?0-Bt:Bt,Yt=a(te,se),Zt=h(te,se),re=(65535&(te=ie*Zt-ne*Yt))*(ee+1)>>>16,0>Bt?0-re:re}function p(Bt){var Yt;return(Yt=90-Bt/.0174532925199433)>0||(Yt+=360),Yt}function n(Bt,Yt,Zt,te,ee,ie,re){var se,ne;0>(ne=te)&&(1===ie&&(ne+=ee),2===ie&&(ne=0),3===ie&&(ne=0-ne,se=Zt[Bt],Zt[Bt]=3.141592653589793>se?3.141592653589793-se:9.42477796076938-se)),ne>=ee&&(1===re&&(ne-=ee),2===re&&(ne=ee-1e-6),3===re&&(ne=ee-1e-6-(ne-ee),se=Zt[Bt],Zt[Bt]=3.141592653589793>se?3.141592653589793-se:9.42477796076938-se)),Yt[Bt]=ne}function s(Bt,Yt,Zt,te,ee,ie,re){var se;0>(se=te)&&(1===ie&&(se+=ee),2===ie&&(se=0),3===ie&&(se=0-se,Zt[Bt]=6.283185307179586-Zt[Bt])),se>=ee&&(1===re&&(se-=ee),2===re&&(se=ee-1e-6),3===re&&(se=ee-1e-6-(se-ee),Zt[Bt]=6.283185307179586-Zt[Bt])),Yt[Bt]=se}var Bt=1,Yt=11,Zt=null,te=0,ee="KedamaPlugin 3 November 2014 (e)",ie=0,re=0,se=0,ne=0;Squeak.registerExternalModule("KedamaPlugin",{makeMaskLog:function V(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le;if(ue=Zt.stackValue(0),le=Zt.stackIntegerValue(1),ne=Zt.stackValue(2),ee=Zt.stackValue(3),Zt.failed())return null;if(ae=ue.words[0],Zt.failed())return null;if(oe=Math.log(ae),(ie=t(ee))!==t(ne))return Zt.primitiveFail(),null;for(Yt=ee.words,se=ne.words,4278190080,re=0;ie-1>=re;re++)(Bt=0===(te=Yt[re])?0:255/oe*Math.log(te)|0)>255&&(Bt=255),se[re]=Bt<<24&4278190080|le;Zt.pop(4)},vectorGetDistanceTo:function H(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de;if(oe=Zt.stackValue(0),de=Zt.stackValue(1),fe=Zt.stackValue(2),re=Zt.stackValue(3),ee=Zt.stackValue(4),Zt.failed())return null;if(!Zt.isWords(oe))return Zt.primitiveFail(),null;if(!Zt.isWords(fe))return Zt.primitiveFail(),null;if(!Zt.isWords(de))return Zt.primitiveFail(),null;if(0>(ue=t(oe)))return Zt.primitiveFail(),null;if(t(fe)!==ue)return Zt.primitiveFail(),null;if(t(de)!==ue)return Zt.primitiveFail(),null;if(ee.isFloat){if(!re.isFloat)return Zt.primitiveFail(),null;Yt=!1}else{if(re.isFloat)return Zt.primitiveFail(),null;Yt=!0}if(Yt){if(t(ee)!==ue)return Zt.primitiveFail(),null;if(t(re)!==ue)return Zt.primitiveFail(),null}for(ae=oe.wordsAsFloat32Array(),ce=fe.wordsAsFloat32Array(),pe=de.wordsAsFloat32Array(),Yt&&(te=ee.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array()),Yt||(se=Zt.floatValueOf(ee),ne=Zt.floatValueOf(re)),Bt=0;ue-1>=Bt;Bt++)Yt&&(se=te[Bt],ne=ie[Bt]),le=se-ce[Bt],he=ne-pe[Bt],ae[Bt]=Math.sqrt(le*le+he*he);return Zt.failed()?null:(Zt.pop(6),void Zt.push(oe))},getScalarHeading:function Q(){var Bt,Yt,te;return Yt=Zt.stackValue(0),te=Zt.stackIntegerValue(1),Zt.failed()?null:Zt.isWords(Yt)?t(Yt)<te?(Zt.primitiveFail(),null):(Bt=p(Bt=Yt.wordsAsFloat32Array()[te-1]),Zt.failed()?null:(Zt.pop(3),void Zt.pushFloat(Bt))):(Zt.primitiveFail(),null)},shutdownModule:function E(){return!0},primitiveAddScalar:function I(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(ue=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),oe=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(oe)),Zt.success(Zt.isWords(ue)),Zt.failed())return null;if(ae=t(oe),Zt.success(ae===t(ue)),Zt.failed())return null;if(se="number"==typeof Bt,ne=Zt.isMemberOf(oe,"WordArray"),se&&ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ue,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(ne)if(se)for(le=oe.words,re=Bt,ce=ue.words,ie=0;ae-1>=ie;ie++)ce[ie]=le[ie]+re;else for(le=oe.words,Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=le[ie]+Yt;else if(se)for(te=oe.wordsAsFloat32Array(),re=Bt,ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]+re;else for(te=oe.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]+Yt;Zt.pop(4),Zt.push(ue)},primSetPixelsAtXY:function y(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me;if(ue=Zt.stackValue(0),Yt=Zt.stackIntegerValue(1),ie=Zt.stackIntegerValue(2),ee=Zt.stackValue(3),me=Zt.stackValue(4),he=Zt.stackValue(5),Zt.failed())return null;if(!Zt.isWords(he))return Zt.primitiveFail(),null;if(!Zt.isWords(me))return Zt.primitiveFail(),null;if(!Zt.isWords(ee))return Zt.primitiveFail(),null;if(Yt*ie!==t(ee))return Zt.primitiveFail(),null;if(ae=t(he),t(me)!==ae)return Zt.primitiveFail(),null;if((ne="number"==typeof ue)&&(se=ue),!ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null;if(t(ue)!==ae)return Zt.primitiveFail(),null}for(fe=he.wordsAsFloat32Array(),de=me.wordsAsFloat32Array(),ne||(le=ue.words),Bt=ee.words,ne&&(oe=se),re=0;ae-1>=re;re++)ce=0|fe[re],pe=0|de[re],ce>=0&&pe>=0&&ie>ce&&Yt>pe&&(te=pe*ie+ce,ne||(oe=le[re]),Bt[te]=oe);return Zt.failed()?null:void Zt.pop(6)},turtleScalarSetX:function K(){var Bt,Yt,te,ee,ie,re,se,ne;return ee=Zt.stackIntegerValue(0),te=Zt.stackIntegerValue(1),Bt=Zt.stackFloatValue(2),re=Zt.stackFloatValue(3),Yt=Zt.stackValue(4),se=Zt.stackIntegerValue(5),ne=Zt.stackValue(6),Zt.failed()?null:Zt.isWords(ne)&&Zt.isWords(Yt)?(ie=t(ne),t(Yt)!==ie?(Zt.primitiveFail(),null):(n(se-1,ne.wordsAsFloat32Array(),Yt.wordsAsFloat32Array(),re,Bt,te,ee),Zt.failed()?null:void Zt.pop(7))):(Zt.primitiveFail(),null)},primPixelAtXY:function W(){var Bt,Yt,te,ee,ie,re,se,ne,ae;return te=Zt.stackIntegerValue(0),ie=Zt.stackIntegerValue(1),ae=Zt.stackFloatValue(2),se=Zt.stackFloatValue(3),Yt=Zt.stackValue(4),Zt.failed()?null:Zt.isWords(Yt)?t(Yt)!==te*ie?(Zt.primitiveFail(),null):(re=0|se,ne=0|ae,Bt=Yt.words,re>=0&&ie>re&&ne>=0&&te>ne?ee=Bt[ne*ie+re]:ee=0,Zt.failed()?null:(Zt.pop(6),void Zt.pushInteger(ee))):(Zt.primitiveFail(),null)},primUpHill:function S(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be;if(ue=Zt.stackIntegerValue(0),ie=Zt.stackIntegerValue(1),ke=Zt.stackIntegerValue(2),Yt=Zt.stackValue(3),fe=Zt.stackFloatValue(4),pe=Zt.stackFloatValue(5),he=Zt.stackFloatValue(6),Zt.failed())return null;if(!Zt.isWords(Yt))return Zt.primitiveFail(),null;if(t(Yt)!==ie*ke)return Zt.primitiveFail(),null;for(Bt=Yt.words,me=he,ve=pe,me=Math.max(me,0),ve=Math.max(ve,0),me=Math.min(me,ke-1),ve=Math.min(ve,ie-1),le=Math.max(me-ue,0),te=Math.min(me+ue,ke-1),ce=Math.max(ve-ue,0),ee=Math.min(ve+ue,ie-1),re=Bt[ve*ke+me],se=-1,be=ce;ee>=be;be++)for(oe=be*ke,ge=le;te>=ge;ge++)(de=Bt[oe+ge])>re&&(se=ge,ne=be,re=de);return ae=-1===se?p(fe):c(se-me,ne-ve)+90|0,Zt.failed()?null:(Zt.pop(8),void Zt.pushFloat(ae))},primScalarForward:function b(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve;return Bt=Zt.stackIntegerValue(0),fe=Zt.stackIntegerValue(1),le=Zt.stackIntegerValue(2),ae=Zt.stackIntegerValue(3),Yt=Zt.stackFloatValue(4),te=Zt.stackFloatValue(5),he=Zt.stackFloatValue(6),re=Zt.stackValue(7),ve=Zt.stackValue(8),de=Zt.stackValue(9),ne=Zt.stackIntegerValue(10),Zt.failed()?null:Zt.isWords(de)&&Zt.isWords(ve)&&Zt.isWords(re)?(ce=t(de),t(ve)!==ce||t(re)!==ce?(Zt.primitiveFail(),null):(pe=de.wordsAsFloat32Array(),me=ve.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array(),ee=he,oe=pe[se=ne-1]+ee*Math.cos(ie[se]),ue=me[se]-ee*Math.sin(ie[se]),n(se,pe,ie,oe,te,ae,le),s(se,me,ie,ue,Yt,fe,Bt),Zt.failed()?null:void Zt.pop(11))):(Zt.primitiveFail(),null)},primitiveDivArrays:function A(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(oe)),Zt.failed())return null;if(ne=t(Bt),Zt.success(ne===t(ae)),Zt.success(ne===t(oe)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),se=Zt.isMemberOf(ae,"WordArray"),re&&se){if(!Zt.isMemberOf(oe,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(oe,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(se)if(re)for(le=ae.words,ue=Bt.words,ce=oe.words,ie=0;ne-1>=ie;ie++)ce[ie]=le[ie]/ue[ie];else for(le=ae.words,Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=le[ie]/Yt[ie];else if(re)for(te=ae.wordsAsFloat32Array(),ue=Bt.words,ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]/ue[ie];else for(te=ae.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]/Yt[ie];Zt.pop(4),Zt.push(oe)},getModuleName:function $(){return ee},primitiveSubArrays:function st(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(oe)),Zt.failed())return null;if(ne=t(Bt),Zt.success(ne===t(ae)),Zt.success(ne===t(oe)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),se=Zt.isMemberOf(ae,"WordArray"),re&&se){if(!Zt.isMemberOf(oe,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(oe,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(se)if(re)for(le=ae.words,ue=Bt.words,ce=oe.words,ie=0;ne-1>=ie;ie++)ce[ie]=le[ie]-ue[ie];else for(le=ae.words,Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=le[ie]-Yt[ie];else if(re)for(te=ae.wordsAsFloat32Array(),ue=Bt.words,ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]-ue[ie];else for(te=ae.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]-Yt[ie];Zt.pop(4),Zt.push(oe)},scalarGetAngleTo:function _(){var Bt,Yt,te,ee,ie;return Yt=Zt.stackFloatValue(0),Bt=Zt.stackFloatValue(1),ie=Zt.stackFloatValue(2),ee=Zt.stackFloatValue(3),Zt.failed()?null:(te=c(ee-Bt,ie-Yt),(te+=90)>360&&(te-=360),Zt.failed()?null:(Zt.pop(5),void Zt.pushFloat(te)))},randomRange:function B(){var Bt,Yt;return Bt=Zt.stackIntegerValue(0),Zt.failed()?null:(Yt=f(Bt),Zt.failed()?null:(Zt.pop(2),void Zt.pushInteger(Yt)))},setInterpreter:function L(te){return!1!==((Zt=te).majorVersion()==Bt)&&Zt.minorVersion()>=Yt},kedamaSetRandomSeed:function m(){var Bt;return Bt=Zt.stackIntegerValue(0),Zt.failed()?null:(te=65536&Bt,void Zt.pop(1))},drawTurtlesInArray:function it(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe;if(oe=Zt.stackValue(0),Yt=Zt.stackValue(1),pe=Zt.stackValue(2),ce=Zt.stackValue(3),ee=Zt.stackIntegerValue(4),re=Zt.stackIntegerValue(5),ie=Zt.stackValue(6),Zt.failed())return null;if(!Zt.isWords(ie))return Zt.primitiveFail(),null;if(!Zt.isWords(ce))return Zt.primitiveFail(),null;if(!Zt.isWords(pe))return Zt.primitiveFail(),null;if(!Zt.isWords(Yt))return Zt.primitiveFail(),null;if(!Zt.isBytes(oe))return Zt.primitiveFail(),null;if(ee*re!==t(ie))return Zt.primitiveFail(),null;if(ne=t(ce),t(pe)!==ne)return Zt.primitiveFail(),null;if(t(Yt)!==ne)return Zt.primitiveFail(),null;if(t(oe)!==ne)return Zt.primitiveFail(),null;for(le=ce.wordsAsFloat32Array(),he=pe.wordsAsFloat32Array(),Bt=Yt.words,ae=oe.bytes,te=ie.words,se=0;ne-1>=se;se++)ue=0|le[se],fe=0|he[se],0!==ae[se]&&ue>=0&&fe>=0&&re>ue&&ee>fe&&(te[fe*re+ue]=Bt[se]);return Zt.failed()?null:void Zt.pop(7)},turtleScalarSetY:function z(){var Bt,Yt,te,ee,ie,re,se,ne;return Bt=Zt.stackIntegerValue(0),ie=Zt.stackIntegerValue(1),Yt=Zt.stackFloatValue(2),re=Zt.stackFloatValue(3),te=Zt.stackValue(4),se=Zt.stackIntegerValue(5),ne=Zt.stackValue(6),Zt.failed()?null:Zt.isWords(ne)&&Zt.isWords(te)?(ee=t(ne),t(te)!==ee?(Zt.primitiveFail(),null):(s(se-1,ne.wordsAsFloat32Array(),te.wordsAsFloat32Array(),re,Yt,ie,Bt),Zt.failed()?null:void Zt.pop(7))):(Zt.primitiveFail(),null)},randomIntoIntegerArray:function M(){var Bt,Yt,te,ee,ie,re,se;if(Bt=Zt.stackFloatValue(0),ie=Zt.stackValue(1),se=Zt.stackIntegerValue(2),Yt=Zt.stackIntegerValue(3),re=Zt.stackIntegerValue(4),Zt.failed())return null;if(!Zt.isWords(ie))return Zt.primitiveFail(),null;if(!(t(ie)>=se&&Yt>=1&&se>=Yt))return Zt.primitiveFail(),null;if(ee=ie.words,Zt.failed())return null;for(te=Yt;se>=te;te++)ee[te-1]=f(re)*Bt|0;Zt.pop(5)},getHeadingArrayInto:function tt(){var Bt,Yt,te,ee,ie,re,se;if(re=Zt.stackValue(0),te=Zt.stackValue(1),Zt.failed())return null;if(!Zt.isWords(te))return Zt.primitiveFail(),null;if(!Zt.isWords(re))return Zt.primitiveFail(),null;if(se=t(te),t(re)!==se)return Zt.primitiveFail(),null;for(Yt=te.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array(),ee=0;se-1>=ee;ee++)Bt=Yt[ee],(Bt=90-(Bt/=.0174532925199433))>0||(Bt+=360),ie[ee]=Bt;return Zt.failed()?null:void Zt.pop(2)},makeTurtlesMap:function v(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe;if(Bt=Zt.stackIntegerValue(0),ae=Zt.stackIntegerValue(1),fe=Zt.stackValue(2),le=Zt.stackValue(3),ne=Zt.stackValue(4),ie=Zt.stackValue(5),!Zt.isWords(fe))return Zt.primitiveFail(),null;if(!Zt.isWords(le))return Zt.primitiveFail(),null;if(!Zt.isWords(ne))return Zt.primitiveFail(),null;if(!Zt.isWords(ie))return Zt.primitiveFail(),null;if(re=t(ne),t(le)!==re)return Zt.primitiveFail(),null;if(t(fe)!==re)return Zt.primitiveFail(),null;if(t(ie)!==Bt*ae)return Zt.primitiveFail(),null;for(ue=le.wordsAsFloat32Array(),ce=fe.wordsAsFloat32Array(),se=ne.words,te=ie.words,Yt=0;Bt*ae-1>=Yt;Yt++)te[Yt]=0;for(Yt=0;re-1>=Yt;Yt++)oe=ue[Yt],(ee=ae*ce[Yt]+oe)>=0&&Bt*ae>ee&&(te[ee]=se[Yt]);return Zt.failed()?null:void Zt.pop(6)},setHeadingArrayFrom:function T(){var Bt,Yt,te,ee,ie,re,se,ne;if(se=Zt.stackValue(0),te=Zt.stackValue(1),Zt.failed())return null;if(!Zt.isWords(te))return Zt.primitiveFail(),null;if(ne=t(te),se.isFloat)ie=!1;else{if(!Zt.isWords(se))return Zt.primitiveFail(),null;if(t(se)!==ne)return Zt.primitiveFail(),null;ie=!0}for(Yt=te.wordsAsFloat32Array(),ie?re=se.wordsAsFloat32Array():Bt=o(Bt=Zt.floatValueOf(se)),ee=0;ne-1>=ee;ee++)ie&&(Bt=o(Bt=re[ee])),Yt[ee]=Bt;return Zt.failed()?null:void Zt.pop(2)},turtlesSetX:function G(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(se=Zt.stackIntegerValue(0),re=Zt.stackIntegerValue(1),Bt=Zt.stackFloatValue(2),ue=Zt.stackValue(3),te=Zt.stackValue(4),ce=Zt.stackValue(5),Zt.failed())return null;if(!Zt.isWords(ce))return Zt.primitiveFail(),null;if(!Zt.isWords(te))return Zt.primitiveFail(),null;if(ue.isFloat)ie=!1;else{if(!Zt.isWords(ue))return Zt.primitiveFail(),null;ie=!0}if(ne=t(ce),t(te)!==ne)return Zt.primitiveFail(),null;if(ie&&t(ue)!==ne)return Zt.primitiveFail(),null;for(le=ce.wordsAsFloat32Array(),Yt=te.wordsAsFloat32Array(),ie?oe=ue.wordsAsFloat32Array():ae=Zt.floatValueOf(ue),ee=0;ne-1>=ee;ee++)n(ee,le,Yt,ie?oe[ee]:ae,Bt,re,se);return Zt.failed()?null:void Zt.pop(6)},setScalarHeading:function R(){var Bt,Yt,te;return Bt=Zt.stackFloatValue(0),Yt=Zt.stackValue(1),te=Zt.stackIntegerValue(2),Zt.failed()?null:Zt.isWords(Yt)?t(Yt)<te?(Zt.primitiveFail(),null):(Yt.wordsAsFloat32Array()[te-1]=o(Bt),Zt.failed()?null:void Zt.pop(3)):(Zt.primitiveFail(),null)},makeMask:function x(){var Bt,Yt,te,ee,ie,re,se,ne,ae;if(ae=Zt.stackIntegerValue(0),ne=Zt.stackIntegerValue(1),se=Zt.stackValue(2),te=Zt.stackValue(3),Zt.failed())return null;if((ee=t(te))!==t(se))return Zt.primitiveFail(),null;if(-32>ae)return Zt.primitiveFail(),null;if(ae>8)return Zt.primitiveFail(),null;for(Yt=te.words,re=se.words,4278190080,ie=0;ee-1>=ie;ie++)(Bt=rt(Yt[ie],ae))>255&&(Bt=255),0>Bt&&(Bt=0),re[ie]=Bt<<24&4278190080|ne;Zt.pop(4)},primitiveDivScalar:function P(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(ue=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),oe=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(oe)),Zt.success(Zt.isWords(ue)),Zt.failed())return null;if(ae=t(oe),Zt.success(ae===t(ue)),Zt.failed())return null;if(se="number"==typeof Bt,ne=Zt.isMemberOf(oe,"WordArray"),se&&ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ue,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(ne)if(se)for(le=oe.words,re=Bt,ce=ue.words,ie=0;ae-1>=ie;ie++)ce[ie]=a(le[ie],re);else for(le=oe.words,Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=le[ie]/Yt;else if(se)for(te=oe.wordsAsFloat32Array(),re=Bt,ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]/re;else for(te=oe.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]/Yt;Zt.pop(4),Zt.push(ue)},primitiveSubScalar:function j(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(ue=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),oe=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(oe)),Zt.success(Zt.isWords(ue)),Zt.failed())return null;if(ae=t(oe),Zt.success(ae===t(ue)),Zt.failed())return null;if(se="number"==typeof Bt,ne=Zt.isMemberOf(oe,"WordArray"),se&&ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ue,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(ne)if(se)for(le=oe.words,re=Bt,ce=ue.words,ie=0;ae-1>=ie;ie++)ce[ie]=le[ie]-re;else for(le=oe.words,Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=le[ie]-Yt;else if(se)for(te=oe.wordsAsFloat32Array(),re=Bt,ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]-re;else for(te=oe.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]-Yt;Zt.pop(4),Zt.push(ue)},primPixelsAtXY:function g(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he;if(se=Zt.stackValue(0),Yt=Zt.stackIntegerValue(1),ie=Zt.stackIntegerValue(2),ee=Zt.stackValue(3),he=Zt.stackValue(4),le=Zt.stackValue(5),Zt.failed())return null;if(!Zt.isWords(se))return Zt.primitiveFail(),null;if(!Zt.isWords(le))return Zt.primitiveFail(),null;if(!Zt.isWords(he))return Zt.primitiveFail(),null;if(!Zt.isWords(ee))return Zt.primitiveFail(),null;if(Yt*ie!==t(ee))return Zt.primitiveFail(),null;if(ae=t(le),t(he)!==ae)return Zt.primitiveFail(),null;if(t(se)!==ae)return Zt.primitiveFail(),null;for(ue=le.wordsAsFloat32Array(),fe=he.wordsAsFloat32Array(),re=se.words,Bt=ee.words,ne=0;ae-1>=ne;ne++)oe=0|ue[ne],ce=0|fe[ne],oe>=0&&ce>=0&&ie>oe&&Yt>ce&&(te=ce*ie+oe,re[ne]=Bt[te]);return Zt.failed()?null:void Zt.pop(6)},vectorGetAngleTo:function J(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe;if(ue=Zt.stackValue(0),pe=Zt.stackValue(1),fe=Zt.stackValue(2),re=Zt.stackValue(3),ee=Zt.stackValue(4),Zt.failed())return null;if(!Zt.isWords(ue))return Zt.primitiveFail(),null;if(!Zt.isWords(fe))return Zt.primitiveFail(),null;if(!Zt.isWords(pe))return Zt.primitiveFail(),null;if(0>(le=t(ue)))return Zt.primitiveFail(),null;if(t(fe)!==le)return Zt.primitiveFail(),null;if(t(pe)!==le)return Zt.primitiveFail(),null;if(ee.isFloat){if(!re.isFloat)return Zt.primitiveFail(),null;Yt=!1}else{if(re.isFloat)return Zt.primitiveFail(),null;Yt=!0}if(Yt){if(t(ee)!==le)return Zt.primitiveFail(),null;if(t(re)!==le)return Zt.primitiveFail(),null}for(oe=ue.wordsAsFloat32Array(),ce=fe.wordsAsFloat32Array(),he=pe.wordsAsFloat32Array(),Yt&&(te=ee.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array()),Yt||(se=Zt.floatValueOf(ee),ne=Zt.floatValueOf(re)),Bt=0;le-1>=Bt;Bt++)Yt&&(se=te[Bt],ne=ie[Bt]),ae=c(se-ce[Bt],ne-he[Bt]),(ae+=90)>360&&(ae-=360),oe[Bt]=ae;return Zt.failed()?null:(Zt.pop(6),void Zt.push(ue))},primitiveMulArrays:function w(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(oe)),Zt.failed())return null;if(ne=t(Bt),Zt.success(ne===t(ae)),Zt.success(ne===t(oe)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),se=Zt.isMemberOf(ae,"WordArray"),re&&se){if(!Zt.isMemberOf(oe,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(oe,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(se)if(re)for(le=ae.words,ue=Bt.words,ce=oe.words,ie=0;ne-1>=ie;ie++)ce[ie]=le[ie]*ue[ie];else for(le=ae.words,Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=le[ie]*Yt[ie];else if(re)for(te=ae.wordsAsFloat32Array(),ue=Bt.words,ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]*ue[ie];else for(te=ae.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]*Yt[ie];Zt.pop(4),Zt.push(oe)},primPixelAtXYPut:function k(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe;return te=Zt.stackIntegerValue(0),re=Zt.stackIntegerValue(1),ie=Zt.stackIntegerValue(2),oe=Zt.stackFloatValue(3),ne=Zt.stackFloatValue(4),Yt=Zt.stackValue(5),Zt.failed()?null:Zt.isWords(Yt)?t(Yt)!==te*re?(Zt.primitiveFail(),null):(se=0|ne,ae=0|oe,(ee=ie)>1073741823&&(ee=1073741823),0>ee&&(ee=0),Bt=Yt.words,se>=0&&re>se&&ae>=0&&te>ae&&(Bt[ae*re+se]=ee),Zt.failed()?null:void Zt.pop(6)):(Zt.primitiveFail(),null)},zoomBitmap:function X(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me;if(me=Zt.stackIntegerValue(0),pe=Zt.stackIntegerValue(1),se=Zt.stackIntegerValue(2),ae=Zt.stackIntegerValue(3),te=Zt.stackValue(4),oe=Zt.stackValue(5),Zt.failed())return null;if(ce=t(oe),ie=t(te),ae*se!==ce)return Zt.primitiveFail(),null;if(ce*pe*me!==ie)return Zt.primitiveFail(),null;for(ne=oe.words,Yt=te.words,ue=0,le=0,ee=0,he=0;se-1>=he;he++){for(de=0;me-1>=de;de++){for(fe=0;ae-1>=fe;fe++)for(Bt=ne[ue],++ue,re=0;pe-1>=re;re++)Yt[ee]=Bt,++ee;ue=le}ue=le+=ae}Zt.pop(6)},initialiseModule:function D(){te=17,se=a(re=2147483647,ie=16807),ne=h(re,ie)},primitiveAddArrays:function O(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(oe)),Zt.failed())return null;if(ne=t(Bt),Zt.success(ne===t(ae)),Zt.success(ne===t(oe)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),se=Zt.isMemberOf(ae,"WordArray"),re&&se){if(!Zt.isMemberOf(oe,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(oe,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(se)if(re)for(le=ae.words,ue=Bt.words,ce=oe.words,ie=0;ne-1>=ie;ie++)ce[ie]=le[ie]+ue[ie];else for(le=ae.words,Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=le[ie]+Yt[ie];else if(re)for(te=ae.wordsAsFloat32Array(),ue=Bt.words,ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]+ue[ie];else for(te=ae.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]+Yt[ie];Zt.pop(4),Zt.push(oe)},scalarGetDistanceTo:function N(){var Bt,Yt,te,ee,ie,re,se;return Yt=Zt.stackFloatValue(0),Bt=Zt.stackFloatValue(1),ie=Zt.stackFloatValue(2),ee=Zt.stackFloatValue(3),Zt.failed()?null:(re=Bt-ee,se=Yt-ie,te=Math.sqrt(re*re+se*se),Zt.failed()?null:(Zt.pop(5),void Zt.pushFloat(te)))},turtlesSetY:function U(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(Bt=Zt.stackIntegerValue(0),ne=Zt.stackIntegerValue(1),Yt=Zt.stackFloatValue(2),ue=Zt.stackValue(3),ee=Zt.stackValue(4),ce=Zt.stackValue(5),Zt.failed())return null;if(!Zt.isWords(ce))return Zt.primitiveFail(),null;if(!Zt.isWords(ee))return Zt.primitiveFail(),null;if(ue.isFloat)re=!1;else{if(!Zt.isWords(ue))return Zt.primitiveFail(),null;re=!0}if(se=t(ce),t(ee)!==se)return Zt.primitiveFail(),null;if(re&&t(ue)!==se)return Zt.primitiveFail(),null;for(le=ce.wordsAsFloat32Array(),te=ee.wordsAsFloat32Array(),re?oe=ue.wordsAsFloat32Array():ae=Zt.floatValueOf(ue),ie=0;se-1>=ie;ie++)s(ie,le,te,re?oe[ie]:ae,Yt,ne,Bt);return Zt.failed()?null:void Zt.pop(6)},randomIntoFloatArray:function q(){var Bt,Yt,te,ee,ie,re,se;if(Bt=Zt.stackFloatValue(0),te=Zt.stackValue(1),se=Zt.stackIntegerValue(2),ee=Zt.stackIntegerValue(3),re=Zt.stackIntegerValue(4),Zt.failed())return null;if(!Zt.isWords(te))return Zt.primitiveFail(),null;if(!(t(te)>=se&&ee>=1&&se>=ee))return Zt.primitiveFail(),null;if(Yt=te.wordsAsFloat32Array(),Zt.failed())return null;for(ie=ee;se>=ie;ie++)Yt[ie-1]=f(re)*Bt;Zt.pop(5)},primTurtlesForward:function F(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge;if(Bt=Zt.stackIntegerValue(0),fe=Zt.stackIntegerValue(1),le=Zt.stackIntegerValue(2),ae=Zt.stackIntegerValue(3),Yt=Zt.stackFloatValue(4),te=Zt.stackFloatValue(5),de=Zt.stackValue(6),re=Zt.stackValue(7),ge=Zt.stackValue(8),ve=Zt.stackValue(9),Zt.failed())return null;if(!Zt.isWords(ve))return Zt.primitiveFail(),null;if(!Zt.isWords(ge))return Zt.primitiveFail(),null;if(!Zt.isWords(re))return Zt.primitiveFail(),null;if(de.isFloat)ne=!1;else{if(!Zt.isWords(de))return Zt.primitiveFail(),null;ne=!0}if(ce=t(ve),t(ge)!==ce)return Zt.primitiveFail(),null;if(t(re)!==ce)return Zt.primitiveFail(),null;if(ne&&t(de)!==ce)return Zt.primitiveFail(),null;for(me=ve.wordsAsFloat32Array(),ke=ge.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array(),ne?pe=de.wordsAsFloat32Array():he=Zt.floatValueOf(de),se=0;ce-1>=se;se++)ee=ne?pe[se]:he,oe=me[se]+ee*Math.cos(ie[se]),ue=ke[se]-ee*Math.sin(ie[se]),n(se,me,ie,oe,te,ae,le),s(se,ke,ie,ue,Yt,fe,Bt);return Zt.failed()?null:void Zt.pop(10)},primitiveMulScalar:function C(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(ue=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),oe=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(oe)),Zt.success(Zt.isWords(ue)),Zt.failed())return null;if(ae=t(oe),Zt.success(ae===t(ue)),Zt.failed())return null;if(se="number"==typeof Bt,ne=Zt.isMemberOf(oe,"WordArray"),se&&ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ue,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(ne)if(se)for(le=oe.words,re=Bt,ce=ue.words,ie=0;ae-1>=ie;ie++)ce[ie]=le[ie]*re;else for(le=oe.words,Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=le[ie]*Yt;else if(se)for(te=oe.wordsAsFloat32Array(),re=Bt,ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]*re;else for(te=oe.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]*Yt;Zt.pop(4),Zt.push(ue)}})})),module("users.bert.SqueakJS.plugins.KedamaPlugin2").requires("users.bert.SqueakJS.vm").toRun((function(){function t(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function s(Bt,Yt){return 0|Math.floor(Bt/Yt)}function a(Bt,Yt){return Bt-s(Bt,Yt)*Yt|0}function Pt(Bt,Yt){return 0>Yt?-31>Yt?0:Bt>>>0-Yt:Yt>31?0:Bt<<Yt}function c(Bt,Yt){var Zt,te;return 0===Bt?Yt>=0?90:270:(Zt=Yt/Bt,te=Math.atan(Zt),Bt>=0?Yt>=0?te/.0174532925199433:360+te/.0174532925199433:180+te/.0174532925199433)}function l(Bt){var Yt,Zt;return Zt=(Yt=90-Bt)/360|0,0>Yt&&--Zt,.0174532925199433*(Yt-360*Zt)}function f(Bt){var Yt,Zt,ee,re;return ee=0>Bt?0-Bt:Bt,Yt=s(te,se),Zt=a(te,se),re=(65535&(te=ie*Zt-ne*Yt))*(ee+1)>>>16,0>Bt?0-re:re}function p(Bt){var Yt;return(Yt=90-Bt/.0174532925199433)>0||(Yt+=360),Yt}function n(Bt,Yt,Zt,te,ee,ie,re){var se,ne;0>(ne=te)&&(1===ie&&(ne+=ee),2===ie&&(ne=0),3===ie&&(ne=0-ne,se=Zt[Bt],Zt[Bt]=3.141592653589793>se?3.141592653589793-se:9.42477796076938-se)),ne>=ee&&(1===re&&(ne-=ee),2===re&&(ne=ee-1e-6),3===re&&(ne=ee-1e-6-(ne-ee),se=Zt[Bt],Zt[Bt]=3.141592653589793>se?3.141592653589793-se:9.42477796076938-se)),Yt[Bt]=ne}function r(Bt,Yt,Zt,te,ee,ie,re){var se;0>(se=te)&&(1===ie&&(se+=ee),2===ie&&(se=0),3===ie&&(se=0-se,Zt[Bt]=6.283185307179586-Zt[Bt])),se>=ee&&(1===re&&(se-=ee),2===re&&(se=ee-1e-6),3===re&&(se=ee-1e-6-(se-ee),Zt[Bt]=6.283185307179586-Zt[Bt])),Yt[Bt]=se}var Bt=1,Yt=11,Zt=null,te=0,ee="KedamaPlugin2 13 November 2014 (e)",ie=0,re=0,se=0,ne=0;Squeak.registerExternalModule("KedamaPlugin2",{primitiveAddArrays:function O(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(oe)),Zt.failed())return null;if(ne=t(Bt),Zt.success(ne===t(ae)),Zt.success(ne===t(oe)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),se=Zt.isMemberOf(ae,"WordArray"),re&&se){if(!Zt.isMemberOf(oe,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(oe,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(se)if(re)for(le=ae.words,ue=Bt.words,ce=oe.words,ie=0;ne-1>=ie;ie++)ce[ie]=le[ie]+ue[ie];else for(le=ae.words,Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=le[ie]+Yt[ie];else if(re)for(te=ae.wordsAsFloat32Array(),ue=Bt.words,ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]+ue[ie];else for(te=ae.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]+Yt[ie];Zt.pop(4),Zt.push(oe)},getModuleName:function St(){return ee},primitiveMulArrays:function D(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(oe)),Zt.failed())return null;if(ne=t(Bt),Zt.success(ne===t(ae)),Zt.success(ne===t(oe)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),se=Zt.isMemberOf(ae,"WordArray"),re&&se){if(!Zt.isMemberOf(oe,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(oe,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(se)if(re)for(le=ae.words,ue=Bt.words,ce=oe.words,ie=0;ne-1>=ie;ie++)ce[ie]=le[ie]*ue[ie];else for(le=ae.words,Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=le[ie]*Yt[ie];else if(re)for(te=ae.wordsAsFloat32Array(),ue=Bt.words,ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]*ue[ie];else for(te=ae.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]*Yt[ie];Zt.pop(4),Zt.push(oe)},drawTurtlesInArray:function At(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe;if(oe=Zt.stackValue(0),Yt=Zt.stackValue(1),pe=Zt.stackValue(2),ce=Zt.stackValue(3),ee=Zt.stackIntegerValue(4),re=Zt.stackIntegerValue(5),ie=Zt.stackValue(6),Zt.failed())return null;if(!Zt.isWords(ie))return Zt.primitiveFail(),null;if(!Zt.isWords(ce))return Zt.primitiveFail(),null;if(!Zt.isWords(pe))return Zt.primitiveFail(),null;if(!Zt.isWords(Yt))return Zt.primitiveFail(),null;if(!Zt.isBytes(oe))return Zt.primitiveFail(),null;if(ee*re!==t(ie))return Zt.primitiveFail(),null;if(ne=t(ce),t(pe)!==ne)return Zt.primitiveFail(),null;if(t(Yt)!==ne)return Zt.primitiveFail(),null;if(t(oe)!==ne)return Zt.primitiveFail(),null;for(le=ce.wordsAsFloat32Array(),he=pe.wordsAsFloat32Array(),Bt=Yt.words,ae=oe.bytes,te=ie.words,se=0;ne-1>=se;se++)ue=0|le[se],fe=0|he[se],0!==ae[se]&&ue>=0&&fe>=0&&re>ue&&ee>fe&&(te[fe*re+ue]=Bt[se]);return Zt.failed()?null:void Zt.pop(7)},primitiveGTScalar:function M(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(ae)),Zt.success(Zt.isBytes(oe)),Zt.failed())return null;if(ne=t(ae),Zt.success(ne===t(oe)),Zt.failed())return null;if(se="number"==typeof Bt,Zt.isMemberOf(ae,"WordArray"))if(se)for(ue=ae.words,re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]>re;else for(ue=ae.words,te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]>te;else if(se)for(ee=ae.wordsAsFloat32Array(),re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]>re;else for(ee=ae.wordsAsFloat32Array(),te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]>te;Zt.pop(4),Zt.push(oe)},setScalarHeading:function ct(){var Bt,Yt,te;return Bt=Zt.stackFloatValue(0),Yt=Zt.stackValue(1),te=Zt.stackIntegerValue(2),Zt.failed()?null:Zt.isWords(Yt)?t(Yt)<te?(Zt.primitiveFail(),null):(Yt.wordsAsFloat32Array()[te-1]=l(Bt),Zt.failed()?null:void Zt.pop(3)):(Zt.primitiveFail(),null)},primitiveSubScalar:function $(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(ue=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),oe=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(oe)),Zt.success(Zt.isWords(ue)),Zt.failed())return null;if(ae=t(oe),Zt.success(ae===t(ue)),Zt.failed())return null;if(se="number"==typeof Bt,ne=Zt.isMemberOf(oe,"WordArray"),se&&ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ue,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(ne)if(se)for(le=oe.words,re=Bt,ce=ue.words,ie=0;ae-1>=ie;ie++)ce[ie]=le[ie]-re;else for(le=oe.words,Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=le[ie]-Yt;else if(se)for(te=oe.wordsAsFloat32Array(),re=Bt,ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]-re;else for(te=oe.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]-Yt;Zt.pop(4),Zt.push(ue)},turtleScalarSetY:function pt(){var Bt,Yt,te,ee,ie,re,se,ne;return Bt=Zt.stackIntegerValue(0),ie=Zt.stackIntegerValue(1),Yt=Zt.stackFloatValue(2),re=Zt.stackFloatValue(3),te=Zt.stackValue(4),se=Zt.stackIntegerValue(5),ne=Zt.stackValue(6),Zt.failed()?null:Zt.isWords(ne)&&Zt.isWords(te)?(ee=t(ne),t(te)!==ee?(Zt.primitiveFail(),null):(r(se-1,ne.wordsAsFloat32Array(),te.wordsAsFloat32Array(),re,Yt,ie,Bt),Zt.failed()?null:void Zt.pop(7))):(Zt.primitiveFail(),null)},vectorGetAngleTo:function vt(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe;if(ue=Zt.stackValue(0),pe=Zt.stackValue(1),fe=Zt.stackValue(2),re=Zt.stackValue(3),ee=Zt.stackValue(4),Zt.failed())return null;if(!Zt.isWords(ue))return Zt.primitiveFail(),null;if(!Zt.isWords(fe))return Zt.primitiveFail(),null;if(!Zt.isWords(pe))return Zt.primitiveFail(),null;if(0>(le=t(ue)))return Zt.primitiveFail(),null;if(t(fe)!==le)return Zt.primitiveFail(),null;if(t(pe)!==le)return Zt.primitiveFail(),null;if(ee.isFloat){if(!re.isFloat)return Zt.primitiveFail(),null;Yt=!1}else{if(re.isFloat)return Zt.primitiveFail(),null;Yt=!0}if(Yt){if(t(ee)!==le)return Zt.primitiveFail(),null;if(t(re)!==le)return Zt.primitiveFail(),null}for(oe=ue.wordsAsFloat32Array(),ce=fe.wordsAsFloat32Array(),he=pe.wordsAsFloat32Array(),Yt&&(te=ee.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array()),Yt||(se=Zt.floatValueOf(ee),ne=Zt.floatValueOf(re)),Bt=0;le-1>=Bt;Bt++)Yt&&(se=te[Bt],ne=ie[Bt]),ae=c(se-ce[Bt],ne-he[Bt]),(ae+=90)>360&&(ae-=360),oe[Bt]=ae;return Zt.failed()?null:(Zt.pop(6),void Zt.push(ue))},primitiveRemArrays:function Y(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve;if(ce=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),le=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(le)),Zt.success(Zt.isWords(ce)),Zt.failed())return null;if(ue=t(Bt),Zt.success(ue===t(le)),Zt.success(ue===t(ce)),Zt.failed())return null;if(ae=Zt.isMemberOf(Bt,"WordArray"),oe=Zt.isMemberOf(le,"WordArray"),ae&&oe){if(!Zt.isMemberOf(ce,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ce,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(oe)if(ae)for(me=le.words,de=Bt.words,ve=ce.words,ne=0;ue-1>=ne;ne++)pe=a(he=me[ne],fe=de[ne]),ve[ne]=pe;else for(me=le.words,ie=Bt.wordsAsFloat32Array(),se=ce.wordsAsFloat32Array(),ne=0;ue-1>=ne;ne++)ee=(he=me[ne])/(Yt=ie[ne]),ee=Math.floor(ee),se[ne]=he-ee*Yt;else if(ae)for(re=le.wordsAsFloat32Array(),de=Bt.words,se=ce.wordsAsFloat32Array(),ne=0;ue-1>=ne;ne++)ee=(te=re[ne])/(fe=de[ne]),ee=Math.floor(ee),se[ne]=te-ee*fe;else for(re=le.wordsAsFloat32Array(),ie=Bt.wordsAsFloat32Array(),se=ce.wordsAsFloat32Array(),ne=0;ue-1>=ne;ne++)ee=(te=re[ne])/(Yt=ie[ne]),ee=Math.floor(ee),se[ne]=te-ee*Yt;Zt.pop(4),Zt.push(ce)},primitiveLTArrays:function N(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(ae=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ne=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ne)),Zt.success(Zt.isBytes(ae)),Zt.failed())return null;if(se=t(Bt),Zt.success(se===t(ne)),Zt.success(se===t(ae)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),Zt.isMemberOf(ne,"WordArray"))if(re)for(ue=ne.words,oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]<oe[ie];else for(ue=ne.words,te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]<te[ie];else if(re)for(ee=ne.wordsAsFloat32Array(),oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]<oe[ie];else for(ee=ne.wordsAsFloat32Array(),te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]<te[ie];Zt.pop(4),Zt.push(ae)},primitiveAddScalar:function I(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(ue=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),oe=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(oe)),Zt.success(Zt.isWords(ue)),Zt.failed())return null;if(ae=t(oe),Zt.success(ae===t(ue)),Zt.failed())return null;if(se="number"==typeof Bt,ne=Zt.isMemberOf(oe,"WordArray"),se&&ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ue,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(ne)if(se)for(le=oe.words,re=Bt,ce=ue.words,ie=0;ae-1>=ie;ie++)ce[ie]=le[ie]+re;else for(le=oe.words,Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=le[ie]+Yt;else if(se)for(te=oe.wordsAsFloat32Array(),re=Bt,ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]+re;else for(te=oe.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]+Yt;Zt.pop(4),Zt.push(ue)},primPixelsAtXY:function g(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he;if(se=Zt.stackValue(0),Yt=Zt.stackIntegerValue(1),ie=Zt.stackIntegerValue(2),ee=Zt.stackValue(3),he=Zt.stackValue(4),le=Zt.stackValue(5),Zt.failed())return null;if(!Zt.isWords(se))return Zt.primitiveFail(),null;if(!Zt.isWords(le))return Zt.primitiveFail(),null;if(!Zt.isWords(he))return Zt.primitiveFail(),null;if(!Zt.isWords(ee))return Zt.primitiveFail(),null;if(Yt*ie!==t(ee))return Zt.primitiveFail(),null;if(ae=t(le),t(he)!==ae)return Zt.primitiveFail(),null;if(t(se)!==ae)return Zt.primitiveFail(),null;for(ue=le.wordsAsFloat32Array(),fe=he.wordsAsFloat32Array(),re=se.words,Bt=ee.words,ne=0;ae-1>=ne;ne++)oe=0|ue[ne],ce=0|fe[ne],oe>=0&&ce>=0&&ie>oe&&Yt>ce&&(te=ce*ie+oe,re[ne]=Bt[te]);return Zt.failed()?null:void Zt.pop(6)},primitiveMulScalar:function T(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(ue=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),oe=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(oe)),Zt.success(Zt.isWords(ue)),Zt.failed())return null;if(ae=t(oe),Zt.success(ae===t(ue)),Zt.failed())return null;if(se="number"==typeof Bt,ne=Zt.isMemberOf(oe,"WordArray"),se&&ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ue,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(ne)if(se)for(le=oe.words,re=Bt,ce=ue.words,ie=0;ae-1>=ie;ie++)ce[ie]=le[ie]*re;else for(le=oe.words,Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=le[ie]*Yt;else if(se)for(te=oe.wordsAsFloat32Array(),re=Bt,ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]*re;else for(te=oe.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]*Yt;Zt.pop(4),Zt.push(ue)},primSetPixelsAtXY:function y(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be;if(he=Zt.stackValue(0),Yt=Zt.stackIntegerValue(1),ie=Zt.stackIntegerValue(2),ee=Zt.stackValue(3),be=Zt.stackValue(4),ve=Zt.stackValue(5),le=Zt.stackValue(6),Zt.failed())return null;if(!Zt.isBytes(le))return Zt.primitiveFail(),null;if(!Zt.isWords(ve))return Zt.primitiveFail(),null;if(!Zt.isWords(be))return Zt.primitiveFail(),null;if(!Zt.isWords(ee))return Zt.primitiveFail(),null;if(Yt*ie!==t(ee))return Zt.primitiveFail(),null;if(ce=t(ve),t(le)!==ce)return Zt.primitiveFail(),null;if(t(be)!==ce)return Zt.primitiveFail(),null;if(ue=le.bytes,me=ve.wordsAsFloat32Array(),ge=be.wordsAsFloat32Array(),ae="number"==typeof he)fe=he;else{if(t(he)!==ce)return Zt.primitiveFail(),null;(oe=Zt.isMemberOf(he,"WordArray"))?pe=he.words:re=he.wordsAsFloat32Array()}for(Bt=ee.words,ne=0;ce-1>=ne;ne++)1===ue[ne]&&(de=0|me[ne],ke=0|ge[ne],de>=0&&ke>=0&&ie>de&&Yt>ke&&(te=ke*ie+de,ae?Bt[te]=fe:oe?Bt[te]=pe[ne]:(se=re[ne],Bt[te]=se)));return Zt.failed()?null:void Zt.pop(7)},setHeadingArrayFrom:function ut(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe;if(ae=Zt.stackValue(0),te=Zt.stackValue(1),se=Zt.stackValue(2),Zt.failed())return null;if(!Zt.isBytes(se))return Zt.primitiveFail(),null;if(!Zt.isWords(te))return Zt.primitiveFail(),null;if(oe=t(te),ae.isFloat)ie=!1;else{if(!Zt.isWords(ae))return Zt.primitiveFail(),null;if(t(ae)!==oe)return Zt.primitiveFail(),null;ie=!0}for(re=se.bytes,Yt=te.wordsAsFloat32Array(),ie?ne=ae.wordsAsFloat32Array():Bt=l(Bt=Zt.floatValueOf(ae)),ee=0;oe-1>=ee;ee++)1===re[ee]&&(ie&&(Bt=l(Bt=ne[ee])),Yt[ee]=Bt);return Zt.failed()?null:void Zt.pop(3)},primPixelAtXYPut:function k(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe;return te=Zt.stackIntegerValue(0),re=Zt.stackIntegerValue(1),ie=Zt.stackIntegerValue(2),oe=Zt.stackFloatValue(3),ne=Zt.stackFloatValue(4),Yt=Zt.stackValue(5),Zt.failed()?null:Zt.isWords(Yt)?t(Yt)!==te*re?(Zt.primitiveFail(),null):(se=0|ne,ae=0|oe,(ee=ie)>1073741823&&(ee=1073741823),0>ee&&(ee=0),Bt=Yt.words,se>=0&&re>se&&ae>=0&&te>ae&&(Bt[ae*re+se]=ee),Zt.failed()?null:void Zt.pop(6)):(Zt.primitiveFail(),null)},makeMaskLog:function R(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le;if(ue=Zt.stackValue(0),le=Zt.stackIntegerValue(1),ne=Zt.stackValue(2),ee=Zt.stackValue(3),Zt.failed())return null;if(ae=ue.words[0],Zt.failed())return null;if(oe=Math.log(ae),(ie=t(ee))!==t(ne))return Zt.primitiveFail(),null;for(Yt=ee.words,se=ne.words,4278190080,re=0;ie-1>=re;re++)(Bt=0===(te=Yt[re])?0:255/oe*Math.log(te)|0)>255&&(Bt=255),se[re]=Bt<<24&4278190080|le;Zt.pop(4)},primitiveLTScalar:function W(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(ae)),Zt.success(Zt.isBytes(oe)),Zt.failed())return null;if(ne=t(ae),Zt.success(ne===t(oe)),Zt.failed())return null;if(se="number"==typeof Bt,Zt.isMemberOf(ae,"WordArray"))if(se)for(ue=ae.words,re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]<re;else for(ue=ae.words,te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]<te;else if(se)for(ee=ae.wordsAsFloat32Array(),re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]<re;else for(ee=ae.wordsAsFloat32Array(),te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]<te;Zt.pop(4),Zt.push(oe)},scalarGetAngleTo:function st(){var Bt,Yt,te,ee,ie;return Yt=Zt.stackFloatValue(0),Bt=Zt.stackFloatValue(1),ie=Zt.stackFloatValue(2),ee=Zt.stackFloatValue(3),Zt.failed()?null:(te=c(ee-Bt,ie-Yt),(te+=90)>360&&(te-=360),Zt.failed()?null:(Zt.pop(5),void Zt.pushFloat(te)))},primitiveOrByteArray:function K(){var Bt,Yt,te,ee,ie,re,se,ne;if(re=Zt.stackObjectValue(0),ne=Zt.stackValue(1),Zt.failed())return null;if(Zt.success(Zt.isBytes(ne)),Zt.success(Zt.isBytes(re)),Zt.failed())return null;if(te=t(ne),ee=t(re),Zt.failed())return null;for(Yt=te,te>ee&&(Yt=ee),ie=re.bytes,se=ne.bytes,Bt=0;Yt-1>=Bt;Bt++)se[Bt]=se[Bt]+ie[Bt]>0;Zt.pop(1)},primitiveLEArrays:function B(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(ae=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ne=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ne)),Zt.success(Zt.isBytes(ae)),Zt.failed())return null;if(se=t(Bt),Zt.success(se===t(ne)),Zt.success(se===t(ae)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),Zt.isMemberOf(ne,"WordArray"))if(re)for(ue=ne.words,oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]<=oe[ie];else for(ue=ne.words,te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]<=te[ie];else if(re)for(ee=ne.wordsAsFloat32Array(),oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]<=oe[ie];else for(ee=ne.wordsAsFloat32Array(),te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]<=te[ie];Zt.pop(4),Zt.push(ae)},primitiveRemScalar:function Z(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe;if(ce=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),le=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(le)),Zt.success(Zt.isWords(ce)),Zt.failed())return null;if(ue=t(le),Zt.success(ue===t(ce)),Zt.failed())return null;if(ae="number"==typeof Bt,oe=Zt.isMemberOf(le,"WordArray"),ae&&oe){if(!Zt.isMemberOf(ce,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ce,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(oe)if(ae)for(he=le.words,ne=Bt,pe=ce.words,se=0;ue-1>=se;se++)pe[se]=a(he[se],ne);else for(he=le.words,Yt=Zt.floatValueOf(Bt),re=ce.wordsAsFloat32Array(),se=0;ue-1>=se;se++)ee=(fe=he[se])/Yt,ee=Math.floor(ee),re[se]=fe-ee*Yt;else if(ae)for(ie=le.wordsAsFloat32Array(),ne=Bt,re=ce.wordsAsFloat32Array(),se=0;ue-1>=se;se++)ee=(te=ie[se])/ne,ee=Math.floor(ee),re[se]=te-ee*ne;else for(ie=le.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),re=ce.wordsAsFloat32Array(),se=0;ue-1>=se;se++)ee=(te=ie[se])/Yt,ee=Math.floor(ee),re[se]=te-ee*Yt;Zt.pop(4),Zt.push(ce)},getHeadingArrayInto:function It(){var Bt,Yt,te,ee,ie,re,se;if(re=Zt.stackValue(0),te=Zt.stackValue(1),Zt.failed())return null;if(!Zt.isWords(te))return Zt.primitiveFail(),null;if(!Zt.isWords(re))return Zt.primitiveFail(),null;if(se=t(te),t(re)!==se)return Zt.primitiveFail(),null;for(Yt=te.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array(),ee=0;se-1>=ee;ee++)Bt=Yt[ee],(Bt=90-(Bt/=.0174532925199433))>0||(Bt+=360),ie[ee]=Bt;return Zt.failed()?null:void Zt.pop(2)},turtlesSetX:function dt(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de;if(oe=Zt.stackIntegerValue(0),se=Zt.stackIntegerValue(1),Bt=Zt.stackFloatValue(2),fe=Zt.stackValue(3),te=Zt.stackValue(4),de=Zt.stackValue(5),ae=Zt.stackValue(6),Zt.failed())return null;if(!Zt.isBytes(ae))return Zt.primitiveFail(),null;if(!Zt.isWords(de))return Zt.primitiveFail(),null;if(!Zt.isWords(te))return Zt.primitiveFail(),null;if(fe.isFloat)ie=!1;else{if(!Zt.isWords(fe))return Zt.primitiveFail(),null;ie=!0,re=Zt.isMemberOf(fe,"WordArray")}if(ue=t(de),t(ae)!==ue)return Zt.primitiveFail(),null;if(t(te)!==ue)return Zt.primitiveFail(),null;if(ie&&t(fe)!==ue)return Zt.primitiveFail(),null;for(ne=ae.bytes,pe=de.wordsAsFloat32Array(),Yt=te.wordsAsFloat32Array(),ie?re?he=fe.words:ce=fe.wordsAsFloat32Array():le=Zt.floatValueOf(fe),ee=0;ue-1>=ee;ee++)1===ne[ee]&&n(ee,pe,Yt,ie?re?he[ee]:ce[ee]:le,Bt,se,oe);return Zt.failed()?null:void Zt.pop(7)},primitivePredicateReplaceBytes:function m(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe;if(se=Zt.stackIntegerValue(0),re=Zt.stackObjectValue(1),ue=Zt.stackIntegerValue(2),oe=Zt.stackIntegerValue(3),ie=Zt.stackObjectValue(4),Zt.failed())return null;if(ce=Zt.fetchPointerofObject(1,ie),te=Zt.fetchPointerofObject(0,ie),Zt.failed())return null;if(!Zt.isBytes(te))return Zt.primitiveFail(),null;if(!Zt.isBytes(ce)||!Zt.isBytes(re))return Zt.primitiveFail(),null;if(le=ce.bytes,Yt=te.bytes,ne=re.bytes,fe=t(ce),ee=t(te),ae=t(re),oe>ue)return Zt.primitiveFail(),null;if(1>oe)return Zt.primitiveFail(),null;if(oe>fe)return Zt.primitiveFail(),null;if(oe>ee)return Zt.primitiveFail(),null;if(ue>fe)return Zt.primitiveFail(),null;if(ue>ee)return Zt.primitiveFail(),null;if(1>se)return Zt.primitiveFail(),null;if(se>ae)return Zt.primitiveFail(),null;if(ue-oe+1>ae-se+1)return Zt.primitiveFail(),null;for(Bt=oe-1;ue-1>=Bt;Bt++)1===Yt[Bt]&&(le[Bt]=ne[se+Bt-oe]);Zt.pop(4)},primitiveDivArrays:function P(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(oe)),Zt.failed())return null;if(ne=t(Bt),Zt.success(ne===t(ae)),Zt.success(ne===t(oe)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),se=Zt.isMemberOf(ae,"WordArray"),re&&se){if(!Zt.isMemberOf(oe,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(oe,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(se)if(re)for(le=ae.words,ue=Bt.words,ce=oe.words,ie=0;ne-1>=ie;ie++)ce[ie]=le[ie]/ue[ie];else for(le=ae.words,Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=le[ie]/Yt[ie];else if(re)for(te=ae.wordsAsFloat32Array(),ue=Bt.words,ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]/ue[ie];else for(te=ae.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]/Yt[ie];Zt.pop(4),Zt.push(oe)},makeMask:function et(){var Bt,Yt,te,ee,ie,re,se,ne,ae;if(ae=Zt.stackIntegerValue(0),ne=Zt.stackIntegerValue(1),se=Zt.stackValue(2),te=Zt.stackValue(3),Zt.failed())return null;if((ee=t(te))!==t(se))return Zt.primitiveFail(),null;if(-32>ae)return Zt.primitiveFail(),null;if(ae>8)return Zt.primitiveFail(),null;for(Yt=te.words,re=se.words,4278190080,ie=0;ee-1>=ie;ie++)(Bt=Pt(Yt[ie],ae))>255&&(Bt=255),0>Bt&&(Bt=0),re[ie]=Bt<<24&4278190080|ne;Zt.pop(4)},primitiveLEScalar:function _(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(ae)),Zt.success(Zt.isBytes(oe)),Zt.failed())return null;if(ne=t(ae),Zt.success(ne===t(oe)),Zt.failed())return null;if(se="number"==typeof Bt,Zt.isMemberOf(ae,"WordArray"))if(se)for(ue=ae.words,re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]<=re;else for(ue=ae.words,te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]<=te;else if(se)for(ee=ae.wordsAsFloat32Array(),re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]<=re;else for(ee=ae.wordsAsFloat32Array(),te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]<=te;Zt.pop(4),Zt.push(oe)},kedamaSetRandomSeed:function at(){var Bt;return Bt=Zt.stackIntegerValue(0),Zt.failed()?null:(te=65536&Bt,void Zt.pop(1))},randomIntoIntegerArray:function it(){var Bt,Yt,te,ee,ie,re,se;if(Bt=Zt.stackFloatValue(0),ie=Zt.stackValue(1),se=Zt.stackIntegerValue(2),Yt=Zt.stackIntegerValue(3),re=Zt.stackIntegerValue(4),Zt.failed())return null;if(!Zt.isWords(ie))return Zt.primitiveFail(),null;if(!(t(ie)>=se&&Yt>=1&&se>=Yt))return Zt.primitiveFail(),null;if(ee=ie.words,Zt.failed())return null;for(te=Yt;se>=te;te++)ee[te-1]=f(re)*Bt|0;Zt.pop(5)},setInterpreter:function lt(te){return!1!==((Zt=te).majorVersion()==Bt)&&Zt.minorVersion()>=Yt},primitivePredicateAtAllPutColor:function G(){var Bt,Yt,te,ee,ie,re,se;if(ie=Zt.stackIntegerValue(0),ee=Zt.stackObjectValue(1),Zt.failed())return null;if(ie|=4278190080,se=Zt.fetchPointerofObject(1,ee),te=Zt.fetchPointerofObject(0,ee),Zt.failed())return null;if(!Zt.isBytes(te))return Zt.primitiveFail(),null;if(!Zt.isWords(se))return Zt.primitiveFail(),null;for(re=se.words,Yt=te.bytes,Bt=0;Bt<=t(se)-1;Bt++)1===Yt[Bt]&&(re[Bt]=ie);Zt.pop(1)},makeTurtlesMap:function v(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe;if(Bt=Zt.stackIntegerValue(0),ae=Zt.stackIntegerValue(1),fe=Zt.stackValue(2),le=Zt.stackValue(3),ne=Zt.stackValue(4),ie=Zt.stackValue(5),!Zt.isWords(fe))return Zt.primitiveFail(),null;if(!Zt.isWords(le))return Zt.primitiveFail(),null;if(!Zt.isWords(ne))return Zt.primitiveFail(),null;if(!Zt.isWords(ie))return Zt.primitiveFail(),null;if(re=t(ne),t(le)!==re)return Zt.primitiveFail(),null;if(t(fe)!==re)return Zt.primitiveFail(),null;if(t(ie)!==Bt*ae)return Zt.primitiveFail(),null;for(ue=le.wordsAsFloat32Array(),ce=fe.wordsAsFloat32Array(),se=ne.words,te=ie.words,Yt=0;Bt*ae-1>=Yt;Yt++)te[Yt]=0;for(Yt=0;re-1>=Yt;Yt++)oe=ue[Yt],(ee=ae*ce[Yt]+oe)>=0&&Bt*ae>ee&&(te[ee]=se[Yt]);return Zt.failed()?null:void Zt.pop(6)},randomIntoFloatArray:function tt(){var Bt,Yt,te,ee,ie,re,se;if(Bt=Zt.stackFloatValue(0),te=Zt.stackValue(1),se=Zt.stackIntegerValue(2),ee=Zt.stackIntegerValue(3),re=Zt.stackIntegerValue(4),Zt.failed())return null;if(!Zt.isWords(te))return Zt.primitiveFail(),null;if(!(t(te)>=se&&ee>=1&&se>=ee))return Zt.primitiveFail(),null;if(Yt=te.wordsAsFloat32Array(),Zt.failed())return null;for(ie=ee;se>=ie;ie++)Yt[ie-1]=f(re)*Bt;Zt.pop(5)},primUpHill:function S(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be;if(ue=Zt.stackIntegerValue(0),ie=Zt.stackIntegerValue(1),ke=Zt.stackIntegerValue(2),Yt=Zt.stackValue(3),fe=Zt.stackFloatValue(4),pe=Zt.stackFloatValue(5),he=Zt.stackFloatValue(6),Zt.failed())return null;if(!Zt.isWords(Yt))return Zt.primitiveFail(),null;if(t(Yt)!==ie*ke)return Zt.primitiveFail(),null;for(Bt=Yt.words,me=he,ve=pe,me=Math.max(me,0),ve=Math.max(ve,0),me=Math.min(me,ke-1),ve=Math.min(ve,ie-1),le=Math.max(me-ue,0),te=Math.min(me+ue,ke-1),ce=Math.max(ve-ue,0),ee=Math.min(ve+ue,ie-1),re=Bt[ve*ke+me],se=-1,be=ce;ee>=be;be++)for(oe=be*ke,ge=le;te>=ge;ge++)(de=Bt[oe+ge])>re&&(se=ge,ne=be,re=de);return ae=-1===se?p(fe):c(se-me,ne-ve)+90|0,Zt.failed()?null:(Zt.pop(8),void Zt.pushFloat(ae))},shutdownModule:function ft(){return!0},primitiveDivScalar:function w(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(ue=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),oe=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(oe)),Zt.success(Zt.isWords(ue)),Zt.failed())return null;if(ae=t(oe),Zt.success(ae===t(ue)),Zt.failed())return null;if(se="number"==typeof Bt,ne=Zt.isMemberOf(oe,"WordArray"),se&&ne){if(!Zt.isMemberOf(ue,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(ue,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(ne)if(se)for(le=oe.words,re=Bt,ce=ue.words,ie=0;ae-1>=ie;ie++)ce[ie]=s(le[ie],re);else for(le=oe.words,Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=le[ie]/Yt;else if(se)for(te=oe.wordsAsFloat32Array(),re=Bt,ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]/re;else for(te=oe.wordsAsFloat32Array(),Yt=Zt.floatValueOf(Bt),ee=ue.wordsAsFloat32Array(),ie=0;ae-1>=ie;ie++)ee[ie]=te[ie]/Yt;Zt.pop(4),Zt.push(ue)},primitiveGEArrays:function j(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(ae=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ne=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ne)),Zt.success(Zt.isBytes(ae)),Zt.failed())return null;if(se=t(Bt),Zt.success(se===t(ne)),Zt.success(se===t(ae)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),Zt.isMemberOf(ne,"WordArray"))if(re)for(ue=ne.words,oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]>=oe[ie];else for(ue=ne.words,te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]>=te[ie];else if(re)for(ee=ne.wordsAsFloat32Array(),oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]>=oe[ie];else for(ee=ne.wordsAsFloat32Array(),te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]>=te[ie];Zt.pop(4),Zt.push(ae)},primitiveNotByteArray:function E(){var Bt,Yt,te,ee;if(ee=Zt.stackValue(0),Zt.failed())return null;if(Zt.success(Zt.isBytes(ee)),Zt.failed())return null;if(Yt=t(ee),Zt.failed())return null;for(te=ee.bytes,Bt=0;Yt-1>=Bt;Bt++)te[Bt]=0===te[Bt]?1:0},randomRange:function rt(){var Bt,Yt;return Bt=Zt.stackIntegerValue(0),Zt.failed()?null:(Yt=f(Bt),Zt.failed()?null:(Zt.pop(2),void Zt.pushInteger(Yt)))},initialiseModule:function ot(){te=17,se=s(re=2147483647,ie=16807),ne=a(re,ie)},getScalarHeading:function Ft(){var Bt,Yt,te;return Yt=Zt.stackValue(0),te=Zt.stackIntegerValue(1),Zt.failed()?null:Zt.isWords(Yt)?t(Yt)<te?(Zt.primitiveFail(),null):(Bt=p(Bt=Yt.wordsAsFloat32Array()[te-1]),Zt.failed()?null:(Zt.pop(3),void Zt.pushFloat(Bt))):(Zt.primitiveFail(),null)},primPixelAtXY:function H(){var Bt,Yt,te,ee,ie,re,se,ne,ae;return te=Zt.stackIntegerValue(0),ie=Zt.stackIntegerValue(1),ae=Zt.stackFloatValue(2),se=Zt.stackFloatValue(3),Yt=Zt.stackValue(4),Zt.failed()?null:Zt.isWords(Yt)?t(Yt)!==te*ie?(Zt.primitiveFail(),null):(re=0|se,ne=0|ae,Bt=Yt.words,re>=0&&ie>re&&ne>=0&&te>ne?ee=Bt[ne*ie+re]:ee=0,Zt.failed()?null:(Zt.pop(6),void Zt.pushInteger(ee))):(Zt.primitiveFail(),null)},primitivePredicateAtAllPutNumber:function U(){var Bt,Yt,te,ee,ie,re,se;if(ie=Zt.stackFloatValue(0),ee=Zt.stackObjectValue(1),Zt.failed())return null;if(se=Zt.fetchPointerofObject(1,ee),te=Zt.fetchPointerofObject(0,ee),Zt.failed())return null;if(!Zt.isBytes(te))return Zt.primitiveFail(),null;if(!Zt.isWords(se))return Zt.primitiveFail(),null;for(re=se.wordsAsFloat32Array(),Yt=te.bytes,Bt=0;Bt<=t(se)-1;Bt++)1===Yt[Bt]&&(re[Bt]=ie);Zt.pop(1)},primitiveEQArrays:function C(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(ae=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ne=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ne)),Zt.success(Zt.isBytes(ae)),Zt.failed())return null;if(se=t(Bt),Zt.success(se===t(ne)),Zt.success(se===t(ae)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),Zt.isMemberOf(ne,"WordArray"))if(re)for(ue=ne.words,oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]===oe[ie];else for(ue=ne.words,te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]===te[ie];else if(re)for(ee=ne.wordsAsFloat32Array(),oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]===oe[ie];else for(ee=ne.wordsAsFloat32Array(),te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]===te[ie];Zt.pop(4),Zt.push(ae)},primitiveNEArrays:function L(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(ae=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ne=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ne)),Zt.success(Zt.isBytes(ae)),Zt.failed())return null;if(se=t(Bt),Zt.success(se===t(ne)),Zt.success(se===t(ae)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),Zt.isMemberOf(ne,"WordArray"))if(re)for(ue=ne.words,oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]!==oe[ie];else for(ue=ne.words,te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]!==te[ie];else if(re)for(ee=ne.wordsAsFloat32Array(),oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]!==oe[ie];else for(ee=ne.wordsAsFloat32Array(),te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]!==te[ie];Zt.pop(4),Zt.push(ae)},primScalarForward:function b(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve;return Bt=Zt.stackIntegerValue(0),fe=Zt.stackIntegerValue(1),le=Zt.stackIntegerValue(2),ae=Zt.stackIntegerValue(3),Yt=Zt.stackFloatValue(4),te=Zt.stackFloatValue(5),he=Zt.stackFloatValue(6),re=Zt.stackValue(7),ve=Zt.stackValue(8),de=Zt.stackValue(9),ne=Zt.stackIntegerValue(10),Zt.failed()?null:Zt.isWords(de)&&Zt.isWords(ve)&&Zt.isWords(re)?(ce=t(de),t(ve)!==ce||t(re)!==ce?(Zt.primitiveFail(),null):(pe=de.wordsAsFloat32Array(),me=ve.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array(),ee=he,oe=pe[se=ne-1]+ee*Math.cos(ie[se]),ue=me[se]-ee*Math.sin(ie[se]),n(se,pe,ie,oe,te,ae,le),r(se,me,ie,ue,Yt,fe,Bt),Zt.failed()?null:void Zt.pop(11))):(Zt.primitiveFail(),null)},vectorGetDistanceTo:function kt(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de;if(oe=Zt.stackValue(0),de=Zt.stackValue(1),fe=Zt.stackValue(2),re=Zt.stackValue(3),ee=Zt.stackValue(4),Zt.failed())return null;if(!Zt.isWords(oe))return Zt.primitiveFail(),null;if(!Zt.isWords(fe))return Zt.primitiveFail(),null;if(!Zt.isWords(de))return Zt.primitiveFail(),null;if(0>(ue=t(oe)))return Zt.primitiveFail(),null;if(t(fe)!==ue)return Zt.primitiveFail(),null;if(t(de)!==ue)return Zt.primitiveFail(),null;if(ee.isFloat){if(!re.isFloat)return Zt.primitiveFail(),null;Yt=!1}else{if(re.isFloat)return Zt.primitiveFail(),null;Yt=!0}if(Yt){if(t(ee)!==ue)return Zt.primitiveFail(),null;if(t(re)!==ue)return Zt.primitiveFail(),null}for(ae=oe.wordsAsFloat32Array(),ce=fe.wordsAsFloat32Array(),pe=de.wordsAsFloat32Array(),Yt&&(te=ee.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array()),Yt||(se=Zt.floatValueOf(ee),ne=Zt.floatValueOf(re)),Bt=0;ue-1>=Bt;Bt++)Yt&&(se=te[Bt],ne=ie[Bt]),le=se-ce[Bt],he=ne-pe[Bt],ae[Bt]=Math.sqrt(le*le+he*he);return Zt.failed()?null:(Zt.pop(6),void Zt.push(oe))},turtlesSetY:function mt(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de;if(Bt=Zt.stackIntegerValue(0),ue=Zt.stackIntegerValue(1),Yt=Zt.stackFloatValue(2),fe=Zt.stackValue(3),ee=Zt.stackValue(4),de=Zt.stackValue(5),ae=Zt.stackValue(6),Zt.failed())return null;if(!Zt.isBytes(ae))return Zt.primitiveFail(),null;if(!Zt.isWords(de))return Zt.primitiveFail(),null;if(!Zt.isWords(ee))return Zt.primitiveFail(),null;if(fe.isFloat)re=!1;else{if(!Zt.isWords(fe))return Zt.primitiveFail(),null;re=!0,se=Zt.isMemberOf(fe,"WordArray")}if(oe=t(de),t(ae)!==oe)return Zt.primitiveFail(),null;if(t(ee)!==oe)return Zt.primitiveFail(),null;if(re&&t(fe)!==oe)return Zt.primitiveFail(),null;for(ne=ae.bytes,pe=de.wordsAsFloat32Array(),te=ee.wordsAsFloat32Array(),re?se?he=fe.words:ce=fe.wordsAsFloat32Array():le=Zt.floatValueOf(fe),ie=0;oe-1>=ie;ie++)1===ne[ie]&&r(ie,pe,te,re?se?he[ie]:ce[ie]:le,Yt,ue,Bt);return Zt.failed()?null:void Zt.pop(7)},turtleScalarSetX:function ht(){var Bt,Yt,te,ee,ie,re,se,ne;return ee=Zt.stackIntegerValue(0),te=Zt.stackIntegerValue(1),Bt=Zt.stackFloatValue(2),re=Zt.stackFloatValue(3),Yt=Zt.stackValue(4),se=Zt.stackIntegerValue(5),ne=Zt.stackValue(6),Zt.failed()?null:Zt.isWords(ne)&&Zt.isWords(Yt)?(ie=t(ne),t(Yt)!==ie?(Zt.primitiveFail(),null):(n(se-1,ne.wordsAsFloat32Array(),Yt.wordsAsFloat32Array(),re,Bt,te,ee),Zt.failed()?null:void Zt.pop(7))):(Zt.primitiveFail(),null)},primTurtlesForward:function F(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye;if(Bt=Zt.stackIntegerValue(0),pe=Zt.stackIntegerValue(1),fe=Zt.stackIntegerValue(2),ae=Zt.stackIntegerValue(3),Yt=Zt.stackFloatValue(4),te=Zt.stackFloatValue(5),ve=Zt.stackValue(6),re=Zt.stackValue(7),ye=Zt.stackValue(8),ge=Zt.stackValue(9),ce=Zt.stackValue(10),Zt.failed())return null;if(!Zt.isBytes(ce))return Zt.primitiveFail(),null;if(!Zt.isWords(ge))return Zt.primitiveFail(),null;if(!Zt.isWords(ye))return Zt.primitiveFail(),null;if(!Zt.isWords(re))return Zt.primitiveFail(),null;if(ve.isFloat)ne=!1;else{if(!Zt.isWords(ve))return Zt.primitiveFail(),null;ne=!0}if(he=t(ge),t(ye)!==he)return Zt.primitiveFail(),null;if(t(re)!==he)return Zt.primitiveFail(),null;if(t(ce)!==he)return Zt.primitiveFail(),null;if(ne&&t(ve)!==he)return Zt.primitiveFail(),null;for(le=ce.bytes,ke=ge.wordsAsFloat32Array(),be=ye.wordsAsFloat32Array(),ie=re.wordsAsFloat32Array(),ne?me=ve.wordsAsFloat32Array():de=Zt.floatValueOf(ve),se=0;he-1>=se;se++)1===le[se]&&(ee=ne?me[se]:de,oe=ke[se]+ee*Math.cos(ie[se]),ue=be[se]-ee*Math.sin(ie[se]),n(se,ke,ie,oe,te,ae,fe),r(se,be,ie,ue,Yt,pe,Bt));return Zt.failed()?null:void Zt.pop(11)},primitiveGEScalar:function x(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(ae)),Zt.success(Zt.isBytes(oe)),Zt.failed())return null;if(ne=t(ae),Zt.success(ne===t(oe)),Zt.failed())return null;if(se="number"==typeof Bt,Zt.isMemberOf(ae,"WordArray"))if(se)for(ue=ae.words,re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]>=re;else for(ue=ae.words,te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]>=te;else if(se)for(ee=ae.wordsAsFloat32Array(),re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]>=re;else for(ee=ae.wordsAsFloat32Array(),te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]>=te;Zt.pop(4),Zt.push(oe)},primitiveAndByteArray:function A(){var Bt,Yt,te,ee,ie,re,se,ne;if(re=Zt.stackObjectValue(0),ne=Zt.stackValue(1),Zt.failed())return null;if(Zt.success(Zt.isBytes(ne)),Zt.success(Zt.isBytes(re)),Zt.failed())return null;if(te=t(ne),ee=t(re),Zt.failed())return null;for(Yt=te,te>ee&&(Yt=ee),ie=re.bytes,se=ne.bytes,Bt=0;Yt-1>=Bt;Bt++)se[Bt]=se[Bt]+ie[Bt]===2;Zt.pop(1)},primitivePredicateReplaceWords:function X(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve;if(ue=Zt.stackIntegerValue(0),oe=Zt.stackObjectValue(1),he=Zt.stackIntegerValue(2),fe=Zt.stackIntegerValue(3),ae=Zt.stackObjectValue(4),Zt.failed())return null;if(me=Zt.fetchPointerofObject(1,ae),re=Zt.fetchPointerofObject(0,ae),Zt.failed())return null;if(!Zt.isBytes(re))return Zt.primitiveFail(),null;if(!(Zt.isWords(me)&&Zt.isWords(oe)||Zt.isPointers(me)&&Zt.isPointers(oe)))return Zt.primitiveFail(),null;if(ie=re.bytes,ve=t(me),se=t(re),ce=t(oe),fe>he)return Zt.primitiveFail(),null;if(1>fe)return Zt.primitiveFail(),null;if(fe>ve)return Zt.primitiveFail(),null;if(fe>se)return Zt.primitiveFail(),null;if(he>ve)return Zt.primitiveFail(),null;if(he>se)return Zt.primitiveFail(),null;if(1>ue)return Zt.primitiveFail(),null;if(ue>ce)return Zt.primitiveFail(),null;if(he-fe+1>ce-ue+1)return Zt.primitiveFail(),null;if(pe=Zt.isMemberOf(me,"KedamaFloatArray"),ne=Zt.isMemberOf(oe,"KedamaFloatArray"),pe&&ne)for(Yt=me.wordsAsFloat32Array(),Bt=oe.wordsAsFloat32Array(),ee=fe-1;he-1>=ee;ee++)1===ie[ee]&&(Yt[ee]=Bt[ue+ee-fe]);if(pe&&!ne)for(Yt=me.wordsAsFloat32Array(),le=oe.words,ee=fe-1;he-1>=ee;ee++)1===ie[ee]&&(Yt[ee]=le[ue+ee-fe]);if(!pe&&ne)for(de=me.words,Bt=oe.wordsAsFloat32Array(),ee=fe-1;he-1>=ee;ee++)1===ie[ee]&&(te=Bt[ue+ee-fe]>>>0,de[ee]=te);if(!pe&&!ne)for(de=me.words,le=oe.words,ee=fe-1;he-1>=ee;ee++)1===ie[ee]&&(de[ee]=le[ue+ee-fe]);Zt.pop(4)},primitiveGTArrays:function q(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(ae=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ne=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ne)),Zt.success(Zt.isBytes(ae)),Zt.failed())return null;if(se=t(Bt),Zt.success(se===t(ne)),Zt.success(se===t(ae)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),Zt.isMemberOf(ne,"WordArray"))if(re)for(ue=ne.words,oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]>oe[ie];else for(ue=ne.words,te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ue[ie]>te[ie];else if(re)for(ee=ne.wordsAsFloat32Array(),oe=Bt.words,Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]>oe[ie];else for(ee=ne.wordsAsFloat32Array(),te=Bt.wordsAsFloat32Array(),Yt=ae.bytes,ie=0;se-1>=ie;ie++)Yt[ie]=ee[ie]>te[ie];Zt.pop(4),Zt.push(ae)},primitivePredicateAtAllPutObject:function J(){var Bt,Yt,te,ee,ie,re,se;if(ie=Zt.stackValue(0),ee=Zt.stackObjectValue(1),Zt.failed())return null;if(se=Zt.fetchPointerofObject(1,ee),te=Zt.fetchPointerofObject(0,ee),Zt.failed())return null;if(!Zt.isBytes(te))return Zt.primitiveFail(),null;if(!Zt.isPointers(se))return Zt.primitiveFail(),null;for(re=se.wordsAsInt32Array(),Yt=te.bytes,Bt=0;Bt<=t(se)-1;Bt++)1===Yt[Bt]&&(re[Bt]=ie);Zt.pop(1)},primitiveEQScalar:function V(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(ae)),Zt.success(Zt.isBytes(oe)),Zt.failed())return null;if(ne=t(ae),Zt.success(ne===t(oe)),Zt.failed())return null;if(se="number"==typeof Bt,Zt.isMemberOf(ae,"WordArray"))if(se)for(ue=ae.words,re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]===re;else for(ue=ae.words,te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]===te;else if(se)for(ee=ae.wordsAsFloat32Array(),re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]===re;else for(ee=ae.wordsAsFloat32Array(),te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]===te;Zt.pop(4),Zt.push(oe)},primitivePredicateAtAllPutBoolean:function z(){var Bt,Yt,te,ee,ie,re,se,ne;if(re=Zt.stackValue(0),ee=Zt.stackObjectValue(1),Zt.failed())return null;if(ie=Zt.isIntegerValue(re)?re:Zt.booleanValueOf(re),ne=Zt.fetchPointerofObject(1,ee),te=Zt.fetchPointerofObject(0,ee),Zt.failed())return null;if(!Zt.isBytes(te))return Zt.primitiveFail(),null;if(!Zt.isBytes(ne))return Zt.primitiveFail(),null;for(se=ne.bytes,Yt=te.bytes,Bt=0;Bt<=t(ne)-1;Bt++)1===Yt[Bt]&&(se[Bt]=ie);Zt.pop(1)},zoomBitmap:function gt(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me;if(me=Zt.stackIntegerValue(0),pe=Zt.stackIntegerValue(1),se=Zt.stackIntegerValue(2),ae=Zt.stackIntegerValue(3),te=Zt.stackValue(4),oe=Zt.stackValue(5),Zt.failed())return null;if(ce=t(oe),ie=t(te),ae*se!==ce)return Zt.primitiveFail(),null;if(ce*pe*me!==ie)return Zt.primitiveFail(),null;for(ne=oe.words,Yt=te.words,ue=0,le=0,ee=0,he=0;se-1>=he;he++){for(de=0;me-1>=de;de++){for(fe=0;ae-1>=fe;fe++)for(Bt=ne[ue],++ue,re=0;pe-1>=re;re++)Yt[ee]=Bt,++ee;ue=le}ue=le+=ae}Zt.pop(6)},primitiveNEScalar:function wt(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(ae)),Zt.success(Zt.isBytes(oe)),Zt.failed())return null;if(ne=t(ae),Zt.success(ne===t(oe)),Zt.failed())return null;if(se="number"==typeof Bt,Zt.isMemberOf(ae,"WordArray"))if(se)for(ue=ae.words,re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]!==re;else for(ue=ae.words,te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ue[ie]!==te;else if(se)for(ee=ae.wordsAsFloat32Array(),re=Bt,Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]!==re;else for(ee=ae.wordsAsFloat32Array(),te=Zt.floatValueOf(Bt),Yt=oe.bytes,ie=0;ne-1>=ie;ie++)Yt[ie]=ee[ie]!==te;Zt.pop(4),Zt.push(oe)},scalarGetDistanceTo:function nt(){var Bt,Yt,te,ee,ie,re,se;return Yt=Zt.stackFloatValue(0),Bt=Zt.stackFloatValue(1),ie=Zt.stackFloatValue(2),ee=Zt.stackFloatValue(3),Zt.failed()?null:(re=Bt-ee,se=Yt-ie,te=Math.sqrt(re*re+se*se),Zt.failed()?null:(Zt.pop(5),void Zt.pushFloat(te)))},primitiveSubArrays:function Q(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(oe=Zt.stackObjectValue(0),Bt=Zt.stackObjectValue(1),ae=Zt.stackObjectValue(2),Zt.failed())return null;if(Zt.success(Zt.isWords(Bt)),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(oe)),Zt.failed())return null;if(ne=t(Bt),Zt.success(ne===t(ae)),Zt.success(ne===t(oe)),Zt.failed())return null;if(re=Zt.isMemberOf(Bt,"WordArray"),se=Zt.isMemberOf(ae,"WordArray"),re&&se){if(!Zt.isMemberOf(oe,"WordArray"))return Zt.primitiveFail(),null}else if(!Zt.isMemberOf(oe,"KedamaFloatArray"))return Zt.primitiveFail(),null;if(se)if(re)for(le=ae.words,ue=Bt.words,ce=oe.words,ie=0;ne-1>=ie;ie++)ce[ie]=le[ie]-ue[ie];else for(le=ae.words,Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=le[ie]-Yt[ie];else if(re)for(te=ae.wordsAsFloat32Array(),ue=Bt.words,ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]-ue[ie];else for(te=ae.wordsAsFloat32Array(),Yt=Bt.wordsAsFloat32Array(),ee=oe.wordsAsFloat32Array(),ie=0;ne-1>=ie;ie++)ee[ie]=te[ie]-Yt[ie];Zt.pop(4),Zt.push(oe)}})})),module("users.bert.SqueakJS.plugins.Klatt").requires("users.bert.SqueakJS.vm").toRun((function(){function Pt(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function _(Bt,Yt){return Bt-function Lt(Bt,Yt){return 0|Math.floor(Bt/Yt)}(Bt,Yt)*Yt|0}function L(Bt,Yt,Zt){var te,ee,ie,re,se;ee=(0-Ke)/Cn*Zt,re=0-(se=Math.exp(ee))*se,ee=2*Ke/Cn*Yt,ie=(0-(ie=se*Math.cos(ee)*2))*(te=1/(te=1-ie-re)),re=(0-re)*te,j(Bt,te),E(Bt,ie),z(Bt,re)}function At(Bt,Yt){var Zt,te;return Zt=x(Bt)*Yt+R(Bt)*(te=X(Bt))+K(Bt)*St(Bt),It(Bt,te),yt(Bt,Yt),Zt}function xi(Bt){var Yt;return Js>0?(Yt=At(Ms,Bt),Yt=i(js,Yt),Yt=At(Ts,Yt),Yt=i(Ws,Yt),Js>=8&&(Yt=i(Ei,Yt)),Js>=7&&(Yt=i(Wi,Yt)),Js>=6&&(Yt=i(pi,Yt)),Js>=5&&(Yt=i(oi,Yt)),Js>=4&&(Yt=i($e,Yt)),Js>=3&&(Yt=i(Ye,Yt)),Js>=2&&(Yt=i(He,Yt)),Js>=1&&(Yt=i(Ge,Yt)),Yt):0}function xt(Bt){return dn.success(dn.isWords(Bt)),dn.failed()?0:Bt.wordsAsFloat32Array()}function Ci(){var Bt;return 0===jn?0:(bn>yn?(Bt=zs*qn+Ks*Mn,Mn=qn,qn=Bt):qn=Bt=Gs*qn-Us,yn>=jn&&(yn=0,function Oi(){hn[Ve]>0?(function mi(){On=hn[Ve],function _i(){var Bt,Yt,Zt,te,ee;ee=Pn/Cn,Bt=Math.sin(2*Ke*12.7*ee),Yt=Math.sin(2*Ke*7.1*ee),Zt=Math.sin(2*Ke*4.7*ee),te=2*hn[Ne]*hn[Ve]/100*(Bt+Yt+Zt),On+=te}(),function Mi(){On+=(O()-32767)*hn[ze]/32768*hn[Ve]}(),function Bi(){0===_(Sn,2)?On+=hn[we]*hn[Ve]*(1-hn[Bs]):On-=hn[we]*hn[Ve]*(1-hn[Bs])}(),0>On&&(On=0),gn=jn=Cn/On|0,hn[Es]>0&&(gn>>=1),bn=jn*hn[Bs]|0,function yi(Bt,Yt,Zt){var te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de;he=jn*Bt|0,le=he/jn,ue=Zt,ae=Yt,0>=ae?ee=1:(ne=(1-le)/ae,ee=1-ne/(Math.exp(ne)-1)),se=Ke*(ue+1),te=Math.cos(se),fe=Math.sin(se),ce=ae/le*se*ee,de=di(se,te,fe,ce),pe=se/he,oe=Math.exp(de*pe),zs=2*Math.cos(pe)*oe,Ks=0-oe*oe,Mn=0,qn=oe*Math.sin(pe),ie=Math.exp(-1/(ae*jn)),re=Math.pow(ie,jn-he),Gs=ie,Us=(1-ie)*re/(1-re),Pi()}(hn[Bs],hn[Hi],hn[Yi]),function qi(){(qn+=(O()-32767)*hn[Ls]/32768*qn)>0&&(qn=0)}(),function Ni(){0!==_(Sn,2)&&(qn*=1-hn[we])>0&&(qn=0)}()}(),Sn=_(Sn+1,65535)):gn=jn=1}()),++yn,Bt)}function s(Bt){return 32.767*Math.pow(2,(Bt-87)/6)}function wi(Bt){var Yt;return dn.success(22===Pt(Bt)),!dn.failed()&&(Yt=dn.fetchPointerofObject(0,Bt),In=xt(Yt),On=dn.fetchFloatofObject(2,Bt),jn=dn.fetchIntegerofObject(3,Bt),yn=dn.fetchIntegerofObject(4,Bt),bn=dn.fetchIntegerofObject(5,Bt),gn=dn.fetchIntegerofObject(6,Bt),zs=dn.fetchFloatofObject(7,Bt),Ks=dn.fetchFloatofObject(8,Bt),qn=dn.fetchFloatofObject(9,Bt),Mn=dn.fetchFloatofObject(10,Bt),Gs=dn.fetchFloatofObject(11,Bt),Us=dn.fetchFloatofObject(12,Bt),pn=dn.fetchFloatofObject(13,Bt),xn=dn.fetchFloatofObject(14,Bt),kn=dn.fetchFloatofObject(15,Bt),Sn=dn.fetchIntegerofObject(16,Bt),Pn=dn.fetchIntegerofObject(17,Bt),Vn=dn.fetchIntegerofObject(18,Bt),Js=dn.fetchIntegerofObject(19,Bt),wn=dn.fetchIntegerofObject(20,Bt),Cn=dn.fetchIntegerofObject(21,Bt),!1===dn.failed())}function O(){return Vn=1309*Vn+13849&65535}function Pi(){var Bt,Yt,Zt,te;for(Yt=0,Zt=qn,te=Mn,Bt=1;bn>=Bt;Bt++)Yt=zs*Zt+Ks*te,te=Zt,Zt=Yt;0!==Yt&&(qn=qn/Yt*1e4)}function Ai(Bt){return i(Je,Bt)-i(Qe,Bt)+i(ti,Bt)-i(li,Bt)+i(Si,Bt)}function Ii(Bt){return i(Ue,Bt)+i(Xe,Bt)+i(Ze,Bt)+i(ai,Bt)+i(qs,Bt)+i(Ds,Bt)}function k(Bt,Yt,Zt,te,ee){return Math.exp(Bt*Yt)*((ee*(Bt*Bt+1)+Bt)*te-Zt)+1}function c(Bt,Yt,Zt){var te,ee,ie,re;te=(0-Ke)/Cn*Zt,ie=0-(re=Math.exp(te))*re,te=2*Ke/Cn*Yt,j(Bt,1-(ee=re*Math.cos(te)*2)-ie),E(Bt,ee),z(Bt,ie)}function o(Bt,Yt,Zt,te){c(Bt,Yt,Zt),j(Bt,x(Bt)*te)}function i(Bt,Yt){var Zt,te;return Zt=x(Bt)*Yt+R(Bt)*(te=X(Bt))+K(Bt)*St(Bt),It(Bt,te),yt(Bt,Zt),Zt}function x(Bt){return In[5*Bt-5]}function j(Bt,Yt){In[5*Bt-5]=Yt}function R(Bt){return In[5*Bt-4]}function E(Bt,Yt){In[5*Bt-4]=Yt}function K(Bt){return In[5*Bt-3]}function z(Bt,Yt){In[5*Bt-3]=Yt}function X(Bt){return In[5*Bt-2]}function yt(Bt,Yt){In[5*Bt-2]=Yt}function St(Bt){return In[5*Bt-1]}function It(Bt,Yt){In[5*Bt-1]=Yt}function bi(Bt){var Yt,Zt,te,ee,ie,re,se,ne,ae,oe,ue;return dn.pushRemappableOop(Bt),dn.pushRemappableOop(dn.floatObjectOf(On)),dn.pushRemappableOop(dn.floatObjectOf(zs)),dn.pushRemappableOop(dn.floatObjectOf(Ks)),dn.pushRemappableOop(dn.floatObjectOf(qn)),dn.pushRemappableOop(dn.floatObjectOf(Mn)),dn.pushRemappableOop(dn.floatObjectOf(Gs)),dn.pushRemappableOop(dn.floatObjectOf(Us)),dn.pushRemappableOop(dn.floatObjectOf(pn)),dn.pushRemappableOop(dn.floatObjectOf(xn)),se=dn.floatObjectOf(kn),ae=dn.popRemappableOop(),ie=dn.popRemappableOop(),ee=dn.popRemappableOop(),te=dn.popRemappableOop(),ue=dn.popRemappableOop(),oe=dn.popRemappableOop(),Zt=dn.popRemappableOop(),Yt=dn.popRemappableOop(),ne=dn.popRemappableOop(),re=dn.popRemappableOop(),!dn.failed()&&(dn.storePointerofObjectwithValue(2,re,ne),dn.storeIntegerofObjectwithValue(3,re,jn),dn.storeIntegerofObjectwithValue(4,re,yn),dn.storeIntegerofObjectwithValue(5,re,bn),dn.storeIntegerofObjectwithValue(6,re,gn),dn.storePointerofObjectwithValue(7,re,Yt),dn.storePointerofObjectwithValue(8,re,Zt),dn.storePointerofObjectwithValue(9,re,oe),dn.storePointerofObjectwithValue(10,re,ue),dn.storePointerofObjectwithValue(11,re,te),dn.storePointerofObjectwithValue(12,re,ee),dn.storePointerofObjectwithValue(13,re,ie),dn.storePointerofObjectwithValue(14,re,ae),dn.storePointerofObjectwithValue(15,re,se),dn.storeIntegerofObjectwithValue(16,re,Sn),dn.storeIntegerofObjectwithValue(17,re,Pn),dn.storeIntegerofObjectwithValue(18,re,Vn),!1===dn.failed())}function gi(Bt){var Yt,le,Pe,we,Ce,Ve,Ne,Te,Ee,ze,Ke;ze=.6*s((hn=Bt)[ue]),Ke=.6*s(hn[ce]),Yt=.4*s(hn[Zt]),Pe=.15*s(hn[ee]),Ce=.06*s(hn[re]),Ne=.04*s(hn[ne]),le=.15*s(hn[te]),we=.06*s(hn[ie]),Ve=.04*s(hn[se]),Te=.022*s(hn[ae]),Ee=.03*s(hn[oe]),Js>=8&&(Cn>=16e3?c(Ei,7500,600):Js=6),Js>=7&&(Cn>=16e3?c(Wi,6500,500):Js=6),Js>=6&&c(pi,hn[_e],hn[ye]),Js>=5&&c(oi,hn[Be],hn[ge]),c($e,hn[Me],hn[ve]),c(Ye,hn[qe],hn[de]),c(He,hn[xe],hn[he]),c(Ge,hn[je],hn[fe]),c(js,hn[We],hn[Se]),c(Ws,hn[Le],hn[Ie]),L(Ms,hn[De],hn[Oe]),L(Ts,hn[Re],hn[Ae]),o(qs,hn[We],hn[Se],ze),o(Ds,hn[Le],hn[Ie],Ke),o(Ue,hn[je],hn[fe],Yt),o(Xe,hn[xe],hn[he],Pe),o(Ze,hn[qe],hn[de],Ce),o(ai,hn[Me],hn[ve],Ne),o(Je,hn[xe],hn[pe],le),o(Qe,hn[qe],hn[me],we),o(ti,hn[Me],hn[ke],Ve),o(li,hn[Be],hn[be],Te),o(Si,hn[_e],hn[Fe],Ee)}function vi(Bt,Yt,Zt){var te,ee,ie,re,se,ne,ae,oe,ue,ce,fe,he,pe,de,me,ve,ke,ge,be;for(gi(Bt),On>0?(be=s(hn[Es]-7),pe=s(hn[Es]),ke=.1*s(hn[Rs])):be=pe=ke=0,se=.25*s(hn[Te]),ee=.05*s(hn[le]),re=.05*s(hn[Pe]),0>=(ae=hn[Ee]-3)&&(ae=57),te=s(ae),o(_s,0,Cn,te),ce=kn,ue=Zt,ve=wn+Zt-1;ve>=ue;)ce=(O()-32768)/4,kn=ce+=.75*kn,yn>gn&&(ce*=.5),ne=se*ce,ge=Ci(),xn=ge,bn>yn&&(ge+=ke*(O()-32768)/4),oe=be*ge,he=pe*ge,he+=ie=ee*ce,fe=xi(oe+=ie),fe+=Ii(de=he),de=ne+he-pn,pn=he,fe=Ai(de)-fe,-32768>(me=(fe=i(_s,fe=re*de-fe))*te|0)&&(me=-32768),me>32767&&(me=32767),Yt[ue-1]=me,++ue,++Pn}function di(Bt,Yt,Zt,te){var ee,ie,re,se,ne,ae,oe;if((se=k(0,Bt,Yt,Zt,te))>0)for(ne=0,ee=se,ie=k(ae=1,Bt,Yt,Zt,te);ie>0;)ne=ae,ee=ie,ie=k(ae*=2,Bt,Yt,Zt,te);else for(ae=0,ee=k(ne=-1,Bt,Yt,Zt,te),ie=se;0>ee;)ae=ne,ie=ee,ee=k(ne*=2,Bt,Yt,Zt,te);for(;ae-ne>Ce;)(re=k(oe=(ae+ne)/2,Bt,Yt,Zt,te))>0?(ne=oe,ee=re):(ae=oe,ie=re);return(ae+ne)/2}var Bt=1,Yt=11,Zt=46,te=34,ee=47,ie=35,re=48,se=36,ne=49,ae=37,oe=38,ue=45,le=9,ce=50,fe=13,he=17,pe=40,de=19,me=41,ve=21,ke=42,ge=23,be=43,ye=25,Fe=44,Se=27,Oe=29,Ie=31,Ae=33,Pe=39,we=4,Ce=1e-4,Ve=0,je=12,xe=16,qe=18,Me=20,Be=22,_e=24,Ne=1,We=26,De=28,Te=10,Le=30,Re=32,Ee=51,ze=2,Ke=3.141592653589793,Ge=12,Ue=3,He=13,Je=7,Xe=4,Ye=14,Qe=8,Ze=5,$e=15,ti=9,ai=6,oi=16,li=10,pi=17,Si=11,Wi=18,Ei=19,Hi=7,Yi=8,js=20,qs=1,Ms=21,Bs=6,_s=24,Ws=22,Ds=2,Ts=23,Ls=3,Rs=11,Es=5,zs=0,Ks=0,Gs=0,Us=0,Js=0,hn=null,pn=0,dn=null,mn="Klatt 3 November 2014 (e)",kn=0,gn=0,bn=0,yn=0,Sn=0,On=0,In=null,Pn=0,wn=0,Cn=0,Vn=0,jn=0,xn=0,qn=0,Mn=0;Squeak.registerExternalModule("Klatt",{setInterpreter:function ki(Zt){return!1!==((dn=Zt).majorVersion()==Bt)&&dn.minorVersion()>=Yt},primitiveSynthesizeFrameIntoStartingAt:function Fi(){var Bt,Yt,Zt,te,ee;return Bt=xt(dn.stackValue(2)),Yt=function ji(Bt){return dn.success(dn.isWords(Bt)),dn.failed()?0:Bt.wordsAsInt16Array()}(Zt=dn.stackValue(1)),ee=dn.stackIntegerValue(0),dn.failed()?null:wi(te=dn.stackObjectValue(3))?(dn.success(2*Pt(Zt)>=wn),dn.failed()?null:(vi(Bt,Yt,ee),bi(te)?void dn.pop(3):null)):null},getModuleName:function Vi(){return mn}})})),module("users.bert.SqueakJS.plugins.LargeIntegers").requires("users.bert.SqueakJS.vm").toRun((function(){function n(Bt){return"number"==typeof Bt?te.classSmallInteger():Bt.sqClass}function i(Bt){return Bt.bytes?Bt.bytes.length:Bt.words?4*Bt.words.length:0}function O(Bt,Yt){return 0|Math.floor(Bt/Yt)}function c(Bt,Yt){return Bt-O(Bt,Yt)*Yt|0}function m(Bt,Yt){return Yt>31?0:Bt<<Yt}function u(Bt,Yt){return Yt>31?0:Bt>>>Yt}function Ft(Bt,Yt,Zt){var ee,ie,re,se,ne,ae,oe,ue;if(1>Yt||1>Zt)return te.primitiveFail();if(ie=Bt,Yt>(ae=Math.min(Zt,St(ie))))return!1;if(ne=1+(Yt-1>>3),ee=1+(ae-1>>3),se=c(Yt-1,8),re=7-c(ae-1,8),ne===ee)return oe=m(255,se)&u(255,re),0!=(r(ie,ne)&oe);if(0!==u(r(ie,ne),se))return!0;for(ue=ne+1;ee-1>=ue;ue++)if(0!==r(ie,ue))return!0;return 0!=(255&m(r(ie,ee),re))}function v(Bt,Yt){var Zt,ee,ie;return ie=te.instantiateClassindexableSize(n(Bt),Yt),ee=Yt>(Zt=i(Bt))?Zt:Yt,q(Bt.bytes,ie.bytes,ee),ie}function A(Bt,Yt){var Zt,ee,ie;return"number"==typeof Bt?(Zt=0>(ee=Bt)?te.classLargeNegativeInteger():te.classLargePositiveInteger(),function bt(Bt,Yt){var Zt,te,ee;for(Zt=Yt.bytes,te=1,ee=b(Bt);ee>=te;te++)Zt[te-1]=o(Bt,te)}(ee,ie=te.instantiateClassindexableSize(Zt,Yt))):ie=v(Bt,Yt),ie}function V(Bt,Yt,Zt){var te,ee,ie;for(ie=Zt-1;ie>=0;){if((ee=Yt[ie])!==(te=Bt[ie]))return te>ee?1:-1;--ie}return 0}function q(Bt,Yt,Zt){var te,ee;for(te=Zt-1,ee=0;te>=ee;ee++)Yt[ee]=Bt[ee];return 0}function mt(Bt,Yt,Zt,te,ee,ie){var re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye;for(ke=ie,be=Bt[(ve=Yt-1)-1],ae=1===ve?0:Bt[ve-2],pe=1;ke>=pe;pe++){if(Zt[(de=te+1-pe)-1]===be)se=255;else for(ye=c(ge=((ge=Zt[de-1])<<8)+Zt[de-2],be),ue=(ce=(se=O(ge,be))*ae)>>>8,oe=255&ce,le=3>de?0:Zt[de-3];ue>ye||ye===ue&&oe>le?(--se,ae>oe?(--ue,oe=oe+256-ae):oe-=ae,fe=ue>=be):fe=!1,fe;)ue-=be;for(he=de-ve,ne=0,me=1;Yt>=me;me++)ue=Bt[me-1]*(se>>>8),oe=Bt[me-1]*(255&se),re=Zt[he-1]-ne-(255&oe),Zt[he-1]=255&re,ne=ue+(oe>>>8)-(re>>=8),++he;if(ne>0)for(--se,he=de-ve,ne=0,me=1;Yt>=me;me++)ne=(ne>>>8)+Zt[he-1]+Bt[me-1],Zt[he-1]=255&ne,++he;ee[ie-pe]=se}return 0}function g(Bt,Yt){var Zt,te;for(te=Yt;0===(Zt=Bt[te-1]);)if(0==--te)return 0;return I(Zt)+8*(te-1)}function b(Bt){return 256>Bt&&Bt>-256?1:65536>Bt&&Bt>-65536?2:16777216>Bt&&Bt>-16777216?3:4}function E(Bt,Yt,Zt,te,ee){var ie,re,se,ne,ae,oe,ue;for(ie=Bt>>3,ae=c(Bt,8),ue=ie-1,ne=0;ue>=ne;ne++)te[ne]=0;if(0===ae)return F(te,ie,ee-1,Yt,0);for(oe=8-ae,re=0,ue=Zt-1,ne=0;ue>=ne;ne++)se=Yt[ne],te[ne+ie]=255&(re|m(se,ae)),re=u(se,oe);return 0!==re&&(te[ee-1]=re),0}function o(Bt,Yt){return 1>Yt&&te.primitiveFail(),Yt>4?0:0>Bt?255&u(0-Bt,8*(Yt-1)):255&u(Bt,8*(Yt-1))}function F(Bt,Yt,Zt,te,ee){return function(){for(var ie=Zt-Yt+1,re=0;ie>re;re++)Bt[re+Yt]=te[re+ee];return 0}()}function D(Bt,Yt,Zt,te,ee){var ie,re,se,ne,ae,oe,ue,le;if(re=Bt>>3,0===(ae=c(Bt,8)))return F(te,0,ee-1,Yt,re);for(oe=8-ae,se=u(Yt[re],ae),ue=Zt-1,ie=le=re+1;ue>=ie;ie++)ne=Yt[ie],te[ie-le]=255&(se|m(ne,oe)),se=u(ne,ae);return 0!==se&&(te[ee-1]=se),0}function I(Bt){var Yt,Zt;return Zt=0,65536>(Yt=Bt)||(Yt>>>=16,Zt+=16),256>Yt||(Yt>>>=8,Zt+=8),16>Yt||(Yt>>>=4,Zt+=4),4>Yt||(Yt>>>=2,Zt+=2),2>Yt||(Yt>>>=1,++Zt),Zt+Yt}function t(Bt){var Yt,Zt,ee,ie,re,se;for(re=0>(se=Bt)?te.classLargeNegativeInteger():te.classLargePositiveInteger(),Yt=b(se),ee=(Zt=te.instantiateClassindexableSize(re,Yt)).bytes,ie=1;Yt>=ie;ie++)ee[ie-1]=o(se,ie);return Zt}function h(Bt,Yt){var Zt,ee,ie,re;return ee=i(Bt),0===(re=g(Bt.bytes,ee))?0:(Zt=re+Yt+7>>3,ie=te.instantiateClassindexableSize(n(Bt),Zt),E(Yt,Bt.bytes,ee,ie.bytes,Zt),ie)}function d(Bt,Yt,Zt){var ee,ie,re,se,ne;return ie=(ne=g(Bt.bytes,Zt))+7>>3,0>=(se=ne-Yt)?te.instantiateClassindexableSize(n(Bt),0):(re=se+7>>3,ee=te.instantiateClassindexableSize(n(Bt),re),D(Yt,Bt.bytes,ie,ee.bytes,re),ee)}function C(Bt,Yt){var Zt,ee,ie,re,se,ne,ae,oe,ue,le;return oe=i(Bt),ue=i(Yt),se=n(Bt),ue>=oe?(re=Bt,ee=oe,le=Yt,ae=ue):(re=Yt,ee=ue,le=Bt,ae=oe),Zt=te.instantiateClassindexableSize(se,ae),ie=function gt(Bt,Yt,Zt,te,ee){var ie,re,se;for(se=0,re=Yt-1,ie=0;re>=ie;ie++)se=(se>>>8)+Bt[ie]+Zt[ie],ee[ie]=255&se;for(re=te-1,ie=Yt;re>=ie;ie++)se=(se>>>8)+Zt[ie],ee[ie]=255&se;return se>>>8}(re.bytes,ee,le.bytes,ae,Zt.bytes),ie>0&&(ne=te.instantiateClassindexableSize(se,ae+1),q(Zt.bytes,ne.bytes,ae),(Zt=ne).bytes[ae]=ie),Zt}function p(Bt,Yt,ee){var se,ne,ae,oe,ue,le,ce,fe,he;if("number"==typeof Bt){if(0>Bt)return te.primitiveFail();ae=t(Bt)}else{if(n(Bt)===te.classLargeNegativeInteger())return te.primitiveFail();ae=Bt}if("number"==typeof Yt){if(0>Yt)return te.primitiveFail();oe=t(Yt)}else{if(n(Yt)===te.classLargeNegativeInteger())return te.primitiveFail();oe=Yt}return ce=i(ae),(fe=i(oe))>ce?(se=ce,ne=ae,ue=fe,le=oe):(se=fe,ne=oe,ue=ce,le=ae),he=te.instantiateClassindexableSize(te.classLargePositiveInteger(),ue),function T(Bt,Yt,ee,se,ne,ae){var oe,ue;if(ue=ee-1,Bt===Zt){for(oe=0;ue>=oe;oe++)ae[oe]=Yt[oe]&se[oe];for(ue=ne-1,oe=ee;ue>=oe;oe++)ae[oe]=0;return 0}if(Bt===ie){for(oe=0;ue>=oe;oe++)ae[oe]=Yt[oe]|se[oe];for(ue=ne-1,oe=ee;ue>=oe;oe++)ae[oe]=se[oe];return 0}if(Bt===re){for(oe=0;ue>=oe;oe++)ae[oe]=Yt[oe]^se[oe];for(ue=ne-1,oe=ee;ue>=oe;oe++)ae[oe]=se[oe];return 0}return te.primitiveFail()}(ee,ne.bytes,se,le.bytes,ue,he.bytes),te.failed()?0:l(he)}function j(Bt,Yt){var Zt,te;return te=i(Bt),(Zt=i(Yt))!==te?Zt>te?-1:1:V(Bt.bytes,Yt.bytes,te)}function x(Bt,Yt,Zt){var ee,ie,re,se,ne,ae,oe,ue,le;return le=i(Bt),ue=i(Yt),ee=Zt?te.classLargeNegativeInteger():te.classLargePositiveInteger(),0>=(oe=le-ue+1)?(ie=te.instantiateClassindexableSize(te.classArray(),2),te.stObjectatput(ie,1,0),te.stObjectatput(ie,2,Bt),ie):(se=A(se=h(Yt,ae=8-I(s(Yt,ue))),a(se)+1),a(re=h(Bt,ae))===le&&(re=A(re,le+1)),ne=te.instantiateClassindexableSize(ee,oe),mt(se.bytes,a(se),re.bytes,a(re),ne.bytes,a(ne)),re=d(re,ae,a(se)-1),ie=te.instantiateClassindexableSize(te.classArray(),2),te.stObjectatput(ie,1,ne),te.stObjectatput(ie,2,re),ie)}function a(Bt){return"number"==typeof Bt?b(Bt):i(Bt)}function W(Bt,Yt,Zt,ee){var ie,re,se,ne;return se=i(Bt),ne=i(Yt),(re=i(Zt))>=se&&re>=ne&&ee>=0&&255>=ee?(ie=te.instantiateClassindexableSize(te.classLargePositiveInteger(),re),function R(Bt,Yt,Zt,te,ee,ie,re,se){var ne,ae,oe,ue,le,ce,fe,he;for(ce=Yt-1,le=te-1,ue=ie-1,oe=0,ae=0;ce>=ae;ae++){for(he=se[0]+Bt[ae]*Zt[0],he+=(fe=he*re&255)*ee[0],ne=1;le>=ne;ne++)he=(he>>>8)+se[ne]+Bt[ae]*Zt[ne]+fe*ee[ne],se[ne-1]=255&he;for(ne=te;ue>=ne;ne++)he=(he>>>8)+se[ne]+fe*ee[ne],se[ne-1]=255&he;he=(he>>>8)+oe,se[ue]=255&he,oe=he>>>8}for(ae=Yt;ue>=ae;ae++){for(he=se[0],he+=(fe=he*re&255)*ee[0],ne=1;ue>=ne;ne++)he=(he>>>8)+se[ne]+fe*ee[ne],se[ne-1]=255&he;he=(he>>>8)+oe,se[ue]=255&he,oe=he>>>8}if(0!==oe||1!==V(ee,se,ie))for(he=0,ae=0;ue>=ae;ae++)he=he+se[ae]-ee[ae],se[ae]=255&he,he>>=8}(Bt.bytes,se,Yt.bytes,ne,Zt.bytes,re,ee,ie.bytes),l(ie)):te.primitiveFail()}function B(Bt,Yt,Zt){var ee,ie,re,se,ne,ae,oe,ue;return ue=i(Bt),(oe=i(Yt))>=ue?(se=Bt,re=ue,ee=Yt,ne=oe):(se=Yt,re=oe,ee=Bt,ne=ue),ie=Zt?te.classLargeNegativeInteger():te.classLargePositiveInteger(),ae=te.instantiateClassindexableSize(ie,ne+re),function L(Bt,Yt,Zt,te,ee){var ie,re,se,ne,ae,oe,ue,le;if(1===Yt&&0===Bt[0])return 0;if(1===te&&0===Zt[0])return 0;for(le=Yt-1,oe=te-1,ae=0;le>=ae;ae++)if(0!==(se=Bt[ae])){for(ue=ae,ne=0,re=0;oe>=re;re++)ne=(ie=(ie=Zt[re])*se+ne+ee[ue])>>>8,ee[ue]=255&ie,++ue;ee[ue]=ne}return 0}(se.bytes,re,ee.bytes,ne,ae.bytes),f(ae)}function r(Bt,Yt){return Yt>i(Bt)?0:s(Bt,Yt)}function M(Bt,Yt){var Zt,ee,ie,re,se,ne,ae,oe,ue,le;if(ae=n(Bt)===te.classLargeNegativeInteger(),(oe=i(Bt))===(ue=i(Yt))){for(;oe>1&&r(Bt,oe)===r(Yt,oe);)--oe;ue=oe}return ue>oe||oe===ue&&r(Bt,oe)<r(Yt,oe)?(ee=Yt,ne=ue,re=Bt,Zt=oe,le=!1===ae):(ee=Bt,ne=oe,re=Yt,Zt=ue,le=ae),se=ne,ie=te.instantiateClassindexableSize(le?te.classLargeNegativeInteger():te.classLargePositiveInteger(),se),function it(Bt,Yt,Zt,te,ee){var ie,re;for(re=0,ie=0;Yt-1>=ie;ie++)re=re+Zt[ie]-Bt[ie],ee[ie]=255&re,re>>=8;for(ie=Yt;te-1>=ie;ie++)re+=Zt[ie],ee[ie]=255&re,re>>=8}(re.bytes,Zt,ee.bytes,ne,ie.bytes),le?y(ie):l(ie)}function k(){return ee}function St(Bt){return g(Bt.bytes,i(Bt))}function _(Bt){var Yt,Zt,ee;if("number"==typeof Bt)return!0;if(0===(Zt=a(Bt)))return!1;if(0===s(Bt,Zt))return!1;if(4,Zt>4)return!0;if(4>Zt)return!1;if(n(Bt)===te.classLargePositiveInteger())return 1073741823,s(Bt,4)>o(1073741823,4);if(ee=-1073741824,s(Bt,4)<o(ee,4))return!1;for(Yt=1;4>=Yt;Yt++)if(s(Bt,Yt)!==o(ee,Yt))return!0;return!1}function f(Bt){return n(Bt)===te.classLargePositiveInteger()?l(Bt):y(Bt)}function y(Bt){var Yt,Zt,te,ee,ie;for(Zt=ee=a(Bt);0!==Zt&&0===s(Bt,Zt);)--Zt;if(0===Zt)return 0;if(4,4>=Zt){if(te=-1073741824,4>Zt||r(Bt,4)<o(te,4)){for(ie=0,Yt=Zt;Yt>=1;Yt+=-1)ie=256*ie-s(Bt,Yt);return ie}for(Yt=1;4>=Yt;Yt++)if(r(Bt,Yt)!==o(te,Yt))return ee>Zt?v(Bt,Zt):Bt;return te}return ee>Zt?v(Bt,Zt):Bt}function l(Bt){var Yt,Zt,te,ee;for(Zt=ee=a(Bt);0!==Zt&&0===s(Bt,Zt);)--Zt;if(0===Zt)return 0;if(4,4>=Zt&&r(Bt,4)<=o(1073741823,4)){for(te=0,Yt=Zt;Yt>=1;Yt+=-1)te=256*te+s(Bt,Yt);return te}return ee>Zt?v(Bt,Zt):Bt}function s(Bt,Yt){return Bt.bytes[Yt-1]}var Bt=1,Yt=11,Zt=0,te=null,ee="LargeIntegers v1.5 (e)",ie=1,re=2;Squeak.registerExternalModule("LargeIntegers",{primDigitAddWith:function H(){var Bt,Yt,Zt;return te.success(te.isKindOfInteger(te.stackValue(1))),Bt=te.stackValue(1),te.success(te.isKindOfInteger(te.stackValue(0))),Yt=te.stackValue(0),te.failed()||(Zt=C("number"==typeof Bt?t(Bt):Bt,"number"==typeof Yt?t(Yt):Yt),te.failed()||te.popthenPush(3,Zt)),null},primDigitBitShiftMagnitude:function $(){var Bt,Yt,Zt,ee;return Zt=te.stackIntegerValue(0),te.success(te.isKindOfInteger(te.stackValue(1))),Yt=te.stackValue(1),te.failed()?null:(Bt="number"==typeof Yt?t(Yt):Yt,Zt>=0?(ee=h(Bt,Zt),te.failed()||te.popthenPush(2,ee),null):(ee=f(d(Bt,0-Zt,i(Bt))),te.failed()||te.popthenPush(2,ee),null))},primGetModuleName:function lt(){var Bt,Yt,Zt,ee;for(Yt=strlen(k()),Bt=(ee=te.instantiateClassindexableSize(te.classString(),Yt)).bytes,Zt=0;Yt-1>=Zt;Zt++)Bt[Zt]=k()[Zt];return te.failed()||te.popthenPush(1,ee),null},primDigitBitLogicWithOp:function Y(){var Bt,Yt,Zt,ee;return te.success(te.isKindOfInteger(te.stackValue(2))),Bt=te.stackValue(2),te.success(te.isKindOfInteger(te.stackValue(1))),Yt=te.stackValue(1),Zt=te.stackIntegerValue(0),te.failed()||(ee=p(Bt,Yt,Zt),te.failed()||te.popthenPush(4,ee)),null},primCheckIfCModuleExists:function G(){var Bt;return Bt=te.trueObject(),te.failed()||te.popthenPush(1,Bt),null},primDigitCompare:function tt(){var Bt,Yt,Zt,ee,ie;return te.success(te.isKindOfInteger(te.stackValue(0))),ee=te.stackValue(0),te.success(te.isKindOfInteger(te.stackValue(1))),Yt=te.stackValue(1),te.failed()?null:"number"==typeof Yt?"number"==typeof ee?(Bt=Yt)>(Zt=ee)?(ie=1,te.failed()||te.popthenPush(2,ie),null):Zt>Bt?(ie=-1,te.failed()||te.popthenPush(2,ie),null):(ie=0,te.failed()||te.popthenPush(2,ie),null):(ie=-1,te.failed()||te.popthenPush(2,ie),null):"number"==typeof ee?(ie=1,te.failed()||te.popthenPush(2,ie),null):(ie=j(Yt,ee),te.failed()||te.popthenPush(2,ie),null)},primDigitMultiplyNegative:function nt(){var Bt,Yt,Zt,ee;return te.success(te.isKindOfInteger(te.stackValue(1))),Yt=te.stackValue(1),Zt=te.booleanValueOf(te.stackValue(0)),te.success(te.isKindOfInteger(te.stackValue(2))),Bt=te.stackValue(2),te.failed()||(ee=B("number"==typeof Bt?t(Bt):Bt,"number"==typeof Yt?t(Yt):Yt,Zt),te.failed()||te.popthenPush(3,ee)),null},primDigitBitShift:function Q(){var Bt,Yt,Zt,ee;return Zt=te.stackIntegerValue(0),te.success(te.isKindOfInteger(te.stackValue(1))),Yt=te.stackValue(1),te.failed()?null:(Bt="number"==typeof Yt?t(Yt):Yt,Zt>=0?(ee=h(Bt,Zt),te.failed()||te.popthenPush(2,ee),null):(ee=f(d(Bt,0-Zt,i(Bt))),te.failed()||te.popthenPush(2,ee),null))},primNormalizePositive:function pt(){var Bt,Yt;return te.success(te.stackValue(0).sqClass===te.classLargePositiveInteger()),Bt=te.stackValue(0),te.failed()||(Yt=l(Bt),te.failed()||te.popthenPush(1,Yt)),null},primDigitSubtractWith:function ut(){var Bt,Yt,Zt;return te.success(te.isKindOfInteger(te.stackValue(1))),Bt=te.stackValue(1),te.success(te.isKindOfInteger(te.stackValue(0))),Yt=te.stackValue(0),te.failed()||(Zt=M("number"==typeof Bt?t(Bt):Bt,"number"==typeof Yt?t(Yt):Yt),te.failed()||te.popthenPush(3,Zt)),null},_primDigitBitShift:function U(){var Bt,Yt,Zt,ee;return te.success(te.isKindOfInteger(te.stackValue(1))),Yt=te.stackValue(1),Zt=te.stackIntegerValue(0),te.failed()?null:(Bt="number"==typeof Yt?t(Yt):Yt,Zt>=0?(ee=h(Bt,Zt),te.failed()||te.popthenPush(3,ee),null):(ee=f(d(Bt,0-Zt,i(Bt))),te.failed()||te.popthenPush(3,ee),null))},primDigitMultiplyWithNegative:function at(){var Bt,Yt,Zt,ee;return te.success(te.isKindOfInteger(te.stackValue(2))),Bt=te.stackValue(2),te.success(te.isKindOfInteger(te.stackValue(1))),Yt=te.stackValue(1),Zt=te.booleanValueOf(te.stackValue(0)),te.failed()||(ee=B("number"==typeof Bt?t(Bt):Bt,"number"==typeof Yt?t(Yt):Yt,Zt),te.failed()||te.popthenPush(4,ee)),null},primDigitSubtract:function ot(){var Bt,Yt,Zt;return te.success(te.isKindOfInteger(te.stackValue(0))),Yt=te.stackValue(0),te.success(te.isKindOfInteger(te.stackValue(1))),Bt=te.stackValue(1),te.failed()||(Zt=M("number"==typeof Bt?t(Bt):Bt,"number"==typeof Yt?t(Yt):Yt),te.failed()||te.popthenPush(2,Zt)),null},primDigitDivNegative:function rt(){var Bt,Yt,Zt,ee,ie,re;if(te.success(te.isKindOfInteger(te.stackValue(1))),ee=te.stackValue(1),ie=te.booleanValueOf(te.stackValue(0)),te.success(te.isKindOfInteger(te.stackValue(2))),Yt=te.stackValue(2),te.failed())return null;if(!_(Yt))return te.primitiveFail(),null;if(!_(ee))return te.primitiveFail(),null;if(Bt="number"==typeof Yt?t(Yt):Yt,"number"==typeof ee){if(0===ee)return te.primitiveFail(),null;Zt=t(ee)}else Zt=ee;return re=x(Bt,Zt,ie),te.failed()||te.popthenPush(3,re),null},primNormalizeNegative:function ht(){var Bt,Yt;return te.success(te.stackValue(0).sqClass===te.classLargeNegativeInteger()),Bt=te.stackValue(0),te.failed()||(Yt=y(Bt),te.failed()||te.popthenPush(1,Yt)),null},primDigitBitOr:function Z(){var Bt,Yt,Zt;return te.success(te.isKindOfInteger(te.stackValue(0))),Yt=te.stackValue(0),te.success(te.isKindOfInteger(te.stackValue(1))),Bt=te.stackValue(1),te.failed()||(Zt=p(Bt,Yt,ie),te.failed()||te.popthenPush(2,Zt)),null},primMontgomeryTimesModulo:function ct(){var Bt,Yt,Zt,ee,ie;return te.success(te.isKindOfInteger(te.stackValue(2))),Yt=te.stackValue(2),te.success(te.isKindOfInteger(te.stackValue(1))),Zt=te.stackValue(1),ee=te.stackIntegerValue(0),te.success(te.isKindOfInteger(te.stackValue(3))),Bt=te.stackValue(3),te.failed()||(ie=W("number"==typeof Bt?t(Bt):Bt,"number"==typeof Yt?t(Yt):Yt,"number"==typeof Zt?t(Zt):Zt,ee),te.failed()||te.popthenPush(4,ie)),null},primDigitBitAnd:function X(){var Bt,Yt,ee;return te.success(te.isKindOfInteger(te.stackValue(0))),Yt=te.stackValue(0),te.success(te.isKindOfInteger(te.stackValue(1))),Bt=te.stackValue(1),te.failed()||(ee=p(Bt,Yt,Zt),te.failed()||te.popthenPush(2,ee)),null},primDigitDivWithNegative:function st(){var Bt,Yt,Zt,ee,ie,re;if(te.success(te.isKindOfInteger(te.stackValue(2))),Zt=te.stackValue(2),te.success(te.isKindOfInteger(te.stackValue(1))),ee=te.stackValue(1),ie=te.booleanValueOf(te.stackValue(0)),te.failed())return null;if(Bt="number"==typeof Zt?t(Zt):Zt,"number"==typeof ee){if(0===ee)return te.primitiveFail(),null;Yt=t(ee)}else Yt=ee;return re=x(Bt,Yt,ie),te.failed()||te.popthenPush(4,re),null},setInterpreter:function dt(Zt){return!1!==((te=Zt).majorVersion()==Bt)&&te.minorVersion()>=Yt},primNormalize:function ft(){var Bt,Yt;return te.success(te.isKindOfInteger(te.stackValue(0))),Bt=te.stackValue(0),te.failed()?null:"number"==typeof Bt?(te.failed()||te.popthenPush(2,Bt),null):(Yt=f(Bt),te.failed()||te.popthenPush(2,Yt),null)},primDigitBitXor:function et(){var Bt,Yt,Zt;return te.success(te.isKindOfInteger(te.stackValue(0))),Yt=te.stackValue(0),te.success(te.isKindOfInteger(te.stackValue(1))),Bt=te.stackValue(1),te.failed()||(Zt=p(Bt,Yt,re),te.failed()||te.popthenPush(2,Zt)),null},primDigitCompareWith:function N(){var Bt,Yt,Zt,ee,ie;return te.success(te.isKindOfInteger(te.stackValue(1))),Zt=te.stackValue(1),te.success(te.isKindOfInteger(te.stackValue(0))),ee=te.stackValue(0),te.failed()?null:"number"==typeof Zt?"number"==typeof ee?(Bt=Zt)>(Yt=ee)?(ie=1,te.failed()||te.popthenPush(3,ie),null):Yt>Bt?(ie=-1,te.failed()||te.popthenPush(3,ie),null):(ie=0,te.failed()||te.popthenPush(3,ie),null):(ie=-1,te.failed()||te.popthenPush(3,ie),null):"number"==typeof ee?(ie=1,te.failed()||te.popthenPush(3,ie),null):(ie=j(Zt,ee),te.failed()||te.popthenPush(3,ie),null)},primDigitAdd:function J(){var Bt,Yt,Zt;return te.success(te.isKindOfInteger(te.stackValue(0))),Yt=te.stackValue(0),te.success(te.isKindOfInteger(te.stackValue(1))),Bt=te.stackValue(1),te.failed()||(Zt=C("number"==typeof Bt?t(Bt):Bt,"number"==typeof Yt?t(Yt):Yt),te.failed()||te.popthenPush(2,Zt)),null},getModuleName:k,primAsLargeInteger:function z(){var Bt,Yt;return te.success(te.isKindOfInteger(te.stackValue(0))),Bt=te.stackValue(0),te.failed()?null:"number"==typeof Bt?(Yt=t(Bt),te.failed()||te.popthenPush(2,Yt),null):(te.failed()||te.popthenPush(2,Bt),null)},primAnyBitFromTo:function K(){var Bt,Yt,Zt,ee;return Yt=te.stackIntegerValue(1),Zt=te.stackIntegerValue(0),te.success(te.isKindOfInteger(te.stackValue(2))),Bt=te.stackValue(2),te.failed()||(ee=Ft("number"==typeof Bt?t(Bt):Bt,Yt,Zt)?te.trueObject():te.falseObject(),te.failed()||te.popthenPush(3,ee)),null}})})),module("users.bert.SqueakJS.plugins.Matrix2x3Plugin").requires("users.bert.SqueakJS.vm").toRun((function(){function u(Bt){return"number"==typeof Bt?Zt.classSmallInteger():Bt.sqClass}function f(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function n(Bt){return Zt.failed()?null:Zt.isWords(Bt)&&6===f(Bt)?Bt.wordsAsFloat32Array():(Zt.primitiveFail(),null)}function a(Bt){var Yt,ie;return Zt.failed()?null:u(Bt)!==Zt.classPoint()?Zt.primitiveFail():(Yt="number"==typeof(ie=Zt.fetchPointerofObject(0,Bt)))||ie.isFloat?(te=Yt?ie:Zt.floatValueOf(ie),(Yt="number"==typeof(ie=Zt.fetchPointerofObject(1,Bt)))||ie.isFloat?void(ee=Yt?ie:Zt.floatValueOf(ie)):Zt.primitiveFail()):Zt.primitiveFail()}function l(Bt){var Yt,se,ne,ae,oe;return ae=te-Bt[2],oe=ee-Bt[5],0===(Yt=Bt[0]*Bt[4]-Bt[1]*Bt[3])?Zt.primitiveFail():(Yt=1/Yt,se=ae*Bt[4]-Bt[1]*oe,ne=Bt[0]*oe-ae*Bt[3],ie=se*Yt,void(re=ne*Yt))}function c(Bt){ie=te*Bt[0]+ee*Bt[1]+Bt[2],re=te*Bt[3]+ee*Bt[4]+Bt[5]}function o(Bt){return Bt>=-1073741824&&1073741823>=ie}function p(Bt){return re+=.5,o(ie+=.5)&&o(re)?void Zt.popthenPush(Bt,Zt.makePointwithxValueyValue(0|ie,0|re)):Zt.primitiveFail()}function h(Bt,Yt,te,ee,ie){var re,se,ne,ae,oe,ue,le;return o(ae=Yt+.5)?o(se=ee+.5)?o(oe=te+.5)?o(ne=ie+.5)?(Zt.pushRemappableOop(Bt),ue=Zt.makePointwithxValueyValue(0|ae,0|oe),Zt.pushRemappableOop(ue),re=Zt.makePointwithxValueyValue(0|se,0|ne),ue=Zt.popRemappableOop(),le=Zt.popRemappableOop(),Zt.storePointerofObjectwithValue(0,le,ue),Zt.storePointerofObjectwithValue(1,le,re),le):Zt.primitiveFail():Zt.primitiveFail():Zt.primitiveFail():Zt.primitiveFail()}var Bt=1,Yt=11,Zt=null,te=0,ee=0,ie=0,re=0,se="Matrix2x3Plugin 3 November 2014 (e)";Squeak.registerExternalModule("Matrix2x3Plugin",{primitiveInvertPoint:function S(){var Bt;return a(Zt.stackObjectValue(0)),Bt=n(Zt.stackObjectValue(1)),Zt.failed()?null:(l(Bt),void(Zt.failed()||p(2)))},primitiveInvertRectInto:function O(){var Bt,Yt,se,ne,ae,oe,ue,le,ce,fe,he;return se=Zt.stackObjectValue(0),he=Zt.stackObjectValue(1),ne=n(Zt.stackObjectValue(2)),Zt.failed()?null:u(he)!==u(se)?Zt.primitiveFail():Zt.isPointers(he)?2!==f(he)?Zt.primitiveFail():(a(Zt.fetchPointerofObject(0,he)),Zt.failed()?null:(ce=te,fe=ee,l(ne),ue=ae=ie,le=oe=re,a(Zt.fetchPointerofObject(1,he)),Zt.failed()?null:(Bt=te,Yt=ee,l(ne),ue=Math.min(ue,ie),ae=Math.max(ae,ie),le=Math.min(le,re),oe=Math.max(oe,re),te=Bt,ee=fe,l(ne),ue=Math.min(ue,ie),ae=Math.max(ae,ie),le=Math.min(le,re),oe=Math.max(oe,re),te=ce,ee=Yt,l(ne),ue=Math.min(ue,ie),ae=Math.max(ae,ie),le=Math.min(le,re),oe=Math.max(oe,re),Zt.failed()||(se=h(se,ue,le,ae,oe)),void(Zt.failed()||Zt.popthenPush(3,se))))):Zt.primitiveFail()},primitiveIsIdentity:function I(){var Bt;return Bt=n(Zt.stackObjectValue(0)),Zt.failed()?null:(Zt.pop(1),void Zt.pushBool(1===Bt[0]&&0===Bt[1]&&0===Bt[2]&&0===Bt[3]&&1===Bt[4]&&0===Bt[5]))},primitiveComposeMatrix:function F(){var Bt,Yt,te,ee;return te=n(ee=Zt.stackObjectValue(0)),Yt=n(Zt.stackObjectValue(1)),Bt=n(Zt.stackObjectValue(2)),Zt.failed()?null:(function k(Bt,Yt,Zt){var te,ee,ie,re,se,ne;te=Bt[0]*Yt[0]+Bt[1]*Yt[3],ee=Bt[0]*Yt[1]+Bt[1]*Yt[4],ie=Bt[0]*Yt[2]+Bt[1]*Yt[5]+Bt[2],re=Bt[3]*Yt[0]+Bt[4]*Yt[3],se=Bt[3]*Yt[1]+Bt[4]*Yt[4],ne=Bt[3]*Yt[2]+Bt[4]*Yt[5]+Bt[5],Zt[0]=te,Zt[1]=ee,Zt[2]=ie,Zt[3]=re,Zt[4]=se,Zt[5]=ne}(Bt,Yt,te),void Zt.popthenPush(3,ee))},setInterpreter:function g(te){return!1!==((Zt=te).majorVersion()==Bt)&&Zt.minorVersion()>=Yt},primitiveTransformRectInto:function m(){var Bt,Yt,se,ne,ae,oe,ue,le,ce,fe,he;return se=Zt.stackObjectValue(0),he=Zt.stackObjectValue(1),ne=n(Zt.stackObjectValue(2)),Zt.failed()?null:u(he)!==u(se)?Zt.primitiveFail():Zt.isPointers(he)?2!==f(he)?Zt.primitiveFail():(a(Zt.fetchPointerofObject(0,he)),Zt.failed()?null:(ce=te,fe=ee,c(ne),ue=ae=ie,le=oe=re,a(Zt.fetchPointerofObject(1,he)),Zt.failed()?null:(Bt=te,Yt=ee,c(ne),ue=Math.min(ue,ie),ae=Math.max(ae,ie),le=Math.min(le,re),oe=Math.max(oe,re),te=Bt,ee=fe,c(ne),ue=Math.min(ue,ie),ae=Math.max(ae,ie),le=Math.min(le,re),oe=Math.max(oe,re),te=ce,ee=Yt,c(ne),ue=Math.min(ue,ie),ae=Math.max(ae,ie),se=h(se,ue,le=Math.min(le,re),ae,oe=Math.max(oe,re)),void(Zt.failed()||Zt.popthenPush(3,se))))):Zt.primitiveFail()},primitiveIsPureTranslation:function P(){var Bt;return Bt=n(Zt.stackObjectValue(0)),Zt.failed()?null:(Zt.pop(1),void Zt.pushBool(1===Bt[0]&&0===Bt[1]&&0===Bt[3]&&1===Bt[4]))},getModuleName:function v(){return se},primitiveTransformPoint:function d(){var Bt;return a(Zt.stackObjectValue(0)),Bt=n(Zt.stackObjectValue(1)),Zt.failed()?null:(c(Bt),void p(2))}})})),module("users.bert.SqueakJS.plugins.MiscPrimitivePlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function c(Bt,Yt){return Bt-function g(Bt,Yt){return 0|Math.floor(Bt/Yt)}(Bt,Yt)*Yt|0}function s(Bt,Yt){return Yt>31?0:Bt>>>Yt}function i(Bt,Yt,Zt){var te;for(te=0;3>=te;te++)Yt[Zt+te-1]=255&s(Bt,8*(3-te));return Zt+4}function t(Bt,Yt,Zt){return 223>=Bt?(Yt[Zt-1]=Bt,Zt+1):7935>=Bt?(Yt[Zt-1]=224+(Bt>>8),Yt[Zt]=c(Bt,256),Zt+2):(Yt[Zt-1]=255,i(Bt,Yt,Zt+1))}var Bt=1,Yt=11,Zt=null,te="MiscPrimitivePlugin 3 November 2014 (e)";Squeak.registerExternalModule("MiscPrimitivePlugin",{primitiveConvert8BitSigned:function u(){var Bt,Yt,te,ee,ie;if(Zt.stackValue(2),Bt=Zt.stackBytes(1),Yt=Zt.stackUint16Array(0),Zt.failed())return null;for(ee=Bt.length,te=1;ee>=te;te++)ie=Bt[te-1],Yt[te-1]=ie>127?ie-256<<8:ie<<8;return Zt.failed()?null:void Zt.pop(2)},primitiveCompareString:function a(){var Bt,Yt,te,ee,ie,re,se,ne;if(Zt.stackValue(3),Bt=Zt.stackBytes(2),Yt=Zt.stackBytes(1),te=Zt.stackBytes(0),Zt.failed())return null;for(se=Bt.length,ne=Yt.length,re=1;re<=Math.min(se,ne);re++)if((ee=te[Bt[re-1]])!==(ie=te[Yt[re-1]]))return ie>ee?(Zt.failed()||Zt.popthenPush(4,1),null):(Zt.failed()||Zt.popthenPush(4,3),null);return se===ne?(Zt.failed()||Zt.popthenPush(4,2),null):ne>se?(Zt.failed()||Zt.popthenPush(4,1),null):(Zt.failed()||Zt.popthenPush(4,3),null)},primitiveTranslateStringWithTable:function d(){var Bt,Yt,te,ee,ie;if(Zt.stackValue(4),Bt=Zt.stackBytes(3),Yt=Zt.stackIntegerValue(2),te=Zt.stackIntegerValue(1),ee=Zt.stackBytes(0),Zt.failed())return null;for(ie=Yt;te>=ie;ie++)Bt[ie-1]=ee[Bt[ie-1]];return Zt.failed()?null:void Zt.pop(4)},primitiveStringHash:function p(){var Bt,Yt,te,ee,ie,re;if(Zt.stackValue(2),Bt=Zt.stackBytes(1),Yt=Zt.stackIntegerValue(0),Zt.failed())return null;for(te=Bt.length,ee=268435455&Yt,re=1;te>=re;re++)ee=9741*(ie=16383&(ee+=Bt[re-1]))+16384*(9741*(ee>>>14)+101*ie&16383)&268435455;return Zt.failed()||Zt.popthenPush(3,ee),null},primitiveCompressToByteArray:function o(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe;if(Zt.stackValue(2),Bt=Zt.stackInt32Array(1),Yt=Zt.stackBytes(0),Zt.failed())return null;for(ee=t(ae=Bt.length,Yt,1),re=1;ae>=re;){for(te=((oe=Bt[re-1])>>>8&255)===(se=255&oe)&&(oe>>>16&255)===se&&(oe>>>24&255)===se,ie=re;ae>ie&&oe===Bt[ie];)++ie;if(ie>re)te?(Yt[(ee=t(4*(ie-re+1)+1,Yt,ee))-1]=se,++ee):ee=i(oe,Yt,ee=t(4*(ie-re+1)+2,Yt,ee)),re=ie+1;else if(te)Yt[(ee=t(5,Yt,ee))-1]=se,++ee,++re;else{for(;ae>ie&&Bt[ie-1]!==Bt[ie];)++ie;for(ie===ae&&++ie,ee=t(4*(ie-re)+3,Yt,ee),ne=re;ie-1>=ne;ne++)ee=i(Bt[ne-1],Yt,ee);re=ie}}return Zt.failed()||Zt.popthenPush(3,ee-1),null},primitiveFindSubstring:function f(){var Bt,Yt,te,ee,ie,re;if(Zt.stackValue(4),Bt=Zt.stackBytes(3),Yt=Zt.stackBytes(2),te=Zt.stackIntegerValue(1),ee=Zt.stackBytes(0),Zt.failed())return null;if(0===Bt.length)return Zt.failed()||Zt.popthenPush(5,0),null;for(re=te;re<=Yt.length-Bt.length+1;re++)for(ie=1;ee[Yt[re+ie-1-1]]===ee[Bt[ie-1]];){if(ie===Bt.length)return Zt.failed()||Zt.popthenPush(5,re),null;++ie}return Zt.failed()||Zt.popthenPush(5,0),null},primitiveIndexOfAsciiInString:function h(){var Bt,Yt,te,ee,ie;if(Zt.stackValue(3),Bt=Zt.stackIntegerValue(2),Yt=Zt.stackBytes(1),te=Zt.stackIntegerValue(0),Zt.failed())return null;for(ie=Yt.length,ee=te;ie>=ee;ee++)if(Yt[ee-1]===Bt)return Zt.failed()||Zt.popthenPush(4,ee),null;return Zt.failed()||Zt.popthenPush(4,0),null},setInterpreter:function m(te){return!1!==((Zt=te).majorVersion()==Bt)&&Zt.minorVersion()>=Yt},primitiveDecompressFromByteArray:function l(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce;if(Zt.stackValue(3),Bt=Zt.stackInt32Array(2),Yt=Zt.stackBytes(1),te=Zt.stackIntegerValue(0),Zt.failed())return null;for(ne=te,se=Yt.length,oe=1,ce=Bt.length+1;se>=ne;){if(ee=Yt[ne-1],++ne,!(223>=ee))if(254>=ee)ee=256*(ee-224)+Yt[ne-1],++ne;else for(ee=0,ae=1;4>=ae;ae++)ee=(ee<<8)+Yt[ne-1],++ne;if(oe+(le=ee>>>2)>ce)return Zt.primitiveFail(),null;if(1===(ie=3&ee))for(re=Yt[ne-1],++ne,re|=re<<8,re|=re<<16,ae=1;le>=ae;ae++)Bt[oe-1]=re,++oe;if(2===ie){for(re=0,ae=1;4>=ae;ae++)re=re<<8|Yt[ne-1],++ne;for(ae=1;le>=ae;ae++)Bt[oe-1]=re,++oe}if(3===ie)for(ue=1;le>=ue;ue++){for(re=0,ae=1;4>=ae;ae++)re=re<<8|Yt[ne-1],++ne;Bt[oe-1]=re,++oe}}return Zt.failed()?null:void Zt.pop(3)},getModuleName:function n(){return te},primitiveFindFirstInString:function r(){var Bt,Yt,te,ee,ie;if(Zt.stackValue(3),Bt=Zt.stackBytes(2),Yt=Zt.stackBytes(1),te=Zt.stackIntegerValue(0),Zt.failed())return null;if(256!==Yt.length)return Zt.failed()||Zt.popthenPush(4,0),null;for(ee=te,ie=Bt.length;ie>=ee&&0===Yt[Bt[ee-1]];)++ee;return ee>ie?(Zt.failed()||Zt.popthenPush(4,0),null):(Zt.failed()||Zt.popthenPush(4,ee),null)}})})),module("users.bert.SqueakJS.plugins.ScratchPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function r(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function t(Bt,Yt){return 0|Math.floor(Bt/Yt)}function s(Bt,Yt){return Bt-t(Bt,Yt)*Yt|0}function n(Bt,Yt,Zt,te,ee){var ie,re,se,ne,ae,oe,ue;return re=t(Zt,60),ne=(1e3-te)*ee,ae=(1e3-t(te*(ie=s(Zt,60)),60))*ee,oe=(1e3-t(te*(60-ie),60))*ee,ue=t(1e3*ee,3922),ne=t(ne,3922),ae=t(ae,3922),oe=t(oe,3922),0===re&&(se=(ue<<16)+(oe<<8)+ne),1===re&&(se=(ae<<16)+(ue<<8)+ne),2===re&&(se=(ne<<16)+(ue<<8)+oe),3===re&&(se=(ne<<16)+(ae<<8)+ue),4===re&&(se=(oe<<16)+(ne<<8)+ue),5===re&&(se=(ue<<16)+(ne<<8)+ae),0===se&&(se=1),Bt[Yt]=se,0}function l(Bt){return Zt.success(Zt.isWordsOrBytes(Bt)),Zt.failed()?0:Bt.wordsAsFloat64Array()}function i(Bt){return Zt.success(Zt.isWords(Bt)),Zt.failed()?0:Bt.words}function a(Bt,Yt,Zt,te,ee){var ie,re;return 0===(re=ee-te)?0:0>(ie=Bt===ee?t(60*(Yt-Zt),re):Yt===ee?120+t(60*(Zt-Bt),re):240+t(60*(Bt-Yt),re))?ie+360:ie}function o(Bt,Yt,Zt){var te,ee;return 0===Bt?Yt:0===Yt?Bt:(0===(ee=((te=1024-Zt)*(Bt>>>16&255)+Zt*(Yt>>>16&255)>>10<<16)+(te*(Bt>>>8&255)+Zt*(Yt>>>8&255)>>10<<8)+(te*(255&Bt)+Zt*(255&Yt)>>10))&&(ee=1),ee)}function u(Bt,Yt,Zt,te,ee){var ie,re,se,ne,ae,oe,ue;return-1>(ne=Yt>>>10)||ne>=te?0:-1>(oe=Zt>>>10)||oe>=ee?0:(ae=1023&Yt,-1===ne&&(ne=0,ae=0),ne===te-1&&(ae=0),ue=1023&Zt,-1===oe&&(oe=0,ue=0),oe===ee-1&&(ue=0),se=16777215&Bt[re=oe*te+ne],ae>0&&(se=o(se,16777215&Bt[re+1],ae)),0===ue?se:(ie=16777215&Bt[re=(oe+1)*te+ne],ae>0&&(ie=o(ie,16777215&Bt[re+1],ae)),o(se,ie,ue)))}var Bt=1,Yt=11,Zt=null,te="ScratchPlugin 3 November 2014 (e)";Squeak.registerExternalModule("ScratchPlugin",{primitiveCondenseSound:function h(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le=0,ce=0;if(ae=Zt.stackValue(2),te=Zt.stackValue(1),ee=Zt.stackIntegerValue(0),Zt.success(Zt.isWords(ae)),Zt.success(Zt.isWords(te)),Bt=t(2*r(ae),ee),oe=2*r(te),Zt.success(oe>=Bt),Zt.failed())return null;for(ne=ae.wordsAsInt16Array(),Yt=te.wordsAsInt16Array(),ie=1;Bt>=ie;ie++){for(se=0,re=1;ee>=re;re++)0>(ue=ne[le++])&&(ue=0-ue),ue>se&&(se=ue);Yt[ce++]=se}return Zt.pop(3),0},getModuleName:function d(){return te},primitiveFisheye:function m(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke;if(ne=Zt.stackValue(3),oe=Zt.stackValue(2),me=Zt.stackIntegerValue(1),le=Zt.stackIntegerValue(0),se=i(ne),ae=i(oe),de=r(ne),Zt.success(r(oe)===de),Zt.failed())return null;for(me>>1,(re=t(de,me))>>1,Yt=me>>1,te=(re=t(de,me))>>1,fe=le/100,ve=0;me-1>=ve;ve++)for(ke=0;re-1>=ke;ke++)ee=(ve-Yt)/Yt,ie=(ke-te)/te,1>=(ce=Math.pow(Math.sqrt(ee*ee+ie*ie),fe))?(Bt=Math.atan2(ie,ee),he=1024*(Yt+ce*Math.cos(Bt)*Yt)|0,pe=1024*(te+ce*Math.sin(Bt)*te)|0):(he=1024*ve,pe=1024*ke),ue=u(se,he,pe,me,re),ae[ke*me+ve]=ue;return Zt.pop(4),0},primitiveWaterRipples1:function S(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe,Se,Oe,Ie,Ae,Pe,we,Ce,Ve,je,xe;if(ve=Zt.stackValue(5),ye=Zt.stackValue(4),Ve=Zt.stackIntegerValue(3),me=i(ve),be=i(ye),te=r(ve),Ie=Zt.stackIntegerValue(2),Bt=Zt.stackValue(1),ee=Zt.stackValue(0),Yt=l(Bt),ie=l(ee),Zt.success(r(ye)===te),Zt.failed())return null;for(pe=t(te,Ve),re=s(Math.random(),Ie)-1,Ae=0;re/2-1>=Ae;Ae++)for(je=s(Math.random(),Ve),xe=s(Math.random(),pe),Se=s(Math.random(),8),fe=-4;4>=fe;fe++)for(he=-4;4>=he;he++)25>(ne=fe*fe+he*he)&&ne>0&&(ue=xe+he|0,(ae=je+fe|0)>0&&ue>0&&pe>ue&&Ve>ae&&(Yt[ue*Ve+ae]=Se*(1-ne/25)));for(ce=1;Ve-2>=ce;ce++)for(se=1;pe-2>=se;se++)Yt[we=se*Ve+ce]=(ie[we+1]+ie[we-1]+ie[we+Ve]+ie[we-Ve]+ie[we-1-Ve]/2+ie[we-1+Ve]/2+ie[we+1-Ve]/2+ie[we+1+Ve]/2)/4-Yt[we],Yt[we]=.9*Yt[we];for(Oe=0;Ve*pe>=Oe;Oe++)Pe=ie[Oe],ie[Oe]=Yt[Oe],Yt[Oe]=Pe;for(ke=0;pe-1>=ke;ke++)for(de=0;Ve-1>=de;de++)de>1&&Ve-1>de&&ke>1&&pe-1>ke?(2>(oe=64*(Yt[Ce=ke*Ve+de]-Yt[Ce-1]+(Yt[Ce+1]-Yt[Ce])))&&(oe=-2),oe>2&&(oe=2),2>(le=(Yt[Ce]-Yt[Ce-Ve]+(Yt[Ce+Ve]-Yt[Ce]))/64)&&(le=-2),le>2&&(le=2),Fe=Ve*pe>(ge=(ke+le)*Ve+(de+oe)|0)&&ge>=0?me[ge]:me[de+ke*Ve]):Fe=me[de+ke*Ve],be[de+ke*Ve]=Fe;return Zt.pop(6),0},primitiveHalfSizeDiagonal:function k(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge;if(ne=i(Zt.stackValue(11)),oe=Zt.stackIntegerValue(10),ae=Zt.stackIntegerValue(9),ue=i(Zt.stackValue(8)),ce=Zt.stackIntegerValue(7),le=Zt.stackIntegerValue(6),me=Zt.stackIntegerValue(5),ve=Zt.stackIntegerValue(4),ie=Zt.stackIntegerValue(3),re=Zt.stackIntegerValue(2),ee=Zt.stackIntegerValue(1),Yt=Zt.stackIntegerValue(0),Zt.success(me>=0&&ve>=0),Zt.success(oe>=me+2*ee),Zt.success(ae>=ve+2*Yt),Zt.success(ie>=0&&re>=0),Zt.success(ce>=ie+ee),Zt.success(le>=re+Yt),Zt.failed())return null;for(ge=0;Yt-1>=ge;ge++)for(de=oe*(ve+2*ge)+me,te=ce*(re+ge)+ie,ke=0;ee-1>=ke;ke++)pe=(16711680&(fe=ne[de]))+(16711680&(he=ne[de+oe+1]))>>>1&16711680,se=(65280&fe)+(65280&he)>>>1&65280,Bt=(255&fe)+(255&he)>>>1,ue[te]=pe|se|Bt,de+=2,++te;return Zt.pop(12),0},primitiveScale:function F(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe,Se;if(te=Zt.stackValue(5),ee=Zt.stackIntegerValue(4),Yt=Zt.stackIntegerValue(3),ae=Zt.stackValue(2),ue=Zt.stackIntegerValue(1),ne=Zt.stackIntegerValue(0),Zt.success(r(te)===ee*Yt),Zt.success(r(ae)===ue*ne),Bt=i(te),se=i(ae),Zt.failed())return null;for(ie=re=0,Fe=t(1024*ee,ue),Se=t(1024*Yt,ne),ce=0;ne-1>=ce;ce++){for(ie=0,le=0;ue-1>=le;le++)ke=(1024-(1023&ie))*(1024-(1023&re)),ge=(1023&ie)*(1024-(1023&re)),be=(1024-(1023&ie))*(1023&re),ye=(1023&ie)*(1023&re),fe=Bt[me=(re>>>10)*ee+(ie>>>10)],he=ee-1>ie>>>10?Bt[me+1]:fe,Yt-1>re>>>10&&(me+=ee),pe=Bt[me],de=ee-1>ie>>>10?Bt[me+1]:pe,ve=0,0===fe&&(fe=he,ve+=ke),0===he&&(he=fe,ve+=ge),0===pe&&(pe=de,ve+=be),0===de&&(de=pe,ve+=ye),0===fe&&(fe=pe,he=de),0===pe&&(pe=fe,de=he),oe=0,5e5>ve&&(oe=((me=ke*(fe>>>16&255)+ge*(he>>>16&255)+be*(pe>>>16&255)+ye*(de>>>16&255))>>>20&255)<<16,oe|=((me=ke*(fe>>>8&255)+ge*(he>>>8&255)+be*(pe>>>8&255)+ye*(de>>>8&255))>>>20&255)<<8,0===(oe|=(me=ke*(255&fe)+ge*(255&he)+be*(255&pe)+ye*(255&de))>>>20&255)&&(oe=1)),se[ce*ue+le]=oe,ie+=Fe;re+=Se}return Zt.pop(6),0},primitiveDoubleSize:function p(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he;if(se=Zt.stackValue(7),ne=Zt.stackIntegerValue(6),re=Zt.stackIntegerValue(5),ue=Zt.stackValue(4),le=Zt.stackIntegerValue(3),oe=Zt.stackIntegerValue(2),Yt=Zt.stackIntegerValue(1),te=Zt.stackIntegerValue(0),ie=i(se),ae=i(ue),Zt.success(le>Yt+2*ne),Zt.success(oe>te+2*re),Zt.failed())return null;for(he=0;re-1>=he;he++)for(Bt=(te+2*he)*le+Yt,fe=0;ne-1>=fe;fe++)ce=ie[fe+he*ne],ae[ee=Bt+2*fe]=ce,ae[ee+1]=ce,ae[ee+le]=ce,ae[ee+le+1]=ce;return Zt.pop(8),0},setInterpreter:function I(te){return!1!==((Zt=te).majorVersion()==Bt)&&Zt.minorVersion()>=Yt},primitiveWhirl:function O(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe,Se;if(le=Zt.stackValue(3),fe=Zt.stackValue(2),ye=Zt.stackIntegerValue(1),re=Zt.stackIntegerValue(0),ue=i(le),ce=i(fe),ge=r(le),Zt.success(r(fe)===ge),Zt.failed())return null;for((te=(oe=t(ge,ye))>>1)>(Yt=ye>>1)?(pe=Yt,me=te/Yt,ve=1):(pe=te,me=1,ve=Yt>te?Yt/te:1),be=-3.141592653589793*re/180,de=pe*pe,Fe=0;ye-1>=Fe;Fe++)for(Se=0;oe-1>=Se;Se++)de>(ie=(se=me*(Fe-Yt))*se+(ne=ve*(Se-te))*ne)&&(Bt=be*(ae=1-Math.sqrt(ie)/pe)*ae,ke=Math.sin(Bt),he=u(ue,1024*(((ee=Math.cos(Bt))*se-ke*ne)/me+Yt)|0,1024*((ke*se+ee*ne)/ve+te)|0,ye,oe),ce[ye*Se+Fe]=he);return Zt.pop(4),0},primitiveBlur:function c(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de;if(se=Zt.stackValue(2),oe=Zt.stackValue(1),he=Zt.stackIntegerValue(0),re=i(se),ae=i(oe),fe=r(se),Zt.success(r(oe)===fe),Zt.failed())return null;for(ie=t(fe,he),de=1;ie-2>=de;de++)for(pe=1;he-2>=pe;pe++){for(ne=ce=ee=Bt=0,te=-1;1>=te;te++)for(Yt=-1;1>=Yt;Yt++)0!==(le=16777215&re[(de+te)*he+(pe+Yt)])&&(ce+=le>>>16&255,ee+=le>>>8&255,Bt+=255&le,++ne);ue=0===ne?0:(t(ce,ne)<<16)+(t(ee,ne)<<8)+t(Bt,ne),ae[de*he+pe]=ue}return Zt.pop(3),0},primitiveBrightnessShift:function f(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe;if(se=Zt.stackValue(2),ue=Zt.stackValue(1),he=Zt.stackIntegerValue(0),re=i(se),pe=r(se),oe=i(ue),Zt.success(r(ue)===pe),Zt.failed())return null;for(ie=0;pe-1>=ie;ie++)0!==(le=16777215&re[ie])&&((te=le>>>8&255)>(ne=ae=ce=le>>>16&255)&&(ne=te),(Bt=255&le)>ne&&(ne=Bt),ae>te&&(ae=te),ae>Bt&&(ae=Bt),ee=a(ce,te,Bt,ae,ne),fe=0===ne?0:t(1e3*(ne-ae),ne),Yt=t(1e3*ne,255),(Yt+=10*he)>1e3&&(Yt=1e3),0>Yt&&(Yt=0),n(oe,ie,ee,fe,Yt));return Zt.pop(3),0},primitiveHalfSizeAverage:function v(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke;if(ne=i(Zt.stackValue(11)),oe=Zt.stackIntegerValue(10),ae=Zt.stackIntegerValue(9),ue=i(Zt.stackValue(8)),ce=Zt.stackIntegerValue(7),le=Zt.stackIntegerValue(6),de=Zt.stackIntegerValue(5),me=Zt.stackIntegerValue(4),ie=Zt.stackIntegerValue(3),re=Zt.stackIntegerValue(2),ee=Zt.stackIntegerValue(1),Yt=Zt.stackIntegerValue(0),Zt.success(de>=0&&me>=0),Zt.success(oe>=de+2*ee),Zt.success(ae>=me+2*Yt),Zt.success(ie>=0&&re>=0),Zt.success(ce>=ie+ee),Zt.success(le>=re+Yt),Zt.failed())return null;for(ke=0;Yt-1>=ke;ke++)for(pe=oe*(me+2*ke)+de,te=ce*(re+ke)+ie,ve=0;ee-1>=ve;ve++)he=16711680&(fe=ne[pe]),se=65280&fe,Bt=255&fe,he+=16711680&(fe=ne[pe+1]),se+=65280&fe,Bt+=255&fe,he+=16711680&(fe=ne[pe+oe]),se+=65280&fe,Bt+=255&fe,he+=16711680&(fe=ne[pe+oe+1]),se+=65280&fe,Bt+=255&fe,ue[te]=he>>>2&16711680|se>>>2&65280|Bt>>>2,pe+=2,++te;return Zt.pop(12),0},primitiveSaturationShift:function y(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he;if(re=Zt.stackValue(2),oe=Zt.stackValue(1),fe=Zt.stackIntegerValue(0),ie=i(re),he=r(re),ae=i(oe),Zt.success(r(oe)===he),Zt.failed())return null;for(ee=0;he-1>=ee;ee++)2>(ue=16777215&ie[ee])||((te=ue>>>8&255)>(se=ne=le=ue>>>16&255)&&(se=te),(Bt=255&ue)>se&&(se=Bt),ne>te&&(ne=te),ne>Bt&&(ne=Bt),Yt=t(1e3*se,255),(ce=0===se?0:t(1e3*(se-ne),se))>0&&((ce+=10*fe)>1e3&&(ce=1e3),0>ce&&(ce=0),n(ae,ee,a(le,te,Bt,ne,se),ce,Yt)));return Zt.pop(3),0},primitiveHueShift:function g(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he;if(re=Zt.stackValue(2),oe=Zt.stackValue(1),fe=Zt.stackIntegerValue(0),ie=i(re),he=r(re),ae=i(oe),Zt.success(r(oe)===he),Zt.failed())return null;for(ee=0;he-1>=ee;ee++)0!==(ue=16777215&ie[ee])&&((te=ue>>>8&255)>(se=ne=le=ue>>>16&255)&&(se=te),(Bt=255&ue)>se&&(se=Bt),ne>te&&(ne=te),ne>Bt&&(ne=Bt),Yt=t(1e3*se,255),ce=0===se?0:t(1e3*(se-ne),se),110>Yt&&(Yt=110,ce=1e3),90>ce&&(ce=90),n(ae,ee,s((110===Yt||90===ce?0:a(le,te,Bt,ne,se))+fe+36e7,360),ce,Yt));return Zt.pop(3),0},primitiveInterpolate:function b(){var Bt,Yt,te,ee,ie,re,se;return Yt=Zt.stackValue(3),ie=Zt.stackIntegerValue(2),re=Zt.stackIntegerValue(1),se=Zt.stackIntegerValue(0),Bt=i(Yt),ee=r(Yt),Zt.failed()?null:(te=u(Bt,re,se,ie,t(ee,ie)),Zt.pop(5),Zt.pushInteger(te),0)},primitiveExtractChannel:function C(){var Bt,Yt,te,ee,ie,re,se,ne=0,ae=0;if(re=Zt.stackValue(2),Yt=Zt.stackValue(1),ee=Zt.booleanValueOf(Zt.stackValue(0)),Zt.success(Zt.isWords(re)),Zt.success(Zt.isWords(Yt)),se=r(re),Zt.success(r(Yt)>=se>>1),Zt.failed())return null;for(ie=re.wordsAsInt16Array(),Bt=Yt.wordsAsInt16Array(),ee&&ne++,te=1;se>=te;te++)Bt[ae++]=ie[ne],ne+=2;return Zt.pop(3),0}})})),module("users.bert.SqueakJS.plugins.SoundGenerationPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function t(Bt,Yt){return Bt-function u(Bt,Yt){return 0|Math.floor(Bt/Yt)}(Bt,Yt)*Yt|0}var Bt=1,Yt=11,Zt=511,te=512,ee=32768,ie=536870912,re=null,se="SoundGenerationPlugin 3 November 2014 (e)";Squeak.registerExternalModule("SoundGenerationPlugin",{primitiveMixFMSound:function s(){var Bt,Yt,Zt,te,ee,ie,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe;if(Bt=re.stackValue(5),Yt=re.stackIntegerValue(4),Zt=re.stackInt16Array(3),te=re.stackIntegerValue(2),ee=re.stackIntegerValue(1),ie=re.stackIntegerValue(0),ke=re.fetchIntegerofObject(3,Bt),ge=re.fetchIntegerofObject(4,Bt),be=re.fetchIntegerofObject(5,Bt),fe=re.fetchIntegerofObject(7,Bt),Fe=re.fetchInt16ArrayofObject(8,Bt),ye=re.fetchIntegerofObject(9,Bt),pe=re.fetchIntegerofObject(10,Bt),de=re.fetchIntegerofObject(11,Bt),he=re.fetchIntegerofObject(14,Bt),me=re.fetchIntegerofObject(15,Bt),ve=re.fetchIntegerofObject(16,Bt),re.failed())return null;for(se=0!==he&&0!==ve,ae=te+Yt-1,ce=te;ae>=ce;ce++)le=ke*Fe[pe>>15]>>15,se?(oe=he*Fe[me>>15],0>(me=t(me+ve,ye))&&(me+=ye),0>(pe=t(pe+de+oe,ye))&&(pe+=ye)):pe=t(pe+de,ye),ee>0&&((ue=Zt[(ne=2*ce-1)-1]+(le*ee>>15))>32767&&(ue=32767),-32767>ue&&(ue=-32767),Zt[ne-1]=ue),ie>0&&((ue=Zt[(ne=2*ce)-1]+(le*ie>>15))>32767&&(ue=32767),-32767>ue&&(ue=-32767),Zt[ne-1]=ue),0!==ge&&(ke+=ge,(ge>0&&ke>=be||0>ge&&be>=ke)&&(ke=be,ge=0));return fe-=Yt,re.failed()?null:(re.storeIntegerofObjectwithValue(3,Bt,ke),re.storeIntegerofObjectwithValue(4,Bt,ge),re.storeIntegerofObjectwithValue(7,Bt,fe),re.storeIntegerofObjectwithValue(10,Bt,pe),re.storeIntegerofObjectwithValue(15,Bt,me),void re.pop(5))},primitiveMixSampledSound:function o(){var Bt,Yt,Zt,te,ee,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye;if(Bt=re.stackValue(5),Yt=re.stackIntegerValue(4),Zt=re.stackInt16Array(3),te=re.stackIntegerValue(2),ee=re.stackIntegerValue(1),se=re.stackIntegerValue(0),ge=re.fetchIntegerofObject(3,Bt),be=re.fetchIntegerofObject(4,Bt),ye=re.fetchIntegerofObject(5,Bt),he=re.fetchIntegerofObject(7,Bt),de=re.fetchInt16ArrayofObject(8,Bt),me=re.fetchIntegerofObject(10,Bt),ke=re.fetchIntegerofObject(11,Bt),pe=re.fetchIntegerofObject(12,Bt),ve=re.fetchIntegerofObject(13,Bt),re.failed())return null;for(ae=te+Yt-1,oe=te,fe=pe+(ke>>>16);me>=fe&&ae>=oe;)ce=de[fe-1]*ge>>15,ee>0&&((le=Zt[(ne=2*oe-1)-1]+(ce*ee>>15))>32767&&(le=32767),-32767>le&&(le=-32767),Zt[ne-1]=le),se>0&&((le=Zt[(ne=2*oe)-1]+(ce*se>>15))>32767&&(le=32767),-32767>le&&(le=-32767),Zt[ne-1]=le),0!==be&&(ge+=be,(be>0&&ge>=ye||0>be&&ye>=ge)&&(ge=ye,be=0)),(ke+=ve)>=ie&&(pe+=ue=ke>>>16,ke-=ue<<16),fe=pe+(ke>>>16),++oe;return he-=Yt,re.failed()?null:(re.storeIntegerofObjectwithValue(3,Bt,ge),re.storeIntegerofObjectwithValue(4,Bt,be),re.storeIntegerofObjectwithValue(7,Bt,he),re.storeIntegerofObjectwithValue(11,Bt,ke),re.storeIntegerofObjectwithValue(12,Bt,pe),void re.pop(5))},setInterpreter:function r(Zt){return!1!==((re=Zt).majorVersion()==Bt)&&re.minorVersion()>=Yt},getModuleName:function h(){return se},primitiveApplyReverb:function m(){var Bt,Yt,Zt,te,ee,ie,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve;if(Bt=re.stackValue(3),Yt=re.stackInt16Array(2),Zt=re.stackIntegerValue(1),te=re.stackIntegerValue(0),me=re.fetchInt32ArrayofObject(7,Bt),ve=re.fetchInt32ArrayofObject(8,Bt),de=re.fetchIntegerofObject(9,Bt),fe=re.fetchIntegerofObject(10,Bt),ce=re.fetchIntegerofObject(11,Bt),he=re.fetchInt16ArrayofObject(12,Bt),pe=re.fetchInt16ArrayofObject(13,Bt),re.failed())return null;for(oe=Zt;Zt+te-1>=oe;oe++){for(ee=ie=0,le=1;de>=le;le++)1>(se=ce-me[le-1])&&(se+=fe),ee+=(ue=ve[le-1])*he[se-1],ie+=ue*pe[se-1];(ae=Yt[(ne=2*oe-1)-1]+(ee>>15))>32767&&(ae=32767),-32767>ae&&(ae=-32767),Yt[ne-1]=ae,he[ce-1]=ae,(ae=Yt[++ne-1]+(ie>>15))>32767&&(ae=32767),-32767>ae&&(ae=-32767),Yt[ne-1]=ae,pe[ce-1]=ae,ce=t(ce,fe)+1}return re.failed()?null:(re.storeIntegerofObjectwithValue(11,Bt,ce),void re.pop(3))},primitiveMixPluckedSound:function a(){var Bt,Yt,Zt,te,ie,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye;if(Bt=re.stackValue(5),Yt=re.stackIntegerValue(4),Zt=re.stackInt16Array(3),te=re.stackIntegerValue(2),ie=re.stackIntegerValue(1),se=re.stackIntegerValue(0),ge=re.fetchIntegerofObject(3,Bt),be=re.fetchIntegerofObject(4,Bt),ye=re.fetchIntegerofObject(5,Bt),pe=re.fetchIntegerofObject(7,Bt),de=re.fetchInt16ArrayofObject(8,Bt),me=re.fetchIntegerofObject(9,Bt),ve=re.fetchIntegerofObject(10,Bt),ke=re.fetchIntegerofObject(11,Bt),re.failed())return null;for(oe=te+Yt-1,fe=ce=me,he=te;oe>=he;he++)(ce=fe+ve)>=ke&&(ce=ee+(ce-ke)),ne=de[(fe>>15)-1]+de[(ce>>15)-1]>>1,de[(fe>>15)-1]=ne,le=ne*ge>>15,fe=ce,ie>0&&((ue=Zt[(ae=2*he-1)-1]+(le*ie>>15))>32767&&(ue=32767),-32767>ue&&(ue=-32767),Zt[ae-1]=ue),se>0&&((ue=Zt[(ae=2*he)-1]+(le*se>>15))>32767&&(ue=32767),-32767>ue&&(ue=-32767),Zt[ae-1]=ue),0!==be&&(ge+=be,(be>0&&ge>=ye||0>be&&ye>=ge)&&(ge=ye,be=0));return me=ce,pe-=Yt,re.failed()?null:(re.storeIntegerofObjectwithValue(3,Bt,ge),re.storeIntegerofObjectwithValue(4,Bt,be),re.storeIntegerofObjectwithValue(7,Bt,pe),re.storeIntegerofObjectwithValue(9,Bt,me),void re.pop(5))},primitiveMixLoopedSampledSound:function n(){var Bt,Yt,ee,ie,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me,ve,ke,ge,be,ye,Fe,Se,Oe,Ie,Ae,Pe,we,Ce,Ve;if(Bt=re.stackValue(5),Yt=re.stackIntegerValue(4),ee=re.stackInt16Array(3),ie=re.stackIntegerValue(2),se=re.stackIntegerValue(1),ne=re.stackIntegerValue(0),we=re.fetchIntegerofObject(3,Bt),Ce=re.fetchIntegerofObject(4,Bt),Ve=re.fetchIntegerofObject(5,Bt),ge=re.fetchIntegerofObject(7,Bt),Se=re.fetchIntegerofObject(8,Bt),ye=re.fetchInt16ArrayofObject(10,Bt),Oe=re.fetchInt16ArrayofObject(11,Bt),be=re.fetchIntegerofObject(16,Bt),Fe=re.fetchIntegerofObject(17,Bt),Pe=re.fetchIntegerofObject(18,Bt),Ie=re.fetchIntegerofObject(19,Bt),Ae=re.fetchIntegerofObject(20,Bt),re.failed())return null;for(le=ye!==Oe,ae=se*we>>15,oe=ne*we>>15,ue=2*ie-1,ce=ie+Yt-1,ke=ie;ce>=ke;ke++){if((ve=(Ie+=Ae)>>9)>Fe&&ge>Se&&(ve=(Ie-=Pe)>>9),(pe=ve+1)>be){if(ve>be)return ge=0,re.failed()||(re.storeIntegerofObjectwithValue(3,Bt,we),re.storeIntegerofObjectwithValue(4,Bt,Ce),re.storeIntegerofObjectwithValue(7,Bt,ge),re.storeIntegerofObjectwithValue(19,Bt,Ie),re.popthenPush(6,null)),null;pe=0===Pe?ve:1+(Ie-Pe>>9)}he=Ie&Zt,de=fe=ye[ve-1]*(te-he)+ye[pe-1]*he>>9,le&&(de=Oe[ve-1]*(te-he)+Oe[pe-1]*he>>9),se>0&&((me=ee[ue-1]+(ae*fe>>15))>32767&&(me=32767),-32767>me&&(me=-32767),ee[ue-1]=me),++ue,ne>0&&((me=ee[ue-1]+(oe*de>>15))>32767&&(me=32767),-32767>me&&(me=-32767),ee[ue-1]=me),++ue,0!==Ce&&(we+=Ce,(Ce>0&&we>=Ve||0>Ce&&Ve>=we)&&(we=Ve,Ce=0),ae=se*we>>15,oe=ne*we>>15)}return ge-=Yt,re.failed()?null:(re.storeIntegerofObjectwithValue(3,Bt,we),re.storeIntegerofObjectwithValue(4,Bt,Ce),re.storeIntegerofObjectwithValue(7,Bt,ge),re.storeIntegerofObjectwithValue(19,Bt,Ie),void re.pop(5))}})})),module("users.bert.SqueakJS.plugins.StarSqueakPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function t(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function r(Bt,Yt){return 0|Math.floor(Bt/Yt)}function a(Bt,Yt){return 0>Yt?-31>Yt?0:Bt>>>0-Yt:Yt>31?0:Bt<<Yt}function i(Bt){return Zt.success(Zt.isWords(Bt)),Zt.failed()?0:Bt.words}var Bt=1,Yt=11,Zt=null,te="StarSqueakPlugin 3 November 2014 (e)";Squeak.registerExternalModule("StarSqueakPlugin",{primitiveDiffuseFromToWidthHeightDelta:function n(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me;if(oe=Zt.stackValue(4),ee=Zt.stackValue(3),fe=Zt.stackIntegerValue(2),se=Zt.stackIntegerValue(1),Yt=Zt.stackIntegerValue(0),ae=i(oe),te=i(ee),Zt.success(t(oe)===t(ee)),Zt.success(t(oe)===fe*se),Zt.failed())return null;for(Bt=(2*Yt+1)*(2*Yt+1),de=0;se-1>=de;de++)for(0>(le=de-Yt)&&(le=0),(re=de+Yt)>=se&&(re=se-1),he=0;fe-1>=he;he++){for(0>(ue=he-Yt)&&(ue=0),(ie=he+Yt)>=fe&&(ie=fe-1),ce=0,me=le;re>=me;me++)for(ne=me*fe,pe=ue;ie>=pe;pe++)ce+=ae[ne+pe];te[de*fe+he]=r(ce,Bt)}Zt.pop(5)},primitiveEvaporateRate:function h(){var Bt,Yt,te,ee,ie;if(te=Zt.stackValue(1),ee=Zt.stackIntegerValue(0),Yt=i(te),ie=t(te),Zt.failed())return null;for(Bt=0;ie-1>=Bt;Bt++)Yt[Bt]=Yt[Bt]*ee>>>10;Zt.pop(2)},setInterpreter:function u(te){return!1!==((Zt=te).majorVersion()==Bt)&&Zt.minorVersion()>=Yt},primitiveMapFromToWidthHeightPatchSizeRgbFlagsShift:function o(){var Bt,Yt,te,ee,ie,re,se,ne,ae,oe,ue,le,ce,fe,he,pe,de,me;if(he=Zt.stackValue(6),te=Zt.stackValue(5),pe=Zt.stackIntegerValue(4),ee=Zt.stackIntegerValue(3),se=Zt.stackIntegerValue(2),ae=Zt.stackIntegerValue(1),le=Zt.stackIntegerValue(0),ce=i(he),Bt=i(te),Zt.success(t(te)===pe*ee),Zt.success(t(te)===t(he)*se*se),Zt.failed())return null;for(oe=0,(4&ae)>0&&(oe+=65536),(2&ae)>0&&(oe+=256),(1&ae)>0&&++oe,fe=-1,me=0;me<=r(ee,se)-1;me++)for(de=0;de<=r(pe,se)-1;de++)for((ie=a(ce[++fe],le))>255&&(ie=255),ne=0>=ie?1:ie*oe,ue=re=(me*pe+de)*se;re+(se-1)*pe>=ue;ue+=pe)for(Yt=ue;ue+se-1>=Yt;Yt++)Bt[Yt]=ne;Zt.pop(7)},getModuleName:function s(){return te}})})),module("users.bert.SqueakJS.plugins.ZipPlugin").requires("users.bert.SqueakJS.vm").toRun((function(){function M(Bt){return"number"==typeof Bt?ce.classSmallInteger():Bt.sqClass}function i(Bt){return Bt.pointers?Bt.pointers.length:Bt.words?Bt.words.length:Bt.bytes?Bt.bytes.length:0}function k(Bt){return Bt.bytes?Bt.bytes.length:Bt.words?4*Bt.words.length:0}function J(Bt,Yt){return Bt-function Pt(Bt,Yt){return 0|Math.floor(Bt/Yt)}(Bt,Yt)*Yt|0}function F(Bt,Yt){return Yt>31?0:Bt<<Yt}function St(Bt,Yt,Zt){var te;if(be[Bt+Zt]!==be[Yt+Zt])return 0;if(be[Bt+Zt-1]!==be[Yt+Zt-1])return 0;if(be[Bt]!==be[Yt])return 0;if(be[Bt+1]!==be[Yt+1])return 1;for(te=2;se>te&&be[Bt+te]===be[Yt+te];)++te;return te}function yt(Bt,Yt,Zt){var te,ee,ie,re,se,ae,oe,ue,le;if(ge>Bt)return!1;if(Be>=Ne)return!0;for(ee=!1,ie=ge;Bt>=ie;){if(ee||(oe=R(ie,ne-1,ie,Yt,Zt),j(ie),se=65535&oe,re=oe>>>16),le=65535&(oe=R(ie+1,re,se,Yt,Zt)),re>=(ue=oe>>>16)&&re>=ne){for(te=vt(re,ie-se),ae=1;re-1>=ae;ae++)j(++ie);ee=!1,++ie}else te=kt(be[ie]),Bt>=++ie&&!te&&(j(ie),ee=!0,se=le,re=ue);if(te)return ge=ie,!0}return ge=ie,!1}function z(Bt){var Yt;for(Yt=M(Bt);!Yt.isNil&&Yt.classInstSize()>=7;)Yt=Yt.superclass();return!Yt.isNil&&(pe=Yt.classInstSize(),!0)}function kt(Bt){return We[Be]=Bt,Pe[Be]=0,_e[Bt]++,++Be===Ne||0==(4095&Be)&&W()}function vt(Bt,Yt){var Zt,te;return We[Be]=Bt-ne,Pe[Be]=Yt,te=Te[Bt-ne],_e[te]++,Zt=257>Yt?Ie[Yt-1]:Ie[256+(Yt-1>>>7)],Ae[Zt]++,++Be,++De,Be===Ne||0==(4095&Be)&&W()}function R(Bt,Yt,Zt,te,ie){var re,oe,ue,le,ce,fe,he;if(he=Yt<<16|Zt,Yt>=se)return he;if(!((ue=Bt-(fe=Ve[B(Bt+ne-1)]))>0&&ee>ue))return he;for(oe=te,ce=Bt>ee?Bt-ee:0,re=Yt;;){if(Bt+(le=St(Bt,fe,re))>Le&&(le=Le-Bt),le===ne&&Bt-fe>ee>>2&&(le=ne-1),le>re){if(he=le<<16|fe,(re=le)>=se)return he;if(re>ie)return he}if(!(--oe>0))return he;if(ce>=(fe=je[fe&ae]))return he}}function j(Bt){var Yt;xe=B(Bt+ne-1),Yt=Ve[xe],Ve[xe]=Bt,je[Bt&ae]=Yt}function ft(Bt){var Yt;if(!(ce.isPointers(Bt)&&i(Bt)>=15))return!1;if(Yt=ce.fetchPointerofObject(0,Bt),!ce.isBytes(Yt))return!1;if(0===pe){if(!z(Bt))return!1;if(i(Bt)<pe+5)return pe=0,!1}return be=Yt.bytes,ye=k(Yt),Le=ce.fetchIntegerofObject(1,Bt),Re=ce.fetchIntegerofObject(2,Bt),Yt=ce.fetchPointerofObject(pe+0,Bt),!(!ce.isWords(Yt)||i(Yt)!==te)&&(Ve=Yt.words,Yt=ce.fetchPointerofObject(pe+1,Bt),!(!ce.isWords(Yt)||i(Yt)!==oe)&&(je=Yt.words,xe=ce.fetchIntegerofObject(pe+2,Bt),ge=ce.fetchIntegerofObject(pe+3,Bt),Yt=ce.fetchPointerofObject(pe+5,Bt),!!ce.isBytes(Yt)&&(Ne=i(Yt),We=Yt.bytes,Yt=ce.fetchPointerofObject(pe+6,Bt),!!(ce.isWords(Yt)&&i(Yt)>=Ne)&&(Pe=Yt.words,Yt=ce.fetchPointerofObject(pe+7,Bt),!(!ce.isWords(Yt)||i(Yt)!==re)&&(_e=Yt.words,Yt=ce.fetchPointerofObject(pe+8,Bt),!(!ce.isWords(Yt)||i(Yt)!==ie)&&(Ae=Yt.words,Be=ce.fetchIntegerofObject(pe+9,Bt),De=ce.fetchIntegerofObject(pe+10,Bt),!ce.failed()))))))}function ut(Bt){var Yt;if(0===pe){if(!z(Bt))return!1;if(i(Bt)<pe+3)return pe=0,!1}return!!(ce.isPointers(Bt)&&i(Bt)>=pe+3)&&(Yt=ce.fetchPointerofObject(0,Bt),ce.isBytes(Yt)?(be=Yt.bytes,ye=k(Yt),Le=ce.fetchIntegerofObject(1,Bt),Re=ce.fetchIntegerofObject(2,Bt),ve=ce.fetchIntegerofObject(pe+1,Bt),ke=ce.fetchIntegerofObject(pe+2,Bt),!ce.failed()):ce.primitiveFail())}function g(Bt,Yt){if(!(Yt>=0&&F(1,Bt)>Yt))return ce.primitiveFail();for(ve|=F(Yt,ke),ke+=Bt;ke>=8&&ye>Le;)be[Le]=255&ve,++Le,ve>>>=8,ke-=8}function X(Bt,Yt,Zt,te){var ee,ie,re,se,ae,oe,ue,le,fe,he,pe,ve,ke,ge,be,Fe;if(be=ce.fetchPointerofObject(0,Bt),ve=ce.fetchIntegerofObject(1,Bt),!((pe=ce.fetchIntegerofObject(2,Bt))>=ve&&ce.isBytes(be)&&pe<=k(be)))return ce.primitiveFail();if(fe=be.bytes,be=ce.fetchPointerofObject(0,Yt),!(ce.isWords(be)&&pe<=i(be)&&ce.fetchIntegerofObject(1,Yt)===ve&&ce.fetchIntegerofObject(2,Yt)===pe))return ce.primitiveFail();if(re=be.words,be=ce.fetchPointerofObject(0,Zt),!ce.isWords(be))return ce.primitiveFail();if(he=i(be),ke=be.words,be=ce.fetchPointerofObject(1,Zt),!ce.isWords(be)||he!==i(be))return ce.primitiveFail();if(ge=be.words,be=ce.fetchPointerofObject(0,te),!ce.isWords(be))return ce.primitiveFail();if(ae=i(be),se=be.words,be=ce.fetchPointerofObject(1,te),!ce.isWords(be)||ae!==i(be))return ce.primitiveFail();for(oe=be.words,g(0,0),Fe=0;pe>ve&&ye>Le+4;)if(le=fe[ve],ie=re[ve],++ve,0===ie){if(++Fe,!(he>le))return ce.primitiveFail();g(ke[le],ge[le])}else{if(Fe=Fe+le+ne,!(256>le))return ce.primitiveFail();if(!(he>(ee=Te[le])))return ce.primitiveFail();if(g(ke[ee],ge[ee]),0!==(ue=Ce[ee-257])&&g(ue,le-=me[ee-257]),!(32768>--ie))return ce.primitiveFail();if(!(ae>(ee=256>ie?Ie[ie]:Ie[256+(ie>>>7)])))return ce.primitiveFail();g(se[ee],oe[ee]),0!==(ue=we[ee])&&g(ue,ie-=de[ee])}return ce.failed()?null:(ce.storeIntegerofObjectwithValue(1,Bt,ve),ce.storeIntegerofObjectwithValue(1,Yt,ve),Fe)}function W(){var Bt;return Be===Ne||0==(4095&Be)&&(!(Be>=10*De)&&(!(De>=(Bt=Be-De))&&De>=4*Bt))}function B(Bt){return function pt(Bt){return(xe<<5^Bt)&Zt}(be[Bt])}function L(Bt,Yt){var Zt,te,ee,ie;if((Zt=Bt[0]>>>24)>ue)return ce.primitiveFail(),0;for(ee=2;;){if((te=ee+x(Zt)-1)>=Yt)return ce.primitiveFail(),0;if(0==(1056964608&(ie=Bt[te])))return ie;if(ee=65535&ie,(Zt=ie>>>24&255)>ue)return ce.primitiveFail(),0}return 0}function x(Bt){for(var Yt,Zt;Bt>ke;)Zt=Ee[++Ke],ve+=F(Zt,ke),ke+=8;return Yt=ve&F(1,Bt)-1,ve=function Ot(Bt,Yt){return Yt>31?0:Bt>>>Yt}(ve,Bt),ke-=Bt,Yt}var Bt=1,Yt=11,Zt=32767,te=32768,ee=32768,ie=30,re=286,se=258,ne=3,ae=32767,oe=32768,ue=16,le=1,ce=null,fe="ZipPlugin 3 November 2014 (e)",he=0,pe=0,de=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],me=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],ve=0,ke=0,ge=0,be=null,ye=0,Fe=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],Se=null,Oe=0,Ie=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],Ae=null,Pe=null,we=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Ce=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ve=null,je=null,xe=0,qe=null,Me=0,Be=0,_e=null,Ne=0,We=null,De=0,Te=[257,258,259,260,261,262,263,264,265,265,266,266,267,267,268,268,269,269,269,269,270,270,270,270,271,271,271,271,272,272,272,272,273,273,273,273,273,273,273,273,274,274,274,274,274,274,274,274,275,275,275,275,275,275,275,275,276,276,276,276,276,276,276,276,277,277,277,277,277,277,277,277,277,277,277,277,277,277,277,277,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284],Le=0,Re=0,Ee=null,ze=0,Ke=0,Ge=0;Squeak.registerExternalModule("ZipPlugin",{primitiveZipSendBlock:function Q(){var Bt,Yt,Zt,te,ee,ie;return 4!==ce.methodArgumentCount()?ce.primitiveFail():(Yt=ce.stackObjectValue(0),te=ce.stackObjectValue(1),Bt=ce.stackObjectValue(2),Zt=ce.stackObjectValue(3),ee=ce.stackObjectValue(4),ce.failed()?null:ut(ee)&&ce.isPointers(Yt)&&i(Yt)>=2&&ce.isPointers(te)&&i(te)>=2&&ce.isPointers(Zt)&&i(Zt)>=3&&ce.isPointers(Bt)&&i(Bt)>=3?(ie=X(Zt,Bt,te,Yt),ce.failed()||(ce.storeIntegerofObjectwithValue(1,ee,Le),ce.storeIntegerofObjectwithValue(he+1,ee,ve),ce.storeIntegerofObjectwithValue(he+2,ee,ke)),void(ce.failed()||(ce.pop(5),ce.pushInteger(ie)))):ce.primitiveFail())},primitiveUpdateAdler32:function et(){var Bt,Yt,Zt,te,ee,ie,re,se;if(4!==ce.methodArgumentCount())return ce.primitiveFail();if(Zt=ce.stackObjectValue(0),se=ce.stackIntegerValue(1),re=ce.stackIntegerValue(2),Bt=ce.positive32BitValueOf(ce.stackValue(3)),ce.failed())return 0;if(!(ce.isBytes(Zt)&&se>=re&&re>0))return ce.primitiveFail();if(!(k(Zt)>=se))return ce.primitiveFail();for(Yt=Zt.bytes,--se,ee=65535&Bt,ie=Bt>>>16&65535,te=--re;se>=te;te++)ee=J(ee+Yt[te],65521),ie=J(ie+ee,65521);Bt=(ie<<16)+ee,ce.popthenPush(5,ce.positive32BitIntegerFor(Bt))},primitiveUpdateGZipCrc32:function $(){var Bt,Yt,Zt,te,ee,ie;if(4!==ce.methodArgumentCount())return ce.primitiveFail();if(Yt=ce.stackObjectValue(0),ie=ce.stackIntegerValue(1),ee=ce.stackIntegerValue(2),Zt=ce.positive32BitValueOf(ce.stackValue(3)),ce.failed())return 0;if(!(ce.isBytes(Yt)&&ie>=ee&&ee>0))return ce.primitiveFail();if(!(k(Yt)>=ie))return ce.primitiveFail();for(Bt=Yt.bytes,--ie,te=--ee;ie>=te;te++)Zt=Fe[255&(Zt^Bt[te])]^Zt>>>8;ce.popthenPush(5,ce.positive32BitIntegerFor(Zt))},primitiveDeflateUpdateHashTable:function it(){var Bt,Yt,Zt,te,ee,ie;if(2!==ce.methodArgumentCount())return ce.primitiveFail();if(Bt=ce.stackIntegerValue(0),te=ce.stackObjectValue(1),ce.failed())return null;if(!ce.isWords(te))return ce.primitiveFail();for(ie=i(te),ee=te.wordsAsInt32Array(),Zt=0;ie-1>=Zt;Zt++)Yt=ee[Zt],ee[Zt]=Yt>=Bt?Yt-Bt:0;ce.pop(2)},setInterpreter:function H(Zt){return!1!==((ce=Zt).majorVersion()==Bt)&&ce.minorVersion()>=Yt},getModuleName:function ht(){return fe},primitiveDeflateBlock:function at(){var Bt,Yt,Zt,te,ee;return 3!==ce.methodArgumentCount()?ce.primitiveFail():(Yt=ce.stackIntegerValue(0),Bt=ce.stackIntegerValue(1),Zt=ce.stackIntegerValue(2),te=ce.stackObjectValue(3),ce.failed()?null:ft(te)?(ee=yt(Zt,Bt,Yt),ce.failed()||(ce.storeIntegerofObjectwithValue(pe+2,te,xe),ce.storeIntegerofObjectwithValue(pe+3,te,ge),ce.storeIntegerofObjectwithValue(pe+9,te,Be),ce.storeIntegerofObjectwithValue(pe+10,te,De)),void(ce.failed()||(ce.pop(4),ce.pushBool(ee)))):ce.primitiveFail())},primitiveInflateDecompressBlock:function tt(){var Bt,Yt;if(2!==ce.methodArgumentCount())return ce.primitiveFail();if(Bt=ce.stackValue(0),!ce.isWords(Bt))return ce.primitiveFail();if(Se=Bt.words,Oe=i(Bt),Bt=ce.stackValue(1),!ce.isWords(Bt))return ce.primitiveFail();if(qe=Bt.words,Me=i(Bt),Yt=ce.stackValue(2),!ce.isPointers(Yt))return ce.primitiveFail();if(0===he){if(!function bt(Bt){var Yt;for(Yt=M(Bt);!Yt.isNil&&Yt.classInstSize()>=13;)Yt=Yt.superclass();return!Yt.isNil&&(he=Yt.classInstSize(),!0)}(Yt))return ce.primitiveFail();if(i(Yt)<he+8)return he=0,ce.primitiveFail()}return i(Yt)<he+8?ce.primitiveFail():(Re=ce.fetchIntegerofObject(2,Yt),Ge=ce.fetchIntegerofObject(he+0,Yt),ve=ce.fetchIntegerofObject(he+1,Yt),ke=ce.fetchIntegerofObject(he+2,Yt),Ke=ce.fetchIntegerofObject(he+4,Yt),ze=ce.fetchIntegerofObject(he+5,Yt),ce.failed()?null:(--Re,--Ke,--ze,Bt=ce.fetchPointerofObject(0,Yt),ce.isBytes(Bt)?(be=Bt.bytes,ye=k(Bt),Bt=ce.fetchPointerofObject(he+3,Yt),ce.isBytes(Bt)?(Ee=Bt.bytes,function It(){var Bt,Yt,Zt,te,ee,ie,re,se,ne,ae,oe;for(ie=ye-1;ie>Re&&ze>=Ke;)if(se=ve,re=ke,ne=Ke,256>(oe=L(qe,Me)))be[++Re]=oe;else{if(256===oe)return Ge&=le,0;if(ee=65535&oe,(Zt=(oe>>>16)-1)>0&&(ee+=x(Zt)),Bt=65535&(oe=L(Se,Oe)),(Zt=oe>>>16)>0&&(Bt+=x(Zt)),Re+ee>=ie)return ve=se,ke=re,Ke=ne,0;for(Yt=Re,ae=Re-Bt,te=1;ee>=te;te++)be[Yt+te]=be[ae+te];Re+=ee}}(),void(ce.failed()||(ce.storeIntegerofObjectwithValue(2,Yt,Re+1),ce.storeIntegerofObjectwithValue(he+0,Yt,Ge),ce.storeIntegerofObjectwithValue(he+1,Yt,ve),ce.storeIntegerofObjectwithValue(he+2,Yt,ke),ce.storeIntegerofObjectwithValue(he+4,Yt,Ke+1),ce.pop(2)))):ce.primitiveFail()):ce.primitiveFail()))}})}));var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(Bt){if(null==Bt)return"";var Yt,Zt,te,ee,ie,re,se,ne="",ae=0;for(Bt=LZString.compress(Bt);ae<2*Bt.length;)ae%2==0?(Yt=Bt.charCodeAt(ae/2)>>8,Zt=255&Bt.charCodeAt(ae/2),te=ae/2+1<Bt.length?Bt.charCodeAt(ae/2+1)>>8:NaN):(Yt=255&Bt.charCodeAt((ae-1)/2),(ae+1)/2<Bt.length?(Zt=Bt.charCodeAt((ae+1)/2)>>8,te=255&Bt.charCodeAt((ae+1)/2)):Zt=te=NaN),ae+=3,ee=Yt>>2,ie=(3&Yt)<<4|Zt>>4,re=(15&Zt)<<2|te>>6,se=63&te,isNaN(Zt)?re=se=64:isNaN(te)&&(se=64),ne=ne+LZString._keyStr.charAt(ee)+LZString._keyStr.charAt(ie)+LZString._keyStr.charAt(re)+LZString._keyStr.charAt(se);return ne},decompressFromBase64:function(Bt){if(null==Bt)return"";var Yt,Zt,te,ee,ie,re,se,ne="",ae=0,oe=0,ue=LZString._f;for(Bt=Bt.replace(/[^A-Za-z0-9\+\/\=]/g,"");oe<Bt.length;)Zt=LZString._keyStr.indexOf(Bt.charAt(oe++))<<2|(ie=LZString._keyStr.indexOf(Bt.charAt(oe++)))>>4,te=(15&ie)<<4|(re=LZString._keyStr.indexOf(Bt.charAt(oe++)))>>2,ee=(3&re)<<6|(se=LZString._keyStr.indexOf(Bt.charAt(oe++))),ae%2==0?(Yt=Zt<<8,64!=re&&(ne+=ue(Yt|te)),64!=se&&(Yt=ee<<8)):(ne+=ue(Yt|Zt),64!=re&&(Yt=te<<8),64!=se&&(ne+=ue(Yt|ee))),ae+=3;return LZString.decompress(ne)},compressToUTF16:function(Bt){if(null==Bt)return"";var Yt,Zt,te,ee="",ie=0,re=LZString._f;for(Bt=LZString.compress(Bt),Yt=0;Yt<Bt.length;Yt++)switch(Zt=Bt.charCodeAt(Yt),ie++){case 0:ee+=re(32+(Zt>>1)),te=(1&Zt)<<14;break;case 1:ee+=re(te+(Zt>>2)+32),te=(3&Zt)<<13;break;case 2:ee+=re(te+(Zt>>3)+32),te=(7&Zt)<<12;break;case 3:ee+=re(te+(Zt>>4)+32),te=(15&Zt)<<11;break;case 4:ee+=re(te+(Zt>>5)+32),te=(31&Zt)<<10;break;case 5:ee+=re(te+(Zt>>6)+32),te=(63&Zt)<<9;break;case 6:ee+=re(te+(Zt>>7)+32),te=(127&Zt)<<8;break;case 7:ee+=re(te+(Zt>>8)+32),te=(255&Zt)<<7;break;case 8:ee+=re(te+(Zt>>9)+32),te=(511&Zt)<<6;break;case 9:ee+=re(te+(Zt>>10)+32),te=(1023&Zt)<<5;break;case 10:ee+=re(te+(Zt>>11)+32),te=(2047&Zt)<<4;break;case 11:ee+=re(te+(Zt>>12)+32),te=(4095&Zt)<<3;break;case 12:ee+=re(te+(Zt>>13)+32),te=(8191&Zt)<<2;break;case 13:ee+=re(te+(Zt>>14)+32),te=(16383&Zt)<<1;break;case 14:ee+=re(te+(Zt>>15)+32,32+(32767&Zt)),ie=0}return ee+re(te+32)},decompressFromUTF16:function(Bt){if(null==Bt)return"";for(var Yt,Zt,te="",ee=0,ie=0,re=LZString._f;ie<Bt.length;){switch(Zt=Bt.charCodeAt(ie)-32,ee++){case 0:Yt=Zt<<1;break;case 1:te+=re(Yt|Zt>>14),Yt=(16383&Zt)<<2;break;case 2:te+=re(Yt|Zt>>13),Yt=(8191&Zt)<<3;break;case 3:te+=re(Yt|Zt>>12),Yt=(4095&Zt)<<4;break;case 4:te+=re(Yt|Zt>>11),Yt=(2047&Zt)<<5;break;case 5:te+=re(Yt|Zt>>10),Yt=(1023&Zt)<<6;break;case 6:te+=re(Yt|Zt>>9),Yt=(511&Zt)<<7;break;case 7:te+=re(Yt|Zt>>8),Yt=(255&Zt)<<8;break;case 8:te+=re(Yt|Zt>>7),Yt=(127&Zt)<<9;break;case 9:te+=re(Yt|Zt>>6),Yt=(63&Zt)<<10;break;case 10:te+=re(Yt|Zt>>5),Yt=(31&Zt)<<11;break;case 11:te+=re(Yt|Zt>>4),Yt=(15&Zt)<<12;break;case 12:te+=re(Yt|Zt>>3),Yt=(7&Zt)<<13;break;case 13:te+=re(Yt|Zt>>2),Yt=(3&Zt)<<14;break;case 14:te+=re(Yt|Zt>>1),Yt=(1&Zt)<<15;break;case 15:te+=re(Yt|Zt),ee=0}ie++}return LZString.decompress(te)},compress:function(Bt){if(null==Bt)return"";var Yt,Zt,te,ee={},ie={},re="",se="",ne="",ae=2,oe=3,ue=2,le="",ce=0,fe=0,he=LZString._f;for(te=0;te<Bt.length;te+=1)if(re=Bt.charAt(te),Object.prototype.hasOwnProperty.call(ee,re)||(ee[re]=oe++,ie[re]=!0),se=ne+re,Object.prototype.hasOwnProperty.call(ee,se))ne=se;else{if(Object.prototype.hasOwnProperty.call(ie,ne)){if(ne.charCodeAt(0)<256){for(Yt=0;ue>Yt;Yt++)ce<<=1,15==fe?(fe=0,le+=he(ce),ce=0):fe++;for(Zt=ne.charCodeAt(0),Yt=0;8>Yt;Yt++)ce=ce<<1|1&Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt>>=1}else{for(Zt=1,Yt=0;ue>Yt;Yt++)ce=ce<<1|Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt=0;for(Zt=ne.charCodeAt(0),Yt=0;16>Yt;Yt++)ce=ce<<1|1&Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt>>=1}0==--ae&&(ae=Math.pow(2,ue),ue++),delete ie[ne]}else for(Zt=ee[ne],Yt=0;ue>Yt;Yt++)ce=ce<<1|1&Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt>>=1;0==--ae&&(ae=Math.pow(2,ue),ue++),ee[se]=oe++,ne=String(re)}if(""!==ne){if(Object.prototype.hasOwnProperty.call(ie,ne)){if(ne.charCodeAt(0)<256){for(Yt=0;ue>Yt;Yt++)ce<<=1,15==fe?(fe=0,le+=he(ce),ce=0):fe++;for(Zt=ne.charCodeAt(0),Yt=0;8>Yt;Yt++)ce=ce<<1|1&Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt>>=1}else{for(Zt=1,Yt=0;ue>Yt;Yt++)ce=ce<<1|Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt=0;for(Zt=ne.charCodeAt(0),Yt=0;16>Yt;Yt++)ce=ce<<1|1&Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt>>=1}0==--ae&&(ae=Math.pow(2,ue),ue++),delete ie[ne]}else for(Zt=ee[ne],Yt=0;ue>Yt;Yt++)ce=ce<<1|1&Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt>>=1;0==--ae&&(ae=Math.pow(2,ue),ue++)}for(Zt=2,Yt=0;ue>Yt;Yt++)ce=ce<<1|1&Zt,15==fe?(fe=0,le+=he(ce),ce=0):fe++,Zt>>=1;for(;;){if(ce<<=1,15==fe){le+=he(ce);break}fe++}return le},decompress:function(Bt){if(null==Bt)return"";if(""==Bt)return null;var Yt,Zt,te,ee,ie,re,se,ne=[],ae=4,oe=4,ue=3,le="",ce="",fe=LZString._f,he={string:Bt,val:Bt.charCodeAt(0),position:32768,index:1};for(Yt=0;3>Yt;Yt+=1)ne[Yt]=Yt;for(te=0,ie=Math.pow(2,2),re=1;re!=ie;)ee=he.val&he.position,he.position>>=1,0==he.position&&(he.position=32768,he.val=he.string.charCodeAt(he.index++)),te|=(ee>0?1:0)*re,re<<=1;switch(te){case 0:for(te=0,ie=Math.pow(2,8),re=1;re!=ie;)ee=he.val&he.position,he.position>>=1,0==he.position&&(he.position=32768,he.val=he.string.charCodeAt(he.index++)),te|=(ee>0?1:0)*re,re<<=1;se=fe(te);break;case 1:for(te=0,ie=Math.pow(2,16),re=1;re!=ie;)ee=he.val&he.position,he.position>>=1,0==he.position&&(he.position=32768,he.val=he.string.charCodeAt(he.index++)),te|=(ee>0?1:0)*re,re<<=1;se=fe(te);break;case 2:return""}for(ne[3]=se,Zt=ce=se;;){if(he.index>he.string.length)return"";for(te=0,ie=Math.pow(2,ue),re=1;re!=ie;)ee=he.val&he.position,he.position>>=1,0==he.position&&(he.position=32768,he.val=he.string.charCodeAt(he.index++)),te|=(ee>0?1:0)*re,re<<=1;switch(se=te){case 0:for(te=0,ie=Math.pow(2,8),re=1;re!=ie;)ee=he.val&he.position,he.position>>=1,0==he.position&&(he.position=32768,he.val=he.string.charCodeAt(he.index++)),te|=(ee>0?1:0)*re,re<<=1;ne[oe++]=fe(te),se=oe-1,ae--;break;case 1:for(te=0,ie=Math.pow(2,16),re=1;re!=ie;)ee=he.val&he.position,he.position>>=1,0==he.position&&(he.position=32768,he.val=he.string.charCodeAt(he.index++)),te|=(ee>0?1:0)*re,re<<=1;ne[oe++]=fe(te),se=oe-1,ae--;break;case 2:return ce}if(0==ae&&(ae=Math.pow(2,ue),ue++),ne[se])le=ne[se];else{if(se!==oe)return null;le=Zt+Zt.charAt(0)}ce+=le,ne[oe++]=Zt+le.charAt(0),Zt=le,0==--ae&&(ae=Math.pow(2,ue),ue++)}}};"undefined"!=typeof module&&null!=module&&(module.exports=LZString);