enyo.kind({name:"enyo.FlyweightRepeater",published:{count:0,multiSelect:!1,toggleSelected:!1},events:{onSetupItem:""},components:[{kind:"Selection",onSelect:"selectDeselect",onDeselect:"selectDeselect"},{name:"client"}],rowOffset:0,bottomUp:!1,create:function(){this.inherited(arguments),this.multiSelectChanged()},multiSelectChanged:function(){this.$.selection.setMulti(this.multiSelect)},setupItem:function(e){this.doSetupItem({index:e,selected:this.isSelected(e)})},generateChildHtml:function(){var e="";this.index=null;for(var t=0,i=0;t<this.count;t++)i=this.rowOffset+(this.bottomUp?this.count-t-1:t),this.setupItem(i),this.$.client.setAttribute("index",i),e+=this.inherited(arguments),this.$.client.teardownRender();return e},previewDomEvent:function(e){var t=this.index=this.rowForEvent(e);e.rowIndex=e.index=t,e.flyweight=this},decorateEvent:function(e,t,i){var n=t&&null!=t.index?t.index:this.index;t&&null!=n&&(t.index=n,t.flyweight=this),this.inherited(arguments)},tap:function(e,t){this.toggleSelected?this.$.selection.toggle(t.index):this.$.selection.select(t.index)},selectDeselect:function(e,t){this.renderRow(t.key)},getSelection:function(){return this.$.selection},isSelected:function(e){return this.getSelection().isSelected(e)},renderRow:function(e){var t=this.fetchRowNode(e);t&&(this.setupItem(e),t.innerHTML=this.$.client.generateChildHtml(),this.$.client.teardownChildren())},fetchRowNode:function(e){if(this.hasNode()){var t=this.node.querySelectorAll('[index="'+e+'"]');return t&&t[0]}},rowForEvent:function(e){for(var t=e.target,i=this.hasNode().id;t&&t.parentNode&&t.id!=i;){var n=t.getAttribute&&t.getAttribute("index");if(null!==n)return Number(n);t=t.parentNode}return-1},prepareRow:function(e){var t=this.fetchRowNode(e);enyo.FlyweightRepeater.claimNode(this.$.client,t)},lockRow:function(){this.$.client.teardownChildren()},performOnRow:function(e,t,i){t&&(this.prepareRow(e),enyo.call(i||null,t),this.lockRow())},statics:{claimNode:function(e,t){var i=t&&t.querySelectorAll("#"+e.id);i=i&&i[0],e.generated=Boolean(i||!e.tag),e.node=i,e.node&&e.rendered();for(var n,o=0,l=e.children;n=l[o];o++)this.claimNode(n,t)}}});