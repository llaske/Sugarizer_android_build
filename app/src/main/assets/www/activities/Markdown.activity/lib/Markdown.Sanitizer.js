!function(){var r,t;function sanitizeHtml(r){return r.replace(/<[^>]*>?/gi,sanitizeTag)}"object"==typeof exports&&"function"==typeof require?(r=exports,t=require("./Markdown.Converter").Converter):(r=window.Markdown,t=Markdown.Converter),r.getSanitizingConverter=function(){var r=new t;return r.hooks.chain("postConversion",sanitizeHtml),r.hooks.chain("postConversion",balanceTags),r};var e=/^(<\/?(b|blockquote|code|del|dd|dl|dt|em|h1|h2|h3|i|kbd|li|ol|p|pre|s|sup|sub|strong|strike|ul)>|<(br|hr)\s?\/?>)$/i,n=/^(<a\shref="((https?|ftp):\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\stitle="[^"<>]+")?\s?>|<\/a>)$/i,i=/^(<img\ssrc="(https?:\/\/|\/)[-A-Za-z0-9+&@#\/%?=~_|!:,.;\(\)]+"(\swidth="\d{1,3}")?(\sheight="\d{1,3}")?(\salt="[^"<>]*")?(\stitle="[^"<>]*")?\s?\/?>)$/i;function sanitizeTag(r){return r.match(e)||r.match(n)||r.match(i)?r:""}function balanceTags(r){if(""==r)return"";var t,e,n=/<\/?\w+[^>]*(\s|$|>)/g,i=r.toLowerCase().match(n),a=(i||[]).length;if(0==a)return r;for(var o,s=[],c=[],h=!1,u=0;u<a;u++)if(t=i[u].replace(/<\/?(\w+).*/,"$1"),!(s[u]||"<p><img><br><li><hr>".search("<"+t+">")>-1)){if(e=i[u],o=-1,!/^<\//.test(e))for(var f=u+1;f<a;f++)if(!s[f]&&i[f]=="</"+t+">"){o=f;break}-1==o?h=c[u]=!0:s[o]=!0}if(!h)return r;u=0;return r=r.replace(n,(function(r){var t=c[u]?"":r;return u++,t}))}}();