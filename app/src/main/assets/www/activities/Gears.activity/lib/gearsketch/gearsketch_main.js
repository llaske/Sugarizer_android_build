(function(){"use strict";var t,e,o,n,r,a,i,__bind=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty,h=[].slice;a=window.gearsketch.Point,t=window.gearsketch.ArcSegment,window.gearsketch.LineSegment,i=window.gearsketch.Util,n=window.gearsketch.model.Gear,o=window.gearsketch.model.Chain,e=window.gearsketch.model.Board,r=function(){var r,u,d,l,c;function GearSketch(t){null==t&&(t=!0),this.update=__bind(this.update,this),this.updateAndDrawNoRAF=__bind(this.updateAndDrawNoRAF,this),this.updateAndDraw=__bind(this.updateAndDraw,this),this.loadButtons(),this.showButtons=t,this.loadDemoPointer(),this.loadBoard(),this.canvas=document.getElementById("gearsketch_canvas"),this.canvasOffsetX=this.canvas.getBoundingClientRect().left,this.canvasOffsetY=this.canvas.getBoundingClientRect().top,this.isDemoPlaying=!1,this.updateCanvasSize(),this.addCanvasListeners(),this.lastUpdateTime=(new Date).getTime(),this.updateAndDrawNoRAF()}return d=i.MODULE,r=i.AXIS_RADIUS,u=[["gearButton","GearIcon.png"],["chainButton","ChainIcon.png"],["momentumButton","MomentumIcon.png"],["playButton","PlayIcon.png"]],l={PEN_DOWN:"penDown",PEN_UP:"penUp",PEN_TAP:"penTap"},c={STRAIGHT:"straight",CIRCLE:"circle",LEFT_HALF_CIRCLE:"leftHalfCircle",RIGHT_HALF_CIRCLE:"rightHalfCircle"},GearSketch.prototype.buttons={},GearSketch.prototype.loadedButtons=0,GearSketch.prototype.areButtonsLoaded=!1,GearSketch.prototype.selectedButton=u[0][0],GearSketch.prototype.gearImages={},GearSketch.prototype.isPenDown=!1,GearSketch.prototype.stroke=[],GearSketch.prototype.offset=new a,GearSketch.prototype.message="",GearSketch.prototype.messageColor="black",GearSketch.prototype.pointerLocation=new a,GearSketch.prototype.currentDemoMovement=0,GearSketch.prototype.movementCompletion=0,GearSketch.prototype.restTimer=0,GearSketch.prototype.buttonLoaded=function(){if(this.loadedButtons++,this.loadedButtons-1==u.length-1)return this.areButtonsLoaded=!0},GearSketch.prototype.loadButtons=function(){var t,e,o,n,r,i,s,h,d=this;for(n=20,h=[],r=0,i=u.length;r<i;r++)o=(s=u[r])[0],e=s[1],(t=new Image).name=o,t.onload=function(){return d.buttonLoaded()},t.src="img/"+e,t.location=new a(n,20),t.padding=3,this.buttons[o]=t,h.push(n+=80);return h},GearSketch.prototype.loadDemoPointer=function(){var t,e=this;return(t=new Image).onload=function(){return e.pointerImage=t},t.src="img/hand.png"},GearSketch.prototype.loadBoard=function(){var t,o,n,r,a,s;for(r in this.board=function(){if(!(parent.location.hash.length>1))return new e;try{return n=parent.location.hash.substr(1),t=i.sendGetRequest("boards/"+n+".txt"),e.fromObject(JSON.parse(t))}catch(t){return t,this.displayMessage("Error: could not load board","red",2e3),new e}}.call(this),s=[],a=this.board.getGears())o=a[r],s.push(this.addGearImage(o));return s},GearSketch.prototype.displayMessage=function(t,e,o){var n=this;if(null==e&&(e="black"),null==o&&(o=0),this.message=t,this.messageColor=e,o>0)return setTimeout((function(){return n.clearMessage()}),o)},GearSketch.prototype.clearMessage=function(){return this.message=""},GearSketch.prototype.selectButton=function(t){return this.selectedButton=t},GearSketch.prototype.shouldShowButtons=function(){return this.showButtons||this.isDemoPlaying},GearSketch.prototype.addCanvasListeners=function(){var t,e=this;return(t=Hammer(this.canvas,{drag_min_distance:1})).on("touch",(function(t){return e.forwardPenDownEvent.call(e,t)})),t.on("drag",(function(t){return e.forwardPenMoveEvent.call(e,t)})),t.on("release",(function(t){return e.forwardPenUpEvent.call(e,t)}))},GearSketch.prototype.forwardPenDownEvent=function(t){var e,o;return t.gesture.preventDefault(),this.isDemoPlaying?this.stopDemo():(e=t.gesture.center.pageX-this.canvasOffsetX,o=t.gesture.center.pageY-this.canvasOffsetY,this.handlePenDown(e,o))},GearSketch.prototype.forwardPenMoveEvent=function(t){var e,o;if(t.gesture.preventDefault(),!this.isDemoPlaying)return e=t.gesture.center.pageX-this.canvasOffsetX,o=t.gesture.center.pageY-this.canvasOffsetY,this.handlePenMove(e,o)},GearSketch.prototype.forwardPenUpEvent=function(t){if(!this.isDemoPlaying)return this.handlePenUp()},GearSketch.prototype.handlePenDown=function(t,e){var o,n;return n=new a(t,e),this.isPenDown?this.handlePenUp():(o=this.getButtonAt(t,e))?this.selectButton(o.name):"gearButton"===this.selectedButton?(this.selectedGear=this.board.getTopLevelGearAt(n),null!=this.selectedGear?this.offset=n.minus(this.selectedGear.location):null==this.board.getGearAt(n)&&this.stroke.push(n),this.isPenDown=!0):"chainButton"===this.selectedButton?(this.stroke.push(n),this.isPenDown=!0):"momentumButton"===this.selectedButton?(this.selectedGear=this.board.getGearAt(n),this.selectedGear&&(this.selectedGear.momentum=0,this.selectedGearMomentum=this.calculateMomentumFromCoords(this.selectedGear,t,e)),this.isPenDown=!0):void 0},GearSketch.prototype.handlePenMove=function(t,e){var o,r,i;if(i=new a(t,e),this.isPenDown)if("gearButton"===this.selectedButton){if(this.selectedGear)return r=i.minus(this.offset),o=this.board.placeGear(this.selectedGear,r),this.goalLocationGear=o?null:new n(r,this.selectedGear.rotation,this.selectedGear.numberOfTeeth,this.selectedGear.id,this.selectedGear.hue);if(this.stroke.length>0)return this.stroke.push(i)}else{if("chainButton"===this.selectedButton)return this.stroke.push(i);if("momentumButton"===this.selectedButton&&this.selectedGear)return this.selectedGearMomentum=this.calculateMomentumFromCoords(this.selectedGear,t,e)}},GearSketch.prototype.handlePenUp=function(){if(this.isPenDown)return"gearButton"===this.selectedButton?null==this.selectedGear&&0!==this.stroke.length&&this.processGearStroke():"chainButton"===this.selectedButton?this.processChainStroke():"momentumButton"===this.selectedButton&&(this.selectedGear&&(Math.abs(this.selectedGearMomentum)>.2?this.selectedGear.momentum=this.selectedGearMomentum:this.selectedGear.momentum=0),this.selectedGearMomentum=0),this.selectedGear=null,this.goalLocationGear=null,this.isPenDown=!1},GearSketch.prototype.isButtonAt=function(t,e,o){return t>o.location.x&&t<o.location.x+o.width+2*o.padding&&e>o.location.y&&e<o.location.y+o.height+2*o.padding},GearSketch.prototype.getButtonAt=function(t,e){var o,n,r;if(!this.shouldShowButtons())return null;for(n in r=this.buttons)if(s.call(r,n)&&(o=r[n],this.isButtonAt(t,e,o)))return o;return null},GearSketch.prototype.normalizeStroke=function(t){var e,o,n,r,a,i;if(10,e=[],t.length>0)for(o=t[0],r=2<=t.length?h.call(t,1):[],e.push(o),a=0,i=r.length;a<i;a++)n=r[a],o.distance(n)>10&&(e.push(n),o=n);return e},GearSketch.prototype.createGearFromStroke=function(t){var e,o,r,i,s,h,u,l,c,p,m,g,f,y,G,S,P,v,k,w;if((m=t.length)>0){for(y=0,G=0,c=Number.MAX_VALUE,u=Number.MIN_VALUE,p=Number.MAX_VALUE,l=Number.MIN_VALUE,v=0,w=t.length;v<w;v++)y+=(g=t[v]).x,G+=g.y,c=Math.min(c,g.x),u=Math.max(u,g.x),p=Math.min(p,g.y),l=Math.max(l,g.y);for(P=u-c,r=l-p,S=Math.floor(.5*(P+r)/d),o=0,i=k=0;0<=m?k<m:k>m;i=0<=m?++k:--k)h=(i+1)%m,o+=t[i].x*t[h].y,o-=t[i].y*t[h].x;if(e=Math.abs(o)/2,f=.25*(u-c+(l-p)),(s=Math.PI*Math.pow(f,2)/e)>.8&&s<1.2&&S>8)return new n(new a(y/m,G/m),0,S)}return null},GearSketch.prototype.removeStrokedGears=function(t){var e,o,n,r;for(o in r=[],n=this.board.getTopLevelGears())s.call(n,o)&&(e=n[o],i.pointPathDistance(e.location,t,!1)<e.innerRadius?r.push(this.board.removeGear(e)):r.push(void 0));return r},GearSketch.prototype.processGearStroke=function(){var t,e;return e=this.normalizeStroke(this.stroke),null!=(t=this.createGearFromStroke(e))?this.board.addGear(t)&&!(t.numberOfTeeth in this.gearImages)&&this.addGearImage(t):this.removeStrokedGears(e),this.stroke=[]},GearSketch.prototype.gearImageLoaded=function(t,e){return this.gearImages[t]=e},GearSketch.prototype.addGearImage=function(t){var e,o,r,i,s,h=this;return o=document.createElement("canvas"),s=2*(t.outerRadius+d),o.height=s,o.width=s,e=o.getContext("2d"),r=new n(new a(.5*s,.5*s),0,t.numberOfTeeth,t.id,null,null,null,null,t.hue),this.drawGear(e,r),(i=new Image).onload=function(){return h.gearImageLoaded(t.numberOfTeeth,i)},i.src=o.toDataURL("image/png")},GearSketch.prototype.removeStrokedChains=function(t){var e,o,n,r;for(o in r=[],n=this.board.getChains())s.call(n,o)&&((e=n[o]).intersectsPath(t)?r.push(this.board.removeChain(e)):r.push(void 0));return r},GearSketch.prototype.processChainStroke=function(){var t,e,n;return n=this.normalizeStroke(this.stroke),this.stroke=[],e=i.findGearsInsidePolygon(n,this.board.getGears()),n.length>=3&&e.length>0?(t=new o(n),this.board.addChain(t)):n.length>=2?this.removeStrokedChains(n):void 0},GearSketch.prototype.calculateMomentumFromCoords=function(t,e,o){var n;return(n=Math.atan2(o-t.location.y,e-t.location.x)+.5*Math.PI)<Math.PI?n:n-2*Math.PI},GearSketch.prototype.updateAndDraw=function(){var t=this;return setTimeout((function(){return requestAnimationFrame(t.updateAndDraw),t.update(),t.draw()}),1e3/60)},GearSketch.prototype.updateAndDrawNoRAF=function(){var t=this;return this.update(),this.draw(),setTimeout((function(){return t.updateAndDrawNoRAF()}),1e3/60)},GearSketch.prototype.update=function(){var t,e;return t=(e=(new Date).getTime())-this.lastUpdateTime,"playButton"===this.selectedButton&&this.board.rotateAllTurningObjects(t),this.isDemoPlaying&&this.updateDemo(t),this.lastUpdateTime=e},GearSketch.prototype.drawGear=function(t,e,o){var n,i,s,h,u,d,l,c,p,m,g,f,y,G,S;if(null==o&&(o="black"),p=(G=e.location).x,m=G.y,c=e.rotation,u=e.numberOfTeeth,i=this.gearImages[e.numberOfTeeth],"black"===o&&null!=i)return i=this.gearImages[e.numberOfTeeth],t.save(),t.translate(p,m),t.rotate(c),t.drawImage(i,-.5*i.width,-.5*i.height),void t.restore();for(n=2*Math.PI/u,h=[],d=[],s=g=0;0<=u?g<u:g>u;s=0<=u?++g:--g)for(l=f=0;f<4;l=++f)0===l||3===l?h.push(a.polar((s+.25*l)*n,e.innerRadius)):d.push(a.polar((s+.25*l)*n,e.outerRadius));for(t.save(),"black"===o?(e.hue||(e.hue=Math.floor(360*Math.random())),t.fillStyle="hsla("+e.hue+", 85%, 60%, 0.8)"):t.fillStyle="hsla(0, 0%, 90%, 0.2)",t.strokeStyle=o,t.lineWidth=2,t.translate(p,m),t.rotate(c),t.beginPath(),t.moveTo(e.innerRadius,0),s=y=0,S=2*u;0<=S?y<S:y>S;s=0<=S?++y:--y)s%2==0?(t.lineTo(h[s].x,h[s].y),t.lineTo(d[s].x,d[s].y)):(t.lineTo(d[s].x,d[s].y),t.lineTo(h[s].x,h[s].y));return t.closePath(),t.fill(),t.stroke(),t.beginPath(),t.moveTo(r,0),t.arc(0,0,r,0,2*Math.PI,!0),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(r,0),t.lineTo(e.innerRadius,0),t.closePath(),t.stroke(),t.restore()},GearSketch.prototype.drawButton=function(t,e){var o,n,r,a,i,s;return a=(s=e.location).x,i=s.y,n=e.padding,t.save(),t.translate(a,i),t.beginPath(),10,r=e.width+2*n,o=e.height+2*n,t.moveTo(10,0),t.lineTo(r-10,0),t.quadraticCurveTo(r,0,r,10),t.lineTo(r,o-10),t.quadraticCurveTo(r,o,r-10,o),t.lineTo(10,o),t.quadraticCurveTo(0,o,0,o-10),t.lineTo(0,10),t.quadraticCurveTo(0,0,10,0),e.name===this.selectedButton?t.fillStyle="rgba(50, 150, 255, 0.8)":t.fillStyle="rgba(255, 255, 255, 0.8)",t.fill(),t.lineWidth=1,t.strokeStyle="black",t.stroke(),t.drawImage(e,n,n),t.restore()},GearSketch.prototype.drawMomentum=function(t,e,o,n){var r,s,h,u,d,l,c,p,m;return null==n&&(n="red"),c=e.pitchRadius,m=new a(e.location.x,e.location.y-c),t.save(),t.lineWidth=5,t.lineCap="round",t.strokeStyle=n,t.translate(m.x,m.y),t.beginPath(),t.arc(0,c,c,-.5*Math.PI,o-.5*Math.PI,o<0),t.stroke(),15,r=.2*Math.PI,h=-Math.cos(o+.5*Math.PI)*c,u=c-Math.sin(o+.5*Math.PI)*c,s=new a(h,u),p=i.sign(o),d=s.minus(a.polar(o+r,15*p)),t.beginPath(),t.moveTo(h,u),t.lineTo(d.x,d.y),t.stroke(),l=s.minus(a.polar(o-r,15*p)),t.beginPath(),t.moveTo(h,u),t.lineTo(l.x,l.y),t.stroke(),t.restore()},GearSketch.prototype.drawChain=function(e,n){var r,a,s,h,u,d,l,c,p;for(e.save(),e.lineWidth=o.WIDTH,e.lineCap="round",e.strokeStyle="rgb(0, 0, 255)",e.moveTo(n.segments[0].start.x,n.segments[0].start.y),h=0,d=(c=n.segments).length;h<d;h++)(s=c[h])instanceof t?(r=s.direction===i.Direction.COUNTER_CLOCKWISE,e.beginPath(),e.arc(s.center.x,s.center.y,s.radius,s.startAngle,s.endAngle,r),e.stroke()):(e.beginPath(),e.moveTo(s.start.x,s.start.y),e.lineTo(s.end.x,s.end.y),e.stroke());for(e.fillStyle="white",u=0,l=(p=n.findPointsOnChain(25)).length;u<l;u++)a=p[u],e.beginPath(),e.arc(a.x,a.y,3,0,2*Math.PI,!0),e.fill();return e.restore()},GearSketch.prototype.drawDemoPointer=function(t,e){return t.drawImage(this.pointerImage,e.x-.5*this.pointerImage.width,e.y)},GearSketch.prototype.draw=function(){var t,e,o,n,r,a,i,h,u,d,l,c,p,m,g,f,y,G,S;if(null!=this.canvas.getContext){for(this.updateCanvasSize(),(r=this.canvas.getContext("2d")).clearRect(0,0,this.canvas.width,this.canvas.height),e=[],i=d=0,f=(u=this.board.getGearsSortedByGroupAndLevel()).length;0<=f?d<f:d>f;i=0<=f?++d:--d)if(h=(a=u[i]).momentum,a===this.selectedGear&&this.goalLocationGear?(this.drawGear(r,a,"grey"),h&&e.push([a,h,"grey"])):(this.drawGear(r,a),h&&e.push([a,h,"red"])),i===u.length-1||this.board.getLevelScore(a)!==this.board.getLevelScore(u[i+1])){for(l=0,m=(y=this.board.getChainsInGroupOnLevel(a.group,a.level)).length;l<m;l++)n=y[l],this.drawChain(r,n);for(c=0,g=e.length;c<g;c++)t=e[c],this.drawMomentum(r,t[0],t[1],t[2]);e=[]}if(this.goalLocationGear&&this.drawGear(r,this.goalLocationGear,"red"),null!=this.selectedGear&&this.selectedGearMomentum&&this.drawMomentum(r,this.selectedGear,this.selectedGearMomentum),this.stroke.length>0){for(r.save(),"gearButton"===this.selectedButton?(r.strokeStyle="black",r.lineWidth=2):(r.strokeStyle="blue",r.lineWidth=4),r.beginPath(),r.moveTo(this.stroke[0].x,this.stroke[0].y),i=p=1,G=this.stroke.length;1<=G?p<G:p>G;i=1<=G?++p:--p)r.lineTo(this.stroke[i].x,this.stroke[i].y);r.stroke(),r.restore()}if(this.areButtonsLoaded&&this.shouldShowButtons())for(o in S=this.buttons)s.call(S,o)&&this.drawButton(r,this.buttons[o]);if(this.message.length>0&&(r.save(),r.fillStyle=this.messageColor,r.font="bold 20px Arial",r.fillText(this.message,20,120),r.restore()),this.isDemoPlaying&&this.pointerImage)return this.drawDemoPointer(r,this.pointerLocation)}},GearSketch.prototype.updateCanvasSize=function(){this.canvas.width=this.canvas.parentElement.getBoundingClientRect().width,this.canvas.height=this.canvas.parentElement.getBoundingClientRect().height},GearSketch.prototype.loadDemoMovements=function(){return this.demoMovements=[{from:this.getButtonCenter("playButton"),to:this.getButtonCenter("gearButton"),atEnd:l.PEN_TAP,type:c.STRAIGHT,duration:2e3},{to:new a(300,200),type:c.STRAIGHT,duration:1500},{atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.CIRCLE,radius:100,duration:1500},{to:new a(500,200),type:c.STRAIGHT,duration:1e3},{atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.CIRCLE,radius:40,duration:1e3},{to:new a(500,240),type:c.STRAIGHT,duration:500},{to:new a(300,300),atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.STRAIGHT,duration:1500},{to:new a(100,180),type:c.STRAIGHT,duration:1e3},{atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.CIRCLE,radius:90,duration:1e3},{to:new a(100,260),type:c.STRAIGHT,duration:500},{to:new a(180,260),atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.STRAIGHT,duration:1500},{to:new a(550,220),type:c.STRAIGHT,duration:1500},{atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.CIRCLE,radius:80,duration:1e3},{to:this.getButtonCenter("chainButton"),atEnd:l.PEN_TAP,type:c.STRAIGHT,duration:1500},{to:new a(280,150),type:c.STRAIGHT,duration:1500},{atStart:l.PEN_DOWN,type:c.LEFT_HALF_CIRCLE,radius:140,duration:1500,pause:0},{to:new a(600,400),type:c.STRAIGHT,duration:1e3,pause:0},{type:c.RIGHT_HALF_CIRCLE,radius:110,duration:1e3,pause:0},{to:new a(280,150),atEnd:l.PEN_UP,type:c.STRAIGHT,duration:1e3},{to:this.getButtonCenter("momentumButton"),atEnd:l.PEN_TAP,type:c.STRAIGHT,duration:1500},{to:new a(185,180),type:c.STRAIGHT,duration:1500},{to:new a(150,190),atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.STRAIGHT,duration:1e3},{to:this.getButtonCenter("playButton"),atEnd:l.PEN_TAP,type:c.STRAIGHT,duration:1500},{to:this.getButtonCenter("chainButton"),atEnd:l.PEN_TAP,type:c.STRAIGHT,duration:3e3},{to:new a(425,250),type:c.STRAIGHT,duration:1e3},{to:new a(525,150),atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.STRAIGHT,duration:1e3},{to:this.getButtonCenter("gearButton"),atEnd:l.PEN_TAP,type:c.STRAIGHT,duration:1500},{to:new a(20,250),type:c.STRAIGHT,duration:1e3},{to:new a(650,300),atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.STRAIGHT,duration:1500},{to:new a(425,200),type:c.STRAIGHT,duration:1e3},{to:new a(200,400),atStart:l.PEN_DOWN,atEnd:l.PEN_UP,type:c.STRAIGHT,duration:1500}]},GearSketch.prototype.getButtonCenter=function(t){var e;return e=this.buttons[t],new a(e.location.x,e.location.y).plus(new a(.5*e.width+e.padding,.5*e.height+e.padding))},GearSketch.prototype.updateDemo=function(t){var e;if(this.restTimer>0)this.restTimer=Math.max(this.restTimer-t,0);else{if(this.currentDemoMovement!==this.demoMovements.length)return e=this.demoMovements[this.currentDemoMovement],0===this.movementCompletion&&(null==e.from&&(e.from=this.pointerLocation),null==e.pause&&(e.pause=500),this.pointerLocation=e.from.clone(),e.atStart===l.PEN_DOWN&&this.handlePenDown(this.pointerLocation.x,this.pointerLocation.y)),this.movementCompletion<1&&(this.movementCompletion=Math.min(1,this.movementCompletion+t/e.duration),this.updatePointerLocation(e,this.movementCompletion),this.handlePenMove(this.pointerLocation.x,this.pointerLocation.y)),1===this.movementCompletion?(e.atEnd===l.PEN_TAP?(this.handlePenDown(this.pointerLocation.x,this.pointerLocation.y),this.handlePenUp()):e.atEnd===l.PEN_UP&&this.handlePenUp(),this.restTimer=e.pause,this.movementCompletion=0,this.currentDemoMovement++):void 0;this.stopDemo()}},GearSketch.prototype.updatePointerLocation=function(t,e){var o,n,r;return t.type===c.STRAIGHT?(r=t.to.minus(t.from),this.pointerLocation=t.from.plus(r.times(e))):t.type===c.CIRCLE?(n=new a(t.from.x,t.from.y+t.radius),this.pointerLocation=n.plus(a.polar(Math.PI-2*(e-.25)*Math.PI,t.radius))):t.type===c.LEFT_HALF_CIRCLE?(n=new a(t.from.x,t.from.y+t.radius),o=1.5*Math.PI-e*Math.PI,this.pointerLocation=n.plus(a.polar(o,t.radius))):t.type===c.RIGHT_HALF_CIRCLE?(n=new a(t.from.x,t.from.y-t.radius),o=.5*Math.PI-e*Math.PI,this.pointerLocation=n.plus(a.polar(o,t.radius))):void 0},GearSketch.prototype.playDemo=function(){this.loadDemoMovements(),this.boardBackup=this.board.clone(),this.board.clear(),this.currentDemoMovement=0,this.movementCompletion=0,this.isDemoPlaying=!0},GearSketch.prototype.stopDemo=function(){return this.isDemoPlaying=!1,this.restTimer=0,this.stroke=[],this.selectedGear=null,this.selectedIcon="gearIcon",this.board.restoreAfterDemo(this.boardBackup),this.clearMessage()},GearSketch.prototype.boardUploaded=function(t){return parent.location.hash=t.target.responseText.trim(),this.displayMessage("Board saved. Share it by copying the text in your address bar.","black",4e3)},GearSketch.prototype.uploadBoard=function(){var t,e=this;return t=JSON.stringify(this.board),i.sendPostRequest(t,"upload_board.php",(function(t){return e.boardUploaded(t)}))},GearSketch}(),window.gearsketch.GearSketch=r}).call(this);