function _computeMinRange(e){e.value=Math.min(e.value,e.parentNode.childNodes[5].value-1);var t=100/(parseInt(e.max)-parseInt(e.min))*parseInt(e.value)-100/(parseInt(e.max)-parseInt(e.min))*parseInt(e.min),n=e.parentNode.childNodes[1].childNodes;n[1].style.width=t+"%",n[5].style.left=t+"%",n[7].style.left=t+"%";let i=app.$refs.api.getStreetSettings(),a=(i.rich-i.poor)/100,o=0==e.value?i.poor:i.poor+e.value*a;document.getElementById("slider-min").innerHTML=_formatIncome(o)}function _computeMaxRange(e){e.value=Math.max(e.value,e.parentNode.childNodes[3].value- -1);var t=100/(parseInt(e.max)-parseInt(e.min))*parseInt(e.value)-100/(parseInt(e.max)-parseInt(e.min))*parseInt(e.min),n=e.parentNode.childNodes[1].childNodes;n[3].style.width=100-t+"%",n[5].style.right=100-t+"%",n[9].style.left=t+"%";let i=app.$refs.api.getStreetSettings(),a=(i.rich-i.poor)/100,o=100==e.value?i.rich:e.value*a;document.getElementById("slider-max").innerHTML=_formatIncome(o)}function _initSlider(e,t,n){let i=document.getElementById("slider-incomes").childNodes;i[1].childNodes[7].style.left=e+"%",i[3].value=e,i[1].childNodes[9].style.left=t+"%",i[5].value=t,i[1].childNodes[5].style.backgroundColor=n,_computeMinRange(i[3]),_computeMaxRange(i[5])}function _formatIncome(e){return new Intl.NumberFormat(app.$refs.api.language,{style:"currency",currency:"USD",maximumFractionDigits:0,minimumFractionDigits:0}).format(Math.floor(e)).replace("$US","$")}define(["sugar-web/graphics/palette","text!activity/palettes/incomes.html"],(function(e,t){var n={IncomePalette:function(n,i){e.Palette.call(this,n,i),this.getPalette().id="incomepalette",this.incomeEvent=document.createEvent("CustomEvent"),this.incomeEvent.initCustomEvent("income",!0,!0,{min:0,max:11e3});var a=document.createElement("div");a.innerHTML=t,this.setContent([a]);var o=this;let r=document.getElementById("slider-incomes").childNodes,l=r[3],c=r[5];l.addEventListener("input",(function(e){let t=app.$refs.api.getStreetSettings(),n=(t.rich-t.poor)/100;_computeMinRange(l),o.incomeEvent.detail.min=0==l.value?t.poor:t.poor+l.value*n,o.incomeEvent.detail.max=100==c.value?t.rich:c.value*n,o.getPalette().dispatchEvent(o.incomeEvent)})),c.addEventListener("input",(function(e){let t=app.$refs.api.getStreetSettings(),n=(t.rich-t.poor)/100;_computeMaxRange(c),o.incomeEvent.detail.min=0==l.value?t.poor:t.poor+l.value*n,o.incomeEvent.detail.max=100==c.value?t.rich:c.value*n,o.getPalette().dispatchEvent(o.incomeEvent)})),document.querySelector("#content").addEventListener("click",(function(e){o.popDown()}));let s=this.getPalette().childNodes[1];s.style.width="450px",s.style.maxWidth="400px",s.style.height="110px",n.addEventListener("click",(function(e){let t=app.$refs.api.getStreetSettings(),n=(t.rich-t.poor)/100;_initSlider((app.currentMinIncome-t.poor)/n,app.currentMaxIncome/n,app.$refs.SugarActivity.getEnvironment().user.colorvalue.stroke)}))}};return n.IncomePalette.prototype=Object.create(e.Palette.prototype,{addEventListener:{value:function(e,t,n){return this.getPalette().addEventListener(e,t,n)},enumerable:!0,configurable:!0,writable:!0}}),n}));