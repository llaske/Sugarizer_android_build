define((function(){"use strict";var e={};function changeColors(e,o,r){var n;return o&&(n=/(<!ENTITY fill_color ")(.*)(">)/,e=e.replace(n,"$1"+o+"$3")),r&&(n=/(<!ENTITY stroke_color ")(.*)(">)/,e=e.replace(n,"$1"+r+"$3")),e}function getBackgroundURL(e){var o=(e.currentStyle||window.getComputedStyle(e,"")).backgroundImage.slice(4,-1),r=o.length-1;return'"'==o[0]&&'"'==o[r]&&(o=o.slice(1,r)),o}return e.load=function(e,o){var r,n="data:image/svg+xml,";"uri"in e?r=e.uri:"name"in e&&(r="lib/graphics/icons/"+e.name+".svg");var t=e.fillColor,a=e.strokeColor;if("data"!=r.substring(0,4)){var l=new XMLHttpRequest;l.onload=function(){var e=changeColors(this.responseText,t,a);o(n+escape(e))},l.open("GET",r),l.send()}else{var c=changeColors(unescape(r.slice(n.length)),t,a);o(n+escape(c))}},e.colorize=function(o,r,n){var t={uri:getBackgroundURL(o),strokeColor:r.stroke,fillColor:r.fill};e.load(t,(function(e){!function setBackgroundURL(e,o){e.style.backgroundImage="url('"+o+"')"}(o,e),n&&n()}))},e}));