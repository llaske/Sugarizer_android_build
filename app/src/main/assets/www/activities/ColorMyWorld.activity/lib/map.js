define(["activity/ol","print","util","colormyworld","humane","flag","l10n"],(function(e,t,l,o,r,n,i){var a={map:null,featureOverlay:null,HILIGHTS:[],tooltipDisplay:null,test:function(){return INSTALLED.keys}};return a.setup_map=function(){window.map=new e.Map({layers:[],target:"cmw_bg",view:new e.View({center:e.proj.transform(INSTALLED.Africa.center,"EPSG:4326","EPSG:3857"),zoom:2})}),window.map.on("click",(function(l){if(o.mode==COLORING){var u=!1;dummmy=window.map.forEachFeatureAtPixel(l.pixel,(function(l,c){var f=l.get("NAME");if(f||(f=l.get("Name")),f||(f=l.get("name")),o.currents.indexOf(f)<0){a.tooltipDisplay&&f==a.tooltipDisplay||(a.tooltipDisplay=f,r.timeout=1e3,r.log(n[`${f.replace(/ /g,"_")}`]+" "+i.get(f.replace(/ /g,"_")).replace(/_/g," ")),setTimeout((function(){a.tooltipDisplay=null}),r.timeout));var s=o.getRGBColorString();t(s);var w=new e.style.Style({fill:new e.style.Fill({color:o.getRGBColorString()}),stroke:new e.style.Stroke({color:DEFAULT_STROKE,width:1})});l.setStyle(w),u=!0}})),u||o.set_background(null)}else o.check_feature(l.pixel)}));var l,u={};a.featureOverlay=new e.layer.Vector({source:new e.source.Vector,map:window.map,style:function(t,l){return u[""]||(u[""]=new e.style.Style({stroke:new e.style.Stroke({color:"#ff0",width:1}),fill:new e.style.Fill({color:"rgba(0,200,0,0.2)"}),text:new e.style.Text({font:"12px Calibri,sans-serif",text:"",fill:new e.style.Fill({color:"#000"}),stroke:new e.style.Stroke({color:"#ff0",width:3})})})),u[""]}});window.map.on("pointermove",(function(e){e.dragging||function(e){var t=map.forEachFeatureAtPixel(e,(function(e){return e})),r=null;t&&((r=t.get("name"))||(r=t.get("Name")),r||(r=t.get("NAME"))),REGION_NAMES.indexOf(r)>-1||o.mode!=TOUR&&t!==l&&(l&&a.featureOverlay.getSource().removeFeature(l),t&&a.featureOverlay.getSource().addFeature(t),l=t)}(window.map.getEventPixel(e.originalEvent))}))},a}));