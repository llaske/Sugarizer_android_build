define(["activity/ol","print","util","colormyworld","humane","flag"],(function(e,t,l,o,r,n){var i={map:null,featureOverlay:null,HILIGHTS:[],tooltipDisplay:null,test:function(){return INSTALLED.keys}};return i.setup_map=function(){window.map=new e.Map({layers:[],target:"cmw_bg",view:new e.View({center:e.proj.transform(INSTALLED.Africa.center,"EPSG:4326","EPSG:3857"),zoom:2})}),window.map.on("click",(function(l){if(o.mode==COLORING){var a=!1;dummmy=window.map.forEachFeatureAtPixel(l.pixel,(function(l,u){var c=l.get("NAME");if(c||(c=l.get("Name")),c||(c=l.get("name")),o.currents.indexOf(c)<0){i.tooltipDisplay&&c==i.tooltipDisplay||(i.tooltipDisplay=c,r.timeout=1e3,r.log(n[`${c.replace(/ /g,"_")}`]+" "+document.webL10n.get(c.replace(/ /g,"_")).replace(/_/g," ")),setTimeout((function(){i.tooltipDisplay=null}),r.timeout));var f=o.getRGBColorString();t(f);var s=new e.style.Style({fill:new e.style.Fill({color:o.getRGBColorString()}),stroke:new e.style.Stroke({color:DEFAULT_STROKE,width:1})});l.setStyle(s),a=!0}})),a||o.set_background(null)}else o.check_feature(l.pixel)}));var l,a={};i.featureOverlay=new e.layer.Vector({source:new e.source.Vector,map:window.map,style:function(t,l){return a[""]||(a[""]=new e.style.Style({stroke:new e.style.Stroke({color:"#ff0",width:1}),fill:new e.style.Fill({color:"rgba(0,200,0,0.2)"}),text:new e.style.Text({font:"12px Calibri,sans-serif",text:"",fill:new e.style.Fill({color:"#000"}),stroke:new e.style.Stroke({color:"#ff0",width:3})})})),a[""]}});window.map.on("pointermove",(function(e){e.dragging||function(e){var t=map.forEachFeatureAtPixel(e,(function(e){return e})),r=null;t&&((r=t.get("name"))||(r=t.get("Name")),r||(r=t.get("NAME"))),REGION_NAMES.indexOf(r)>-1||o.mode!=TOUR&&t!==l&&(l&&i.featureOverlay.getSource().removeFeature(l),t&&i.featureOverlay.getSource().addFeature(t),l=t)}(window.map.getEventPixel(e.originalEvent))}))},i}));