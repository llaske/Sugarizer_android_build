define(["sugar-web/activity/activity","sugar-web/datastore","sugar-web/env","webL10n","tutorial"],(function(e,t,n,o,a){activity=e,requirejs(["domReady!"],(function(e){activity.setup();var t=activity.getDatastoreObject();n.getEnvironment((function(e,t){var n="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,a=t.user?t.user.language:n;o.language.code=a})),loadGallery(null),appInit(),t.loadAsText((function(e,t,n){loadGallery(JSON.parse(n));for(var o=0;o<thumbcnvs.length;o++)drawThumb(thumbcnvs[o],gallery[o]);"edit"==mode?editMode():selectorMode(),loadPos(selected)})),document.getElementById("help-button").addEventListener("click",(function(e){a.start()})),document.getElementById("fullscreen-button").addEventListener("click",(function(){document.getElementById("main-toolbar").style.display="none",document.getElementById("canvas").style.top="0px",document.getElementById("unfullscreen-button").style.visibility="visible",computeSize()}));var unfullscreen=function(e){document.getElementById("main-toolbar").style.display="block",document.getElementById("canvas").style.top="55px",document.getElementById("unfullscreen-button").style.visibility="hidden",computeSize()};document.getElementById("unfullscreen-button").addEventListener("click",unfullscreen),("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)&&document.getElementById("unfullscreen-button").addEventListener("touchstart",unfullscreen,!1)}))}));