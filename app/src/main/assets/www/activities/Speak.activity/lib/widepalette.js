define((function(){"use strict";var e=[];var t={};return t.Palette=function(t,i){var n,o,a,l,r;this.invoker=t,this.invoker.classList.contains("toolbutton")&&this.invoker.classList.add("invoker"),this.primaryText=i;var s=this;function updatePosition(e,t){var i,o;if(void 0!==e&&void 0!==t)i=e,o=t;else{var a=function getOffset(e){var t=e.currentStyle||window.getComputedStyle(e,""),i=-2*t.marginLeft.slice(0,-2),n=-1*t.marginTop.slice(0,-2),o=e.getBoundingClientRect();return i+=o.left,{top:n+=o.top,left:i,width:o.width,height:o.height}}(s.invoker);i=a.left,o=a.top}n.style.left=i+"px",n.style.top=o+"px"}function createPaletteElement(){if(void 0===n){if((n=document.createElement("div")).className="palette widepalette",n.style.visibility="hidden",document.body.appendChild(n),s.invoker.classList.contains("toolbutton")){var e=document.createElement("div");e.className="palette-invoker";var t=s.invoker.currentStyle||window.getComputedStyle(s.invoker,"");e.style.backgroundImage=t.backgroundImage,e.addEventListener("click",(function(e){s.toggle()})),n.appendChild(e)}(o=document.createElement("div")).className="wrapper",n.appendChild(o),void 0!==s.primaryText&&((a=document.createElement("div")).className="header",a.innerText=s.primaryText,o.appendChild(a)),(l=document.createElement("hr")).className="header-separator",l.style.display="none",o.appendChild(l),(r=document.createElement("div")).className="container",o.appendChild(r),updatePosition()}}e.push(this),t.addEventListener("click",(function(e){s.invoker.classList.contains("toolbutton")||updatePosition(e.x,e.y),s.toggle()})),this.getPalette=function(){return void 0===n&&createPaletteElement(),n},this.setContent=function(e){void 0===n&&createPaletteElement(),function removePreviousContent(){for(var e=0;e<r.children.length;e++){var t=r.children[e];r.removeChild(t)}}(),function addNewContent(){for(var t=0;t<e.length;t++){var i=e[t];r.appendChild(i)}}(),e.length>0&&void 0!==this.primaryText?l.style.display="block":l.style.display="none"},this.isDown=function(){return void 0===n||"hidden"==n.style.visibility}},t.Palette.prototype.popUp=function(){for(var t=0;t<e.length;t++){var i=e[t];i!=this&&i.popDown()}this.getPalette().style.visibility="visible"},t.Palette.prototype.popDown=function(){this.getPalette().style.visibility="hidden"},t.Palette.prototype.toggle=function(){this.isDown()?this.popUp():this.popDown()},t}));