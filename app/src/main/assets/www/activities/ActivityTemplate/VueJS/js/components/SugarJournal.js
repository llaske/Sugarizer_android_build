Vue.component("sugar-journal",{data:function(){return{activity:null,LZString:null}},mounted(){var t=this;requirejs(["sugar-web/activity/activity","sugar-web/env","lz-string"],(function(e,n,r){t.activity=e,t.LZString=r,n.getEnvironment((function(e,n){n.objectId?t.activity.getDatastoreObject().loadAsText((function(e,n,o){if(null==e&&null!=o){var a=r.decompressFromUTF16(o);t.$emit("journal-data-loaded",JSON.parse(a),n)}else t.$emit("journal-load-error",e)})):n.sharedId?t.$emit("journal-shared-instance"):t.$emit("journal-new-instance")}))}))},methods:{saveData:function(t){var e=this.LZString.compressToUTF16(JSON.stringify(t));this.activity.getDatastoreObject().setDataAsText(e),this.activity.getDatastoreObject().save((function(t){null===t?console.log("write done."):console.log("write failed.")}))},insertFromJournal:function(t){for(var e=[null,null,null,null],n=0;n<e.length;n++)e[n]=t[n];return new Promise(((t,n)=>{requirejs(["sugar-web/datastore","sugar-web/graphics/journalchooser"],(function(n,r){setTimeout((function(){r.show((function(e){e&&new n.DatastoreObject(e.objectId).loadAsText((function(e,n,r){e?console.error(e):t(r,n)}))}),e[0],e[1],e[2],e[3])}),0)}))}))},createEntry:function(t,e){return new Promise(((n,r)=>{requirejs(["sugar-web/datastore"],(function(r){r.create(e,(function(){n()}),t)}))}))}}});