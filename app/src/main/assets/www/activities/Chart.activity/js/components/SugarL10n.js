Vue.component("sugar-localization",{template:"<div/>",data:function(){return{l10n:null,code:null,dictionary:null,activityInitialized:!1,units:[{name:"Years",factor:30758400},{name:"Months",factor:2592e3},{name:"Weeks",factor:604800},{name:"Days",factor:86400},{name:"Hours",factor:3600},{name:"Minutes",factor:60}]}},computed:{readyToEmit:function(){return null!=this.dictionary&&this.activityInitialized}},watch:{readyToEmit:function(t,n){t&&this.$emit("localized")}},mounted:function(){const t=this;requirejs(["sugar-web/env"],(function(n){n.getEnvironment(((n,e)=>{const i="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,a=e.user?e.user.language:i;t.loadLanguageFile(a)}))}));t.$root.$children.find((function(t){return"SugarActivity"==t.$options.name})).$on("initialized",(function(){t.activityInitialized=!0}))},methods:{loadLanguageFile:function(t){const n=this;requirejs(["lib/i18next.min.js","lib/axios.min.js"],(function(e,i){i.get(`./locales/${t}.json`).then((i=>{e.init({lng:t,fallbackLng:"en",resources:{[t]:{translation:i.data}}},(()=>{n.l10n=e,n.code=e.language,n.dictionary=e.getResourceBundle(e.language,"translation")}))})).catch((t=>{n.loadLanguageFile("en"),console.log(t)}))}))},get:function(t,n){let e="";if(e=this.dictionary&&this.dictionary[t]||t,n){let t=e.match(/{{\s*[\w\.]+\s*}}/g);for(let i in t){let a=t[i].match(/[\w\.]+/)[0];n[a]&&(e=e.replace(t[i],n[a]))}}return e},localize:function(t){const n=this;Object.keys(t).forEach(((e,i)=>{t[e]=n.get(e.substr(6))}))},localizeTimestamp:function(t){const n=0;let e="",i=(Date.now()-t)/1e3;for(let t=0;t<this.units.length;t++){let a=this.units[t].factor,o=Math.floor(i/a);if(o>0&&(n>0&&(e+=","),e+=" "+o+" "+(1==o?this.get(this.units[t].name+"_one"):this.get(this.units[t].name+"_other")),i-=o*a),""!=e&&(n+=1),2==n)break}return 0==n?this.get("SecondsAgo"):this.get("Ago",{time:e})}}});