define(["sugar-web/graphics/palette","mustache"],(function(t,e){var n={TextPalette:function(n,o){t.Palette.call(this,n,o),this.getPalette().id="fontpalette",this.fontChangeEvent=document.createEvent("CustomEvent"),this.fontChangeEvent.initCustomEvent("font-change",!0,!0,{family:"Arial"}),this.template='<center><table><tbody>{{#rows}}<tr>{{#.}}<td style="padding:5px"><button lineHeight="{{lineHeight}}" title="{{fontFamily}}" style="height:55px; width:55px; background-size:40px !important;  background: #fff url({{ icon }}) no-repeat center; "></button></td>{{/.}}</tr>{{/rows}}</tbody></table></center>';var i=document.createElement("div");i.innerHTML=e.render(this.template,{rows:[[{icon:"icons/font-arial.svg",lineHeight:"0.7",fontFamily:"Arial"},{icon:"icons/font-comic-sans.svg",lineHeight:"0.8",fontFamily:"Comic Sans MS"},{icon:"icons/font-verdana.svg",lineHeight:"0.8",fontFamily:"Verdana"}]]}),this.setContent([i]);var r=i.querySelectorAll("button"),a=this;for(var l=0;l<r.length;l++)r[l].addEventListener("click",(function(t){for(var e=0;e<r.length;e++)r[e].style.border="0px solid #000";t.target.style.border="3px solid red",a.fontChangeEvent.detail.family=t.target.title,a.getPalette().dispatchEvent(a.fontChangeEvent),a.popDown()}));!function popDownOnButtonClick(t){for(var e=0;e<r.length;e++)r[e].style.border="0px solid #000";t.target.style.border="3px solid red",a.popDown()}({target:r[0]})}};return n.TextPalette.prototype=Object.create(t.Palette.prototype,{setFont:{value:function(t){for(var e=this.getPalette().querySelectorAll("button"),n=0;n<e.length;n++)t==e[n].title?e[n].style.border="3px solid red":e[n].style.border="0px solid #000"},enumerable:!0,configurable:!0,writable:!0},addEventListener:{value:function(t,e,n){return this.getPalette().addEventListener(t,e,n)},enumerable:!0,configurable:!0,writable:!0}}),n}));