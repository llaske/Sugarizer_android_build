const CSVParser={_detectDelimiter:function(t){let e="",n=0;return t=t.slice(0,4),[",","\t",";","|"].forEach((i=>{let r=0;t.forEach((t=>{r+=t.split('"').filter(((t,e)=>e%2==0)).join("").split(i).length})),r>n&&(n=r,e=i)})),e},_uniquify:function(t){let e={};t.forEach(((n,i)=>{""===n?(e[n]=(e[n]||0)+1,t[i]=`__${e[n]}`):e.hasOwnProperty(n)?t[i]=`${n}__${e[n]++}`:e[n]=1}))},_convertToJSON:function(t,e){const n=[],i=t[0].split(e).map((t=>t.replace(/"/g,"").trim()));this._uniquify(i);let r=!1,o="",s=!0,l=0,c={};for(let h=1;h<t.length;h++){const u=t[h];r||(l=0,s=!1,o="",c={});for(let t=0;t<u.length;t++){const n=u[t],h=u[t+1];'"'===n?t===u.length-1?(r&&(r=!1),o=o.trim(),c[i[l]]=o):s&&'"'===h?(t++,o+='"'):(r&&(r=!1),s=!s):n!==e||s?(o+=n,t===u.length-1&&(s?(r=!0,o+=" "):(o=o.trim(),c[i[l]]=o))):(o=o.trim(),c[i[l]]=o,o="",l++,t===u.length-1&&(c[i[l]]=""))}r||n.push(c)}return{headers:i,data:n}},csvToJson:function(t,e){const n=t.trim().split(/\r\n|\n|\r/);return e=e||this._detectDelimiter(n),this._convertToJSON(n,e)},jsonToCsv:function(t,e,n=","){if(!t.length)return;e?this._uniquify(e):e=Object.keys(t[0]);let i=e.join(n)+"\n",r=Object.keys(t[0]);return t.forEach((t=>{let e=[];r.forEach((i=>{let r=t[i];"string"==typeof r&&r.includes(n)&&(r=`"${r}"`),e.push(r)})),i+=e.join(n)+"\n"})),i}};