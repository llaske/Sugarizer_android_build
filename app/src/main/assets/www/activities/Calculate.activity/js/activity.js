define(["sugar-web/activity/activity","mustache","sugar-web/graphics/palette","activity/calculate-activity","activity/calculate-app","math","parser","nanomodal"],(function(t,e,l){CalculateApp.libs.palette=l,requirejs(["d3"],(function(t){requirejs(["function-plot"],(function(t){CalculateApp.libs.functionPlot=t}))})),CalculateApp.libs.activity=t,CalculateApp.libs.mustache=e,requirejs(["domReady!","activity/trigo-palette","activity/algebra-palette","l10n","sugar-web/datastore","tutorial","sugar-web/env"],(function(e,l,a,n,i,u,c){c.getEnvironment((function(t,e){var l="undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.i18n.getUILanguage():navigator.language,a=e.user?e.user.language:l;n.init(a)})),window.addEventListener("localized",(function(){CalculateApp.translateGui()})),CalculateApp.libs.l10n=n,CalculateApp.libs.trigopalette=l,CalculateApp.libs.algebrapalette=a,initGui(),document.getElementById("help-button").addEventListener("click",(function(t){u.start()})),CalculateApp.focus(),CalculateApp.onResize(),document.getElementById("fullscreen-button").addEventListener("click",(function(){document.getElementById("main-toolbar").style.visibility="hidden",document.getElementById("body").style.bottom="40px",document.getElementById("unfullscreen-button").style.visibility="visible",document.getElementById("unfullscreen-button").style.top="20px"})),document.getElementById("unfullscreen-button").addEventListener("click",(function(){document.getElementById("main-toolbar").style.visibility="visible",document.getElementById("body").style.bottom="0px",document.getElementById("unfullscreen-button").style.visibility="hidden"})),t.setup(),t.getXOColor((function(t,e){void 0!==e&&(CalculateApp.data.buddyColor=e,CalculateApp.displayAllCalculations())})),t.getDatastoreObject().loadAsText((function(t,e,l){var a=JSON.parse(l);void 0!==a&&(CalculateApp.data.calculations=a,CalculateApp.displayAllCalculations())}))}))}));