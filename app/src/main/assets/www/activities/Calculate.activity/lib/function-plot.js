!function(l){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=l();else if("function"==typeof define&&define.amd)define([],l);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).functionPlot=l()}}((function(){return function t(l,c,u){function i(p,f){if(!c[p]){if(!l[p]){var d="function"==typeof require&&require;if(!f&&d)return d(p,!0);if(h)return h(p,!0);var v=new Error("Cannot find module '"+p+"'");throw v.code="MODULE_NOT_FOUND",v}var m=c[p]={exports:{}};l[p][0].call(m.exports,(function(c){var u=l[p][1][c];return i(u||c)}),m,m.exports,t,l,c,u)}return c[p].exports}for(var h="function"==typeof require&&require,p=0;p<u.length;p++)i(u[p]);return i}({1:[function(l,c){"use strict";var u,h,p=window.d3,f=l("events"),d=l("extend"),v=l("./lib/tip"),m=l("./lib/utils"),y=l("./lib/helper/"),x=m.assert;c.exports=function(l){function e(){this.id=l.target,this.linkedGraphs=[this],this.setVars(),this.build(),this.setUpEventListeners()}(l=l||{}).data=l.data||[];var c,m,g,b,w,_,L=p.svg.line().x((function(l){return w(l[0])})).y((function(l){return _(l[1])}));return e.prototype=Object.create(f.prototype),e.prototype.updateBounds=function(){c=this.meta.width=(l.width||u.DEFAULT_WIDTH)-g.left-g.right,m=this.meta.height=(l.height||u.DEFAULT_HEIGHT)-g.top-g.bottom;var h=this.meta.xDomain,f=this.meta.yDomain,d=p.format("s"),v=p.format(".0r"),o=function(l){return Math.abs(l)>=1?d(l):v(l)};w=this.meta.xScale=p.scale.linear().domain(h).range([0,c]),_=this.meta.yScale=p.scale.linear().domain(f).range([m,0]),this.meta.xAxis=p.svg.axis().scale(w).orient("bottom").tickFormat(o),this.meta.yAxis=p.svg.axis().scale(_).orient("left").tickFormat(o)},e.prototype.setVars=function(){this.meta={},g=this.meta.margin={left:30,right:30,top:20,bottom:20},b=this.meta.zoomBehavior=p.behavior.zoom();var c=this.meta.xDomain=l.xDomain||[-5,5],u=this.meta.yDomain=l.yDomain||[-5,5];x(c[0]<c[1]),x(u[0]<u[1]),l.title&&(this.meta.margin.top=40),this.updateBounds()},e.prototype.build=function(){var u=this.root=p.select(l.target).selectAll("svg").data([l]);this.root.enter=u.enter().append("svg").attr("class","function-plot").attr("font-size",this.getFontSize()),u.attr("width",c+g.left+g.right).attr("height",m+g.top+g.bottom),this.buildTitle(),this.buildLegend(),this.buildCanvas(),this.buildClip(),this.buildAxis(),this.buildContent();var h=this.tip=v(d(l.tip,{owner:this}));this.canvas.call(h),this.buildZoomHelper()},e.prototype.buildTitle=function(){var u=this.root.selectAll("text.title").data((function(l){return[l.title].filter(Boolean)}));u.enter().append("text").attr("class","title").attr("y",g.top/2).attr("x",g.left+c/2).attr("font-size",25).attr("text-anchor","middle").attr("alignment-baseline","middle").text(l.title),u.exit().remove()},e.prototype.buildLegend=function(){this.root.enter.append("text").attr("class","top-right-legend").attr("text-anchor","end"),this.root.select(".top-right-legend").attr("y",g.top).attr("x",c+g.left)},e.prototype.buildCanvas=function(){var c=this;this.meta.zoomBehavior.x(w).y(_).scaleExtent([1e-5,1/0]).on("zoom",(function(){c.emit("all:zoom",w,_)}));var u=this.canvas=this.root.selectAll(".canvas").data((function(l){return[l]}));this.canvas.enter=u.enter().append("g").attr("class","canvas"),u.attr("transform","translate("+g.left+","+g.top+")").call(b).each((function(){var c=p.select(this);l.disableZoom&&c.on(".zoom",null)}))},e.prototype.buildClip=function(){var l=this.id;this.canvas.enter.append("defs").append("clipPath").attr("id","function-plot-clip-"+l).append("rect").attr("class","clip static-clip"),this.canvas.selectAll(".clip").attr("width",c).attr("height",m)},e.prototype.buildAxis=function(){var l=this.canvas.enter;l.append("g").attr("class","x axis"),l.append("g").attr("class","y axis"),this.canvas.select(".x.axis").attr("transform","translate(0,"+m+")").call(this.meta.xAxis),this.canvas.select(".y.axis").call(this.meta.yAxis),this.canvas.selectAll(".axis path, .axis line").attr("fill","none").attr("stroke","black").attr("shape-rendering","crispedges").attr("opacity",.1)},e.prototype.buildAxisLabel=function(){var l,u,h=this.canvas;(l=h.selectAll("text.x.axis-label").data((function(l){return[l.xLabel].filter(Boolean)}))).enter().append("text").attr("class","x axis-label").attr("text-anchor","end"),l.attr("x",c).attr("y",m-6).text((function(l){return l})),l.exit().remove(),u=h.selectAll("text.y.axis-label").data((function(l){return[l.yLabel].filter(Boolean)})),u.enter().append("text").attr("class","y axis-label").attr("y",6).attr("dy",".75em").attr("text-anchor","end").attr("transform","rotate(-90)"),u.text((function(l){return l})),u.exit().remove()},e.prototype.buildContent=function(){var l=this,c=this.canvas,u=this.content=c.selectAll("g.content").data((function(l){return[l]}));u.enter().append("g").attr("clip-path","url(#function-plot-clip-"+this.id+")").attr("class","content");var f=u.selectAll("path.y.origin").data([[[0,_.domain()[0]],[0,_.domain()[1]]]]);f.enter().append("path").attr("class","y origin").attr("stroke","#eee"),f.attr("d",L);var v=u.selectAll("path.x.origin").data([[[w.domain()[0],0],[w.domain()[1],0]]]);v.enter().append("path").attr("class","x origin").attr("stroke","#eee"),v.attr("d",L);var m=u.selectAll("g.graph").data((function(l){return l.data}));m.enter().append("g").attr("class","graph"),m.each((function(c,u){var f=d({owner:l,index:u},c.graphOptions),v=f.type||"line";p.select(this).call(h[v](f)),p.select(this).call(y(f))}))},e.prototype.buildZoomHelper=function(){var l=this;this.canvas.enter.append("rect").attr("class","zoom-and-drag").style("fill","none").style("pointer-events","all"),this.canvas.select(".zoom-and-drag").attr("width",c).attr("height",m).on("mouseover",(function(){l.emit("all:mouseover")})).on("mouseout",(function(){l.emit("all:mouseout")})).on("mousemove",(function(){l.emit("all:mousemove")}))},e.prototype.addLink=function(){for(var l=0;l<arguments.length;l+=1)this.linkedGraphs.push(arguments[l])},e.prototype.getFontSize=function(){var l=Math.max(Math.max(c,m)/60,8);return l>15&&(l=15),l},e.prototype.setUpEventListeners=function(){var l=this,c={mousemove:function(c,u){l.tip.move(c,u)},mouseover:function(){l.tip.show()},mouseout:function(){l.tip.hide()},draw:function(){l.buildContent()},"zoom:scaleUpdate":function(l,c){b.x(w.domain(l.domain())).y(_.domain(c.domain()))},"tip:update":function(c,h,p){var f=l.root.datum().data[p],d=f.title||"",v=f.renderer||function(l,c){return l.toFixed(3)+", "+c.toFixed(3)},m=[];d&&m.push(d),m.push(v(c,h)),l.root.select(".top-right-legend").attr("fill",u.COLORS[p]).text(m.join(" "))}},h={mousemove:function(){var c=p.mouse(l.root.select("rect.zoom-and-drag").node()),u=w.invert(c[0]),h=_.invert(c[1]);l.linkedGraphs.forEach((function(l){l.emit("mousemove",u,h)}))},zoom:function(c,u){l.linkedGraphs.forEach((function(l,h){var p=l.canvas;p.select(".x.axis").call(l.meta.xAxis),p.select(".y.axis").call(l.meta.yAxis),h&&l.emit("zoom:scaleUpdate",c,u),l.emit("draw")})),l.emit("all:mousemove")}};Object.keys(c).forEach((function(u){l.on(u,c[u]),!h[u]&&l.on("all:"+u,(function(){var c=Array.prototype.slice.call(arguments);l.linkedGraphs.forEach((function(l){var h=c.slice();h.unshift(u),l.emit.apply(l,h)}))}))})),Object.keys(h).forEach((function(c){l.on("all:"+c,h[c])}))},new e},u=c.exports.constants=l("./lib/constants"),h=c.exports.types=l("./lib/types/")},{"./lib/constants":3,"./lib/helper/":6,"./lib/tip":7,"./lib/types/":8,"./lib/utils":11,events:2,extend:12}],2:[function(l,c){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(l){return"function"==typeof l}function s(l){return"object"==typeof l&&null!==l}function a(l){return void 0===l}c.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(l){if(!function i(l){return"number"==typeof l}(l)||0>l||isNaN(l))throw TypeError("n must be a positive number");return this._maxListeners=l,this},n.prototype.emit=function(l){var c,u,h,p,f,d;if(this._events||(this._events={}),"error"===l&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if((c=arguments[1])instanceof Error)throw c;throw TypeError('Uncaught, unspecified "error" event.')}if(a(u=this._events[l]))return!1;if(r(u))switch(arguments.length){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:for(h=arguments.length,p=new Array(h-1),f=1;h>f;f++)p[f-1]=arguments[f];u.apply(this,p)}else if(s(u)){for(h=arguments.length,p=new Array(h-1),f=1;h>f;f++)p[f-1]=arguments[f];for(h=(d=u.slice()).length,f=0;h>f;f++)d[f].apply(this,p)}return!0},n.prototype.addListener=function(l,c){var u;if(!r(c))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",l,r(c.listener)?c.listener:c),this._events[l]?s(this._events[l])?this._events[l].push(c):this._events[l]=[this._events[l],c]:this._events[l]=c,s(this._events[l])&&!this._events[l].warned)&&((u=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&u>0&&this._events[l].length>u&&(this._events[l].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[l].length),"function"==typeof console.trace&&console.trace()));return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(l,c){function n(){this.removeListener(l,n),u||(u=!0,c.apply(this,arguments))}if(!r(c))throw TypeError("listener must be a function");var u=!1;return n.listener=c,this.on(l,n),this},n.prototype.removeListener=function(l,c){var u,h,p,f;if(!r(c))throw TypeError("listener must be a function");if(!this._events||!this._events[l])return this;if(p=(u=this._events[l]).length,h=-1,u===c||r(u.listener)&&u.listener===c)delete this._events[l],this._events.removeListener&&this.emit("removeListener",l,c);else if(s(u)){for(f=p;f-- >0;)if(u[f]===c||u[f].listener&&u[f].listener===c){h=f;break}if(0>h)return this;1===u.length?(u.length=0,delete this._events[l]):u.splice(h,1),this._events.removeListener&&this.emit("removeListener",l,c)}return this},n.prototype.removeAllListeners=function(l){var c,u;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[l]&&delete this._events[l],this;if(0===arguments.length){for(c in this._events)"removeListener"!==c&&this.removeAllListeners(c);return this.removeAllListeners("removeListener"),this._events={},this}if(r(u=this._events[l]))this.removeListener(l,u);else for(;u.length;)this.removeListener(l,u[u.length-1]);return delete this._events[l],this},n.prototype.listeners=function(l){return this._events&&this._events[l]?r(this._events[l])?[this._events[l]]:this._events[l].slice():[]},n.listenerCount=function(l,c){return l._events&&l._events[c]?r(l._events[c])?1:l._events[c].length:0}},{}],3:[function(l,c){"use strict";var u=window.d3;c.exports={COLORS:["steelblue","red","#05b378","orange","#4040e8","yellow"].map((function(l){return u.hsl(l)})),ITERATIONS_LIMIT:1e3,DEFAULT_WIDTH:550,DEFAULT_HEIGHT:350,TIP_X_EPS:1}},{}],4:[function(l,c){"use strict";var u=l("./utils"),h=l("./constants"),p=u.assert;c.exports={range:function(l,c){var u=c.range||[-1/0,1/0],h=l.meta.xScale;return[Math.max(h.domain()[0],u[0]),Math.min(h.domain()[1],u[1])]},eval:function(l,c){p("function"==typeof c.fn);var f=[],d=this.range(l,c),v=d[0],m=d[1],y=c.samples||100,x=c.deltaX;x||(x=(m-v)/y);var g=(m-v)/x;p((g=g||1)>=0),g>h.ITERATIONS_LIMIT&&(x=(m-v)/(g=h.ITERATIONS_LIMIT));for(var b=0;g>=b;b+=1){var w=v+x*b,_=c.fn(w);u.isValidNumber(w)&&u.isValidNumber(_)&&f.push([w,_])}return this.split(f,c.graphOptions)},split:function(l,c){c=c||{};var u=.001,h=Array.prototype.slice.call(c.limits||[]),p=[],f=0,d=1,v=[];for(h.unshift(-1e8),h.push(1e8);f<l.length;){for(;f<l.length&&l[f][0]<h[d-1]+u;)++f;for(v=[];f<l.length&&l[f][0]>=h[d-1]+u&&l[f][0]<=h[d]-u;)v.push(l[f++]);++d,v.length&&p.push(v)}return p}}},{"./constants":3,"./utils":11}],5:[function(l,c){"use strict";var u=window.d3,h=l("../types/line");c.exports=function(l){function e(l){var c=l.derivative.x0,u=l.fn(c),h=l.derivative.fn(c);p.fn=function(l){return h*(l-c)+u}}function i(u){var h=this;u.derivative.updateOnMouseOver&&!u.derivative.$$mouseListener&&(u.derivative.$$mouseListener=function(l){u.derivative.x0=l,c(h)},l.owner.on("tip:update",u.derivative.$$mouseListener))}var c,p={skipTip:!0};return c=function(c){c.each((function(f){var d=u.select(this);e.call(c,f),i.call(c,f);var v=d.selectAll("g.derivative").data([p]);v.enter().append("g").attr("class","derivative"),v.call(h(l)),v.selectAll("path").attr("opacity",.5)}))}}},{"../types/line":9}],6:[function(l,c){"use strict";var u=window.d3,h=l("./derivative");c.exports=function(l){return function e(c){c.each((function(c){var p=u.select(this);c.derivative&&p.call(h(l))}))}}},{"./derivative":5}],7:[function(l,c){"use strict";var u=window.d3,h=l("extend"),p=l("./utils"),f=l("./constants");c.exports=function(l){function e(l,c){return l.append("path").datum(c).attr("stroke","grey").attr("stroke-dasharray","5,5").attr("opacity",.5).attr("d",d)}function a(h){var p=h.selectAll("g.tip").data((function(l){return[l]}));p.enter().append("g").attr("class","tip").attr("clip-path","url(#function-plot-clip-"+l.owner.id+")"),a.el=p.selectAll("g.inner-tip").data((function(l){return[l]})),a.el.enter().append("g").attr("class","inner-tip").style("display","none").each((function(){var h=u.select(this);e(h,[[0,-l.owner.meta.height-c],[0,l.owner.meta.height+c]]).attr("class","tip-x-line").style("display","none"),e(h,[[-l.owner.meta.width-c,0],[l.owner.meta.width+c,0]]).attr("class","tip-y-line").style("display","none"),h.append("circle").attr("r",3),h.append("text").attr("transform","translate(5,-5)")})),h.selectAll(".tip-x-line").style("display",l.xLine?null:"none"),h.selectAll(".tip-y-line").style("display",l.yLine?null:"none")}l=h({xLine:!1,yLine:!1,renderer:function(l,c){return"("+l.toFixed(3)+", "+c.toFixed(3)+")"},owner:null},l);var c=20,d=u.svg.line().x((function(l){return l[0]})).y((function(l){return l[1]}));return a.move=function(u,h){var d,v,m,y=1/0,x=-1,g=a.el,b=1e8,w=l.owner.meta,_=g.data()[0].data,L=w.xScale,A=w.yScale,E=w.width,O=w.height;for(d=0;d<_.length;d+=1)if(!_[d].skipTip){var T=_[d].range||[-b,b];if(u>T[0]-f.TIP_X_EPS&&u<T[1]+f.TIP_X_EPS){var S=_[d].fn(u);if(p.isValidNumber(S)){var k=Math.abs(S-h);y>k&&(y=k,x=d)}}}if(-1!==x){v=u,_[x].range&&(v=Math.max(v,_[x].range[0]),v=Math.min(v,_[x].range[1])),m=_[x].fn(v),a.show(),l.owner.emit("tip:update",v,m,x);var I=p.restrict(v,L.invert(-c),L.invert(E+c)),M=p.restrict(m,A.invert(O+c),A.invert(-c));g.attr("transform","translate("+L(I)+","+A(M)+")"),g.select("circle").attr("fill",f.COLORS[x]),g.select("text").attr("fill",f.COLORS[x]).text(l.renderer(v,m))}else a.hide()},a.show=function(){this.el.style("display",null)},a.hide=function(){this.el.style("display","none")},Object.keys(l).forEach((function(c){p.getterSetter.call(a,l,c)})),a}},{"./constants":3,"./utils":11,extend:12}],8:[function(l,c){"use strict";c.exports={line:l("./line"),scatter:l("./scatter")}},{"./line":9,"./scatter":10}],9:[function(l,c){"use strict";var u=window.d3,h=l("../constants"),p=l("../data");c.exports=function(l){var c=l.owner.meta.xScale,f=l.owner.meta.yScale,d=u.svg.line().interpolate(l.interpolate||"cardinal").x((function(l){return c(l[0])})).y((function(l){return f(l[1])})),v=u.svg.area().x((function(l){return c(l[0])})).y0(f(0)).y1((function(l){return f(l[1])}));return function e(c){var f=l.index;c.each((function(c){var m=e.el=u.select(this),y=p.eval(l.owner,c),x=m.selectAll("path").data(y);x.enter().append("path").attr("class","line line-"+f).attr("stroke",h.COLORS[f]),x.each((function(){var c,p=u.select(this);l.closed?(p.attr("fill",h.COLORS[f]),p.attr("fill-opacity",.3),c=v):(p.attr("fill","none"),c=d),p.attr("d",c)})),x.exit().remove()}))}}},{"../constants":3,"../data":4}],10:[function(l,c){"use strict";var u=window.d3,h=l("../constants"),p=l("../data");c.exports=function(l){var c=l.owner.meta.xScale,f=l.owner.meta.yScale;return function e(d){var v=l.index;d.each((function(d){var m,y,x=u.hsl(h.COLORS[v].toString()),g=p.eval(l.owner,d),b=[];for(m=0;m<g.length;m+=1)for(y=0;y<g[m].length;y+=1)b.push(g[m][y]);var w=u.select(this).selectAll("circle").data(b);w.enter().append("circle").attr("class","circle circle-"+v).attr("fill",u.hsl(x.toString()).brighter(1.5)).attr("stroke",x),w.attr("opacity",.7).attr("r",1).attr("cx",(function(l){return c(l[0])})).attr("cy",(function(l){return f(l[1])})),w.exit().remove()}))}}},{"../constants":3,"../data":4}],11:[function(l,c){"use strict";c.exports={isValidNumber:function(l){return"number"==typeof l&&!isNaN(l)&&isFinite(l)},getterSetter:function(l,c){var u=this;this[c]=function(h){return arguments.length?(l[c]=h,u):l[c]}},restrict:function(l,c,u){if(c>u){var h=c;c=u,u=h}return l=Math.max(l,c),Math.min(l,u)},assert:function(l,c){if(c=c||"assertion failed",!l)throw new Error(c)}}},{}],12:[function(l,c){var u,h=Object.prototype.hasOwnProperty,p=Object.prototype.toString,s=function(l){"use strict";if(!l||"[object Object]"!==p.call(l))return!1;var c,f=h.call(l,"constructor"),d=l.constructor&&l.constructor.prototype&&h.call(l.constructor.prototype,"isPrototypeOf");if(l.constructor&&!f&&!d)return!1;for(c in l);return c===u||h.call(l,c)};c.exports=function a(){"use strict";var l,c,h,p,f,d,v=arguments[0],m=1,y=arguments.length,x=!1;for("boolean"==typeof v?(x=v,v=arguments[1]||{},m=2):("object"!=typeof v&&"function"!=typeof v||null==v)&&(v={});y>m;++m)if(null!=(l=arguments[m]))for(c in l)h=v[c],v!==(p=l[c])&&(x&&p&&(s(p)||(f=Array.isArray(p)))?(f?(f=!1,d=h&&Array.isArray(h)?h:[]):d=h&&s(h)?h:{},v[c]=a(x,d,p)):p!==u&&(v[c]=p));return v}},{}]},{},[1])(1)}));