define((function(){"use strict";var n={getEnvironment:function(e){if(n.isSugarizer()){var getUrlParameter=function(n){var e=RegExp("[?&]"+n+"=([^&]*)").exec(window.location.search);return e&&decodeURIComponent(e[1].replace(/\+/g," "))};window.top.sugar={},window.top.sugar.environment={activityId:getUrlParameter("aid"),activityName:getUrlParameter("n"),bundleId:getUrlParameter("a"),objectId:getUrlParameter("o"),sharedId:getUrlParameter("s"),help:getUrlParameter("h"),standAlone:getUrlParameter("sa")},"undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime?chrome.storage.local.get("sugar_settings",(function(n){window.top.sugar.environment.user=JSON.parse(n.sugar_settings),e(null,window.top.sugar.environment)})):(window.top.sugar.environment.user=JSON.parse(localStorage.sugar_settings),setTimeout((function(){e(null,window.top.sugar.environment)}),0))}else if(n.isStandalone())setTimeout((function(){e(null,{})}),0);else{var environmentCallback=function(){e(null,window.top.sugar.environment)};window.top.sugar?setTimeout((function(){environmentCallback()}),0):(window.top.sugar={},window.top.sugar.onEnvironmentSet=function(){environmentCallback()})}},getObjectId:function(e){n.getEnvironment((function(n,t){e(t.objectId)}))},getURLScheme:function(){return window.location.protocol},getHost:function(){return window.location.hostname},isStandalone:function(){var e=n.getURLScheme();return"activity:"!==e&&"file:"!==e&&"0.0.0.0"!==window.location.hostname},isSugarizer:function(){if("undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime)return!0;if("undefined"!=typeof Storage&&void 0!==window.localStorage)try{return null!==window.localStorage.getItem("sugar_settings")}catch(n){return!1}return!1},isSugarizerOS:function(){return void 0!==window.sugarizerOS}};return n}));